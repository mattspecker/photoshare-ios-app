const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index-DJafiPoS.js","assets/index-CtwFNlw1.css","assets/QRScanner-DtRyZ6Bb.js"])))=>i.map(i=>d[i]);
var pe=Object.defineProperty;var ge=(t,r,n)=>r in t?pe(t,r,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[r]=n;var ee=(t,r,n)=>ge(t,typeof r!="symbol"?r+"":r,n);import{r as i,j as e,B as E,R as xe,s as R,u as re,a as oe,b as ce,d as le,I as K,C as fe,c as ve,e as te,f as we,g as je,T as _e,h as be,i as Ne,U as Ce,k as Ee,L as ye,Q as de,D as Se,l as De,m as ke,n as Pe,o as Te,p as se,_ as ue,q as Le,t as Re,v as Ae,w as Me,x as Ie,y as Oe,z as qe,P as ze,A as ae,S as Ue,E as Fe,F as $e,G as Be,H as Je,J as Qe}from"./index-DJafiPoS.js";import{C as He}from"./circle-x-BcFUi8j5.js";import{S as Ge,D as Ve,a as We,F as Ye,b as Ze,c as G,U as me,P as he}from"./dropdown-menu-DJsBqjfm.js";import"./circle-CQRJsGNp.js";class Xe extends i.Component{constructor(n){super(n);ee(this,"handleRetry",()=>{this.setState({hasError:!1,error:null,errorInfo:null})});this.state={hasError:!1,error:null,errorInfo:null}}static getDerivedStateFromError(n){return{hasError:!0,error:n,errorInfo:null}}componentDidCatch(n,a){console.error("ðŸš¨ Error Boundary caught an error:",n,a),this.setState({error:n,errorInfo:a})}render(){return this.state.hasError?this.props.fallback?this.props.fallback:e.jsx("div",{className:"min-h-screen bg-background flex items-center justify-center p-4",children:e.jsxs("div",{className:"max-w-md w-full space-y-6 text-center",children:[e.jsx("div",{className:"flex justify-center",children:e.jsx("div",{className:"p-4 rounded-full bg-destructive/10",children:e.jsx(He,{className:"w-12 h-12 text-destructive"})})}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("h1",{className:"text-2xl font-semibold",children:"Something Went Wrong"}),e.jsx("p",{className:"text-muted-foreground",children:"An error occurred while rendering this component. Please try again or refresh the page."})]}),!1,e.jsxs("div",{className:"space-y-2",children:[e.jsxs(E,{onClick:()=>window.location.reload(),className:"w-full",children:[e.jsx(xe,{className:"h-4 w-4 mr-2"}),"Refresh Page"]}),e.jsx(E,{onClick:this.handleRetry,variant:"outline",className:"w-full",children:"Try Again"})]})]})}):this.props.children}}const ne=(t,r={})=>{const{maxBatchSize:n=20,batchDelayMs:a=50}=r,o=i.useRef(new Map),h=i.useRef(null),c=i.useCallback(async()=>{const m=new Map(o.current);if(o.current.clear(),m.size!==0)try{const d=Array.from(m.keys());console.log(`ðŸ”„ Processing batch of ${d.length} requests`);const s=await t(d);m.forEach((v,u)=>{const w=s.get(u);w!==void 0?v.resolve(w):v.reject(new Error(`No result for ID: ${u}`))}),console.log("âœ… Batch completed successfully")}catch(d){console.error("âŒ Batch processing failed:",d),m.forEach(s=>{s.reject(d)})}},[t]),b=i.useCallback(()=>{h.current&&clearTimeout(h.current),h.current=setTimeout(()=>{c()},a)},[c,a]);return{request:i.useCallback(m=>new Promise((d,s)=>{o.current.set(m,{id:m,resolve:d,reject:s}),o.current.size>=n?(h.current&&(clearTimeout(h.current),h.current=null),c()):b()}),[n,c,b])}},Ke=()=>{const[t,r]=i.useState(new Map),[n,a]=i.useState(!1),o=i.useCallback(async m=>{console.log(`ðŸ“Š Batching participant counts for ${m.length} events`);const d=new Map,s=m.map(async u=>{const{data:w,error:A}=await R.rpc("get_event_participant_count",{event_id_param:u});return A?(console.error(`âŒ Failed to get participant count for ${u}:`,A),{eventId:u,count:0}):{eventId:u,count:w||0}});return(await Promise.all(s)).forEach(({eventId:u,count:w})=>{d.set(u,w)}),d},[]),h=i.useCallback(async m=>{console.log(`ðŸ“¸ Batching media counts for ${m.length} events`);const{data:d,error:s}=await R.from("media").select("event_id").in("event_id",m).eq("is_visible",!0);if(s)throw console.error("âŒ Failed to batch media counts:",s),s;const v=new Map;return m.forEach(u=>v.set(u,0)),d==null||d.forEach(u=>{const w=v.get(u.event_id)||0;v.set(u.event_id,w+1)}),v},[]),{request:c}=ne(o,{maxBatchSize:25,batchDelayMs:100}),{request:b}=ne(h,{maxBatchSize:25,batchDelayMs:100}),y=i.useCallback(async m=>{if(m.length===0)return[];console.log(`ðŸš€ Loading counts for ${m.length} events (batched)`),a(!0);try{const d=await Promise.all(m.map(async s=>{var v,u,w,A,k,M;try{const[z,N]=await Promise.all([c(s.event_id),b(s.event_id)]),C={participantCount:z||0,photoCount:N||0};r(Y=>new Map(Y).set(s.event_id,C));const P=new Date,S=new Date(s.start_time),U=new Date(s.end_time);let I="upcoming";return s.status==="paused"?I="paused":P>=S&&P<=U?I="live":P>U&&(I="ended"),{id:s.event_id,name:s.name,description:"",startTime:s.start_time,endTime:s.end_time,status:I,participantCount:C.participantCount,photoCount:C.photoCount,eventCode:((w=(u=(v=s.invite_links)==null?void 0:v[0])==null?void 0:u.link)==null?void 0:w.split("/").pop())||ie(s.event_id),passcode:s.passcode,isOwner:s.isOwner,isAdmin:s.isAdmin,isOrganizer:s.isOrganizer,qrCodeImageUrl:s.qr_code_image_url,headerImageUrl:s.header_image_url,photosDeletedAt:s.photos_deleted_at}}catch(z){console.error(`âŒ Failed to load counts for event ${s.event_id}:`,z);const N=new Date,C=new Date(s.start_time),P=new Date(s.end_time);let S="upcoming";return s.status==="paused"?S="paused":N>=C&&N<=P?S="live":N>P&&(S="ended"),{id:s.event_id,name:s.name,description:"",startTime:s.start_time,endTime:s.end_time,status:S,participantCount:0,photoCount:0,eventCode:((M=(k=(A=s.invite_links)==null?void 0:A[0])==null?void 0:k.link)==null?void 0:M.split("/").pop())||ie(s.event_id),passcode:s.passcode,isOwner:s.isOwner,isAdmin:s.isAdmin,isOrganizer:s.isOrganizer,qrCodeImageUrl:s.qr_code_image_url,headerImageUrl:s.header_image_url,photosDeletedAt:s.photos_deleted_at}}}));return console.log(`âœ… Loaded counts for ${d.length} events`),d}catch(d){throw console.error("âŒ Failed to load event counts:",d),d}finally{a(!1)}},[c,b]);return{counts:t,isLoading:n,loadEventCounts:y}},ie=t=>{const r=["AMAZING","EPIC","MAGICAL","SUNNY","GOLDEN","BRIGHT"],n=["PARTY","EVENT","CELEBRATION","GATHERING","MOMENTS","MEMORIES"],a=t.replace(/-/g,"").toLowerCase(),o=parseInt(a.slice(0,2),16)%r.length,h=parseInt(a.slice(2,4),16)%n.length,c=parseInt(a.slice(4,6),16)%100;return`${r[o]}${n[h]}${c}`},et=()=>{const{user:t,logout:r,isLoading:n}=re(),{toast:a}=oe(),o=ce(),[h,c]=i.useState([]),[b,y]=i.useState(!0),{loadEventCounts:m,isLoading:d}=Ke(),[s,v]=i.useState(""),[u,w]=i.useState("all"),[A,k]=i.useState(!1),[M,z]=i.useState(""),[N,C]=i.useState(""),[P,S]=i.useState(!1);i.useEffect(()=>{const x=new URLSearchParams(window.location.search),D=x.get("join"),_=x.get("passcode");D&&(z(D.toUpperCase()),C(_||""),k(!0),window.history.replaceState({},document.title,"/dashboard"))},[]),i.useEffect(()=>{if(!n){if(!t){o("/login");return}U()}},[t,n,o]);const U=i.useCallback(async()=>{if(t)try{y(!0),console.log("Loading events for user:",t==null?void 0:t.id);const[x,D]=await Promise.all([R.from("events").select(`
            event_id,
            name,
            start_time,
            end_time,
            status,
            passcode,
            owner_id,
            qr_code_image_url,
            header_image_url,
            photos_deleted_at,
            invite_links(link)
          `).eq("owner_id",t.id),R.from("event_participants").select(`
            roles,
            events!inner(
              event_id,
              name,
              start_time,
              end_time,
              status,
              passcode,
              owner_id,
              qr_code_image_url,
              header_image_url,
              photos_deleted_at,
              invite_links(link)
            )
          `).eq("user_id",t.id)]),_=x.data||[],T=D.data||[],$=T.map(l=>l.events),O=new Map,L=new Set(_.map(l=>l.event_id)),J=new Set(T.filter(l=>l.roles&&l.roles.includes("admin")).map(l=>l.events.event_id)),Q=new Set(T.filter(l=>l.roles&&l.roles.includes("organizer")).map(l=>l.events.event_id));[..._,...$].forEach(l=>{var H,Z;if(!O.has(l.event_id)){const X=(Z=(H=l.invite_links)==null?void 0:H[0])==null?void 0:Z.link;let W="NO_CODE";if(X){const p=X.match(/\/join\/([A-Z0-9]+)/);W=p?p[1]:"NO_CODE"}O.set(l.event_id,{...l,eventCode:W,isOwner:L.has(l.event_id),isAdmin:J.has(l.event_id),isOrganizer:Q.has(l.event_id)})}});const g=Array.from(O.values()),B=x.error||D.error;if(B){console.error("Error loading events:",B),a({title:"Failed to load events",description:`Database error: ${B.message}`,variant:"destructive"});return}console.log(`ðŸš€ Loading ${(g==null?void 0:g.length)||0} events with batched requests`);const F=(await m(g||[])).sort((l,H)=>new Date(H.startTime).getTime()-new Date(l.startTime).getTime());c(F)}catch(x){console.error("Error loading events:",x),a({title:"Failed to load events",description:"Please try again or check your connection.",variant:"destructive"})}finally{y(!1)}},[t,m,a]),I=h.filter(x=>{var T;const D=le(x.name).toLowerCase().includes(s.toLowerCase())||((T=x.description)==null?void 0:T.toLowerCase().includes(s.toLowerCase()))||x.eventCode.toLowerCase().includes(s.toLowerCase());let _=!0;return u==="memories"?_=!!x.photosDeletedAt:u==="all"?_=!x.photosDeletedAt:_=x.status===u&&!x.photosDeletedAt,D&&_}),Y=i.useCallback(async(x,D)=>{const _=x||M,T=D||N;if(!_.trim()){a({title:"Event code required",description:"Please enter an event code to join.",variant:"destructive"});return}S(!0);try{const $=`%/join/${_.toUpperCase()}`,{data:O,error:L}=await R.from("invite_links").select("event_id, link").ilike("link",$).maybeSingle();if(L){a({title:"Database error",description:`Unable to search for event: ${L.message}`,variant:"destructive"});return}if(!O){a({title:"Event not found",description:"Please check the event code and try again.",variant:"destructive"});return}const{data:J,error:Q}=await R.from("events").select(`
          event_id,
          name,
          start_time,
          end_time,
          status,
          passcode,
          owner_id
        `).eq("event_id",O.event_id).maybeSingle();if(Q||!J){a({title:"Event not found",description:"Please check the event code and try again.",variant:"destructive"});return}const g=J;if(g.owner_id===(t==null?void 0:t.id)){a({title:"Already your event",description:"This is an event you created."}),k(!1);return}if(g.passcode&&T!==g.passcode){a({title:"Invalid passcode",description:"Please enter the correct event passcode.",variant:"destructive"});return}const{data:B}=await R.from("event_participants").select("*").eq("event_id",g.event_id).eq("user_id",t==null?void 0:t.id).single();if(B){a({title:"Already joined",description:"You're already a participant in this event."}),k(!1),o(`/event/${g.event_id}`);return}const{error:V}=await R.from("event_participants").insert({event_id:g.event_id,user_id:t==null?void 0:t.id,roles:["participant"]});if(V){a({title:"Failed to join event",description:V.message,variant:"destructive"});return}try{await R.from("user_event_notification_settings").insert({user_id:t==null?void 0:t.id,event_id:g.event_id,upcoming_event:!0,event_starting:!0,upload_reminder:!0,download_reminder:!0});const F=localStorage.getItem(`auto_upload_settings_${t==null?void 0:t.id}`);F&&JSON.parse(F).autoUploadEnabled&&await R.from("event_participants").update({auto_upload_enabled:!0,auto_upload_start_time:g.start_time,auto_upload_end_time:g.end_time}).eq("event_id",g.event_id).eq("user_id",t==null?void 0:t.id)}catch(F){console.error("Failed to set default preferences:",F)}a({title:"Successfully joined!",description:`Welcome to ${g.name}`}),k(!1),z(""),C(""),U(),o(`/event/${g.event_id}`)}catch($){console.error("Error joining event:",$),a({title:"Failed to join event",description:"Please try again.",variant:"destructive"})}finally{S(!1)}},[t,M,N,a,o,U]);return{events:h,isLoadingEvents:b,isLoadingCounts:d,searchQuery:s,statusFilter:u,showJoinDialog:A,joinEventCode:M,joinPasscode:N,isJoining:P,filteredEvents:I,setSearchQuery:v,setStatusFilter:w,setShowJoinDialog:k,setJoinEventCode:z,setJoinPasscode:C,joinEvent:Y,loadEvents:U,logout:r}},tt=({user:t,searchQuery:r,setSearchQuery:n,statusFilter:a,setStatusFilter:o})=>e.jsxs("div",{className:"safe-area-header bg-background/80 backdrop-blur-md border-b border-border px-4 py-4 sticky top-[73px] z-30",children:[e.jsxs("div",{className:"flex gap-2 mb-3",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx(Ge,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-muted-foreground w-4 h-4"}),e.jsx(K,{type:"text",placeholder:"Search events...",value:r,onChange:h=>n(h.target.value),className:"pl-10",autoFocus:!1})]}),e.jsxs(Ve,{children:[e.jsx(We,{asChild:!0,children:e.jsx(E,{size:"icon",variant:"outline",className:"min-w-[48px] min-h-[48px]",children:e.jsx(Ye,{className:"w-4 h-4"})})}),e.jsxs(Ze,{align:"end",className:"w-48 bg-background z-50",children:[e.jsx(G,{onClick:()=>o("all"),children:"All Events"}),e.jsx(G,{onClick:()=>o("live"),children:"Live"}),e.jsx(G,{onClick:()=>o("upcoming"),children:"Upcoming"}),e.jsx(G,{onClick:()=>o("ended"),children:"Ended"}),e.jsx(G,{onClick:()=>o("paused"),children:"Paused"}),e.jsx(G,{onClick:()=>o("memories"),children:"Memories"})]})]})]}),e.jsx("h2",{className:"text-xl font-semibold",children:"My Events"})]}),st=({event:t,onShowQR:r,onToggleNotifications:n,enabledNotifications:a,formatDateTime:o,getStatusColor:h})=>{const c=!!t.photosDeletedAt,b=c?"memory-card":"event-card";return e.jsxs(fe,{className:b,children:[e.jsxs("div",{className:"aspect-[2/1] relative overflow-hidden rounded-t-xl",children:[e.jsx("img",{src:t.headerImageUrl||ve,alt:`${t.name} header`,className:"w-full h-full object-cover",loading:"lazy"}),!c&&e.jsx(te,{className:`absolute top-2 right-2 ${h(t.status)} text-white capitalize`,children:t.status}),c&&e.jsx(te,{className:"absolute top-2 right-2 bg-muted/80 text-muted-foreground",children:"Memory"}),e.jsx("div",{className:"absolute bottom-0 left-0 right-0 bg-gradient-to-t from-black/80 to-transparent p-4",children:e.jsx("h3",{className:"text-xl font-bold text-white",children:le(t.name)})})]}),e.jsxs(we,{className:"p-4 space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[e.jsx(je,{className:"w-4 h-4"}),e.jsx("span",{children:o(t.startTime)})]}),!c&&n&&a&&e.jsx(_e,{variant:"outline",size:"default",pressed:a[t.id]||!1,onPressedChange:()=>n(t.id),className:"min-w-[48px] min-h-[48px] data-[state=on]:border-accent data-[state=on]:bg-transparent data-[state=off]:border-border","aria-label":a[t.id]?"Disable notifications":"Enable notifications",children:a[t.id]?e.jsx(be,{className:"w-5 h-5 fill-accent text-accent"}):e.jsx(Ne,{className:"w-5 h-5"})})]}),e.jsxs("div",{className:"flex items-center gap-4 text-sm text-muted-foreground",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(Ce,{className:"w-4 h-4"}),e.jsxs("span",{children:[t.participantCount," guests"]})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(Ee,{className:"w-4 h-4"}),e.jsxs("span",{children:[t.photoCount," photos"]})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(E,{asChild:!0,className:"flex-1 camera-button",children:e.jsx(ye,{to:`/event/${t.id}`,children:c?"View Memory":"View Event"})}),!c&&e.jsx(E,{variant:"outline",size:"icon",onClick:()=>r(t),className:"min-w-[48px] min-h-[48px]",children:e.jsx(de,{className:"w-4 h-4"})})]})]})]})},at=({show:t,onClose:r,eventCode:n,setEventCode:a,passcode:o,setPasscode:h,isJoining:c,onJoin:b})=>e.jsx(Se,{open:t,onOpenChange:r,children:e.jsxs(De,{children:[e.jsxs(ke,{children:[e.jsx(Pe,{children:"Join Event"}),e.jsx(Te,{children:"Enter the event code to join an existing event."})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(se,{htmlFor:"eventCode",children:"Event Code"}),e.jsx(K,{id:"eventCode",type:"text",placeholder:"Enter event code",value:n,onChange:y=>a(y.target.value.toUpperCase()),className:"uppercase"})]}),e.jsxs("div",{children:[e.jsx(se,{htmlFor:"passcode",children:"Passcode (if required)"}),e.jsx(K,{id:"passcode",type:"password",placeholder:"Enter passcode",value:o,onChange:y=>h(y.target.value)})]}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx(E,{variant:"outline",onClick:r,className:"flex-1",disabled:c,children:"Cancel"}),e.jsx(E,{onClick:b,className:"flex-1",disabled:c||!n.trim(),children:c?"Joining...":"Join Event"})]})]})]})}),nt=({onCreateEvent:t,onJoinEvent:r})=>e.jsx("div",{className:"fixed bottom-0 left-0 right-0 bg-background/95 backdrop-blur-sm border-t border-border p-4 [@media(max-width:390px)]:px-2 pb-8 safe-area-bottom",children:e.jsxs("div",{className:"flex space-x-3 [@media(max-width:390px)]:space-x-2 max-w-screen-lg mx-auto",children:[e.jsxs(E,{onClick:r,variant:"outline",size:"lg",className:"flex-1 h-14 [@media(max-width:390px)]:h-12 text-base [@media(max-width:390px)]:text-sm gap-2 [@media(max-width:390px)]:gap-1.5",children:[e.jsx(me,{className:"w-5 h-5 [@media(max-width:390px)]:w-4 [@media(max-width:390px)]:h-4"}),"Join Event"]}),e.jsxs(E,{onClick:t,size:"lg",className:"flex-1 camera-button h-14 [@media(max-width:390px)]:h-12 text-base [@media(max-width:390px)]:text-sm gap-2 [@media(max-width:390px)]:gap-1.5",children:[e.jsx(he,{className:"w-5 h-5 [@media(max-width:390px)]:w-4 [@media(max-width:390px)]:h-4"}),"Create Event"]})]})}),it=i.lazy(()=>ue(()=>import("./index-DJafiPoS.js").then(t=>t.cV),__vite__mapDeps([0,1]))),rt=i.lazy(()=>ue(()=>import("./QRScanner-DtRyZ6Bb.js"),__vite__mapDeps([2,0,1]))),mt=()=>{var W;const{user:t}=re(),{toast:r}=oe();Le();const n=ce(),{events:a,isLoadingEvents:o,searchQuery:h,statusFilter:c,showJoinDialog:b,joinEventCode:y,joinPasscode:m,isJoining:d,filteredEvents:s,setSearchQuery:v,setStatusFilter:u,setShowJoinDialog:w,setJoinEventCode:A,setJoinPasscode:k,joinEvent:M,logout:z}=et(),[N,C]=i.useState({});Re();const{setupEventNotifications:P,removeEventNotifications:S}=Ae(),{platform:U,isNative:I,dbPlatform:Y}=Me(),{createNotificationSettingsForUserEvents:x,getEventNotificationSettings:D,createEventNotificationSettings:_,removeEventNotificationSettings:T}=Ie();i.useEffect(()=>{(async()=>{if(!t||a.length===0)return;const f={};for(const j of a){const q=await D(j.id);f[j.id]=q!==null}C(f)})()},[a.length,t]);const[$,O]=i.useState(!1),[L,J]=i.useState(null),[Q,g]=i.useState(!1);Oe();const{shouldShowOnboarding:B,currentStep:V,isLoading:F,markStepComplete:l}=qe(),H=p=>{switch(p){case"live":return"bg-green-500 text-white";case"upcoming":return"bg-blue-500 text-white";case"paused":return"bg-orange-500 text-white";case"ended":return"bg-gray-500 text-white";default:return"bg-gray-500 text-white"}},Z=(p,f)=>{try{const j=new Date(p);return f?j.toLocaleDateString("en-US",{month:"short",day:"numeric",hour:"2-digit",minute:"2-digit",timeZoneName:"short"}):j.toLocaleDateString("en-US",{month:"short",day:"numeric",hour:"2-digit",minute:"2-digit",timeZoneName:"short"})}catch(j){return console.error("Date formatting error:",j),"Invalid date"}},X=async p=>{const f=!N[p],j=a.find(q=>q.id===p);if(!j){r({title:"Event not found",description:"Unable to toggle notifications for this event.",variant:"destructive"});return}try{if(f){if(await _(p,{upcomingEvent:!0,eventStarting:!0,uploadReminder:!0,downloadReminder:!0}),I){const q={eventId:j.id,eventName:j.name,startTime:j.startTime,endTime:j.endTime,deleteDate:j.photosDeletedAt||new Date(new Date(j.endTime).getTime()+2592e6).toISOString(),timezone:"UTC"};await P(q)}}else await T(p),I&&await S(p);C(q=>({...q,[p]:f})),r({title:f?"Notifications enabled":"Notifications disabled",description:f?"You'll receive updates about this event":"No more notifications for this event"})}catch(q){console.error("Failed to toggle notifications:",q),r({title:"Failed to update notifications",description:"Please try again.",variant:"destructive"})}};return B&&!F?e.jsx(ze,{currentStep:V,onStepComplete:l}):e.jsx(Xe,{children:e.jsxs("div",{className:"min-h-screen bg-background font-outfit",children:[e.jsx("div",{className:"sticky top-0 z-40 bg-background/80 backdrop-blur-md border-b border-border",children:e.jsxs("div",{className:"flex items-center justify-between px-4 py-3",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"p-2 rounded-xl",style:{background:"var(--gradient-primary)",boxShadow:"var(--shadow-camera)"},children:e.jsx(ae,{className:"h-6 w-6 text-primary-foreground"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Welcome back"}),e.jsx("p",{className:"font-semibold",children:((W=t==null?void 0:t.email)==null?void 0:W.split("@")[0])||"User"})]})]}),e.jsx(E,{variant:"ghost",size:"icon",onClick:()=>n("/settings"),className:"shrink-0",children:e.jsx(Ue,{className:"w-5 h-5"})})]})}),e.jsx(tt,{user:t,searchQuery:h,setSearchQuery:v,statusFilter:c,setStatusFilter:u}),e.jsx("div",{className:"container mx-auto px-4 py-8 pb-32",children:o?e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[...Array(6)].map((p,f)=>e.jsxs("div",{className:"event-card",children:[e.jsx("div",{className:"aspect-video bg-muted loading-shimmer rounded-t-xl"}),e.jsxs("div",{className:"p-4 space-y-3",children:[e.jsx("div",{className:"h-4 bg-muted loading-shimmer rounded w-3/4"}),e.jsx("div",{className:"h-3 bg-muted loading-shimmer rounded w-1/2"}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx("div",{className:"h-8 bg-muted loading-shimmer rounded flex-1"}),e.jsx("div",{className:"h-8 bg-muted loading-shimmer rounded w-12"})]})]})]},f))}):s.length>0?e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:s.map(p=>e.jsx(st,{event:p,onShowQR:f=>{J(f),O(!0)},onToggleNotifications:X,enabledNotifications:N,formatDateTime:Z,getStatusColor:H},p.id))}):e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"camera-button w-16 h-16 mx-auto mb-4",children:e.jsx(ae,{className:"w-8 h-8"})}),e.jsx("h3",{className:"text-lg font-medium mb-2",children:a.length===0?"No events yet":`No ${c==="all"?"":c+" "}events found`}),e.jsx("p",{className:"text-muted-foreground mb-6",children:a.length===0?"Create your first event or join one to get started!":"Try adjusting your search or filter criteria"}),a.length===0&&e.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 justify-center",children:[e.jsxs(E,{onClick:()=>n("/create-event"),className:"camera-button",children:[e.jsx(he,{className:"w-4 h-4 mr-2"}),"Create Event"]}),e.jsxs(E,{variant:"outline",onClick:()=>n("/join"),children:[e.jsx(me,{className:"w-4 h-4 mr-2"}),"Join Event"]})]})]})}),e.jsx(nt,{onCreateEvent:()=>n("/create-event"),onJoinEvent:()=>n("/join")}),e.jsx(at,{show:b,onClose:()=>w(!1),eventCode:y,setEventCode:A,passcode:m,setPasscode:k,isJoining:d,onJoin:()=>M()}),L&&e.jsx(i.Suspense,{fallback:e.jsx("div",{children:"Loading..."}),children:e.jsx(Fe,{open:$,onOpenChange:O,children:e.jsxs($e,{children:[e.jsxs(Be,{children:[e.jsxs(Je,{className:"flex items-center gap-2",children:[e.jsx(de,{className:"h-5 w-5"}),"Share Event"]}),e.jsx(Qe,{children:"Scan the QR code or share the event link to invite guests"})]}),e.jsx(it,{eventCode:L.eventCode,eventName:L.name,passcode:L.passcode,customQRCodeUrl:L.qrCodeImageUrl})]})})}),Q&&e.jsx(i.Suspense,{fallback:e.jsx("div",{children:"Loading scanner..."}),children:e.jsx(rt,{isOpen:Q,onScanResult:(p,f)=>{console.log("QR scan result:",{eventCode:p,passcode:f}),M(p,f),g(!1)},onClose:()=>g(!1)})})]})})};export{mt as default};
