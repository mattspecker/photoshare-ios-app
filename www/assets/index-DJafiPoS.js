const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/Dashboard-BHYlAOpn.js","assets/circle-x-BcFUi8j5.js","assets/dropdown-menu-DJsBqjfm.js","assets/circle-CQRJsGNp.js","assets/AdminDashboard-CU8KvEIB.js","assets/alert-CfkXRUBM.js","assets/trending-up-DxtAA6yN.js","assets/CreateEvent-D3rAg9uo.js","assets/EventCreationBranding-BLv5icVp.js","assets/validation-DjZNYcmo.js","assets/Camera-CAx9bHLJ.js","assets/progress-BaocU3Fv.js","assets/circle-check-CtFdAZ6P.js","assets/JoinEvent-BbPYzfbI.js","assets/QRScanner-DtRyZ6Bb.js","assets/Settings-rrgpavlv.js","assets/sun-Cy0ZKASr.js","assets/TestDownloadPicker-CH7ogvDp.js","assets/checkbox-iDr-qMvW.js","assets/Styles-DB_OukcW.js","assets/TestDashboard-D3glmJ79.js","assets/TestCreateEvent-HlMlIQWe.js","assets/TestJoinEvent-DGl32hPa.js","assets/TestCamera-DJ4MNXYy.js","assets/TestSettings-BKmWVVfC.js","assets/TestAdminDashboard-CFJ7oiO7.js","assets/TestUploadOverlay-mIh1bHuM.js","assets/TestErrorUI-CT6WhJl7.js"])))=>i.map(i=>d[i]);
var q3=Object.defineProperty;var Cb=n=>{throw TypeError(n)};var Y3=(n,e,t)=>e in n?q3(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t;var It=(n,e,t)=>Y3(n,typeof e!="symbol"?e+"":e,t),q0=(n,e,t)=>e.has(n)||Cb("Cannot "+t);var se=(n,e,t)=>(q0(n,e,"read from private field"),t?t.call(n):e.get(n)),at=(n,e,t)=>e.has(n)?Cb("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(n):e.set(n,t),He=(n,e,t,r)=>(q0(n,e,"write to private field"),r?r.call(n,t):e.set(n,t),t),xn=(n,e,t)=>(q0(n,e,"access private method"),t);var Wd=(n,e,t,r)=>({set _(s){He(n,e,s,t)},get _(){return se(n,e,r)}});function X3(n,e){for(var t=0;t<e.length;t++){const r=e[t];if(typeof r!="string"&&!Array.isArray(r)){for(const s in r)if(s!=="default"&&!(s in n)){const i=Object.getOwnPropertyDescriptor(r,s);i&&Object.defineProperty(n,s,i.get?i:{enumerable:!0,get:()=>r[s]})}}}return Object.freeze(Object.defineProperty(n,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function t(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(s){if(s.ep)return;s.ep=!0;const i=t(s);fetch(s.href,i)}})();var Ie=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Ap(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}function G2(n){if(n.__esModule)return n;var e=n.default;if(typeof e=="function"){var t=function r(){return this instanceof r?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};t.prototype=e.prototype}else t={};return Object.defineProperty(t,"__esModule",{value:!0}),Object.keys(n).forEach(function(r){var s=Object.getOwnPropertyDescriptor(n,r);Object.defineProperty(t,r,s.get?s:{enumerable:!0,get:function(){return n[r]}})}),t}var q2={exports:{}},Dp={},Y2={exports:{}},Je={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var fd=Symbol.for("react.element"),K3=Symbol.for("react.portal"),J3=Symbol.for("react.fragment"),Q3=Symbol.for("react.strict_mode"),Z3=Symbol.for("react.profiler"),e5=Symbol.for("react.provider"),t5=Symbol.for("react.context"),n5=Symbol.for("react.forward_ref"),r5=Symbol.for("react.suspense"),s5=Symbol.for("react.memo"),i5=Symbol.for("react.lazy"),Eb=Symbol.iterator;function o5(n){return n===null||typeof n!="object"?null:(n=Eb&&n[Eb]||n["@@iterator"],typeof n=="function"?n:null)}var X2={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},K2=Object.assign,J2={};function rc(n,e,t){this.props=n,this.context=e,this.refs=J2,this.updater=t||X2}rc.prototype.isReactComponent={};rc.prototype.setState=function(n,e){if(typeof n!="object"&&typeof n!="function"&&n!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,n,e,"setState")};rc.prototype.forceUpdate=function(n){this.updater.enqueueForceUpdate(this,n,"forceUpdate")};function Q2(){}Q2.prototype=rc.prototype;function Sx(n,e,t){this.props=n,this.context=e,this.refs=J2,this.updater=t||X2}var Cx=Sx.prototype=new Q2;Cx.constructor=Sx;K2(Cx,rc.prototype);Cx.isPureReactComponent=!0;var kb=Array.isArray,Z2=Object.prototype.hasOwnProperty,Ex={current:null},ek={key:!0,ref:!0,__self:!0,__source:!0};function tk(n,e,t){var r,s={},i=null,o=null;if(e!=null)for(r in e.ref!==void 0&&(o=e.ref),e.key!==void 0&&(i=""+e.key),e)Z2.call(e,r)&&!ek.hasOwnProperty(r)&&(s[r]=e[r]);var a=arguments.length-2;if(a===1)s.children=t;else if(1<a){for(var l=Array(a),c=0;c<a;c++)l[c]=arguments[c+2];s.children=l}if(n&&n.defaultProps)for(r in a=n.defaultProps,a)s[r]===void 0&&(s[r]=a[r]);return{$$typeof:fd,type:n,key:i,ref:o,props:s,_owner:Ex.current}}function a5(n,e){return{$$typeof:fd,type:n.type,key:e,ref:n.ref,props:n.props,_owner:n._owner}}function kx(n){return typeof n=="object"&&n!==null&&n.$$typeof===fd}function l5(n){var e={"=":"=0",":":"=2"};return"$"+n.replace(/[=:]/g,function(t){return e[t]})}var Pb=/\/+/g;function Y0(n,e){return typeof n=="object"&&n!==null&&n.key!=null?l5(""+n.key):e.toString(36)}function Xh(n,e,t,r,s){var i=typeof n;(i==="undefined"||i==="boolean")&&(n=null);var o=!1;if(n===null)o=!0;else switch(i){case"string":case"number":o=!0;break;case"object":switch(n.$$typeof){case fd:case K3:o=!0}}if(o)return o=n,s=s(o),n=r===""?"."+Y0(o,0):r,kb(s)?(t="",n!=null&&(t=n.replace(Pb,"$&/")+"/"),Xh(s,e,t,"",function(c){return c})):s!=null&&(kx(s)&&(s=a5(s,t+(!s.key||o&&o.key===s.key?"":(""+s.key).replace(Pb,"$&/")+"/")+n)),e.push(s)),1;if(o=0,r=r===""?".":r+":",kb(n))for(var a=0;a<n.length;a++){i=n[a];var l=r+Y0(i,a);o+=Xh(i,e,t,l,s)}else if(l=o5(n),typeof l=="function")for(n=l.call(n),a=0;!(i=n.next()).done;)i=i.value,l=r+Y0(i,a++),o+=Xh(i,e,t,l,s);else if(i==="object")throw e=String(n),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(n).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return o}function Hd(n,e,t){if(n==null)return n;var r=[],s=0;return Xh(n,r,"","",function(i){return e.call(t,i,s++)}),r}function c5(n){if(n._status===-1){var e=n._result;e=e(),e.then(function(t){(n._status===0||n._status===-1)&&(n._status=1,n._result=t)},function(t){(n._status===0||n._status===-1)&&(n._status=2,n._result=t)}),n._status===-1&&(n._status=0,n._result=e)}if(n._status===1)return n._result.default;throw n._result}var Bn={current:null},Kh={transition:null},u5={ReactCurrentDispatcher:Bn,ReactCurrentBatchConfig:Kh,ReactCurrentOwner:Ex};function nk(){throw Error("act(...) is not supported in production builds of React.")}Je.Children={map:Hd,forEach:function(n,e,t){Hd(n,function(){e.apply(this,arguments)},t)},count:function(n){var e=0;return Hd(n,function(){e++}),e},toArray:function(n){return Hd(n,function(e){return e})||[]},only:function(n){if(!kx(n))throw Error("React.Children.only expected to receive a single React element child.");return n}};Je.Component=rc;Je.Fragment=J3;Je.Profiler=Z3;Je.PureComponent=Sx;Je.StrictMode=Q3;Je.Suspense=r5;Je.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=u5;Je.act=nk;Je.cloneElement=function(n,e,t){if(n==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+n+".");var r=K2({},n.props),s=n.key,i=n.ref,o=n._owner;if(e!=null){if(e.ref!==void 0&&(i=e.ref,o=Ex.current),e.key!==void 0&&(s=""+e.key),n.type&&n.type.defaultProps)var a=n.type.defaultProps;for(l in e)Z2.call(e,l)&&!ek.hasOwnProperty(l)&&(r[l]=e[l]===void 0&&a!==void 0?a[l]:e[l])}var l=arguments.length-2;if(l===1)r.children=t;else if(1<l){a=Array(l);for(var c=0;c<l;c++)a[c]=arguments[c+2];r.children=a}return{$$typeof:fd,type:n.type,key:s,ref:i,props:r,_owner:o}};Je.createContext=function(n){return n={$$typeof:t5,_currentValue:n,_currentValue2:n,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},n.Provider={$$typeof:e5,_context:n},n.Consumer=n};Je.createElement=tk;Je.createFactory=function(n){var e=tk.bind(null,n);return e.type=n,e};Je.createRef=function(){return{current:null}};Je.forwardRef=function(n){return{$$typeof:n5,render:n}};Je.isValidElement=kx;Je.lazy=function(n){return{$$typeof:i5,_payload:{_status:-1,_result:n},_init:c5}};Je.memo=function(n,e){return{$$typeof:s5,type:n,compare:e===void 0?null:e}};Je.startTransition=function(n){var e=Kh.transition;Kh.transition={};try{n()}finally{Kh.transition=e}};Je.unstable_act=nk;Je.useCallback=function(n,e){return Bn.current.useCallback(n,e)};Je.useContext=function(n){return Bn.current.useContext(n)};Je.useDebugValue=function(){};Je.useDeferredValue=function(n){return Bn.current.useDeferredValue(n)};Je.useEffect=function(n,e){return Bn.current.useEffect(n,e)};Je.useId=function(){return Bn.current.useId()};Je.useImperativeHandle=function(n,e,t){return Bn.current.useImperativeHandle(n,e,t)};Je.useInsertionEffect=function(n,e){return Bn.current.useInsertionEffect(n,e)};Je.useLayoutEffect=function(n,e){return Bn.current.useLayoutEffect(n,e)};Je.useMemo=function(n,e){return Bn.current.useMemo(n,e)};Je.useReducer=function(n,e,t){return Bn.current.useReducer(n,e,t)};Je.useRef=function(n){return Bn.current.useRef(n)};Je.useState=function(n){return Bn.current.useState(n)};Je.useSyncExternalStore=function(n,e,t){return Bn.current.useSyncExternalStore(n,e,t)};Je.useTransition=function(){return Bn.current.useTransition()};Je.version="18.3.1";Y2.exports=Je;var b=Y2.exports;const Y=Ap(b),rk=X3({__proto__:null,default:Y},[b]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var d5=b,h5=Symbol.for("react.element"),f5=Symbol.for("react.fragment"),p5=Object.prototype.hasOwnProperty,g5=d5.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,m5={key:!0,ref:!0,__self:!0,__source:!0};function sk(n,e,t){var r,s={},i=null,o=null;t!==void 0&&(i=""+t),e.key!==void 0&&(i=""+e.key),e.ref!==void 0&&(o=e.ref);for(r in e)p5.call(e,r)&&!m5.hasOwnProperty(r)&&(s[r]=e[r]);if(n&&n.defaultProps)for(r in e=n.defaultProps,e)s[r]===void 0&&(s[r]=e[r]);return{$$typeof:h5,type:n,key:i,ref:o,props:s,_owner:g5.current}}Dp.Fragment=f5;Dp.jsx=sk;Dp.jsxs=sk;q2.exports=Dp;var f=q2.exports,ik={exports:{}},pr={},ok={exports:{}},ak={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(n){function e(k,N){var M=k.length;k.push(N);e:for(;0<M;){var T=M-1>>>1,j=k[T];if(0<s(j,N))k[T]=N,k[M]=j,M=T;else break e}}function t(k){return k.length===0?null:k[0]}function r(k){if(k.length===0)return null;var N=k[0],M=k.pop();if(M!==N){k[0]=M;e:for(var T=0,j=k.length,$=j>>>1;T<$;){var z=2*(T+1)-1,ee=k[z],X=z+1,J=k[X];if(0>s(ee,M))X<j&&0>s(J,ee)?(k[T]=J,k[X]=M,T=X):(k[T]=ee,k[z]=M,T=z);else if(X<j&&0>s(J,M))k[T]=J,k[X]=M,T=X;else break e}}return N}function s(k,N){var M=k.sortIndex-N.sortIndex;return M!==0?M:k.id-N.id}if(typeof performance=="object"&&typeof performance.now=="function"){var i=performance;n.unstable_now=function(){return i.now()}}else{var o=Date,a=o.now();n.unstable_now=function(){return o.now()-a}}var l=[],c=[],u=1,h=null,d=3,p=!1,m=!1,g=!1,y=typeof setTimeout=="function"?setTimeout:null,x=typeof clearTimeout=="function"?clearTimeout:null,v=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function w(k){for(var N=t(c);N!==null;){if(N.callback===null)r(c);else if(N.startTime<=k)r(c),N.sortIndex=N.expirationTime,e(l,N);else break;N=t(c)}}function _(k){if(g=!1,w(k),!m)if(t(l)!==null)m=!0,F(S);else{var N=t(c);N!==null&&D(_,N.startTime-k)}}function S(k,N){m=!1,g&&(g=!1,x(P),P=-1),p=!0;var M=d;try{for(w(N),h=t(l);h!==null&&(!(h.expirationTime>N)||k&&!R());){var T=h.callback;if(typeof T=="function"){h.callback=null,d=h.priorityLevel;var j=T(h.expirationTime<=N);N=n.unstable_now(),typeof j=="function"?h.callback=j:h===t(l)&&r(l),w(N)}else r(l);h=t(l)}if(h!==null)var $=!0;else{var z=t(c);z!==null&&D(_,z.startTime-N),$=!1}return $}finally{h=null,d=M,p=!1}}var E=!1,C=null,P=-1,O=5,A=-1;function R(){return!(n.unstable_now()-A<O)}function B(){if(C!==null){var k=n.unstable_now();A=k;var N=!0;try{N=C(!0,k)}finally{N?I():(E=!1,C=null)}}else E=!1}var I;if(typeof v=="function")I=function(){v(B)};else if(typeof MessageChannel<"u"){var L=new MessageChannel,U=L.port2;L.port1.onmessage=B,I=function(){U.postMessage(null)}}else I=function(){y(B,0)};function F(k){C=k,E||(E=!0,I())}function D(k,N){P=y(function(){k(n.unstable_now())},N)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(k){k.callback=null},n.unstable_continueExecution=function(){m||p||(m=!0,F(S))},n.unstable_forceFrameRate=function(k){0>k||125<k?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):O=0<k?Math.floor(1e3/k):5},n.unstable_getCurrentPriorityLevel=function(){return d},n.unstable_getFirstCallbackNode=function(){return t(l)},n.unstable_next=function(k){switch(d){case 1:case 2:case 3:var N=3;break;default:N=d}var M=d;d=N;try{return k()}finally{d=M}},n.unstable_pauseExecution=function(){},n.unstable_requestPaint=function(){},n.unstable_runWithPriority=function(k,N){switch(k){case 1:case 2:case 3:case 4:case 5:break;default:k=3}var M=d;d=k;try{return N()}finally{d=M}},n.unstable_scheduleCallback=function(k,N,M){var T=n.unstable_now();switch(typeof M=="object"&&M!==null?(M=M.delay,M=typeof M=="number"&&0<M?T+M:T):M=T,k){case 1:var j=-1;break;case 2:j=250;break;case 5:j=1073741823;break;case 4:j=1e4;break;default:j=5e3}return j=M+j,k={id:u++,callback:N,priorityLevel:k,startTime:M,expirationTime:j,sortIndex:-1},M>T?(k.sortIndex=M,e(c,k),t(l)===null&&k===t(c)&&(g?(x(P),P=-1):g=!0,D(_,M-T))):(k.sortIndex=j,e(l,k),m||p||(m=!0,F(S))),k},n.unstable_shouldYield=R,n.unstable_wrapCallback=function(k){var N=d;return function(){var M=d;d=N;try{return k.apply(this,arguments)}finally{d=M}}}})(ak);ok.exports=ak;var v5=ok.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var y5=b,fr=v5;function ce(n){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+n,t=1;t<arguments.length;t++)e+="&args[]="+encodeURIComponent(arguments[t]);return"Minified React error #"+n+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var lk=new Set,Pu={};function xa(n,e){Bl(n,e),Bl(n+"Capture",e)}function Bl(n,e){for(Pu[n]=e,n=0;n<e.length;n++)lk.add(e[n])}var Js=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),dv=Object.prototype.hasOwnProperty,x5=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,Tb={},Ab={};function w5(n){return dv.call(Ab,n)?!0:dv.call(Tb,n)?!1:x5.test(n)?Ab[n]=!0:(Tb[n]=!0,!1)}function b5(n,e,t,r){if(t!==null&&t.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return r?!1:t!==null?!t.acceptsBooleans:(n=n.toLowerCase().slice(0,5),n!=="data-"&&n!=="aria-");default:return!1}}function _5(n,e,t,r){if(e===null||typeof e>"u"||b5(n,e,t,r))return!0;if(r)return!1;if(t!==null)switch(t.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function Un(n,e,t,r,s,i,o){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=s,this.mustUseProperty=t,this.propertyName=n,this.type=e,this.sanitizeURL=i,this.removeEmptyString=o}var mn={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(n){mn[n]=new Un(n,0,!1,n,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(n){var e=n[0];mn[e]=new Un(e,1,!1,n[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(n){mn[n]=new Un(n,2,!1,n.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(n){mn[n]=new Un(n,2,!1,n,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(n){mn[n]=new Un(n,3,!1,n.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(n){mn[n]=new Un(n,3,!0,n,null,!1,!1)});["capture","download"].forEach(function(n){mn[n]=new Un(n,4,!1,n,null,!1,!1)});["cols","rows","size","span"].forEach(function(n){mn[n]=new Un(n,6,!1,n,null,!1,!1)});["rowSpan","start"].forEach(function(n){mn[n]=new Un(n,5,!1,n.toLowerCase(),null,!1,!1)});var Px=/[\-:]([a-z])/g;function Tx(n){return n[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(n){var e=n.replace(Px,Tx);mn[e]=new Un(e,1,!1,n,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(n){var e=n.replace(Px,Tx);mn[e]=new Un(e,1,!1,n,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(n){var e=n.replace(Px,Tx);mn[e]=new Un(e,1,!1,n,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(n){mn[n]=new Un(n,1,!1,n.toLowerCase(),null,!1,!1)});mn.xlinkHref=new Un("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(n){mn[n]=new Un(n,1,!1,n.toLowerCase(),null,!0,!0)});function Ax(n,e,t,r){var s=mn.hasOwnProperty(e)?mn[e]:null;(s!==null?s.type!==0:r||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(_5(e,t,s,r)&&(t=null),r||s===null?w5(e)&&(t===null?n.removeAttribute(e):n.setAttribute(e,""+t)):s.mustUseProperty?n[s.propertyName]=t===null?s.type===3?!1:"":t:(e=s.attributeName,r=s.attributeNamespace,t===null?n.removeAttribute(e):(s=s.type,t=s===3||s===4&&t===!0?"":""+t,r?n.setAttributeNS(r,e,t):n.setAttribute(e,t))))}var ui=y5.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Vd=Symbol.for("react.element"),qa=Symbol.for("react.portal"),Ya=Symbol.for("react.fragment"),Dx=Symbol.for("react.strict_mode"),hv=Symbol.for("react.profiler"),ck=Symbol.for("react.provider"),uk=Symbol.for("react.context"),Ox=Symbol.for("react.forward_ref"),fv=Symbol.for("react.suspense"),pv=Symbol.for("react.suspense_list"),Ix=Symbol.for("react.memo"),Ai=Symbol.for("react.lazy"),dk=Symbol.for("react.offscreen"),Db=Symbol.iterator;function Oc(n){return n===null||typeof n!="object"?null:(n=Db&&n[Db]||n["@@iterator"],typeof n=="function"?n:null)}var Dt=Object.assign,X0;function Xc(n){if(X0===void 0)try{throw Error()}catch(t){var e=t.stack.trim().match(/\n( *(at )?)/);X0=e&&e[1]||""}return`
`+X0+n}var K0=!1;function J0(n,e){if(!n||K0)return"";K0=!0;var t=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(c){var r=c}Reflect.construct(n,[],e)}else{try{e.call()}catch(c){r=c}n.call(e.prototype)}else{try{throw Error()}catch(c){r=c}n()}}catch(c){if(c&&r&&typeof c.stack=="string"){for(var s=c.stack.split(`
`),i=r.stack.split(`
`),o=s.length-1,a=i.length-1;1<=o&&0<=a&&s[o]!==i[a];)a--;for(;1<=o&&0<=a;o--,a--)if(s[o]!==i[a]){if(o!==1||a!==1)do if(o--,a--,0>a||s[o]!==i[a]){var l=`
`+s[o].replace(" at new "," at ");return n.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",n.displayName)),l}while(1<=o&&0<=a);break}}}finally{K0=!1,Error.prepareStackTrace=t}return(n=n?n.displayName||n.name:"")?Xc(n):""}function S5(n){switch(n.tag){case 5:return Xc(n.type);case 16:return Xc("Lazy");case 13:return Xc("Suspense");case 19:return Xc("SuspenseList");case 0:case 2:case 15:return n=J0(n.type,!1),n;case 11:return n=J0(n.type.render,!1),n;case 1:return n=J0(n.type,!0),n;default:return""}}function gv(n){if(n==null)return null;if(typeof n=="function")return n.displayName||n.name||null;if(typeof n=="string")return n;switch(n){case Ya:return"Fragment";case qa:return"Portal";case hv:return"Profiler";case Dx:return"StrictMode";case fv:return"Suspense";case pv:return"SuspenseList"}if(typeof n=="object")switch(n.$$typeof){case uk:return(n.displayName||"Context")+".Consumer";case ck:return(n._context.displayName||"Context")+".Provider";case Ox:var e=n.render;return n=n.displayName,n||(n=e.displayName||e.name||"",n=n!==""?"ForwardRef("+n+")":"ForwardRef"),n;case Ix:return e=n.displayName||null,e!==null?e:gv(n.type)||"Memo";case Ai:e=n._payload,n=n._init;try{return gv(n(e))}catch{}}return null}function C5(n){var e=n.type;switch(n.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return n=e.render,n=n.displayName||n.name||"",e.displayName||(n!==""?"ForwardRef("+n+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return gv(e);case 8:return e===Dx?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function oo(n){switch(typeof n){case"boolean":case"number":case"string":case"undefined":return n;case"object":return n;default:return""}}function hk(n){var e=n.type;return(n=n.nodeName)&&n.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function E5(n){var e=hk(n)?"checked":"value",t=Object.getOwnPropertyDescriptor(n.constructor.prototype,e),r=""+n[e];if(!n.hasOwnProperty(e)&&typeof t<"u"&&typeof t.get=="function"&&typeof t.set=="function"){var s=t.get,i=t.set;return Object.defineProperty(n,e,{configurable:!0,get:function(){return s.call(this)},set:function(o){r=""+o,i.call(this,o)}}),Object.defineProperty(n,e,{enumerable:t.enumerable}),{getValue:function(){return r},setValue:function(o){r=""+o},stopTracking:function(){n._valueTracker=null,delete n[e]}}}}function Gd(n){n._valueTracker||(n._valueTracker=E5(n))}function fk(n){if(!n)return!1;var e=n._valueTracker;if(!e)return!0;var t=e.getValue(),r="";return n&&(r=hk(n)?n.checked?"true":"false":n.value),n=r,n!==t?(e.setValue(n),!0):!1}function Cf(n){if(n=n||(typeof document<"u"?document:void 0),typeof n>"u")return null;try{return n.activeElement||n.body}catch{return n.body}}function mv(n,e){var t=e.checked;return Dt({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:t??n._wrapperState.initialChecked})}function Ob(n,e){var t=e.defaultValue==null?"":e.defaultValue,r=e.checked!=null?e.checked:e.defaultChecked;t=oo(e.value!=null?e.value:t),n._wrapperState={initialChecked:r,initialValue:t,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function pk(n,e){e=e.checked,e!=null&&Ax(n,"checked",e,!1)}function vv(n,e){pk(n,e);var t=oo(e.value),r=e.type;if(t!=null)r==="number"?(t===0&&n.value===""||n.value!=t)&&(n.value=""+t):n.value!==""+t&&(n.value=""+t);else if(r==="submit"||r==="reset"){n.removeAttribute("value");return}e.hasOwnProperty("value")?yv(n,e.type,t):e.hasOwnProperty("defaultValue")&&yv(n,e.type,oo(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(n.defaultChecked=!!e.defaultChecked)}function Ib(n,e,t){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!(r!=="submit"&&r!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+n._wrapperState.initialValue,t||e===n.value||(n.value=e),n.defaultValue=e}t=n.name,t!==""&&(n.name=""),n.defaultChecked=!!n._wrapperState.initialChecked,t!==""&&(n.name=t)}function yv(n,e,t){(e!=="number"||Cf(n.ownerDocument)!==n)&&(t==null?n.defaultValue=""+n._wrapperState.initialValue:n.defaultValue!==""+t&&(n.defaultValue=""+t))}var Kc=Array.isArray;function cl(n,e,t,r){if(n=n.options,e){e={};for(var s=0;s<t.length;s++)e["$"+t[s]]=!0;for(t=0;t<n.length;t++)s=e.hasOwnProperty("$"+n[t].value),n[t].selected!==s&&(n[t].selected=s),s&&r&&(n[t].defaultSelected=!0)}else{for(t=""+oo(t),e=null,s=0;s<n.length;s++){if(n[s].value===t){n[s].selected=!0,r&&(n[s].defaultSelected=!0);return}e!==null||n[s].disabled||(e=n[s])}e!==null&&(e.selected=!0)}}function xv(n,e){if(e.dangerouslySetInnerHTML!=null)throw Error(ce(91));return Dt({},e,{value:void 0,defaultValue:void 0,children:""+n._wrapperState.initialValue})}function Rb(n,e){var t=e.value;if(t==null){if(t=e.children,e=e.defaultValue,t!=null){if(e!=null)throw Error(ce(92));if(Kc(t)){if(1<t.length)throw Error(ce(93));t=t[0]}e=t}e==null&&(e=""),t=e}n._wrapperState={initialValue:oo(t)}}function gk(n,e){var t=oo(e.value),r=oo(e.defaultValue);t!=null&&(t=""+t,t!==n.value&&(n.value=t),e.defaultValue==null&&n.defaultValue!==t&&(n.defaultValue=t)),r!=null&&(n.defaultValue=""+r)}function Nb(n){var e=n.textContent;e===n._wrapperState.initialValue&&e!==""&&e!==null&&(n.value=e)}function mk(n){switch(n){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function wv(n,e){return n==null||n==="http://www.w3.org/1999/xhtml"?mk(e):n==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":n}var qd,vk=function(n){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,t,r,s){MSApp.execUnsafeLocalFunction(function(){return n(e,t,r,s)})}:n}(function(n,e){if(n.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in n)n.innerHTML=e;else{for(qd=qd||document.createElement("div"),qd.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=qd.firstChild;n.firstChild;)n.removeChild(n.firstChild);for(;e.firstChild;)n.appendChild(e.firstChild)}});function Tu(n,e){if(e){var t=n.firstChild;if(t&&t===n.lastChild&&t.nodeType===3){t.nodeValue=e;return}}n.textContent=e}var iu={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},k5=["Webkit","ms","Moz","O"];Object.keys(iu).forEach(function(n){k5.forEach(function(e){e=e+n.charAt(0).toUpperCase()+n.substring(1),iu[e]=iu[n]})});function yk(n,e,t){return e==null||typeof e=="boolean"||e===""?"":t||typeof e!="number"||e===0||iu.hasOwnProperty(n)&&iu[n]?(""+e).trim():e+"px"}function xk(n,e){n=n.style;for(var t in e)if(e.hasOwnProperty(t)){var r=t.indexOf("--")===0,s=yk(t,e[t],r);t==="float"&&(t="cssFloat"),r?n.setProperty(t,s):n[t]=s}}var P5=Dt({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function bv(n,e){if(e){if(P5[n]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(ce(137,n));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(ce(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(ce(61))}if(e.style!=null&&typeof e.style!="object")throw Error(ce(62))}}function _v(n,e){if(n.indexOf("-")===-1)return typeof e.is=="string";switch(n){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Sv=null;function Rx(n){return n=n.target||n.srcElement||window,n.correspondingUseElement&&(n=n.correspondingUseElement),n.nodeType===3?n.parentNode:n}var Cv=null,ul=null,dl=null;function jb(n){if(n=md(n)){if(typeof Cv!="function")throw Error(ce(280));var e=n.stateNode;e&&(e=jp(e),Cv(n.stateNode,n.type,e))}}function wk(n){ul?dl?dl.push(n):dl=[n]:ul=n}function bk(){if(ul){var n=ul,e=dl;if(dl=ul=null,jb(n),e)for(n=0;n<e.length;n++)jb(e[n])}}function _k(n,e){return n(e)}function Sk(){}var Q0=!1;function Ck(n,e,t){if(Q0)return n(e,t);Q0=!0;try{return _k(n,e,t)}finally{Q0=!1,(ul!==null||dl!==null)&&(Sk(),bk())}}function Au(n,e){var t=n.stateNode;if(t===null)return null;var r=jp(t);if(r===null)return null;t=r[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(n=n.type,r=!(n==="button"||n==="input"||n==="select"||n==="textarea")),n=!r;break e;default:n=!1}if(n)return null;if(t&&typeof t!="function")throw Error(ce(231,e,typeof t));return t}var Ev=!1;if(Js)try{var Ic={};Object.defineProperty(Ic,"passive",{get:function(){Ev=!0}}),window.addEventListener("test",Ic,Ic),window.removeEventListener("test",Ic,Ic)}catch{Ev=!1}function T5(n,e,t,r,s,i,o,a,l){var c=Array.prototype.slice.call(arguments,3);try{e.apply(t,c)}catch(u){this.onError(u)}}var ou=!1,Ef=null,kf=!1,kv=null,A5={onError:function(n){ou=!0,Ef=n}};function D5(n,e,t,r,s,i,o,a,l){ou=!1,Ef=null,T5.apply(A5,arguments)}function O5(n,e,t,r,s,i,o,a,l){if(D5.apply(this,arguments),ou){if(ou){var c=Ef;ou=!1,Ef=null}else throw Error(ce(198));kf||(kf=!0,kv=c)}}function wa(n){var e=n,t=n;if(n.alternate)for(;e.return;)e=e.return;else{n=e;do e=n,e.flags&4098&&(t=e.return),n=e.return;while(n)}return e.tag===3?t:null}function Ek(n){if(n.tag===13){var e=n.memoizedState;if(e===null&&(n=n.alternate,n!==null&&(e=n.memoizedState)),e!==null)return e.dehydrated}return null}function Lb(n){if(wa(n)!==n)throw Error(ce(188))}function I5(n){var e=n.alternate;if(!e){if(e=wa(n),e===null)throw Error(ce(188));return e!==n?null:n}for(var t=n,r=e;;){var s=t.return;if(s===null)break;var i=s.alternate;if(i===null){if(r=s.return,r!==null){t=r;continue}break}if(s.child===i.child){for(i=s.child;i;){if(i===t)return Lb(s),n;if(i===r)return Lb(s),e;i=i.sibling}throw Error(ce(188))}if(t.return!==r.return)t=s,r=i;else{for(var o=!1,a=s.child;a;){if(a===t){o=!0,t=s,r=i;break}if(a===r){o=!0,r=s,t=i;break}a=a.sibling}if(!o){for(a=i.child;a;){if(a===t){o=!0,t=i,r=s;break}if(a===r){o=!0,r=i,t=s;break}a=a.sibling}if(!o)throw Error(ce(189))}}if(t.alternate!==r)throw Error(ce(190))}if(t.tag!==3)throw Error(ce(188));return t.stateNode.current===t?n:e}function kk(n){return n=I5(n),n!==null?Pk(n):null}function Pk(n){if(n.tag===5||n.tag===6)return n;for(n=n.child;n!==null;){var e=Pk(n);if(e!==null)return e;n=n.sibling}return null}var Tk=fr.unstable_scheduleCallback,Mb=fr.unstable_cancelCallback,R5=fr.unstable_shouldYield,N5=fr.unstable_requestPaint,Mt=fr.unstable_now,j5=fr.unstable_getCurrentPriorityLevel,Nx=fr.unstable_ImmediatePriority,Ak=fr.unstable_UserBlockingPriority,Pf=fr.unstable_NormalPriority,L5=fr.unstable_LowPriority,Dk=fr.unstable_IdlePriority,Op=null,ps=null;function M5(n){if(ps&&typeof ps.onCommitFiberRoot=="function")try{ps.onCommitFiberRoot(Op,n,void 0,(n.current.flags&128)===128)}catch{}}var Jr=Math.clz32?Math.clz32:U5,F5=Math.log,B5=Math.LN2;function U5(n){return n>>>=0,n===0?32:31-(F5(n)/B5|0)|0}var Yd=64,Xd=4194304;function Jc(n){switch(n&-n){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return n&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return n&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return n}}function Tf(n,e){var t=n.pendingLanes;if(t===0)return 0;var r=0,s=n.suspendedLanes,i=n.pingedLanes,o=t&268435455;if(o!==0){var a=o&~s;a!==0?r=Jc(a):(i&=o,i!==0&&(r=Jc(i)))}else o=t&~s,o!==0?r=Jc(o):i!==0&&(r=Jc(i));if(r===0)return 0;if(e!==0&&e!==r&&!(e&s)&&(s=r&-r,i=e&-e,s>=i||s===16&&(i&4194240)!==0))return e;if(r&4&&(r|=t&16),e=n.entangledLanes,e!==0)for(n=n.entanglements,e&=r;0<e;)t=31-Jr(e),s=1<<t,r|=n[t],e&=~s;return r}function $5(n,e){switch(n){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function z5(n,e){for(var t=n.suspendedLanes,r=n.pingedLanes,s=n.expirationTimes,i=n.pendingLanes;0<i;){var o=31-Jr(i),a=1<<o,l=s[o];l===-1?(!(a&t)||a&r)&&(s[o]=$5(a,e)):l<=e&&(n.expiredLanes|=a),i&=~a}}function Pv(n){return n=n.pendingLanes&-1073741825,n!==0?n:n&1073741824?1073741824:0}function Ok(){var n=Yd;return Yd<<=1,!(Yd&4194240)&&(Yd=64),n}function Z0(n){for(var e=[],t=0;31>t;t++)e.push(n);return e}function pd(n,e,t){n.pendingLanes|=e,e!==536870912&&(n.suspendedLanes=0,n.pingedLanes=0),n=n.eventTimes,e=31-Jr(e),n[e]=t}function W5(n,e){var t=n.pendingLanes&~e;n.pendingLanes=e,n.suspendedLanes=0,n.pingedLanes=0,n.expiredLanes&=e,n.mutableReadLanes&=e,n.entangledLanes&=e,e=n.entanglements;var r=n.eventTimes;for(n=n.expirationTimes;0<t;){var s=31-Jr(t),i=1<<s;e[s]=0,r[s]=-1,n[s]=-1,t&=~i}}function jx(n,e){var t=n.entangledLanes|=e;for(n=n.entanglements;t;){var r=31-Jr(t),s=1<<r;s&e|n[r]&e&&(n[r]|=e),t&=~s}}var ft=0;function Ik(n){return n&=-n,1<n?4<n?n&268435455?16:536870912:4:1}var Rk,Lx,Nk,jk,Lk,Tv=!1,Kd=[],Yi=null,Xi=null,Ki=null,Du=new Map,Ou=new Map,Ii=[],H5="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Fb(n,e){switch(n){case"focusin":case"focusout":Yi=null;break;case"dragenter":case"dragleave":Xi=null;break;case"mouseover":case"mouseout":Ki=null;break;case"pointerover":case"pointerout":Du.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":Ou.delete(e.pointerId)}}function Rc(n,e,t,r,s,i){return n===null||n.nativeEvent!==i?(n={blockedOn:e,domEventName:t,eventSystemFlags:r,nativeEvent:i,targetContainers:[s]},e!==null&&(e=md(e),e!==null&&Lx(e)),n):(n.eventSystemFlags|=r,e=n.targetContainers,s!==null&&e.indexOf(s)===-1&&e.push(s),n)}function V5(n,e,t,r,s){switch(e){case"focusin":return Yi=Rc(Yi,n,e,t,r,s),!0;case"dragenter":return Xi=Rc(Xi,n,e,t,r,s),!0;case"mouseover":return Ki=Rc(Ki,n,e,t,r,s),!0;case"pointerover":var i=s.pointerId;return Du.set(i,Rc(Du.get(i)||null,n,e,t,r,s)),!0;case"gotpointercapture":return i=s.pointerId,Ou.set(i,Rc(Ou.get(i)||null,n,e,t,r,s)),!0}return!1}function Mk(n){var e=Go(n.target);if(e!==null){var t=wa(e);if(t!==null){if(e=t.tag,e===13){if(e=Ek(t),e!==null){n.blockedOn=e,Lk(n.priority,function(){Nk(t)});return}}else if(e===3&&t.stateNode.current.memoizedState.isDehydrated){n.blockedOn=t.tag===3?t.stateNode.containerInfo:null;return}}}n.blockedOn=null}function Jh(n){if(n.blockedOn!==null)return!1;for(var e=n.targetContainers;0<e.length;){var t=Av(n.domEventName,n.eventSystemFlags,e[0],n.nativeEvent);if(t===null){t=n.nativeEvent;var r=new t.constructor(t.type,t);Sv=r,t.target.dispatchEvent(r),Sv=null}else return e=md(t),e!==null&&Lx(e),n.blockedOn=t,!1;e.shift()}return!0}function Bb(n,e,t){Jh(n)&&t.delete(e)}function G5(){Tv=!1,Yi!==null&&Jh(Yi)&&(Yi=null),Xi!==null&&Jh(Xi)&&(Xi=null),Ki!==null&&Jh(Ki)&&(Ki=null),Du.forEach(Bb),Ou.forEach(Bb)}function Nc(n,e){n.blockedOn===e&&(n.blockedOn=null,Tv||(Tv=!0,fr.unstable_scheduleCallback(fr.unstable_NormalPriority,G5)))}function Iu(n){function e(s){return Nc(s,n)}if(0<Kd.length){Nc(Kd[0],n);for(var t=1;t<Kd.length;t++){var r=Kd[t];r.blockedOn===n&&(r.blockedOn=null)}}for(Yi!==null&&Nc(Yi,n),Xi!==null&&Nc(Xi,n),Ki!==null&&Nc(Ki,n),Du.forEach(e),Ou.forEach(e),t=0;t<Ii.length;t++)r=Ii[t],r.blockedOn===n&&(r.blockedOn=null);for(;0<Ii.length&&(t=Ii[0],t.blockedOn===null);)Mk(t),t.blockedOn===null&&Ii.shift()}var hl=ui.ReactCurrentBatchConfig,Af=!0;function q5(n,e,t,r){var s=ft,i=hl.transition;hl.transition=null;try{ft=1,Mx(n,e,t,r)}finally{ft=s,hl.transition=i}}function Y5(n,e,t,r){var s=ft,i=hl.transition;hl.transition=null;try{ft=4,Mx(n,e,t,r)}finally{ft=s,hl.transition=i}}function Mx(n,e,t,r){if(Af){var s=Av(n,e,t,r);if(s===null)cg(n,e,r,Df,t),Fb(n,r);else if(V5(s,n,e,t,r))r.stopPropagation();else if(Fb(n,r),e&4&&-1<H5.indexOf(n)){for(;s!==null;){var i=md(s);if(i!==null&&Rk(i),i=Av(n,e,t,r),i===null&&cg(n,e,r,Df,t),i===s)break;s=i}s!==null&&r.stopPropagation()}else cg(n,e,r,null,t)}}var Df=null;function Av(n,e,t,r){if(Df=null,n=Rx(r),n=Go(n),n!==null)if(e=wa(n),e===null)n=null;else if(t=e.tag,t===13){if(n=Ek(e),n!==null)return n;n=null}else if(t===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;n=null}else e!==n&&(n=null);return Df=n,null}function Fk(n){switch(n){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(j5()){case Nx:return 1;case Ak:return 4;case Pf:case L5:return 16;case Dk:return 536870912;default:return 16}default:return 16}}var Hi=null,Fx=null,Qh=null;function Bk(){if(Qh)return Qh;var n,e=Fx,t=e.length,r,s="value"in Hi?Hi.value:Hi.textContent,i=s.length;for(n=0;n<t&&e[n]===s[n];n++);var o=t-n;for(r=1;r<=o&&e[t-r]===s[i-r];r++);return Qh=s.slice(n,1<r?1-r:void 0)}function Zh(n){var e=n.keyCode;return"charCode"in n?(n=n.charCode,n===0&&e===13&&(n=13)):n=e,n===10&&(n=13),32<=n||n===13?n:0}function Jd(){return!0}function Ub(){return!1}function gr(n){function e(t,r,s,i,o){this._reactName=t,this._targetInst=s,this.type=r,this.nativeEvent=i,this.target=o,this.currentTarget=null;for(var a in n)n.hasOwnProperty(a)&&(t=n[a],this[a]=t?t(i):i[a]);return this.isDefaultPrevented=(i.defaultPrevented!=null?i.defaultPrevented:i.returnValue===!1)?Jd:Ub,this.isPropagationStopped=Ub,this}return Dt(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var t=this.nativeEvent;t&&(t.preventDefault?t.preventDefault():typeof t.returnValue!="unknown"&&(t.returnValue=!1),this.isDefaultPrevented=Jd)},stopPropagation:function(){var t=this.nativeEvent;t&&(t.stopPropagation?t.stopPropagation():typeof t.cancelBubble!="unknown"&&(t.cancelBubble=!0),this.isPropagationStopped=Jd)},persist:function(){},isPersistent:Jd}),e}var sc={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(n){return n.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Bx=gr(sc),gd=Dt({},sc,{view:0,detail:0}),X5=gr(gd),eg,tg,jc,Ip=Dt({},gd,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Ux,button:0,buttons:0,relatedTarget:function(n){return n.relatedTarget===void 0?n.fromElement===n.srcElement?n.toElement:n.fromElement:n.relatedTarget},movementX:function(n){return"movementX"in n?n.movementX:(n!==jc&&(jc&&n.type==="mousemove"?(eg=n.screenX-jc.screenX,tg=n.screenY-jc.screenY):tg=eg=0,jc=n),eg)},movementY:function(n){return"movementY"in n?n.movementY:tg}}),$b=gr(Ip),K5=Dt({},Ip,{dataTransfer:0}),J5=gr(K5),Q5=Dt({},gd,{relatedTarget:0}),ng=gr(Q5),Z5=Dt({},sc,{animationName:0,elapsedTime:0,pseudoElement:0}),eN=gr(Z5),tN=Dt({},sc,{clipboardData:function(n){return"clipboardData"in n?n.clipboardData:window.clipboardData}}),nN=gr(tN),rN=Dt({},sc,{data:0}),zb=gr(rN),sN={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},iN={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},oN={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function aN(n){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(n):(n=oN[n])?!!e[n]:!1}function Ux(){return aN}var lN=Dt({},gd,{key:function(n){if(n.key){var e=sN[n.key]||n.key;if(e!=="Unidentified")return e}return n.type==="keypress"?(n=Zh(n),n===13?"Enter":String.fromCharCode(n)):n.type==="keydown"||n.type==="keyup"?iN[n.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Ux,charCode:function(n){return n.type==="keypress"?Zh(n):0},keyCode:function(n){return n.type==="keydown"||n.type==="keyup"?n.keyCode:0},which:function(n){return n.type==="keypress"?Zh(n):n.type==="keydown"||n.type==="keyup"?n.keyCode:0}}),cN=gr(lN),uN=Dt({},Ip,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Wb=gr(uN),dN=Dt({},gd,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Ux}),hN=gr(dN),fN=Dt({},sc,{propertyName:0,elapsedTime:0,pseudoElement:0}),pN=gr(fN),gN=Dt({},Ip,{deltaX:function(n){return"deltaX"in n?n.deltaX:"wheelDeltaX"in n?-n.wheelDeltaX:0},deltaY:function(n){return"deltaY"in n?n.deltaY:"wheelDeltaY"in n?-n.wheelDeltaY:"wheelDelta"in n?-n.wheelDelta:0},deltaZ:0,deltaMode:0}),mN=gr(gN),vN=[9,13,27,32],$x=Js&&"CompositionEvent"in window,au=null;Js&&"documentMode"in document&&(au=document.documentMode);var yN=Js&&"TextEvent"in window&&!au,Uk=Js&&(!$x||au&&8<au&&11>=au),Hb=" ",Vb=!1;function $k(n,e){switch(n){case"keyup":return vN.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function zk(n){return n=n.detail,typeof n=="object"&&"data"in n?n.data:null}var Xa=!1;function xN(n,e){switch(n){case"compositionend":return zk(e);case"keypress":return e.which!==32?null:(Vb=!0,Hb);case"textInput":return n=e.data,n===Hb&&Vb?null:n;default:return null}}function wN(n,e){if(Xa)return n==="compositionend"||!$x&&$k(n,e)?(n=Bk(),Qh=Fx=Hi=null,Xa=!1,n):null;switch(n){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return Uk&&e.locale!=="ko"?null:e.data;default:return null}}var bN={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Gb(n){var e=n&&n.nodeName&&n.nodeName.toLowerCase();return e==="input"?!!bN[n.type]:e==="textarea"}function Wk(n,e,t,r){wk(r),e=Of(e,"onChange"),0<e.length&&(t=new Bx("onChange","change",null,t,r),n.push({event:t,listeners:e}))}var lu=null,Ru=null;function _N(n){eP(n,0)}function Rp(n){var e=Qa(n);if(fk(e))return n}function SN(n,e){if(n==="change")return e}var Hk=!1;if(Js){var rg;if(Js){var sg="oninput"in document;if(!sg){var qb=document.createElement("div");qb.setAttribute("oninput","return;"),sg=typeof qb.oninput=="function"}rg=sg}else rg=!1;Hk=rg&&(!document.documentMode||9<document.documentMode)}function Yb(){lu&&(lu.detachEvent("onpropertychange",Vk),Ru=lu=null)}function Vk(n){if(n.propertyName==="value"&&Rp(Ru)){var e=[];Wk(e,Ru,n,Rx(n)),Ck(_N,e)}}function CN(n,e,t){n==="focusin"?(Yb(),lu=e,Ru=t,lu.attachEvent("onpropertychange",Vk)):n==="focusout"&&Yb()}function EN(n){if(n==="selectionchange"||n==="keyup"||n==="keydown")return Rp(Ru)}function kN(n,e){if(n==="click")return Rp(e)}function PN(n,e){if(n==="input"||n==="change")return Rp(e)}function TN(n,e){return n===e&&(n!==0||1/n===1/e)||n!==n&&e!==e}var es=typeof Object.is=="function"?Object.is:TN;function Nu(n,e){if(es(n,e))return!0;if(typeof n!="object"||n===null||typeof e!="object"||e===null)return!1;var t=Object.keys(n),r=Object.keys(e);if(t.length!==r.length)return!1;for(r=0;r<t.length;r++){var s=t[r];if(!dv.call(e,s)||!es(n[s],e[s]))return!1}return!0}function Xb(n){for(;n&&n.firstChild;)n=n.firstChild;return n}function Kb(n,e){var t=Xb(n);n=0;for(var r;t;){if(t.nodeType===3){if(r=n+t.textContent.length,n<=e&&r>=e)return{node:t,offset:e-n};n=r}e:{for(;t;){if(t.nextSibling){t=t.nextSibling;break e}t=t.parentNode}t=void 0}t=Xb(t)}}function Gk(n,e){return n&&e?n===e?!0:n&&n.nodeType===3?!1:e&&e.nodeType===3?Gk(n,e.parentNode):"contains"in n?n.contains(e):n.compareDocumentPosition?!!(n.compareDocumentPosition(e)&16):!1:!1}function qk(){for(var n=window,e=Cf();e instanceof n.HTMLIFrameElement;){try{var t=typeof e.contentWindow.location.href=="string"}catch{t=!1}if(t)n=e.contentWindow;else break;e=Cf(n.document)}return e}function zx(n){var e=n&&n.nodeName&&n.nodeName.toLowerCase();return e&&(e==="input"&&(n.type==="text"||n.type==="search"||n.type==="tel"||n.type==="url"||n.type==="password")||e==="textarea"||n.contentEditable==="true")}function AN(n){var e=qk(),t=n.focusedElem,r=n.selectionRange;if(e!==t&&t&&t.ownerDocument&&Gk(t.ownerDocument.documentElement,t)){if(r!==null&&zx(t)){if(e=r.start,n=r.end,n===void 0&&(n=e),"selectionStart"in t)t.selectionStart=e,t.selectionEnd=Math.min(n,t.value.length);else if(n=(e=t.ownerDocument||document)&&e.defaultView||window,n.getSelection){n=n.getSelection();var s=t.textContent.length,i=Math.min(r.start,s);r=r.end===void 0?i:Math.min(r.end,s),!n.extend&&i>r&&(s=r,r=i,i=s),s=Kb(t,i);var o=Kb(t,r);s&&o&&(n.rangeCount!==1||n.anchorNode!==s.node||n.anchorOffset!==s.offset||n.focusNode!==o.node||n.focusOffset!==o.offset)&&(e=e.createRange(),e.setStart(s.node,s.offset),n.removeAllRanges(),i>r?(n.addRange(e),n.extend(o.node,o.offset)):(e.setEnd(o.node,o.offset),n.addRange(e)))}}for(e=[],n=t;n=n.parentNode;)n.nodeType===1&&e.push({element:n,left:n.scrollLeft,top:n.scrollTop});for(typeof t.focus=="function"&&t.focus(),t=0;t<e.length;t++)n=e[t],n.element.scrollLeft=n.left,n.element.scrollTop=n.top}}var DN=Js&&"documentMode"in document&&11>=document.documentMode,Ka=null,Dv=null,cu=null,Ov=!1;function Jb(n,e,t){var r=t.window===t?t.document:t.nodeType===9?t:t.ownerDocument;Ov||Ka==null||Ka!==Cf(r)||(r=Ka,"selectionStart"in r&&zx(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),cu&&Nu(cu,r)||(cu=r,r=Of(Dv,"onSelect"),0<r.length&&(e=new Bx("onSelect","select",null,e,t),n.push({event:e,listeners:r}),e.target=Ka)))}function Qd(n,e){var t={};return t[n.toLowerCase()]=e.toLowerCase(),t["Webkit"+n]="webkit"+e,t["Moz"+n]="moz"+e,t}var Ja={animationend:Qd("Animation","AnimationEnd"),animationiteration:Qd("Animation","AnimationIteration"),animationstart:Qd("Animation","AnimationStart"),transitionend:Qd("Transition","TransitionEnd")},ig={},Yk={};Js&&(Yk=document.createElement("div").style,"AnimationEvent"in window||(delete Ja.animationend.animation,delete Ja.animationiteration.animation,delete Ja.animationstart.animation),"TransitionEvent"in window||delete Ja.transitionend.transition);function Np(n){if(ig[n])return ig[n];if(!Ja[n])return n;var e=Ja[n],t;for(t in e)if(e.hasOwnProperty(t)&&t in Yk)return ig[n]=e[t];return n}var Xk=Np("animationend"),Kk=Np("animationiteration"),Jk=Np("animationstart"),Qk=Np("transitionend"),Zk=new Map,Qb="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function mo(n,e){Zk.set(n,e),xa(e,[n])}for(var og=0;og<Qb.length;og++){var ag=Qb[og],ON=ag.toLowerCase(),IN=ag[0].toUpperCase()+ag.slice(1);mo(ON,"on"+IN)}mo(Xk,"onAnimationEnd");mo(Kk,"onAnimationIteration");mo(Jk,"onAnimationStart");mo("dblclick","onDoubleClick");mo("focusin","onFocus");mo("focusout","onBlur");mo(Qk,"onTransitionEnd");Bl("onMouseEnter",["mouseout","mouseover"]);Bl("onMouseLeave",["mouseout","mouseover"]);Bl("onPointerEnter",["pointerout","pointerover"]);Bl("onPointerLeave",["pointerout","pointerover"]);xa("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));xa("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));xa("onBeforeInput",["compositionend","keypress","textInput","paste"]);xa("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));xa("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));xa("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Qc="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),RN=new Set("cancel close invalid load scroll toggle".split(" ").concat(Qc));function Zb(n,e,t){var r=n.type||"unknown-event";n.currentTarget=t,O5(r,e,void 0,n),n.currentTarget=null}function eP(n,e){e=(e&4)!==0;for(var t=0;t<n.length;t++){var r=n[t],s=r.event;r=r.listeners;e:{var i=void 0;if(e)for(var o=r.length-1;0<=o;o--){var a=r[o],l=a.instance,c=a.currentTarget;if(a=a.listener,l!==i&&s.isPropagationStopped())break e;Zb(s,a,c),i=l}else for(o=0;o<r.length;o++){if(a=r[o],l=a.instance,c=a.currentTarget,a=a.listener,l!==i&&s.isPropagationStopped())break e;Zb(s,a,c),i=l}}}if(kf)throw n=kv,kf=!1,kv=null,n}function bt(n,e){var t=e[Lv];t===void 0&&(t=e[Lv]=new Set);var r=n+"__bubble";t.has(r)||(tP(e,n,2,!1),t.add(r))}function lg(n,e,t){var r=0;e&&(r|=4),tP(t,n,r,e)}var Zd="_reactListening"+Math.random().toString(36).slice(2);function ju(n){if(!n[Zd]){n[Zd]=!0,lk.forEach(function(t){t!=="selectionchange"&&(RN.has(t)||lg(t,!1,n),lg(t,!0,n))});var e=n.nodeType===9?n:n.ownerDocument;e===null||e[Zd]||(e[Zd]=!0,lg("selectionchange",!1,e))}}function tP(n,e,t,r){switch(Fk(e)){case 1:var s=q5;break;case 4:s=Y5;break;default:s=Mx}t=s.bind(null,e,t,n),s=void 0,!Ev||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(s=!0),r?s!==void 0?n.addEventListener(e,t,{capture:!0,passive:s}):n.addEventListener(e,t,!0):s!==void 0?n.addEventListener(e,t,{passive:s}):n.addEventListener(e,t,!1)}function cg(n,e,t,r,s){var i=r;if(!(e&1)&&!(e&2)&&r!==null)e:for(;;){if(r===null)return;var o=r.tag;if(o===3||o===4){var a=r.stateNode.containerInfo;if(a===s||a.nodeType===8&&a.parentNode===s)break;if(o===4)for(o=r.return;o!==null;){var l=o.tag;if((l===3||l===4)&&(l=o.stateNode.containerInfo,l===s||l.nodeType===8&&l.parentNode===s))return;o=o.return}for(;a!==null;){if(o=Go(a),o===null)return;if(l=o.tag,l===5||l===6){r=i=o;continue e}a=a.parentNode}}r=r.return}Ck(function(){var c=i,u=Rx(t),h=[];e:{var d=Zk.get(n);if(d!==void 0){var p=Bx,m=n;switch(n){case"keypress":if(Zh(t)===0)break e;case"keydown":case"keyup":p=cN;break;case"focusin":m="focus",p=ng;break;case"focusout":m="blur",p=ng;break;case"beforeblur":case"afterblur":p=ng;break;case"click":if(t.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":p=$b;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":p=J5;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":p=hN;break;case Xk:case Kk:case Jk:p=eN;break;case Qk:p=pN;break;case"scroll":p=X5;break;case"wheel":p=mN;break;case"copy":case"cut":case"paste":p=nN;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":p=Wb}var g=(e&4)!==0,y=!g&&n==="scroll",x=g?d!==null?d+"Capture":null:d;g=[];for(var v=c,w;v!==null;){w=v;var _=w.stateNode;if(w.tag===5&&_!==null&&(w=_,x!==null&&(_=Au(v,x),_!=null&&g.push(Lu(v,_,w)))),y)break;v=v.return}0<g.length&&(d=new p(d,m,null,t,u),h.push({event:d,listeners:g}))}}if(!(e&7)){e:{if(d=n==="mouseover"||n==="pointerover",p=n==="mouseout"||n==="pointerout",d&&t!==Sv&&(m=t.relatedTarget||t.fromElement)&&(Go(m)||m[Qs]))break e;if((p||d)&&(d=u.window===u?u:(d=u.ownerDocument)?d.defaultView||d.parentWindow:window,p?(m=t.relatedTarget||t.toElement,p=c,m=m?Go(m):null,m!==null&&(y=wa(m),m!==y||m.tag!==5&&m.tag!==6)&&(m=null)):(p=null,m=c),p!==m)){if(g=$b,_="onMouseLeave",x="onMouseEnter",v="mouse",(n==="pointerout"||n==="pointerover")&&(g=Wb,_="onPointerLeave",x="onPointerEnter",v="pointer"),y=p==null?d:Qa(p),w=m==null?d:Qa(m),d=new g(_,v+"leave",p,t,u),d.target=y,d.relatedTarget=w,_=null,Go(u)===c&&(g=new g(x,v+"enter",m,t,u),g.target=w,g.relatedTarget=y,_=g),y=_,p&&m)t:{for(g=p,x=m,v=0,w=g;w;w=Da(w))v++;for(w=0,_=x;_;_=Da(_))w++;for(;0<v-w;)g=Da(g),v--;for(;0<w-v;)x=Da(x),w--;for(;v--;){if(g===x||x!==null&&g===x.alternate)break t;g=Da(g),x=Da(x)}g=null}else g=null;p!==null&&e_(h,d,p,g,!1),m!==null&&y!==null&&e_(h,y,m,g,!0)}}e:{if(d=c?Qa(c):window,p=d.nodeName&&d.nodeName.toLowerCase(),p==="select"||p==="input"&&d.type==="file")var S=SN;else if(Gb(d))if(Hk)S=PN;else{S=EN;var E=CN}else(p=d.nodeName)&&p.toLowerCase()==="input"&&(d.type==="checkbox"||d.type==="radio")&&(S=kN);if(S&&(S=S(n,c))){Wk(h,S,t,u);break e}E&&E(n,d,c),n==="focusout"&&(E=d._wrapperState)&&E.controlled&&d.type==="number"&&yv(d,"number",d.value)}switch(E=c?Qa(c):window,n){case"focusin":(Gb(E)||E.contentEditable==="true")&&(Ka=E,Dv=c,cu=null);break;case"focusout":cu=Dv=Ka=null;break;case"mousedown":Ov=!0;break;case"contextmenu":case"mouseup":case"dragend":Ov=!1,Jb(h,t,u);break;case"selectionchange":if(DN)break;case"keydown":case"keyup":Jb(h,t,u)}var C;if($x)e:{switch(n){case"compositionstart":var P="onCompositionStart";break e;case"compositionend":P="onCompositionEnd";break e;case"compositionupdate":P="onCompositionUpdate";break e}P=void 0}else Xa?$k(n,t)&&(P="onCompositionEnd"):n==="keydown"&&t.keyCode===229&&(P="onCompositionStart");P&&(Uk&&t.locale!=="ko"&&(Xa||P!=="onCompositionStart"?P==="onCompositionEnd"&&Xa&&(C=Bk()):(Hi=u,Fx="value"in Hi?Hi.value:Hi.textContent,Xa=!0)),E=Of(c,P),0<E.length&&(P=new zb(P,n,null,t,u),h.push({event:P,listeners:E}),C?P.data=C:(C=zk(t),C!==null&&(P.data=C)))),(C=yN?xN(n,t):wN(n,t))&&(c=Of(c,"onBeforeInput"),0<c.length&&(u=new zb("onBeforeInput","beforeinput",null,t,u),h.push({event:u,listeners:c}),u.data=C))}eP(h,e)})}function Lu(n,e,t){return{instance:n,listener:e,currentTarget:t}}function Of(n,e){for(var t=e+"Capture",r=[];n!==null;){var s=n,i=s.stateNode;s.tag===5&&i!==null&&(s=i,i=Au(n,t),i!=null&&r.unshift(Lu(n,i,s)),i=Au(n,e),i!=null&&r.push(Lu(n,i,s))),n=n.return}return r}function Da(n){if(n===null)return null;do n=n.return;while(n&&n.tag!==5);return n||null}function e_(n,e,t,r,s){for(var i=e._reactName,o=[];t!==null&&t!==r;){var a=t,l=a.alternate,c=a.stateNode;if(l!==null&&l===r)break;a.tag===5&&c!==null&&(a=c,s?(l=Au(t,i),l!=null&&o.unshift(Lu(t,l,a))):s||(l=Au(t,i),l!=null&&o.push(Lu(t,l,a)))),t=t.return}o.length!==0&&n.push({event:e,listeners:o})}var NN=/\r\n?/g,jN=/\u0000|\uFFFD/g;function t_(n){return(typeof n=="string"?n:""+n).replace(NN,`
`).replace(jN,"")}function eh(n,e,t){if(e=t_(e),t_(n)!==e&&t)throw Error(ce(425))}function If(){}var Iv=null,Rv=null;function Nv(n,e){return n==="textarea"||n==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var jv=typeof setTimeout=="function"?setTimeout:void 0,LN=typeof clearTimeout=="function"?clearTimeout:void 0,n_=typeof Promise=="function"?Promise:void 0,MN=typeof queueMicrotask=="function"?queueMicrotask:typeof n_<"u"?function(n){return n_.resolve(null).then(n).catch(FN)}:jv;function FN(n){setTimeout(function(){throw n})}function ug(n,e){var t=e,r=0;do{var s=t.nextSibling;if(n.removeChild(t),s&&s.nodeType===8)if(t=s.data,t==="/$"){if(r===0){n.removeChild(s),Iu(e);return}r--}else t!=="$"&&t!=="$?"&&t!=="$!"||r++;t=s}while(t);Iu(e)}function Ji(n){for(;n!=null;n=n.nextSibling){var e=n.nodeType;if(e===1||e===3)break;if(e===8){if(e=n.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return n}function r_(n){n=n.previousSibling;for(var e=0;n;){if(n.nodeType===8){var t=n.data;if(t==="$"||t==="$!"||t==="$?"){if(e===0)return n;e--}else t==="/$"&&e++}n=n.previousSibling}return null}var ic=Math.random().toString(36).slice(2),us="__reactFiber$"+ic,Mu="__reactProps$"+ic,Qs="__reactContainer$"+ic,Lv="__reactEvents$"+ic,BN="__reactListeners$"+ic,UN="__reactHandles$"+ic;function Go(n){var e=n[us];if(e)return e;for(var t=n.parentNode;t;){if(e=t[Qs]||t[us]){if(t=e.alternate,e.child!==null||t!==null&&t.child!==null)for(n=r_(n);n!==null;){if(t=n[us])return t;n=r_(n)}return e}n=t,t=n.parentNode}return null}function md(n){return n=n[us]||n[Qs],!n||n.tag!==5&&n.tag!==6&&n.tag!==13&&n.tag!==3?null:n}function Qa(n){if(n.tag===5||n.tag===6)return n.stateNode;throw Error(ce(33))}function jp(n){return n[Mu]||null}var Mv=[],Za=-1;function vo(n){return{current:n}}function _t(n){0>Za||(n.current=Mv[Za],Mv[Za]=null,Za--)}function vt(n,e){Za++,Mv[Za]=n.current,n.current=e}var ao={},kn=vo(ao),Yn=vo(!1),ia=ao;function Ul(n,e){var t=n.type.contextTypes;if(!t)return ao;var r=n.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var s={},i;for(i in t)s[i]=e[i];return r&&(n=n.stateNode,n.__reactInternalMemoizedUnmaskedChildContext=e,n.__reactInternalMemoizedMaskedChildContext=s),s}function Xn(n){return n=n.childContextTypes,n!=null}function Rf(){_t(Yn),_t(kn)}function s_(n,e,t){if(kn.current!==ao)throw Error(ce(168));vt(kn,e),vt(Yn,t)}function nP(n,e,t){var r=n.stateNode;if(e=e.childContextTypes,typeof r.getChildContext!="function")return t;r=r.getChildContext();for(var s in r)if(!(s in e))throw Error(ce(108,C5(n)||"Unknown",s));return Dt({},t,r)}function Nf(n){return n=(n=n.stateNode)&&n.__reactInternalMemoizedMergedChildContext||ao,ia=kn.current,vt(kn,n),vt(Yn,Yn.current),!0}function i_(n,e,t){var r=n.stateNode;if(!r)throw Error(ce(169));t?(n=nP(n,e,ia),r.__reactInternalMemoizedMergedChildContext=n,_t(Yn),_t(kn),vt(kn,n)):_t(Yn),vt(Yn,t)}var Is=null,Lp=!1,dg=!1;function rP(n){Is===null?Is=[n]:Is.push(n)}function $N(n){Lp=!0,rP(n)}function yo(){if(!dg&&Is!==null){dg=!0;var n=0,e=ft;try{var t=Is;for(ft=1;n<t.length;n++){var r=t[n];do r=r(!0);while(r!==null)}Is=null,Lp=!1}catch(s){throw Is!==null&&(Is=Is.slice(n+1)),Tk(Nx,yo),s}finally{ft=e,dg=!1}}return null}var el=[],tl=0,jf=null,Lf=0,br=[],_r=0,oa=null,Ls=1,Ms="";function Lo(n,e){el[tl++]=Lf,el[tl++]=jf,jf=n,Lf=e}function sP(n,e,t){br[_r++]=Ls,br[_r++]=Ms,br[_r++]=oa,oa=n;var r=Ls;n=Ms;var s=32-Jr(r)-1;r&=~(1<<s),t+=1;var i=32-Jr(e)+s;if(30<i){var o=s-s%5;i=(r&(1<<o)-1).toString(32),r>>=o,s-=o,Ls=1<<32-Jr(e)+s|t<<s|r,Ms=i+n}else Ls=1<<i|t<<s|r,Ms=n}function Wx(n){n.return!==null&&(Lo(n,1),sP(n,1,0))}function Hx(n){for(;n===jf;)jf=el[--tl],el[tl]=null,Lf=el[--tl],el[tl]=null;for(;n===oa;)oa=br[--_r],br[_r]=null,Ms=br[--_r],br[_r]=null,Ls=br[--_r],br[_r]=null}var dr=null,ur=null,St=!1,Hr=null;function iP(n,e){var t=Cr(5,null,null,0);t.elementType="DELETED",t.stateNode=e,t.return=n,e=n.deletions,e===null?(n.deletions=[t],n.flags|=16):e.push(t)}function o_(n,e){switch(n.tag){case 5:var t=n.type;return e=e.nodeType!==1||t.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(n.stateNode=e,dr=n,ur=Ji(e.firstChild),!0):!1;case 6:return e=n.pendingProps===""||e.nodeType!==3?null:e,e!==null?(n.stateNode=e,dr=n,ur=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(t=oa!==null?{id:Ls,overflow:Ms}:null,n.memoizedState={dehydrated:e,treeContext:t,retryLane:1073741824},t=Cr(18,null,null,0),t.stateNode=e,t.return=n,n.child=t,dr=n,ur=null,!0):!1;default:return!1}}function Fv(n){return(n.mode&1)!==0&&(n.flags&128)===0}function Bv(n){if(St){var e=ur;if(e){var t=e;if(!o_(n,e)){if(Fv(n))throw Error(ce(418));e=Ji(t.nextSibling);var r=dr;e&&o_(n,e)?iP(r,t):(n.flags=n.flags&-4097|2,St=!1,dr=n)}}else{if(Fv(n))throw Error(ce(418));n.flags=n.flags&-4097|2,St=!1,dr=n}}}function a_(n){for(n=n.return;n!==null&&n.tag!==5&&n.tag!==3&&n.tag!==13;)n=n.return;dr=n}function th(n){if(n!==dr)return!1;if(!St)return a_(n),St=!0,!1;var e;if((e=n.tag!==3)&&!(e=n.tag!==5)&&(e=n.type,e=e!=="head"&&e!=="body"&&!Nv(n.type,n.memoizedProps)),e&&(e=ur)){if(Fv(n))throw oP(),Error(ce(418));for(;e;)iP(n,e),e=Ji(e.nextSibling)}if(a_(n),n.tag===13){if(n=n.memoizedState,n=n!==null?n.dehydrated:null,!n)throw Error(ce(317));e:{for(n=n.nextSibling,e=0;n;){if(n.nodeType===8){var t=n.data;if(t==="/$"){if(e===0){ur=Ji(n.nextSibling);break e}e--}else t!=="$"&&t!=="$!"&&t!=="$?"||e++}n=n.nextSibling}ur=null}}else ur=dr?Ji(n.stateNode.nextSibling):null;return!0}function oP(){for(var n=ur;n;)n=Ji(n.nextSibling)}function $l(){ur=dr=null,St=!1}function Vx(n){Hr===null?Hr=[n]:Hr.push(n)}var zN=ui.ReactCurrentBatchConfig;function Lc(n,e,t){if(n=t.ref,n!==null&&typeof n!="function"&&typeof n!="object"){if(t._owner){if(t=t._owner,t){if(t.tag!==1)throw Error(ce(309));var r=t.stateNode}if(!r)throw Error(ce(147,n));var s=r,i=""+n;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===i?e.ref:(e=function(o){var a=s.refs;o===null?delete a[i]:a[i]=o},e._stringRef=i,e)}if(typeof n!="string")throw Error(ce(284));if(!t._owner)throw Error(ce(290,n))}return n}function nh(n,e){throw n=Object.prototype.toString.call(e),Error(ce(31,n==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":n))}function l_(n){var e=n._init;return e(n._payload)}function aP(n){function e(x,v){if(n){var w=x.deletions;w===null?(x.deletions=[v],x.flags|=16):w.push(v)}}function t(x,v){if(!n)return null;for(;v!==null;)e(x,v),v=v.sibling;return null}function r(x,v){for(x=new Map;v!==null;)v.key!==null?x.set(v.key,v):x.set(v.index,v),v=v.sibling;return x}function s(x,v){return x=to(x,v),x.index=0,x.sibling=null,x}function i(x,v,w){return x.index=w,n?(w=x.alternate,w!==null?(w=w.index,w<v?(x.flags|=2,v):w):(x.flags|=2,v)):(x.flags|=1048576,v)}function o(x){return n&&x.alternate===null&&(x.flags|=2),x}function a(x,v,w,_){return v===null||v.tag!==6?(v=yg(w,x.mode,_),v.return=x,v):(v=s(v,w),v.return=x,v)}function l(x,v,w,_){var S=w.type;return S===Ya?u(x,v,w.props.children,_,w.key):v!==null&&(v.elementType===S||typeof S=="object"&&S!==null&&S.$$typeof===Ai&&l_(S)===v.type)?(_=s(v,w.props),_.ref=Lc(x,v,w),_.return=x,_):(_=af(w.type,w.key,w.props,null,x.mode,_),_.ref=Lc(x,v,w),_.return=x,_)}function c(x,v,w,_){return v===null||v.tag!==4||v.stateNode.containerInfo!==w.containerInfo||v.stateNode.implementation!==w.implementation?(v=xg(w,x.mode,_),v.return=x,v):(v=s(v,w.children||[]),v.return=x,v)}function u(x,v,w,_,S){return v===null||v.tag!==7?(v=ra(w,x.mode,_,S),v.return=x,v):(v=s(v,w),v.return=x,v)}function h(x,v,w){if(typeof v=="string"&&v!==""||typeof v=="number")return v=yg(""+v,x.mode,w),v.return=x,v;if(typeof v=="object"&&v!==null){switch(v.$$typeof){case Vd:return w=af(v.type,v.key,v.props,null,x.mode,w),w.ref=Lc(x,null,v),w.return=x,w;case qa:return v=xg(v,x.mode,w),v.return=x,v;case Ai:var _=v._init;return h(x,_(v._payload),w)}if(Kc(v)||Oc(v))return v=ra(v,x.mode,w,null),v.return=x,v;nh(x,v)}return null}function d(x,v,w,_){var S=v!==null?v.key:null;if(typeof w=="string"&&w!==""||typeof w=="number")return S!==null?null:a(x,v,""+w,_);if(typeof w=="object"&&w!==null){switch(w.$$typeof){case Vd:return w.key===S?l(x,v,w,_):null;case qa:return w.key===S?c(x,v,w,_):null;case Ai:return S=w._init,d(x,v,S(w._payload),_)}if(Kc(w)||Oc(w))return S!==null?null:u(x,v,w,_,null);nh(x,w)}return null}function p(x,v,w,_,S){if(typeof _=="string"&&_!==""||typeof _=="number")return x=x.get(w)||null,a(v,x,""+_,S);if(typeof _=="object"&&_!==null){switch(_.$$typeof){case Vd:return x=x.get(_.key===null?w:_.key)||null,l(v,x,_,S);case qa:return x=x.get(_.key===null?w:_.key)||null,c(v,x,_,S);case Ai:var E=_._init;return p(x,v,w,E(_._payload),S)}if(Kc(_)||Oc(_))return x=x.get(w)||null,u(v,x,_,S,null);nh(v,_)}return null}function m(x,v,w,_){for(var S=null,E=null,C=v,P=v=0,O=null;C!==null&&P<w.length;P++){C.index>P?(O=C,C=null):O=C.sibling;var A=d(x,C,w[P],_);if(A===null){C===null&&(C=O);break}n&&C&&A.alternate===null&&e(x,C),v=i(A,v,P),E===null?S=A:E.sibling=A,E=A,C=O}if(P===w.length)return t(x,C),St&&Lo(x,P),S;if(C===null){for(;P<w.length;P++)C=h(x,w[P],_),C!==null&&(v=i(C,v,P),E===null?S=C:E.sibling=C,E=C);return St&&Lo(x,P),S}for(C=r(x,C);P<w.length;P++)O=p(C,x,P,w[P],_),O!==null&&(n&&O.alternate!==null&&C.delete(O.key===null?P:O.key),v=i(O,v,P),E===null?S=O:E.sibling=O,E=O);return n&&C.forEach(function(R){return e(x,R)}),St&&Lo(x,P),S}function g(x,v,w,_){var S=Oc(w);if(typeof S!="function")throw Error(ce(150));if(w=S.call(w),w==null)throw Error(ce(151));for(var E=S=null,C=v,P=v=0,O=null,A=w.next();C!==null&&!A.done;P++,A=w.next()){C.index>P?(O=C,C=null):O=C.sibling;var R=d(x,C,A.value,_);if(R===null){C===null&&(C=O);break}n&&C&&R.alternate===null&&e(x,C),v=i(R,v,P),E===null?S=R:E.sibling=R,E=R,C=O}if(A.done)return t(x,C),St&&Lo(x,P),S;if(C===null){for(;!A.done;P++,A=w.next())A=h(x,A.value,_),A!==null&&(v=i(A,v,P),E===null?S=A:E.sibling=A,E=A);return St&&Lo(x,P),S}for(C=r(x,C);!A.done;P++,A=w.next())A=p(C,x,P,A.value,_),A!==null&&(n&&A.alternate!==null&&C.delete(A.key===null?P:A.key),v=i(A,v,P),E===null?S=A:E.sibling=A,E=A);return n&&C.forEach(function(B){return e(x,B)}),St&&Lo(x,P),S}function y(x,v,w,_){if(typeof w=="object"&&w!==null&&w.type===Ya&&w.key===null&&(w=w.props.children),typeof w=="object"&&w!==null){switch(w.$$typeof){case Vd:e:{for(var S=w.key,E=v;E!==null;){if(E.key===S){if(S=w.type,S===Ya){if(E.tag===7){t(x,E.sibling),v=s(E,w.props.children),v.return=x,x=v;break e}}else if(E.elementType===S||typeof S=="object"&&S!==null&&S.$$typeof===Ai&&l_(S)===E.type){t(x,E.sibling),v=s(E,w.props),v.ref=Lc(x,E,w),v.return=x,x=v;break e}t(x,E);break}else e(x,E);E=E.sibling}w.type===Ya?(v=ra(w.props.children,x.mode,_,w.key),v.return=x,x=v):(_=af(w.type,w.key,w.props,null,x.mode,_),_.ref=Lc(x,v,w),_.return=x,x=_)}return o(x);case qa:e:{for(E=w.key;v!==null;){if(v.key===E)if(v.tag===4&&v.stateNode.containerInfo===w.containerInfo&&v.stateNode.implementation===w.implementation){t(x,v.sibling),v=s(v,w.children||[]),v.return=x,x=v;break e}else{t(x,v);break}else e(x,v);v=v.sibling}v=xg(w,x.mode,_),v.return=x,x=v}return o(x);case Ai:return E=w._init,y(x,v,E(w._payload),_)}if(Kc(w))return m(x,v,w,_);if(Oc(w))return g(x,v,w,_);nh(x,w)}return typeof w=="string"&&w!==""||typeof w=="number"?(w=""+w,v!==null&&v.tag===6?(t(x,v.sibling),v=s(v,w),v.return=x,x=v):(t(x,v),v=yg(w,x.mode,_),v.return=x,x=v),o(x)):t(x,v)}return y}var zl=aP(!0),lP=aP(!1),Mf=vo(null),Ff=null,nl=null,Gx=null;function qx(){Gx=nl=Ff=null}function Yx(n){var e=Mf.current;_t(Mf),n._currentValue=e}function Uv(n,e,t){for(;n!==null;){var r=n.alternate;if((n.childLanes&e)!==e?(n.childLanes|=e,r!==null&&(r.childLanes|=e)):r!==null&&(r.childLanes&e)!==e&&(r.childLanes|=e),n===t)break;n=n.return}}function fl(n,e){Ff=n,Gx=nl=null,n=n.dependencies,n!==null&&n.firstContext!==null&&(n.lanes&e&&(qn=!0),n.firstContext=null)}function Pr(n){var e=n._currentValue;if(Gx!==n)if(n={context:n,memoizedValue:e,next:null},nl===null){if(Ff===null)throw Error(ce(308));nl=n,Ff.dependencies={lanes:0,firstContext:n}}else nl=nl.next=n;return e}var qo=null;function Xx(n){qo===null?qo=[n]:qo.push(n)}function cP(n,e,t,r){var s=e.interleaved;return s===null?(t.next=t,Xx(e)):(t.next=s.next,s.next=t),e.interleaved=t,Zs(n,r)}function Zs(n,e){n.lanes|=e;var t=n.alternate;for(t!==null&&(t.lanes|=e),t=n,n=n.return;n!==null;)n.childLanes|=e,t=n.alternate,t!==null&&(t.childLanes|=e),t=n,n=n.return;return t.tag===3?t.stateNode:null}var Di=!1;function Kx(n){n.updateQueue={baseState:n.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function uP(n,e){n=n.updateQueue,e.updateQueue===n&&(e.updateQueue={baseState:n.baseState,firstBaseUpdate:n.firstBaseUpdate,lastBaseUpdate:n.lastBaseUpdate,shared:n.shared,effects:n.effects})}function Ws(n,e){return{eventTime:n,lane:e,tag:0,payload:null,callback:null,next:null}}function Qi(n,e,t){var r=n.updateQueue;if(r===null)return null;if(r=r.shared,rt&2){var s=r.pending;return s===null?e.next=e:(e.next=s.next,s.next=e),r.pending=e,Zs(n,t)}return s=r.interleaved,s===null?(e.next=e,Xx(r)):(e.next=s.next,s.next=e),r.interleaved=e,Zs(n,t)}function ef(n,e,t){if(e=e.updateQueue,e!==null&&(e=e.shared,(t&4194240)!==0)){var r=e.lanes;r&=n.pendingLanes,t|=r,e.lanes=t,jx(n,t)}}function c_(n,e){var t=n.updateQueue,r=n.alternate;if(r!==null&&(r=r.updateQueue,t===r)){var s=null,i=null;if(t=t.firstBaseUpdate,t!==null){do{var o={eventTime:t.eventTime,lane:t.lane,tag:t.tag,payload:t.payload,callback:t.callback,next:null};i===null?s=i=o:i=i.next=o,t=t.next}while(t!==null);i===null?s=i=e:i=i.next=e}else s=i=e;t={baseState:r.baseState,firstBaseUpdate:s,lastBaseUpdate:i,shared:r.shared,effects:r.effects},n.updateQueue=t;return}n=t.lastBaseUpdate,n===null?t.firstBaseUpdate=e:n.next=e,t.lastBaseUpdate=e}function Bf(n,e,t,r){var s=n.updateQueue;Di=!1;var i=s.firstBaseUpdate,o=s.lastBaseUpdate,a=s.shared.pending;if(a!==null){s.shared.pending=null;var l=a,c=l.next;l.next=null,o===null?i=c:o.next=c,o=l;var u=n.alternate;u!==null&&(u=u.updateQueue,a=u.lastBaseUpdate,a!==o&&(a===null?u.firstBaseUpdate=c:a.next=c,u.lastBaseUpdate=l))}if(i!==null){var h=s.baseState;o=0,u=c=l=null,a=i;do{var d=a.lane,p=a.eventTime;if((r&d)===d){u!==null&&(u=u.next={eventTime:p,lane:0,tag:a.tag,payload:a.payload,callback:a.callback,next:null});e:{var m=n,g=a;switch(d=e,p=t,g.tag){case 1:if(m=g.payload,typeof m=="function"){h=m.call(p,h,d);break e}h=m;break e;case 3:m.flags=m.flags&-65537|128;case 0:if(m=g.payload,d=typeof m=="function"?m.call(p,h,d):m,d==null)break e;h=Dt({},h,d);break e;case 2:Di=!0}}a.callback!==null&&a.lane!==0&&(n.flags|=64,d=s.effects,d===null?s.effects=[a]:d.push(a))}else p={eventTime:p,lane:d,tag:a.tag,payload:a.payload,callback:a.callback,next:null},u===null?(c=u=p,l=h):u=u.next=p,o|=d;if(a=a.next,a===null){if(a=s.shared.pending,a===null)break;d=a,a=d.next,d.next=null,s.lastBaseUpdate=d,s.shared.pending=null}}while(!0);if(u===null&&(l=h),s.baseState=l,s.firstBaseUpdate=c,s.lastBaseUpdate=u,e=s.shared.interleaved,e!==null){s=e;do o|=s.lane,s=s.next;while(s!==e)}else i===null&&(s.shared.lanes=0);la|=o,n.lanes=o,n.memoizedState=h}}function u_(n,e,t){if(n=e.effects,e.effects=null,n!==null)for(e=0;e<n.length;e++){var r=n[e],s=r.callback;if(s!==null){if(r.callback=null,r=t,typeof s!="function")throw Error(ce(191,s));s.call(r)}}}var vd={},gs=vo(vd),Fu=vo(vd),Bu=vo(vd);function Yo(n){if(n===vd)throw Error(ce(174));return n}function Jx(n,e){switch(vt(Bu,e),vt(Fu,n),vt(gs,vd),n=e.nodeType,n){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:wv(null,"");break;default:n=n===8?e.parentNode:e,e=n.namespaceURI||null,n=n.tagName,e=wv(e,n)}_t(gs),vt(gs,e)}function Wl(){_t(gs),_t(Fu),_t(Bu)}function dP(n){Yo(Bu.current);var e=Yo(gs.current),t=wv(e,n.type);e!==t&&(vt(Fu,n),vt(gs,t))}function Qx(n){Fu.current===n&&(_t(gs),_t(Fu))}var Pt=vo(0);function Uf(n){for(var e=n;e!==null;){if(e.tag===13){var t=e.memoizedState;if(t!==null&&(t=t.dehydrated,t===null||t.data==="$?"||t.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===n)break;for(;e.sibling===null;){if(e.return===null||e.return===n)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var hg=[];function Zx(){for(var n=0;n<hg.length;n++)hg[n]._workInProgressVersionPrimary=null;hg.length=0}var tf=ui.ReactCurrentDispatcher,fg=ui.ReactCurrentBatchConfig,aa=0,At=null,Kt=null,an=null,$f=!1,uu=!1,Uu=0,WN=0;function wn(){throw Error(ce(321))}function ew(n,e){if(e===null)return!1;for(var t=0;t<e.length&&t<n.length;t++)if(!es(n[t],e[t]))return!1;return!0}function tw(n,e,t,r,s,i){if(aa=i,At=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,tf.current=n===null||n.memoizedState===null?qN:YN,n=t(r,s),uu){i=0;do{if(uu=!1,Uu=0,25<=i)throw Error(ce(301));i+=1,an=Kt=null,e.updateQueue=null,tf.current=XN,n=t(r,s)}while(uu)}if(tf.current=zf,e=Kt!==null&&Kt.next!==null,aa=0,an=Kt=At=null,$f=!1,e)throw Error(ce(300));return n}function nw(){var n=Uu!==0;return Uu=0,n}function os(){var n={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return an===null?At.memoizedState=an=n:an=an.next=n,an}function Tr(){if(Kt===null){var n=At.alternate;n=n!==null?n.memoizedState:null}else n=Kt.next;var e=an===null?At.memoizedState:an.next;if(e!==null)an=e,Kt=n;else{if(n===null)throw Error(ce(310));Kt=n,n={memoizedState:Kt.memoizedState,baseState:Kt.baseState,baseQueue:Kt.baseQueue,queue:Kt.queue,next:null},an===null?At.memoizedState=an=n:an=an.next=n}return an}function $u(n,e){return typeof e=="function"?e(n):e}function pg(n){var e=Tr(),t=e.queue;if(t===null)throw Error(ce(311));t.lastRenderedReducer=n;var r=Kt,s=r.baseQueue,i=t.pending;if(i!==null){if(s!==null){var o=s.next;s.next=i.next,i.next=o}r.baseQueue=s=i,t.pending=null}if(s!==null){i=s.next,r=r.baseState;var a=o=null,l=null,c=i;do{var u=c.lane;if((aa&u)===u)l!==null&&(l=l.next={lane:0,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null}),r=c.hasEagerState?c.eagerState:n(r,c.action);else{var h={lane:u,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null};l===null?(a=l=h,o=r):l=l.next=h,At.lanes|=u,la|=u}c=c.next}while(c!==null&&c!==i);l===null?o=r:l.next=a,es(r,e.memoizedState)||(qn=!0),e.memoizedState=r,e.baseState=o,e.baseQueue=l,t.lastRenderedState=r}if(n=t.interleaved,n!==null){s=n;do i=s.lane,At.lanes|=i,la|=i,s=s.next;while(s!==n)}else s===null&&(t.lanes=0);return[e.memoizedState,t.dispatch]}function gg(n){var e=Tr(),t=e.queue;if(t===null)throw Error(ce(311));t.lastRenderedReducer=n;var r=t.dispatch,s=t.pending,i=e.memoizedState;if(s!==null){t.pending=null;var o=s=s.next;do i=n(i,o.action),o=o.next;while(o!==s);es(i,e.memoizedState)||(qn=!0),e.memoizedState=i,e.baseQueue===null&&(e.baseState=i),t.lastRenderedState=i}return[i,r]}function hP(){}function fP(n,e){var t=At,r=Tr(),s=e(),i=!es(r.memoizedState,s);if(i&&(r.memoizedState=s,qn=!0),r=r.queue,rw(mP.bind(null,t,r,n),[n]),r.getSnapshot!==e||i||an!==null&&an.memoizedState.tag&1){if(t.flags|=2048,zu(9,gP.bind(null,t,r,s,e),void 0,null),cn===null)throw Error(ce(349));aa&30||pP(t,e,s)}return s}function pP(n,e,t){n.flags|=16384,n={getSnapshot:e,value:t},e=At.updateQueue,e===null?(e={lastEffect:null,stores:null},At.updateQueue=e,e.stores=[n]):(t=e.stores,t===null?e.stores=[n]:t.push(n))}function gP(n,e,t,r){e.value=t,e.getSnapshot=r,vP(e)&&yP(n)}function mP(n,e,t){return t(function(){vP(e)&&yP(n)})}function vP(n){var e=n.getSnapshot;n=n.value;try{var t=e();return!es(n,t)}catch{return!0}}function yP(n){var e=Zs(n,1);e!==null&&Qr(e,n,1,-1)}function d_(n){var e=os();return typeof n=="function"&&(n=n()),e.memoizedState=e.baseState=n,n={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:$u,lastRenderedState:n},e.queue=n,n=n.dispatch=GN.bind(null,At,n),[e.memoizedState,n]}function zu(n,e,t,r){return n={tag:n,create:e,destroy:t,deps:r,next:null},e=At.updateQueue,e===null?(e={lastEffect:null,stores:null},At.updateQueue=e,e.lastEffect=n.next=n):(t=e.lastEffect,t===null?e.lastEffect=n.next=n:(r=t.next,t.next=n,n.next=r,e.lastEffect=n)),n}function xP(){return Tr().memoizedState}function nf(n,e,t,r){var s=os();At.flags|=n,s.memoizedState=zu(1|e,t,void 0,r===void 0?null:r)}function Mp(n,e,t,r){var s=Tr();r=r===void 0?null:r;var i=void 0;if(Kt!==null){var o=Kt.memoizedState;if(i=o.destroy,r!==null&&ew(r,o.deps)){s.memoizedState=zu(e,t,i,r);return}}At.flags|=n,s.memoizedState=zu(1|e,t,i,r)}function h_(n,e){return nf(8390656,8,n,e)}function rw(n,e){return Mp(2048,8,n,e)}function wP(n,e){return Mp(4,2,n,e)}function bP(n,e){return Mp(4,4,n,e)}function _P(n,e){if(typeof e=="function")return n=n(),e(n),function(){e(null)};if(e!=null)return n=n(),e.current=n,function(){e.current=null}}function SP(n,e,t){return t=t!=null?t.concat([n]):null,Mp(4,4,_P.bind(null,e,n),t)}function sw(){}function CP(n,e){var t=Tr();e=e===void 0?null:e;var r=t.memoizedState;return r!==null&&e!==null&&ew(e,r[1])?r[0]:(t.memoizedState=[n,e],n)}function EP(n,e){var t=Tr();e=e===void 0?null:e;var r=t.memoizedState;return r!==null&&e!==null&&ew(e,r[1])?r[0]:(n=n(),t.memoizedState=[n,e],n)}function kP(n,e,t){return aa&21?(es(t,e)||(t=Ok(),At.lanes|=t,la|=t,n.baseState=!0),e):(n.baseState&&(n.baseState=!1,qn=!0),n.memoizedState=t)}function HN(n,e){var t=ft;ft=t!==0&&4>t?t:4,n(!0);var r=fg.transition;fg.transition={};try{n(!1),e()}finally{ft=t,fg.transition=r}}function PP(){return Tr().memoizedState}function VN(n,e,t){var r=eo(n);if(t={lane:r,action:t,hasEagerState:!1,eagerState:null,next:null},TP(n))AP(e,t);else if(t=cP(n,e,t,r),t!==null){var s=jn();Qr(t,n,r,s),DP(t,e,r)}}function GN(n,e,t){var r=eo(n),s={lane:r,action:t,hasEagerState:!1,eagerState:null,next:null};if(TP(n))AP(e,s);else{var i=n.alternate;if(n.lanes===0&&(i===null||i.lanes===0)&&(i=e.lastRenderedReducer,i!==null))try{var o=e.lastRenderedState,a=i(o,t);if(s.hasEagerState=!0,s.eagerState=a,es(a,o)){var l=e.interleaved;l===null?(s.next=s,Xx(e)):(s.next=l.next,l.next=s),e.interleaved=s;return}}catch{}finally{}t=cP(n,e,s,r),t!==null&&(s=jn(),Qr(t,n,r,s),DP(t,e,r))}}function TP(n){var e=n.alternate;return n===At||e!==null&&e===At}function AP(n,e){uu=$f=!0;var t=n.pending;t===null?e.next=e:(e.next=t.next,t.next=e),n.pending=e}function DP(n,e,t){if(t&4194240){var r=e.lanes;r&=n.pendingLanes,t|=r,e.lanes=t,jx(n,t)}}var zf={readContext:Pr,useCallback:wn,useContext:wn,useEffect:wn,useImperativeHandle:wn,useInsertionEffect:wn,useLayoutEffect:wn,useMemo:wn,useReducer:wn,useRef:wn,useState:wn,useDebugValue:wn,useDeferredValue:wn,useTransition:wn,useMutableSource:wn,useSyncExternalStore:wn,useId:wn,unstable_isNewReconciler:!1},qN={readContext:Pr,useCallback:function(n,e){return os().memoizedState=[n,e===void 0?null:e],n},useContext:Pr,useEffect:h_,useImperativeHandle:function(n,e,t){return t=t!=null?t.concat([n]):null,nf(4194308,4,_P.bind(null,e,n),t)},useLayoutEffect:function(n,e){return nf(4194308,4,n,e)},useInsertionEffect:function(n,e){return nf(4,2,n,e)},useMemo:function(n,e){var t=os();return e=e===void 0?null:e,n=n(),t.memoizedState=[n,e],n},useReducer:function(n,e,t){var r=os();return e=t!==void 0?t(e):e,r.memoizedState=r.baseState=e,n={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:n,lastRenderedState:e},r.queue=n,n=n.dispatch=VN.bind(null,At,n),[r.memoizedState,n]},useRef:function(n){var e=os();return n={current:n},e.memoizedState=n},useState:d_,useDebugValue:sw,useDeferredValue:function(n){return os().memoizedState=n},useTransition:function(){var n=d_(!1),e=n[0];return n=HN.bind(null,n[1]),os().memoizedState=n,[e,n]},useMutableSource:function(){},useSyncExternalStore:function(n,e,t){var r=At,s=os();if(St){if(t===void 0)throw Error(ce(407));t=t()}else{if(t=e(),cn===null)throw Error(ce(349));aa&30||pP(r,e,t)}s.memoizedState=t;var i={value:t,getSnapshot:e};return s.queue=i,h_(mP.bind(null,r,i,n),[n]),r.flags|=2048,zu(9,gP.bind(null,r,i,t,e),void 0,null),t},useId:function(){var n=os(),e=cn.identifierPrefix;if(St){var t=Ms,r=Ls;t=(r&~(1<<32-Jr(r)-1)).toString(32)+t,e=":"+e+"R"+t,t=Uu++,0<t&&(e+="H"+t.toString(32)),e+=":"}else t=WN++,e=":"+e+"r"+t.toString(32)+":";return n.memoizedState=e},unstable_isNewReconciler:!1},YN={readContext:Pr,useCallback:CP,useContext:Pr,useEffect:rw,useImperativeHandle:SP,useInsertionEffect:wP,useLayoutEffect:bP,useMemo:EP,useReducer:pg,useRef:xP,useState:function(){return pg($u)},useDebugValue:sw,useDeferredValue:function(n){var e=Tr();return kP(e,Kt.memoizedState,n)},useTransition:function(){var n=pg($u)[0],e=Tr().memoizedState;return[n,e]},useMutableSource:hP,useSyncExternalStore:fP,useId:PP,unstable_isNewReconciler:!1},XN={readContext:Pr,useCallback:CP,useContext:Pr,useEffect:rw,useImperativeHandle:SP,useInsertionEffect:wP,useLayoutEffect:bP,useMemo:EP,useReducer:gg,useRef:xP,useState:function(){return gg($u)},useDebugValue:sw,useDeferredValue:function(n){var e=Tr();return Kt===null?e.memoizedState=n:kP(e,Kt.memoizedState,n)},useTransition:function(){var n=gg($u)[0],e=Tr().memoizedState;return[n,e]},useMutableSource:hP,useSyncExternalStore:fP,useId:PP,unstable_isNewReconciler:!1};function Mr(n,e){if(n&&n.defaultProps){e=Dt({},e),n=n.defaultProps;for(var t in n)e[t]===void 0&&(e[t]=n[t]);return e}return e}function $v(n,e,t,r){e=n.memoizedState,t=t(r,e),t=t==null?e:Dt({},e,t),n.memoizedState=t,n.lanes===0&&(n.updateQueue.baseState=t)}var Fp={isMounted:function(n){return(n=n._reactInternals)?wa(n)===n:!1},enqueueSetState:function(n,e,t){n=n._reactInternals;var r=jn(),s=eo(n),i=Ws(r,s);i.payload=e,t!=null&&(i.callback=t),e=Qi(n,i,s),e!==null&&(Qr(e,n,s,r),ef(e,n,s))},enqueueReplaceState:function(n,e,t){n=n._reactInternals;var r=jn(),s=eo(n),i=Ws(r,s);i.tag=1,i.payload=e,t!=null&&(i.callback=t),e=Qi(n,i,s),e!==null&&(Qr(e,n,s,r),ef(e,n,s))},enqueueForceUpdate:function(n,e){n=n._reactInternals;var t=jn(),r=eo(n),s=Ws(t,r);s.tag=2,e!=null&&(s.callback=e),e=Qi(n,s,r),e!==null&&(Qr(e,n,r,t),ef(e,n,r))}};function f_(n,e,t,r,s,i,o){return n=n.stateNode,typeof n.shouldComponentUpdate=="function"?n.shouldComponentUpdate(r,i,o):e.prototype&&e.prototype.isPureReactComponent?!Nu(t,r)||!Nu(s,i):!0}function OP(n,e,t){var r=!1,s=ao,i=e.contextType;return typeof i=="object"&&i!==null?i=Pr(i):(s=Xn(e)?ia:kn.current,r=e.contextTypes,i=(r=r!=null)?Ul(n,s):ao),e=new e(t,i),n.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=Fp,n.stateNode=e,e._reactInternals=n,r&&(n=n.stateNode,n.__reactInternalMemoizedUnmaskedChildContext=s,n.__reactInternalMemoizedMaskedChildContext=i),e}function p_(n,e,t,r){n=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(t,r),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(t,r),e.state!==n&&Fp.enqueueReplaceState(e,e.state,null)}function zv(n,e,t,r){var s=n.stateNode;s.props=t,s.state=n.memoizedState,s.refs={},Kx(n);var i=e.contextType;typeof i=="object"&&i!==null?s.context=Pr(i):(i=Xn(e)?ia:kn.current,s.context=Ul(n,i)),s.state=n.memoizedState,i=e.getDerivedStateFromProps,typeof i=="function"&&($v(n,e,i,t),s.state=n.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof s.getSnapshotBeforeUpdate=="function"||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(e=s.state,typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount(),e!==s.state&&Fp.enqueueReplaceState(s,s.state,null),Bf(n,t,s,r),s.state=n.memoizedState),typeof s.componentDidMount=="function"&&(n.flags|=4194308)}function Hl(n,e){try{var t="",r=e;do t+=S5(r),r=r.return;while(r);var s=t}catch(i){s=`
Error generating stack: `+i.message+`
`+i.stack}return{value:n,source:e,stack:s,digest:null}}function mg(n,e,t){return{value:n,source:null,stack:t??null,digest:e??null}}function Wv(n,e){try{console.error(e.value)}catch(t){setTimeout(function(){throw t})}}var KN=typeof WeakMap=="function"?WeakMap:Map;function IP(n,e,t){t=Ws(-1,t),t.tag=3,t.payload={element:null};var r=e.value;return t.callback=function(){Hf||(Hf=!0,Zv=r),Wv(n,e)},t}function RP(n,e,t){t=Ws(-1,t),t.tag=3;var r=n.type.getDerivedStateFromError;if(typeof r=="function"){var s=e.value;t.payload=function(){return r(s)},t.callback=function(){Wv(n,e)}}var i=n.stateNode;return i!==null&&typeof i.componentDidCatch=="function"&&(t.callback=function(){Wv(n,e),typeof r!="function"&&(Zi===null?Zi=new Set([this]):Zi.add(this));var o=e.stack;this.componentDidCatch(e.value,{componentStack:o!==null?o:""})}),t}function g_(n,e,t){var r=n.pingCache;if(r===null){r=n.pingCache=new KN;var s=new Set;r.set(e,s)}else s=r.get(e),s===void 0&&(s=new Set,r.set(e,s));s.has(t)||(s.add(t),n=uj.bind(null,n,e,t),e.then(n,n))}function m_(n){do{var e;if((e=n.tag===13)&&(e=n.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return n;n=n.return}while(n!==null);return null}function v_(n,e,t,r,s){return n.mode&1?(n.flags|=65536,n.lanes=s,n):(n===e?n.flags|=65536:(n.flags|=128,t.flags|=131072,t.flags&=-52805,t.tag===1&&(t.alternate===null?t.tag=17:(e=Ws(-1,1),e.tag=2,Qi(t,e,1))),t.lanes|=1),n)}var JN=ui.ReactCurrentOwner,qn=!1;function On(n,e,t,r){e.child=n===null?lP(e,null,t,r):zl(e,n.child,t,r)}function y_(n,e,t,r,s){t=t.render;var i=e.ref;return fl(e,s),r=tw(n,e,t,r,i,s),t=nw(),n!==null&&!qn?(e.updateQueue=n.updateQueue,e.flags&=-2053,n.lanes&=~s,ei(n,e,s)):(St&&t&&Wx(e),e.flags|=1,On(n,e,r,s),e.child)}function x_(n,e,t,r,s){if(n===null){var i=t.type;return typeof i=="function"&&!hw(i)&&i.defaultProps===void 0&&t.compare===null&&t.defaultProps===void 0?(e.tag=15,e.type=i,NP(n,e,i,r,s)):(n=af(t.type,null,r,e,e.mode,s),n.ref=e.ref,n.return=e,e.child=n)}if(i=n.child,!(n.lanes&s)){var o=i.memoizedProps;if(t=t.compare,t=t!==null?t:Nu,t(o,r)&&n.ref===e.ref)return ei(n,e,s)}return e.flags|=1,n=to(i,r),n.ref=e.ref,n.return=e,e.child=n}function NP(n,e,t,r,s){if(n!==null){var i=n.memoizedProps;if(Nu(i,r)&&n.ref===e.ref)if(qn=!1,e.pendingProps=r=i,(n.lanes&s)!==0)n.flags&131072&&(qn=!0);else return e.lanes=n.lanes,ei(n,e,s)}return Hv(n,e,t,r,s)}function jP(n,e,t){var r=e.pendingProps,s=r.children,i=n!==null?n.memoizedState:null;if(r.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},vt(sl,lr),lr|=t;else{if(!(t&1073741824))return n=i!==null?i.baseLanes|t:t,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:n,cachePool:null,transitions:null},e.updateQueue=null,vt(sl,lr),lr|=n,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=i!==null?i.baseLanes:t,vt(sl,lr),lr|=r}else i!==null?(r=i.baseLanes|t,e.memoizedState=null):r=t,vt(sl,lr),lr|=r;return On(n,e,s,t),e.child}function LP(n,e){var t=e.ref;(n===null&&t!==null||n!==null&&n.ref!==t)&&(e.flags|=512,e.flags|=2097152)}function Hv(n,e,t,r,s){var i=Xn(t)?ia:kn.current;return i=Ul(e,i),fl(e,s),t=tw(n,e,t,r,i,s),r=nw(),n!==null&&!qn?(e.updateQueue=n.updateQueue,e.flags&=-2053,n.lanes&=~s,ei(n,e,s)):(St&&r&&Wx(e),e.flags|=1,On(n,e,t,s),e.child)}function w_(n,e,t,r,s){if(Xn(t)){var i=!0;Nf(e)}else i=!1;if(fl(e,s),e.stateNode===null)rf(n,e),OP(e,t,r),zv(e,t,r,s),r=!0;else if(n===null){var o=e.stateNode,a=e.memoizedProps;o.props=a;var l=o.context,c=t.contextType;typeof c=="object"&&c!==null?c=Pr(c):(c=Xn(t)?ia:kn.current,c=Ul(e,c));var u=t.getDerivedStateFromProps,h=typeof u=="function"||typeof o.getSnapshotBeforeUpdate=="function";h||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==r||l!==c)&&p_(e,o,r,c),Di=!1;var d=e.memoizedState;o.state=d,Bf(e,r,o,s),l=e.memoizedState,a!==r||d!==l||Yn.current||Di?(typeof u=="function"&&($v(e,t,u,r),l=e.memoizedState),(a=Di||f_(e,t,a,r,d,l,c))?(h||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(e.flags|=4194308)):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=r,e.memoizedState=l),o.props=r,o.state=l,o.context=c,r=a):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),r=!1)}else{o=e.stateNode,uP(n,e),a=e.memoizedProps,c=e.type===e.elementType?a:Mr(e.type,a),o.props=c,h=e.pendingProps,d=o.context,l=t.contextType,typeof l=="object"&&l!==null?l=Pr(l):(l=Xn(t)?ia:kn.current,l=Ul(e,l));var p=t.getDerivedStateFromProps;(u=typeof p=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==h||d!==l)&&p_(e,o,r,l),Di=!1,d=e.memoizedState,o.state=d,Bf(e,r,o,s);var m=e.memoizedState;a!==h||d!==m||Yn.current||Di?(typeof p=="function"&&($v(e,t,p,r),m=e.memoizedState),(c=Di||f_(e,t,c,r,d,m,l)||!1)?(u||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(r,m,l),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(r,m,l)),typeof o.componentDidUpdate=="function"&&(e.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof o.componentDidUpdate!="function"||a===n.memoizedProps&&d===n.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===n.memoizedProps&&d===n.memoizedState||(e.flags|=1024),e.memoizedProps=r,e.memoizedState=m),o.props=r,o.state=m,o.context=l,r=c):(typeof o.componentDidUpdate!="function"||a===n.memoizedProps&&d===n.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===n.memoizedProps&&d===n.memoizedState||(e.flags|=1024),r=!1)}return Vv(n,e,t,r,i,s)}function Vv(n,e,t,r,s,i){LP(n,e);var o=(e.flags&128)!==0;if(!r&&!o)return s&&i_(e,t,!1),ei(n,e,i);r=e.stateNode,JN.current=e;var a=o&&typeof t.getDerivedStateFromError!="function"?null:r.render();return e.flags|=1,n!==null&&o?(e.child=zl(e,n.child,null,i),e.child=zl(e,null,a,i)):On(n,e,a,i),e.memoizedState=r.state,s&&i_(e,t,!0),e.child}function MP(n){var e=n.stateNode;e.pendingContext?s_(n,e.pendingContext,e.pendingContext!==e.context):e.context&&s_(n,e.context,!1),Jx(n,e.containerInfo)}function b_(n,e,t,r,s){return $l(),Vx(s),e.flags|=256,On(n,e,t,r),e.child}var Gv={dehydrated:null,treeContext:null,retryLane:0};function qv(n){return{baseLanes:n,cachePool:null,transitions:null}}function FP(n,e,t){var r=e.pendingProps,s=Pt.current,i=!1,o=(e.flags&128)!==0,a;if((a=o)||(a=n!==null&&n.memoizedState===null?!1:(s&2)!==0),a?(i=!0,e.flags&=-129):(n===null||n.memoizedState!==null)&&(s|=1),vt(Pt,s&1),n===null)return Bv(e),n=e.memoizedState,n!==null&&(n=n.dehydrated,n!==null)?(e.mode&1?n.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(o=r.children,n=r.fallback,i?(r=e.mode,i=e.child,o={mode:"hidden",children:o},!(r&1)&&i!==null?(i.childLanes=0,i.pendingProps=o):i=$p(o,r,0,null),n=ra(n,r,t,null),i.return=e,n.return=e,i.sibling=n,e.child=i,e.child.memoizedState=qv(t),e.memoizedState=Gv,n):iw(e,o));if(s=n.memoizedState,s!==null&&(a=s.dehydrated,a!==null))return QN(n,e,o,r,a,s,t);if(i){i=r.fallback,o=e.mode,s=n.child,a=s.sibling;var l={mode:"hidden",children:r.children};return!(o&1)&&e.child!==s?(r=e.child,r.childLanes=0,r.pendingProps=l,e.deletions=null):(r=to(s,l),r.subtreeFlags=s.subtreeFlags&14680064),a!==null?i=to(a,i):(i=ra(i,o,t,null),i.flags|=2),i.return=e,r.return=e,r.sibling=i,e.child=r,r=i,i=e.child,o=n.child.memoizedState,o=o===null?qv(t):{baseLanes:o.baseLanes|t,cachePool:null,transitions:o.transitions},i.memoizedState=o,i.childLanes=n.childLanes&~t,e.memoizedState=Gv,r}return i=n.child,n=i.sibling,r=to(i,{mode:"visible",children:r.children}),!(e.mode&1)&&(r.lanes=t),r.return=e,r.sibling=null,n!==null&&(t=e.deletions,t===null?(e.deletions=[n],e.flags|=16):t.push(n)),e.child=r,e.memoizedState=null,r}function iw(n,e){return e=$p({mode:"visible",children:e},n.mode,0,null),e.return=n,n.child=e}function rh(n,e,t,r){return r!==null&&Vx(r),zl(e,n.child,null,t),n=iw(e,e.pendingProps.children),n.flags|=2,e.memoizedState=null,n}function QN(n,e,t,r,s,i,o){if(t)return e.flags&256?(e.flags&=-257,r=mg(Error(ce(422))),rh(n,e,o,r)):e.memoizedState!==null?(e.child=n.child,e.flags|=128,null):(i=r.fallback,s=e.mode,r=$p({mode:"visible",children:r.children},s,0,null),i=ra(i,s,o,null),i.flags|=2,r.return=e,i.return=e,r.sibling=i,e.child=r,e.mode&1&&zl(e,n.child,null,o),e.child.memoizedState=qv(o),e.memoizedState=Gv,i);if(!(e.mode&1))return rh(n,e,o,null);if(s.data==="$!"){if(r=s.nextSibling&&s.nextSibling.dataset,r)var a=r.dgst;return r=a,i=Error(ce(419)),r=mg(i,r,void 0),rh(n,e,o,r)}if(a=(o&n.childLanes)!==0,qn||a){if(r=cn,r!==null){switch(o&-o){case 4:s=2;break;case 16:s=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:s=32;break;case 536870912:s=268435456;break;default:s=0}s=s&(r.suspendedLanes|o)?0:s,s!==0&&s!==i.retryLane&&(i.retryLane=s,Zs(n,s),Qr(r,n,s,-1))}return dw(),r=mg(Error(ce(421))),rh(n,e,o,r)}return s.data==="$?"?(e.flags|=128,e.child=n.child,e=dj.bind(null,n),s._reactRetry=e,null):(n=i.treeContext,ur=Ji(s.nextSibling),dr=e,St=!0,Hr=null,n!==null&&(br[_r++]=Ls,br[_r++]=Ms,br[_r++]=oa,Ls=n.id,Ms=n.overflow,oa=e),e=iw(e,r.children),e.flags|=4096,e)}function __(n,e,t){n.lanes|=e;var r=n.alternate;r!==null&&(r.lanes|=e),Uv(n.return,e,t)}function vg(n,e,t,r,s){var i=n.memoizedState;i===null?n.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:t,tailMode:s}:(i.isBackwards=e,i.rendering=null,i.renderingStartTime=0,i.last=r,i.tail=t,i.tailMode=s)}function BP(n,e,t){var r=e.pendingProps,s=r.revealOrder,i=r.tail;if(On(n,e,r.children,t),r=Pt.current,r&2)r=r&1|2,e.flags|=128;else{if(n!==null&&n.flags&128)e:for(n=e.child;n!==null;){if(n.tag===13)n.memoizedState!==null&&__(n,t,e);else if(n.tag===19)__(n,t,e);else if(n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break e;for(;n.sibling===null;){if(n.return===null||n.return===e)break e;n=n.return}n.sibling.return=n.return,n=n.sibling}r&=1}if(vt(Pt,r),!(e.mode&1))e.memoizedState=null;else switch(s){case"forwards":for(t=e.child,s=null;t!==null;)n=t.alternate,n!==null&&Uf(n)===null&&(s=t),t=t.sibling;t=s,t===null?(s=e.child,e.child=null):(s=t.sibling,t.sibling=null),vg(e,!1,s,t,i);break;case"backwards":for(t=null,s=e.child,e.child=null;s!==null;){if(n=s.alternate,n!==null&&Uf(n)===null){e.child=s;break}n=s.sibling,s.sibling=t,t=s,s=n}vg(e,!0,t,null,i);break;case"together":vg(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function rf(n,e){!(e.mode&1)&&n!==null&&(n.alternate=null,e.alternate=null,e.flags|=2)}function ei(n,e,t){if(n!==null&&(e.dependencies=n.dependencies),la|=e.lanes,!(t&e.childLanes))return null;if(n!==null&&e.child!==n.child)throw Error(ce(153));if(e.child!==null){for(n=e.child,t=to(n,n.pendingProps),e.child=t,t.return=e;n.sibling!==null;)n=n.sibling,t=t.sibling=to(n,n.pendingProps),t.return=e;t.sibling=null}return e.child}function ZN(n,e,t){switch(e.tag){case 3:MP(e),$l();break;case 5:dP(e);break;case 1:Xn(e.type)&&Nf(e);break;case 4:Jx(e,e.stateNode.containerInfo);break;case 10:var r=e.type._context,s=e.memoizedProps.value;vt(Mf,r._currentValue),r._currentValue=s;break;case 13:if(r=e.memoizedState,r!==null)return r.dehydrated!==null?(vt(Pt,Pt.current&1),e.flags|=128,null):t&e.child.childLanes?FP(n,e,t):(vt(Pt,Pt.current&1),n=ei(n,e,t),n!==null?n.sibling:null);vt(Pt,Pt.current&1);break;case 19:if(r=(t&e.childLanes)!==0,n.flags&128){if(r)return BP(n,e,t);e.flags|=128}if(s=e.memoizedState,s!==null&&(s.rendering=null,s.tail=null,s.lastEffect=null),vt(Pt,Pt.current),r)break;return null;case 22:case 23:return e.lanes=0,jP(n,e,t)}return ei(n,e,t)}var UP,Yv,$P,zP;UP=function(n,e){for(var t=e.child;t!==null;){if(t.tag===5||t.tag===6)n.appendChild(t.stateNode);else if(t.tag!==4&&t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return;t=t.return}t.sibling.return=t.return,t=t.sibling}};Yv=function(){};$P=function(n,e,t,r){var s=n.memoizedProps;if(s!==r){n=e.stateNode,Yo(gs.current);var i=null;switch(t){case"input":s=mv(n,s),r=mv(n,r),i=[];break;case"select":s=Dt({},s,{value:void 0}),r=Dt({},r,{value:void 0}),i=[];break;case"textarea":s=xv(n,s),r=xv(n,r),i=[];break;default:typeof s.onClick!="function"&&typeof r.onClick=="function"&&(n.onclick=If)}bv(t,r);var o;t=null;for(c in s)if(!r.hasOwnProperty(c)&&s.hasOwnProperty(c)&&s[c]!=null)if(c==="style"){var a=s[c];for(o in a)a.hasOwnProperty(o)&&(t||(t={}),t[o]="")}else c!=="dangerouslySetInnerHTML"&&c!=="children"&&c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&c!=="autoFocus"&&(Pu.hasOwnProperty(c)?i||(i=[]):(i=i||[]).push(c,null));for(c in r){var l=r[c];if(a=s!=null?s[c]:void 0,r.hasOwnProperty(c)&&l!==a&&(l!=null||a!=null))if(c==="style")if(a){for(o in a)!a.hasOwnProperty(o)||l&&l.hasOwnProperty(o)||(t||(t={}),t[o]="");for(o in l)l.hasOwnProperty(o)&&a[o]!==l[o]&&(t||(t={}),t[o]=l[o])}else t||(i||(i=[]),i.push(c,t)),t=l;else c==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,a=a?a.__html:void 0,l!=null&&a!==l&&(i=i||[]).push(c,l)):c==="children"?typeof l!="string"&&typeof l!="number"||(i=i||[]).push(c,""+l):c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&(Pu.hasOwnProperty(c)?(l!=null&&c==="onScroll"&&bt("scroll",n),i||a===l||(i=[])):(i=i||[]).push(c,l))}t&&(i=i||[]).push("style",t);var c=i;(e.updateQueue=c)&&(e.flags|=4)}};zP=function(n,e,t,r){t!==r&&(e.flags|=4)};function Mc(n,e){if(!St)switch(n.tailMode){case"hidden":e=n.tail;for(var t=null;e!==null;)e.alternate!==null&&(t=e),e=e.sibling;t===null?n.tail=null:t.sibling=null;break;case"collapsed":t=n.tail;for(var r=null;t!==null;)t.alternate!==null&&(r=t),t=t.sibling;r===null?e||n.tail===null?n.tail=null:n.tail.sibling=null:r.sibling=null}}function bn(n){var e=n.alternate!==null&&n.alternate.child===n.child,t=0,r=0;if(e)for(var s=n.child;s!==null;)t|=s.lanes|s.childLanes,r|=s.subtreeFlags&14680064,r|=s.flags&14680064,s.return=n,s=s.sibling;else for(s=n.child;s!==null;)t|=s.lanes|s.childLanes,r|=s.subtreeFlags,r|=s.flags,s.return=n,s=s.sibling;return n.subtreeFlags|=r,n.childLanes=t,e}function ej(n,e,t){var r=e.pendingProps;switch(Hx(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return bn(e),null;case 1:return Xn(e.type)&&Rf(),bn(e),null;case 3:return r=e.stateNode,Wl(),_t(Yn),_t(kn),Zx(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(n===null||n.child===null)&&(th(e)?e.flags|=4:n===null||n.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,Hr!==null&&(ny(Hr),Hr=null))),Yv(n,e),bn(e),null;case 5:Qx(e);var s=Yo(Bu.current);if(t=e.type,n!==null&&e.stateNode!=null)$P(n,e,t,r,s),n.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!r){if(e.stateNode===null)throw Error(ce(166));return bn(e),null}if(n=Yo(gs.current),th(e)){r=e.stateNode,t=e.type;var i=e.memoizedProps;switch(r[us]=e,r[Mu]=i,n=(e.mode&1)!==0,t){case"dialog":bt("cancel",r),bt("close",r);break;case"iframe":case"object":case"embed":bt("load",r);break;case"video":case"audio":for(s=0;s<Qc.length;s++)bt(Qc[s],r);break;case"source":bt("error",r);break;case"img":case"image":case"link":bt("error",r),bt("load",r);break;case"details":bt("toggle",r);break;case"input":Ob(r,i),bt("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!i.multiple},bt("invalid",r);break;case"textarea":Rb(r,i),bt("invalid",r)}bv(t,i),s=null;for(var o in i)if(i.hasOwnProperty(o)){var a=i[o];o==="children"?typeof a=="string"?r.textContent!==a&&(i.suppressHydrationWarning!==!0&&eh(r.textContent,a,n),s=["children",a]):typeof a=="number"&&r.textContent!==""+a&&(i.suppressHydrationWarning!==!0&&eh(r.textContent,a,n),s=["children",""+a]):Pu.hasOwnProperty(o)&&a!=null&&o==="onScroll"&&bt("scroll",r)}switch(t){case"input":Gd(r),Ib(r,i,!0);break;case"textarea":Gd(r),Nb(r);break;case"select":case"option":break;default:typeof i.onClick=="function"&&(r.onclick=If)}r=s,e.updateQueue=r,r!==null&&(e.flags|=4)}else{o=s.nodeType===9?s:s.ownerDocument,n==="http://www.w3.org/1999/xhtml"&&(n=mk(t)),n==="http://www.w3.org/1999/xhtml"?t==="script"?(n=o.createElement("div"),n.innerHTML="<script><\/script>",n=n.removeChild(n.firstChild)):typeof r.is=="string"?n=o.createElement(t,{is:r.is}):(n=o.createElement(t),t==="select"&&(o=n,r.multiple?o.multiple=!0:r.size&&(o.size=r.size))):n=o.createElementNS(n,t),n[us]=e,n[Mu]=r,UP(n,e,!1,!1),e.stateNode=n;e:{switch(o=_v(t,r),t){case"dialog":bt("cancel",n),bt("close",n),s=r;break;case"iframe":case"object":case"embed":bt("load",n),s=r;break;case"video":case"audio":for(s=0;s<Qc.length;s++)bt(Qc[s],n);s=r;break;case"source":bt("error",n),s=r;break;case"img":case"image":case"link":bt("error",n),bt("load",n),s=r;break;case"details":bt("toggle",n),s=r;break;case"input":Ob(n,r),s=mv(n,r),bt("invalid",n);break;case"option":s=r;break;case"select":n._wrapperState={wasMultiple:!!r.multiple},s=Dt({},r,{value:void 0}),bt("invalid",n);break;case"textarea":Rb(n,r),s=xv(n,r),bt("invalid",n);break;default:s=r}bv(t,s),a=s;for(i in a)if(a.hasOwnProperty(i)){var l=a[i];i==="style"?xk(n,l):i==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,l!=null&&vk(n,l)):i==="children"?typeof l=="string"?(t!=="textarea"||l!=="")&&Tu(n,l):typeof l=="number"&&Tu(n,""+l):i!=="suppressContentEditableWarning"&&i!=="suppressHydrationWarning"&&i!=="autoFocus"&&(Pu.hasOwnProperty(i)?l!=null&&i==="onScroll"&&bt("scroll",n):l!=null&&Ax(n,i,l,o))}switch(t){case"input":Gd(n),Ib(n,r,!1);break;case"textarea":Gd(n),Nb(n);break;case"option":r.value!=null&&n.setAttribute("value",""+oo(r.value));break;case"select":n.multiple=!!r.multiple,i=r.value,i!=null?cl(n,!!r.multiple,i,!1):r.defaultValue!=null&&cl(n,!!r.multiple,r.defaultValue,!0);break;default:typeof s.onClick=="function"&&(n.onclick=If)}switch(t){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return bn(e),null;case 6:if(n&&e.stateNode!=null)zP(n,e,n.memoizedProps,r);else{if(typeof r!="string"&&e.stateNode===null)throw Error(ce(166));if(t=Yo(Bu.current),Yo(gs.current),th(e)){if(r=e.stateNode,t=e.memoizedProps,r[us]=e,(i=r.nodeValue!==t)&&(n=dr,n!==null))switch(n.tag){case 3:eh(r.nodeValue,t,(n.mode&1)!==0);break;case 5:n.memoizedProps.suppressHydrationWarning!==!0&&eh(r.nodeValue,t,(n.mode&1)!==0)}i&&(e.flags|=4)}else r=(t.nodeType===9?t:t.ownerDocument).createTextNode(r),r[us]=e,e.stateNode=r}return bn(e),null;case 13:if(_t(Pt),r=e.memoizedState,n===null||n.memoizedState!==null&&n.memoizedState.dehydrated!==null){if(St&&ur!==null&&e.mode&1&&!(e.flags&128))oP(),$l(),e.flags|=98560,i=!1;else if(i=th(e),r!==null&&r.dehydrated!==null){if(n===null){if(!i)throw Error(ce(318));if(i=e.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(ce(317));i[us]=e}else $l(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;bn(e),i=!1}else Hr!==null&&(ny(Hr),Hr=null),i=!0;if(!i)return e.flags&65536?e:null}return e.flags&128?(e.lanes=t,e):(r=r!==null,r!==(n!==null&&n.memoizedState!==null)&&r&&(e.child.flags|=8192,e.mode&1&&(n===null||Pt.current&1?Jt===0&&(Jt=3):dw())),e.updateQueue!==null&&(e.flags|=4),bn(e),null);case 4:return Wl(),Yv(n,e),n===null&&ju(e.stateNode.containerInfo),bn(e),null;case 10:return Yx(e.type._context),bn(e),null;case 17:return Xn(e.type)&&Rf(),bn(e),null;case 19:if(_t(Pt),i=e.memoizedState,i===null)return bn(e),null;if(r=(e.flags&128)!==0,o=i.rendering,o===null)if(r)Mc(i,!1);else{if(Jt!==0||n!==null&&n.flags&128)for(n=e.child;n!==null;){if(o=Uf(n),o!==null){for(e.flags|=128,Mc(i,!1),r=o.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),e.subtreeFlags=0,r=t,t=e.child;t!==null;)i=t,n=r,i.flags&=14680066,o=i.alternate,o===null?(i.childLanes=0,i.lanes=n,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=o.childLanes,i.lanes=o.lanes,i.child=o.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=o.memoizedProps,i.memoizedState=o.memoizedState,i.updateQueue=o.updateQueue,i.type=o.type,n=o.dependencies,i.dependencies=n===null?null:{lanes:n.lanes,firstContext:n.firstContext}),t=t.sibling;return vt(Pt,Pt.current&1|2),e.child}n=n.sibling}i.tail!==null&&Mt()>Vl&&(e.flags|=128,r=!0,Mc(i,!1),e.lanes=4194304)}else{if(!r)if(n=Uf(o),n!==null){if(e.flags|=128,r=!0,t=n.updateQueue,t!==null&&(e.updateQueue=t,e.flags|=4),Mc(i,!0),i.tail===null&&i.tailMode==="hidden"&&!o.alternate&&!St)return bn(e),null}else 2*Mt()-i.renderingStartTime>Vl&&t!==1073741824&&(e.flags|=128,r=!0,Mc(i,!1),e.lanes=4194304);i.isBackwards?(o.sibling=e.child,e.child=o):(t=i.last,t!==null?t.sibling=o:e.child=o,i.last=o)}return i.tail!==null?(e=i.tail,i.rendering=e,i.tail=e.sibling,i.renderingStartTime=Mt(),e.sibling=null,t=Pt.current,vt(Pt,r?t&1|2:t&1),e):(bn(e),null);case 22:case 23:return uw(),r=e.memoizedState!==null,n!==null&&n.memoizedState!==null!==r&&(e.flags|=8192),r&&e.mode&1?lr&1073741824&&(bn(e),e.subtreeFlags&6&&(e.flags|=8192)):bn(e),null;case 24:return null;case 25:return null}throw Error(ce(156,e.tag))}function tj(n,e){switch(Hx(e),e.tag){case 1:return Xn(e.type)&&Rf(),n=e.flags,n&65536?(e.flags=n&-65537|128,e):null;case 3:return Wl(),_t(Yn),_t(kn),Zx(),n=e.flags,n&65536&&!(n&128)?(e.flags=n&-65537|128,e):null;case 5:return Qx(e),null;case 13:if(_t(Pt),n=e.memoizedState,n!==null&&n.dehydrated!==null){if(e.alternate===null)throw Error(ce(340));$l()}return n=e.flags,n&65536?(e.flags=n&-65537|128,e):null;case 19:return _t(Pt),null;case 4:return Wl(),null;case 10:return Yx(e.type._context),null;case 22:case 23:return uw(),null;case 24:return null;default:return null}}var sh=!1,Cn=!1,nj=typeof WeakSet=="function"?WeakSet:Set,ye=null;function rl(n,e){var t=n.ref;if(t!==null)if(typeof t=="function")try{t(null)}catch(r){Nt(n,e,r)}else t.current=null}function Xv(n,e,t){try{t()}catch(r){Nt(n,e,r)}}var S_=!1;function rj(n,e){if(Iv=Af,n=qk(),zx(n)){if("selectionStart"in n)var t={start:n.selectionStart,end:n.selectionEnd};else e:{t=(t=n.ownerDocument)&&t.defaultView||window;var r=t.getSelection&&t.getSelection();if(r&&r.rangeCount!==0){t=r.anchorNode;var s=r.anchorOffset,i=r.focusNode;r=r.focusOffset;try{t.nodeType,i.nodeType}catch{t=null;break e}var o=0,a=-1,l=-1,c=0,u=0,h=n,d=null;t:for(;;){for(var p;h!==t||s!==0&&h.nodeType!==3||(a=o+s),h!==i||r!==0&&h.nodeType!==3||(l=o+r),h.nodeType===3&&(o+=h.nodeValue.length),(p=h.firstChild)!==null;)d=h,h=p;for(;;){if(h===n)break t;if(d===t&&++c===s&&(a=o),d===i&&++u===r&&(l=o),(p=h.nextSibling)!==null)break;h=d,d=h.parentNode}h=p}t=a===-1||l===-1?null:{start:a,end:l}}else t=null}t=t||{start:0,end:0}}else t=null;for(Rv={focusedElem:n,selectionRange:t},Af=!1,ye=e;ye!==null;)if(e=ye,n=e.child,(e.subtreeFlags&1028)!==0&&n!==null)n.return=e,ye=n;else for(;ye!==null;){e=ye;try{var m=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(m!==null){var g=m.memoizedProps,y=m.memoizedState,x=e.stateNode,v=x.getSnapshotBeforeUpdate(e.elementType===e.type?g:Mr(e.type,g),y);x.__reactInternalSnapshotBeforeUpdate=v}break;case 3:var w=e.stateNode.containerInfo;w.nodeType===1?w.textContent="":w.nodeType===9&&w.documentElement&&w.removeChild(w.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(ce(163))}}catch(_){Nt(e,e.return,_)}if(n=e.sibling,n!==null){n.return=e.return,ye=n;break}ye=e.return}return m=S_,S_=!1,m}function du(n,e,t){var r=e.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var s=r=r.next;do{if((s.tag&n)===n){var i=s.destroy;s.destroy=void 0,i!==void 0&&Xv(e,t,i)}s=s.next}while(s!==r)}}function Bp(n,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var t=e=e.next;do{if((t.tag&n)===n){var r=t.create;t.destroy=r()}t=t.next}while(t!==e)}}function Kv(n){var e=n.ref;if(e!==null){var t=n.stateNode;switch(n.tag){case 5:n=t;break;default:n=t}typeof e=="function"?e(n):e.current=n}}function WP(n){var e=n.alternate;e!==null&&(n.alternate=null,WP(e)),n.child=null,n.deletions=null,n.sibling=null,n.tag===5&&(e=n.stateNode,e!==null&&(delete e[us],delete e[Mu],delete e[Lv],delete e[BN],delete e[UN])),n.stateNode=null,n.return=null,n.dependencies=null,n.memoizedProps=null,n.memoizedState=null,n.pendingProps=null,n.stateNode=null,n.updateQueue=null}function HP(n){return n.tag===5||n.tag===3||n.tag===4}function C_(n){e:for(;;){for(;n.sibling===null;){if(n.return===null||HP(n.return))return null;n=n.return}for(n.sibling.return=n.return,n=n.sibling;n.tag!==5&&n.tag!==6&&n.tag!==18;){if(n.flags&2||n.child===null||n.tag===4)continue e;n.child.return=n,n=n.child}if(!(n.flags&2))return n.stateNode}}function Jv(n,e,t){var r=n.tag;if(r===5||r===6)n=n.stateNode,e?t.nodeType===8?t.parentNode.insertBefore(n,e):t.insertBefore(n,e):(t.nodeType===8?(e=t.parentNode,e.insertBefore(n,t)):(e=t,e.appendChild(n)),t=t._reactRootContainer,t!=null||e.onclick!==null||(e.onclick=If));else if(r!==4&&(n=n.child,n!==null))for(Jv(n,e,t),n=n.sibling;n!==null;)Jv(n,e,t),n=n.sibling}function Qv(n,e,t){var r=n.tag;if(r===5||r===6)n=n.stateNode,e?t.insertBefore(n,e):t.appendChild(n);else if(r!==4&&(n=n.child,n!==null))for(Qv(n,e,t),n=n.sibling;n!==null;)Qv(n,e,t),n=n.sibling}var fn=null,Ur=!1;function vi(n,e,t){for(t=t.child;t!==null;)VP(n,e,t),t=t.sibling}function VP(n,e,t){if(ps&&typeof ps.onCommitFiberUnmount=="function")try{ps.onCommitFiberUnmount(Op,t)}catch{}switch(t.tag){case 5:Cn||rl(t,e);case 6:var r=fn,s=Ur;fn=null,vi(n,e,t),fn=r,Ur=s,fn!==null&&(Ur?(n=fn,t=t.stateNode,n.nodeType===8?n.parentNode.removeChild(t):n.removeChild(t)):fn.removeChild(t.stateNode));break;case 18:fn!==null&&(Ur?(n=fn,t=t.stateNode,n.nodeType===8?ug(n.parentNode,t):n.nodeType===1&&ug(n,t),Iu(n)):ug(fn,t.stateNode));break;case 4:r=fn,s=Ur,fn=t.stateNode.containerInfo,Ur=!0,vi(n,e,t),fn=r,Ur=s;break;case 0:case 11:case 14:case 15:if(!Cn&&(r=t.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){s=r=r.next;do{var i=s,o=i.destroy;i=i.tag,o!==void 0&&(i&2||i&4)&&Xv(t,e,o),s=s.next}while(s!==r)}vi(n,e,t);break;case 1:if(!Cn&&(rl(t,e),r=t.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=t.memoizedProps,r.state=t.memoizedState,r.componentWillUnmount()}catch(a){Nt(t,e,a)}vi(n,e,t);break;case 21:vi(n,e,t);break;case 22:t.mode&1?(Cn=(r=Cn)||t.memoizedState!==null,vi(n,e,t),Cn=r):vi(n,e,t);break;default:vi(n,e,t)}}function E_(n){var e=n.updateQueue;if(e!==null){n.updateQueue=null;var t=n.stateNode;t===null&&(t=n.stateNode=new nj),e.forEach(function(r){var s=hj.bind(null,n,r);t.has(r)||(t.add(r),r.then(s,s))})}}function Ir(n,e){var t=e.deletions;if(t!==null)for(var r=0;r<t.length;r++){var s=t[r];try{var i=n,o=e,a=o;e:for(;a!==null;){switch(a.tag){case 5:fn=a.stateNode,Ur=!1;break e;case 3:fn=a.stateNode.containerInfo,Ur=!0;break e;case 4:fn=a.stateNode.containerInfo,Ur=!0;break e}a=a.return}if(fn===null)throw Error(ce(160));VP(i,o,s),fn=null,Ur=!1;var l=s.alternate;l!==null&&(l.return=null),s.return=null}catch(c){Nt(s,e,c)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)GP(e,n),e=e.sibling}function GP(n,e){var t=n.alternate,r=n.flags;switch(n.tag){case 0:case 11:case 14:case 15:if(Ir(e,n),is(n),r&4){try{du(3,n,n.return),Bp(3,n)}catch(g){Nt(n,n.return,g)}try{du(5,n,n.return)}catch(g){Nt(n,n.return,g)}}break;case 1:Ir(e,n),is(n),r&512&&t!==null&&rl(t,t.return);break;case 5:if(Ir(e,n),is(n),r&512&&t!==null&&rl(t,t.return),n.flags&32){var s=n.stateNode;try{Tu(s,"")}catch(g){Nt(n,n.return,g)}}if(r&4&&(s=n.stateNode,s!=null)){var i=n.memoizedProps,o=t!==null?t.memoizedProps:i,a=n.type,l=n.updateQueue;if(n.updateQueue=null,l!==null)try{a==="input"&&i.type==="radio"&&i.name!=null&&pk(s,i),_v(a,o);var c=_v(a,i);for(o=0;o<l.length;o+=2){var u=l[o],h=l[o+1];u==="style"?xk(s,h):u==="dangerouslySetInnerHTML"?vk(s,h):u==="children"?Tu(s,h):Ax(s,u,h,c)}switch(a){case"input":vv(s,i);break;case"textarea":gk(s,i);break;case"select":var d=s._wrapperState.wasMultiple;s._wrapperState.wasMultiple=!!i.multiple;var p=i.value;p!=null?cl(s,!!i.multiple,p,!1):d!==!!i.multiple&&(i.defaultValue!=null?cl(s,!!i.multiple,i.defaultValue,!0):cl(s,!!i.multiple,i.multiple?[]:"",!1))}s[Mu]=i}catch(g){Nt(n,n.return,g)}}break;case 6:if(Ir(e,n),is(n),r&4){if(n.stateNode===null)throw Error(ce(162));s=n.stateNode,i=n.memoizedProps;try{s.nodeValue=i}catch(g){Nt(n,n.return,g)}}break;case 3:if(Ir(e,n),is(n),r&4&&t!==null&&t.memoizedState.isDehydrated)try{Iu(e.containerInfo)}catch(g){Nt(n,n.return,g)}break;case 4:Ir(e,n),is(n);break;case 13:Ir(e,n),is(n),s=n.child,s.flags&8192&&(i=s.memoizedState!==null,s.stateNode.isHidden=i,!i||s.alternate!==null&&s.alternate.memoizedState!==null||(lw=Mt())),r&4&&E_(n);break;case 22:if(u=t!==null&&t.memoizedState!==null,n.mode&1?(Cn=(c=Cn)||u,Ir(e,n),Cn=c):Ir(e,n),is(n),r&8192){if(c=n.memoizedState!==null,(n.stateNode.isHidden=c)&&!u&&n.mode&1)for(ye=n,u=n.child;u!==null;){for(h=ye=u;ye!==null;){switch(d=ye,p=d.child,d.tag){case 0:case 11:case 14:case 15:du(4,d,d.return);break;case 1:rl(d,d.return);var m=d.stateNode;if(typeof m.componentWillUnmount=="function"){r=d,t=d.return;try{e=r,m.props=e.memoizedProps,m.state=e.memoizedState,m.componentWillUnmount()}catch(g){Nt(r,t,g)}}break;case 5:rl(d,d.return);break;case 22:if(d.memoizedState!==null){P_(h);continue}}p!==null?(p.return=d,ye=p):P_(h)}u=u.sibling}e:for(u=null,h=n;;){if(h.tag===5){if(u===null){u=h;try{s=h.stateNode,c?(i=s.style,typeof i.setProperty=="function"?i.setProperty("display","none","important"):i.display="none"):(a=h.stateNode,l=h.memoizedProps.style,o=l!=null&&l.hasOwnProperty("display")?l.display:null,a.style.display=yk("display",o))}catch(g){Nt(n,n.return,g)}}}else if(h.tag===6){if(u===null)try{h.stateNode.nodeValue=c?"":h.memoizedProps}catch(g){Nt(n,n.return,g)}}else if((h.tag!==22&&h.tag!==23||h.memoizedState===null||h===n)&&h.child!==null){h.child.return=h,h=h.child;continue}if(h===n)break e;for(;h.sibling===null;){if(h.return===null||h.return===n)break e;u===h&&(u=null),h=h.return}u===h&&(u=null),h.sibling.return=h.return,h=h.sibling}}break;case 19:Ir(e,n),is(n),r&4&&E_(n);break;case 21:break;default:Ir(e,n),is(n)}}function is(n){var e=n.flags;if(e&2){try{e:{for(var t=n.return;t!==null;){if(HP(t)){var r=t;break e}t=t.return}throw Error(ce(160))}switch(r.tag){case 5:var s=r.stateNode;r.flags&32&&(Tu(s,""),r.flags&=-33);var i=C_(n);Qv(n,i,s);break;case 3:case 4:var o=r.stateNode.containerInfo,a=C_(n);Jv(n,a,o);break;default:throw Error(ce(161))}}catch(l){Nt(n,n.return,l)}n.flags&=-3}e&4096&&(n.flags&=-4097)}function sj(n,e,t){ye=n,qP(n)}function qP(n,e,t){for(var r=(n.mode&1)!==0;ye!==null;){var s=ye,i=s.child;if(s.tag===22&&r){var o=s.memoizedState!==null||sh;if(!o){var a=s.alternate,l=a!==null&&a.memoizedState!==null||Cn;a=sh;var c=Cn;if(sh=o,(Cn=l)&&!c)for(ye=s;ye!==null;)o=ye,l=o.child,o.tag===22&&o.memoizedState!==null?T_(s):l!==null?(l.return=o,ye=l):T_(s);for(;i!==null;)ye=i,qP(i),i=i.sibling;ye=s,sh=a,Cn=c}k_(n)}else s.subtreeFlags&8772&&i!==null?(i.return=s,ye=i):k_(n)}}function k_(n){for(;ye!==null;){var e=ye;if(e.flags&8772){var t=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:Cn||Bp(5,e);break;case 1:var r=e.stateNode;if(e.flags&4&&!Cn)if(t===null)r.componentDidMount();else{var s=e.elementType===e.type?t.memoizedProps:Mr(e.type,t.memoizedProps);r.componentDidUpdate(s,t.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var i=e.updateQueue;i!==null&&u_(e,i,r);break;case 3:var o=e.updateQueue;if(o!==null){if(t=null,e.child!==null)switch(e.child.tag){case 5:t=e.child.stateNode;break;case 1:t=e.child.stateNode}u_(e,o,t)}break;case 5:var a=e.stateNode;if(t===null&&e.flags&4){t=a;var l=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&t.focus();break;case"img":l.src&&(t.src=l.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var c=e.alternate;if(c!==null){var u=c.memoizedState;if(u!==null){var h=u.dehydrated;h!==null&&Iu(h)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(ce(163))}Cn||e.flags&512&&Kv(e)}catch(d){Nt(e,e.return,d)}}if(e===n){ye=null;break}if(t=e.sibling,t!==null){t.return=e.return,ye=t;break}ye=e.return}}function P_(n){for(;ye!==null;){var e=ye;if(e===n){ye=null;break}var t=e.sibling;if(t!==null){t.return=e.return,ye=t;break}ye=e.return}}function T_(n){for(;ye!==null;){var e=ye;try{switch(e.tag){case 0:case 11:case 15:var t=e.return;try{Bp(4,e)}catch(l){Nt(e,t,l)}break;case 1:var r=e.stateNode;if(typeof r.componentDidMount=="function"){var s=e.return;try{r.componentDidMount()}catch(l){Nt(e,s,l)}}var i=e.return;try{Kv(e)}catch(l){Nt(e,i,l)}break;case 5:var o=e.return;try{Kv(e)}catch(l){Nt(e,o,l)}}}catch(l){Nt(e,e.return,l)}if(e===n){ye=null;break}var a=e.sibling;if(a!==null){a.return=e.return,ye=a;break}ye=e.return}}var ij=Math.ceil,Wf=ui.ReactCurrentDispatcher,ow=ui.ReactCurrentOwner,Er=ui.ReactCurrentBatchConfig,rt=0,cn=null,Wt=null,gn=0,lr=0,sl=vo(0),Jt=0,Wu=null,la=0,Up=0,aw=0,hu=null,Vn=null,lw=0,Vl=1/0,Ds=null,Hf=!1,Zv=null,Zi=null,ih=!1,Vi=null,Vf=0,fu=0,ey=null,sf=-1,of=0;function jn(){return rt&6?Mt():sf!==-1?sf:sf=Mt()}function eo(n){return n.mode&1?rt&2&&gn!==0?gn&-gn:zN.transition!==null?(of===0&&(of=Ok()),of):(n=ft,n!==0||(n=window.event,n=n===void 0?16:Fk(n.type)),n):1}function Qr(n,e,t,r){if(50<fu)throw fu=0,ey=null,Error(ce(185));pd(n,t,r),(!(rt&2)||n!==cn)&&(n===cn&&(!(rt&2)&&(Up|=t),Jt===4&&Ri(n,gn)),Kn(n,r),t===1&&rt===0&&!(e.mode&1)&&(Vl=Mt()+500,Lp&&yo()))}function Kn(n,e){var t=n.callbackNode;z5(n,e);var r=Tf(n,n===cn?gn:0);if(r===0)t!==null&&Mb(t),n.callbackNode=null,n.callbackPriority=0;else if(e=r&-r,n.callbackPriority!==e){if(t!=null&&Mb(t),e===1)n.tag===0?$N(A_.bind(null,n)):rP(A_.bind(null,n)),MN(function(){!(rt&6)&&yo()}),t=null;else{switch(Ik(r)){case 1:t=Nx;break;case 4:t=Ak;break;case 16:t=Pf;break;case 536870912:t=Dk;break;default:t=Pf}t=tT(t,YP.bind(null,n))}n.callbackPriority=e,n.callbackNode=t}}function YP(n,e){if(sf=-1,of=0,rt&6)throw Error(ce(327));var t=n.callbackNode;if(pl()&&n.callbackNode!==t)return null;var r=Tf(n,n===cn?gn:0);if(r===0)return null;if(r&30||r&n.expiredLanes||e)e=Gf(n,r);else{e=r;var s=rt;rt|=2;var i=KP();(cn!==n||gn!==e)&&(Ds=null,Vl=Mt()+500,na(n,e));do try{lj();break}catch(a){XP(n,a)}while(!0);qx(),Wf.current=i,rt=s,Wt!==null?e=0:(cn=null,gn=0,e=Jt)}if(e!==0){if(e===2&&(s=Pv(n),s!==0&&(r=s,e=ty(n,s))),e===1)throw t=Wu,na(n,0),Ri(n,r),Kn(n,Mt()),t;if(e===6)Ri(n,r);else{if(s=n.current.alternate,!(r&30)&&!oj(s)&&(e=Gf(n,r),e===2&&(i=Pv(n),i!==0&&(r=i,e=ty(n,i))),e===1))throw t=Wu,na(n,0),Ri(n,r),Kn(n,Mt()),t;switch(n.finishedWork=s,n.finishedLanes=r,e){case 0:case 1:throw Error(ce(345));case 2:Mo(n,Vn,Ds);break;case 3:if(Ri(n,r),(r&130023424)===r&&(e=lw+500-Mt(),10<e)){if(Tf(n,0)!==0)break;if(s=n.suspendedLanes,(s&r)!==r){jn(),n.pingedLanes|=n.suspendedLanes&s;break}n.timeoutHandle=jv(Mo.bind(null,n,Vn,Ds),e);break}Mo(n,Vn,Ds);break;case 4:if(Ri(n,r),(r&4194240)===r)break;for(e=n.eventTimes,s=-1;0<r;){var o=31-Jr(r);i=1<<o,o=e[o],o>s&&(s=o),r&=~i}if(r=s,r=Mt()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*ij(r/1960))-r,10<r){n.timeoutHandle=jv(Mo.bind(null,n,Vn,Ds),r);break}Mo(n,Vn,Ds);break;case 5:Mo(n,Vn,Ds);break;default:throw Error(ce(329))}}}return Kn(n,Mt()),n.callbackNode===t?YP.bind(null,n):null}function ty(n,e){var t=hu;return n.current.memoizedState.isDehydrated&&(na(n,e).flags|=256),n=Gf(n,e),n!==2&&(e=Vn,Vn=t,e!==null&&ny(e)),n}function ny(n){Vn===null?Vn=n:Vn.push.apply(Vn,n)}function oj(n){for(var e=n;;){if(e.flags&16384){var t=e.updateQueue;if(t!==null&&(t=t.stores,t!==null))for(var r=0;r<t.length;r++){var s=t[r],i=s.getSnapshot;s=s.value;try{if(!es(i(),s))return!1}catch{return!1}}}if(t=e.child,e.subtreeFlags&16384&&t!==null)t.return=e,e=t;else{if(e===n)break;for(;e.sibling===null;){if(e.return===null||e.return===n)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function Ri(n,e){for(e&=~aw,e&=~Up,n.suspendedLanes|=e,n.pingedLanes&=~e,n=n.expirationTimes;0<e;){var t=31-Jr(e),r=1<<t;n[t]=-1,e&=~r}}function A_(n){if(rt&6)throw Error(ce(327));pl();var e=Tf(n,0);if(!(e&1))return Kn(n,Mt()),null;var t=Gf(n,e);if(n.tag!==0&&t===2){var r=Pv(n);r!==0&&(e=r,t=ty(n,r))}if(t===1)throw t=Wu,na(n,0),Ri(n,e),Kn(n,Mt()),t;if(t===6)throw Error(ce(345));return n.finishedWork=n.current.alternate,n.finishedLanes=e,Mo(n,Vn,Ds),Kn(n,Mt()),null}function cw(n,e){var t=rt;rt|=1;try{return n(e)}finally{rt=t,rt===0&&(Vl=Mt()+500,Lp&&yo())}}function ca(n){Vi!==null&&Vi.tag===0&&!(rt&6)&&pl();var e=rt;rt|=1;var t=Er.transition,r=ft;try{if(Er.transition=null,ft=1,n)return n()}finally{ft=r,Er.transition=t,rt=e,!(rt&6)&&yo()}}function uw(){lr=sl.current,_t(sl)}function na(n,e){n.finishedWork=null,n.finishedLanes=0;var t=n.timeoutHandle;if(t!==-1&&(n.timeoutHandle=-1,LN(t)),Wt!==null)for(t=Wt.return;t!==null;){var r=t;switch(Hx(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&Rf();break;case 3:Wl(),_t(Yn),_t(kn),Zx();break;case 5:Qx(r);break;case 4:Wl();break;case 13:_t(Pt);break;case 19:_t(Pt);break;case 10:Yx(r.type._context);break;case 22:case 23:uw()}t=t.return}if(cn=n,Wt=n=to(n.current,null),gn=lr=e,Jt=0,Wu=null,aw=Up=la=0,Vn=hu=null,qo!==null){for(e=0;e<qo.length;e++)if(t=qo[e],r=t.interleaved,r!==null){t.interleaved=null;var s=r.next,i=t.pending;if(i!==null){var o=i.next;i.next=s,r.next=o}t.pending=r}qo=null}return n}function XP(n,e){do{var t=Wt;try{if(qx(),tf.current=zf,$f){for(var r=At.memoizedState;r!==null;){var s=r.queue;s!==null&&(s.pending=null),r=r.next}$f=!1}if(aa=0,an=Kt=At=null,uu=!1,Uu=0,ow.current=null,t===null||t.return===null){Jt=1,Wu=e,Wt=null;break}e:{var i=n,o=t.return,a=t,l=e;if(e=gn,a.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){var c=l,u=a,h=u.tag;if(!(u.mode&1)&&(h===0||h===11||h===15)){var d=u.alternate;d?(u.updateQueue=d.updateQueue,u.memoizedState=d.memoizedState,u.lanes=d.lanes):(u.updateQueue=null,u.memoizedState=null)}var p=m_(o);if(p!==null){p.flags&=-257,v_(p,o,a,i,e),p.mode&1&&g_(i,c,e),e=p,l=c;var m=e.updateQueue;if(m===null){var g=new Set;g.add(l),e.updateQueue=g}else m.add(l);break e}else{if(!(e&1)){g_(i,c,e),dw();break e}l=Error(ce(426))}}else if(St&&a.mode&1){var y=m_(o);if(y!==null){!(y.flags&65536)&&(y.flags|=256),v_(y,o,a,i,e),Vx(Hl(l,a));break e}}i=l=Hl(l,a),Jt!==4&&(Jt=2),hu===null?hu=[i]:hu.push(i),i=o;do{switch(i.tag){case 3:i.flags|=65536,e&=-e,i.lanes|=e;var x=IP(i,l,e);c_(i,x);break e;case 1:a=l;var v=i.type,w=i.stateNode;if(!(i.flags&128)&&(typeof v.getDerivedStateFromError=="function"||w!==null&&typeof w.componentDidCatch=="function"&&(Zi===null||!Zi.has(w)))){i.flags|=65536,e&=-e,i.lanes|=e;var _=RP(i,a,e);c_(i,_);break e}}i=i.return}while(i!==null)}QP(t)}catch(S){e=S,Wt===t&&t!==null&&(Wt=t=t.return);continue}break}while(!0)}function KP(){var n=Wf.current;return Wf.current=zf,n===null?zf:n}function dw(){(Jt===0||Jt===3||Jt===2)&&(Jt=4),cn===null||!(la&268435455)&&!(Up&268435455)||Ri(cn,gn)}function Gf(n,e){var t=rt;rt|=2;var r=KP();(cn!==n||gn!==e)&&(Ds=null,na(n,e));do try{aj();break}catch(s){XP(n,s)}while(!0);if(qx(),rt=t,Wf.current=r,Wt!==null)throw Error(ce(261));return cn=null,gn=0,Jt}function aj(){for(;Wt!==null;)JP(Wt)}function lj(){for(;Wt!==null&&!R5();)JP(Wt)}function JP(n){var e=eT(n.alternate,n,lr);n.memoizedProps=n.pendingProps,e===null?QP(n):Wt=e,ow.current=null}function QP(n){var e=n;do{var t=e.alternate;if(n=e.return,e.flags&32768){if(t=tj(t,e),t!==null){t.flags&=32767,Wt=t;return}if(n!==null)n.flags|=32768,n.subtreeFlags=0,n.deletions=null;else{Jt=6,Wt=null;return}}else if(t=ej(t,e,lr),t!==null){Wt=t;return}if(e=e.sibling,e!==null){Wt=e;return}Wt=e=n}while(e!==null);Jt===0&&(Jt=5)}function Mo(n,e,t){var r=ft,s=Er.transition;try{Er.transition=null,ft=1,cj(n,e,t,r)}finally{Er.transition=s,ft=r}return null}function cj(n,e,t,r){do pl();while(Vi!==null);if(rt&6)throw Error(ce(327));t=n.finishedWork;var s=n.finishedLanes;if(t===null)return null;if(n.finishedWork=null,n.finishedLanes=0,t===n.current)throw Error(ce(177));n.callbackNode=null,n.callbackPriority=0;var i=t.lanes|t.childLanes;if(W5(n,i),n===cn&&(Wt=cn=null,gn=0),!(t.subtreeFlags&2064)&&!(t.flags&2064)||ih||(ih=!0,tT(Pf,function(){return pl(),null})),i=(t.flags&15990)!==0,t.subtreeFlags&15990||i){i=Er.transition,Er.transition=null;var o=ft;ft=1;var a=rt;rt|=4,ow.current=null,rj(n,t),GP(t,n),AN(Rv),Af=!!Iv,Rv=Iv=null,n.current=t,sj(t),N5(),rt=a,ft=o,Er.transition=i}else n.current=t;if(ih&&(ih=!1,Vi=n,Vf=s),i=n.pendingLanes,i===0&&(Zi=null),M5(t.stateNode),Kn(n,Mt()),e!==null)for(r=n.onRecoverableError,t=0;t<e.length;t++)s=e[t],r(s.value,{componentStack:s.stack,digest:s.digest});if(Hf)throw Hf=!1,n=Zv,Zv=null,n;return Vf&1&&n.tag!==0&&pl(),i=n.pendingLanes,i&1?n===ey?fu++:(fu=0,ey=n):fu=0,yo(),null}function pl(){if(Vi!==null){var n=Ik(Vf),e=Er.transition,t=ft;try{if(Er.transition=null,ft=16>n?16:n,Vi===null)var r=!1;else{if(n=Vi,Vi=null,Vf=0,rt&6)throw Error(ce(331));var s=rt;for(rt|=4,ye=n.current;ye!==null;){var i=ye,o=i.child;if(ye.flags&16){var a=i.deletions;if(a!==null){for(var l=0;l<a.length;l++){var c=a[l];for(ye=c;ye!==null;){var u=ye;switch(u.tag){case 0:case 11:case 15:du(8,u,i)}var h=u.child;if(h!==null)h.return=u,ye=h;else for(;ye!==null;){u=ye;var d=u.sibling,p=u.return;if(WP(u),u===c){ye=null;break}if(d!==null){d.return=p,ye=d;break}ye=p}}}var m=i.alternate;if(m!==null){var g=m.child;if(g!==null){m.child=null;do{var y=g.sibling;g.sibling=null,g=y}while(g!==null)}}ye=i}}if(i.subtreeFlags&2064&&o!==null)o.return=i,ye=o;else e:for(;ye!==null;){if(i=ye,i.flags&2048)switch(i.tag){case 0:case 11:case 15:du(9,i,i.return)}var x=i.sibling;if(x!==null){x.return=i.return,ye=x;break e}ye=i.return}}var v=n.current;for(ye=v;ye!==null;){o=ye;var w=o.child;if(o.subtreeFlags&2064&&w!==null)w.return=o,ye=w;else e:for(o=v;ye!==null;){if(a=ye,a.flags&2048)try{switch(a.tag){case 0:case 11:case 15:Bp(9,a)}}catch(S){Nt(a,a.return,S)}if(a===o){ye=null;break e}var _=a.sibling;if(_!==null){_.return=a.return,ye=_;break e}ye=a.return}}if(rt=s,yo(),ps&&typeof ps.onPostCommitFiberRoot=="function")try{ps.onPostCommitFiberRoot(Op,n)}catch{}r=!0}return r}finally{ft=t,Er.transition=e}}return!1}function D_(n,e,t){e=Hl(t,e),e=IP(n,e,1),n=Qi(n,e,1),e=jn(),n!==null&&(pd(n,1,e),Kn(n,e))}function Nt(n,e,t){if(n.tag===3)D_(n,n,t);else for(;e!==null;){if(e.tag===3){D_(e,n,t);break}else if(e.tag===1){var r=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(Zi===null||!Zi.has(r))){n=Hl(t,n),n=RP(e,n,1),e=Qi(e,n,1),n=jn(),e!==null&&(pd(e,1,n),Kn(e,n));break}}e=e.return}}function uj(n,e,t){var r=n.pingCache;r!==null&&r.delete(e),e=jn(),n.pingedLanes|=n.suspendedLanes&t,cn===n&&(gn&t)===t&&(Jt===4||Jt===3&&(gn&130023424)===gn&&500>Mt()-lw?na(n,0):aw|=t),Kn(n,e)}function ZP(n,e){e===0&&(n.mode&1?(e=Xd,Xd<<=1,!(Xd&130023424)&&(Xd=4194304)):e=1);var t=jn();n=Zs(n,e),n!==null&&(pd(n,e,t),Kn(n,t))}function dj(n){var e=n.memoizedState,t=0;e!==null&&(t=e.retryLane),ZP(n,t)}function hj(n,e){var t=0;switch(n.tag){case 13:var r=n.stateNode,s=n.memoizedState;s!==null&&(t=s.retryLane);break;case 19:r=n.stateNode;break;default:throw Error(ce(314))}r!==null&&r.delete(e),ZP(n,t)}var eT;eT=function(n,e,t){if(n!==null)if(n.memoizedProps!==e.pendingProps||Yn.current)qn=!0;else{if(!(n.lanes&t)&&!(e.flags&128))return qn=!1,ZN(n,e,t);qn=!!(n.flags&131072)}else qn=!1,St&&e.flags&1048576&&sP(e,Lf,e.index);switch(e.lanes=0,e.tag){case 2:var r=e.type;rf(n,e),n=e.pendingProps;var s=Ul(e,kn.current);fl(e,t),s=tw(null,e,r,n,s,t);var i=nw();return e.flags|=1,typeof s=="object"&&s!==null&&typeof s.render=="function"&&s.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,Xn(r)?(i=!0,Nf(e)):i=!1,e.memoizedState=s.state!==null&&s.state!==void 0?s.state:null,Kx(e),s.updater=Fp,e.stateNode=s,s._reactInternals=e,zv(e,r,n,t),e=Vv(null,e,r,!0,i,t)):(e.tag=0,St&&i&&Wx(e),On(null,e,s,t),e=e.child),e;case 16:r=e.elementType;e:{switch(rf(n,e),n=e.pendingProps,s=r._init,r=s(r._payload),e.type=r,s=e.tag=pj(r),n=Mr(r,n),s){case 0:e=Hv(null,e,r,n,t);break e;case 1:e=w_(null,e,r,n,t);break e;case 11:e=y_(null,e,r,n,t);break e;case 14:e=x_(null,e,r,Mr(r.type,n),t);break e}throw Error(ce(306,r,""))}return e;case 0:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:Mr(r,s),Hv(n,e,r,s,t);case 1:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:Mr(r,s),w_(n,e,r,s,t);case 3:e:{if(MP(e),n===null)throw Error(ce(387));r=e.pendingProps,i=e.memoizedState,s=i.element,uP(n,e),Bf(e,r,null,t);var o=e.memoizedState;if(r=o.element,i.isDehydrated)if(i={element:r,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},e.updateQueue.baseState=i,e.memoizedState=i,e.flags&256){s=Hl(Error(ce(423)),e),e=b_(n,e,r,t,s);break e}else if(r!==s){s=Hl(Error(ce(424)),e),e=b_(n,e,r,t,s);break e}else for(ur=Ji(e.stateNode.containerInfo.firstChild),dr=e,St=!0,Hr=null,t=lP(e,null,r,t),e.child=t;t;)t.flags=t.flags&-3|4096,t=t.sibling;else{if($l(),r===s){e=ei(n,e,t);break e}On(n,e,r,t)}e=e.child}return e;case 5:return dP(e),n===null&&Bv(e),r=e.type,s=e.pendingProps,i=n!==null?n.memoizedProps:null,o=s.children,Nv(r,s)?o=null:i!==null&&Nv(r,i)&&(e.flags|=32),LP(n,e),On(n,e,o,t),e.child;case 6:return n===null&&Bv(e),null;case 13:return FP(n,e,t);case 4:return Jx(e,e.stateNode.containerInfo),r=e.pendingProps,n===null?e.child=zl(e,null,r,t):On(n,e,r,t),e.child;case 11:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:Mr(r,s),y_(n,e,r,s,t);case 7:return On(n,e,e.pendingProps,t),e.child;case 8:return On(n,e,e.pendingProps.children,t),e.child;case 12:return On(n,e,e.pendingProps.children,t),e.child;case 10:e:{if(r=e.type._context,s=e.pendingProps,i=e.memoizedProps,o=s.value,vt(Mf,r._currentValue),r._currentValue=o,i!==null)if(es(i.value,o)){if(i.children===s.children&&!Yn.current){e=ei(n,e,t);break e}}else for(i=e.child,i!==null&&(i.return=e);i!==null;){var a=i.dependencies;if(a!==null){o=i.child;for(var l=a.firstContext;l!==null;){if(l.context===r){if(i.tag===1){l=Ws(-1,t&-t),l.tag=2;var c=i.updateQueue;if(c!==null){c=c.shared;var u=c.pending;u===null?l.next=l:(l.next=u.next,u.next=l),c.pending=l}}i.lanes|=t,l=i.alternate,l!==null&&(l.lanes|=t),Uv(i.return,t,e),a.lanes|=t;break}l=l.next}}else if(i.tag===10)o=i.type===e.type?null:i.child;else if(i.tag===18){if(o=i.return,o===null)throw Error(ce(341));o.lanes|=t,a=o.alternate,a!==null&&(a.lanes|=t),Uv(o,t,e),o=i.sibling}else o=i.child;if(o!==null)o.return=i;else for(o=i;o!==null;){if(o===e){o=null;break}if(i=o.sibling,i!==null){i.return=o.return,o=i;break}o=o.return}i=o}On(n,e,s.children,t),e=e.child}return e;case 9:return s=e.type,r=e.pendingProps.children,fl(e,t),s=Pr(s),r=r(s),e.flags|=1,On(n,e,r,t),e.child;case 14:return r=e.type,s=Mr(r,e.pendingProps),s=Mr(r.type,s),x_(n,e,r,s,t);case 15:return NP(n,e,e.type,e.pendingProps,t);case 17:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:Mr(r,s),rf(n,e),e.tag=1,Xn(r)?(n=!0,Nf(e)):n=!1,fl(e,t),OP(e,r,s),zv(e,r,s,t),Vv(null,e,r,!0,n,t);case 19:return BP(n,e,t);case 22:return jP(n,e,t)}throw Error(ce(156,e.tag))};function tT(n,e){return Tk(n,e)}function fj(n,e,t,r){this.tag=n,this.key=t,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Cr(n,e,t,r){return new fj(n,e,t,r)}function hw(n){return n=n.prototype,!(!n||!n.isReactComponent)}function pj(n){if(typeof n=="function")return hw(n)?1:0;if(n!=null){if(n=n.$$typeof,n===Ox)return 11;if(n===Ix)return 14}return 2}function to(n,e){var t=n.alternate;return t===null?(t=Cr(n.tag,e,n.key,n.mode),t.elementType=n.elementType,t.type=n.type,t.stateNode=n.stateNode,t.alternate=n,n.alternate=t):(t.pendingProps=e,t.type=n.type,t.flags=0,t.subtreeFlags=0,t.deletions=null),t.flags=n.flags&14680064,t.childLanes=n.childLanes,t.lanes=n.lanes,t.child=n.child,t.memoizedProps=n.memoizedProps,t.memoizedState=n.memoizedState,t.updateQueue=n.updateQueue,e=n.dependencies,t.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},t.sibling=n.sibling,t.index=n.index,t.ref=n.ref,t}function af(n,e,t,r,s,i){var o=2;if(r=n,typeof n=="function")hw(n)&&(o=1);else if(typeof n=="string")o=5;else e:switch(n){case Ya:return ra(t.children,s,i,e);case Dx:o=8,s|=8;break;case hv:return n=Cr(12,t,e,s|2),n.elementType=hv,n.lanes=i,n;case fv:return n=Cr(13,t,e,s),n.elementType=fv,n.lanes=i,n;case pv:return n=Cr(19,t,e,s),n.elementType=pv,n.lanes=i,n;case dk:return $p(t,s,i,e);default:if(typeof n=="object"&&n!==null)switch(n.$$typeof){case ck:o=10;break e;case uk:o=9;break e;case Ox:o=11;break e;case Ix:o=14;break e;case Ai:o=16,r=null;break e}throw Error(ce(130,n==null?n:typeof n,""))}return e=Cr(o,t,e,s),e.elementType=n,e.type=r,e.lanes=i,e}function ra(n,e,t,r){return n=Cr(7,n,r,e),n.lanes=t,n}function $p(n,e,t,r){return n=Cr(22,n,r,e),n.elementType=dk,n.lanes=t,n.stateNode={isHidden:!1},n}function yg(n,e,t){return n=Cr(6,n,null,e),n.lanes=t,n}function xg(n,e,t){return e=Cr(4,n.children!==null?n.children:[],n.key,e),e.lanes=t,e.stateNode={containerInfo:n.containerInfo,pendingChildren:null,implementation:n.implementation},e}function gj(n,e,t,r,s){this.tag=e,this.containerInfo=n,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Z0(0),this.expirationTimes=Z0(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Z0(0),this.identifierPrefix=r,this.onRecoverableError=s,this.mutableSourceEagerHydrationData=null}function fw(n,e,t,r,s,i,o,a,l){return n=new gj(n,e,t,a,l),e===1?(e=1,i===!0&&(e|=8)):e=0,i=Cr(3,null,null,e),n.current=i,i.stateNode=n,i.memoizedState={element:r,isDehydrated:t,cache:null,transitions:null,pendingSuspenseBoundaries:null},Kx(i),n}function mj(n,e,t){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:qa,key:r==null?null:""+r,children:n,containerInfo:e,implementation:t}}function nT(n){if(!n)return ao;n=n._reactInternals;e:{if(wa(n)!==n||n.tag!==1)throw Error(ce(170));var e=n;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(Xn(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(ce(171))}if(n.tag===1){var t=n.type;if(Xn(t))return nP(n,t,e)}return e}function rT(n,e,t,r,s,i,o,a,l){return n=fw(t,r,!0,n,s,i,o,a,l),n.context=nT(null),t=n.current,r=jn(),s=eo(t),i=Ws(r,s),i.callback=e??null,Qi(t,i,s),n.current.lanes=s,pd(n,s,r),Kn(n,r),n}function zp(n,e,t,r){var s=e.current,i=jn(),o=eo(s);return t=nT(t),e.context===null?e.context=t:e.pendingContext=t,e=Ws(i,o),e.payload={element:n},r=r===void 0?null:r,r!==null&&(e.callback=r),n=Qi(s,e,o),n!==null&&(Qr(n,s,o,i),ef(n,s,o)),o}function qf(n){if(n=n.current,!n.child)return null;switch(n.child.tag){case 5:return n.child.stateNode;default:return n.child.stateNode}}function O_(n,e){if(n=n.memoizedState,n!==null&&n.dehydrated!==null){var t=n.retryLane;n.retryLane=t!==0&&t<e?t:e}}function pw(n,e){O_(n,e),(n=n.alternate)&&O_(n,e)}function vj(){return null}var sT=typeof reportError=="function"?reportError:function(n){console.error(n)};function gw(n){this._internalRoot=n}Wp.prototype.render=gw.prototype.render=function(n){var e=this._internalRoot;if(e===null)throw Error(ce(409));zp(n,e,null,null)};Wp.prototype.unmount=gw.prototype.unmount=function(){var n=this._internalRoot;if(n!==null){this._internalRoot=null;var e=n.containerInfo;ca(function(){zp(null,n,null,null)}),e[Qs]=null}};function Wp(n){this._internalRoot=n}Wp.prototype.unstable_scheduleHydration=function(n){if(n){var e=jk();n={blockedOn:null,target:n,priority:e};for(var t=0;t<Ii.length&&e!==0&&e<Ii[t].priority;t++);Ii.splice(t,0,n),t===0&&Mk(n)}};function mw(n){return!(!n||n.nodeType!==1&&n.nodeType!==9&&n.nodeType!==11)}function Hp(n){return!(!n||n.nodeType!==1&&n.nodeType!==9&&n.nodeType!==11&&(n.nodeType!==8||n.nodeValue!==" react-mount-point-unstable "))}function I_(){}function yj(n,e,t,r,s){if(s){if(typeof r=="function"){var i=r;r=function(){var c=qf(o);i.call(c)}}var o=rT(e,r,n,0,null,!1,!1,"",I_);return n._reactRootContainer=o,n[Qs]=o.current,ju(n.nodeType===8?n.parentNode:n),ca(),o}for(;s=n.lastChild;)n.removeChild(s);if(typeof r=="function"){var a=r;r=function(){var c=qf(l);a.call(c)}}var l=fw(n,0,!1,null,null,!1,!1,"",I_);return n._reactRootContainer=l,n[Qs]=l.current,ju(n.nodeType===8?n.parentNode:n),ca(function(){zp(e,l,t,r)}),l}function Vp(n,e,t,r,s){var i=t._reactRootContainer;if(i){var o=i;if(typeof s=="function"){var a=s;s=function(){var l=qf(o);a.call(l)}}zp(e,o,n,s)}else o=yj(t,e,n,s,r);return qf(o)}Rk=function(n){switch(n.tag){case 3:var e=n.stateNode;if(e.current.memoizedState.isDehydrated){var t=Jc(e.pendingLanes);t!==0&&(jx(e,t|1),Kn(e,Mt()),!(rt&6)&&(Vl=Mt()+500,yo()))}break;case 13:ca(function(){var r=Zs(n,1);if(r!==null){var s=jn();Qr(r,n,1,s)}}),pw(n,1)}};Lx=function(n){if(n.tag===13){var e=Zs(n,134217728);if(e!==null){var t=jn();Qr(e,n,134217728,t)}pw(n,134217728)}};Nk=function(n){if(n.tag===13){var e=eo(n),t=Zs(n,e);if(t!==null){var r=jn();Qr(t,n,e,r)}pw(n,e)}};jk=function(){return ft};Lk=function(n,e){var t=ft;try{return ft=n,e()}finally{ft=t}};Cv=function(n,e,t){switch(e){case"input":if(vv(n,t),e=t.name,t.type==="radio"&&e!=null){for(t=n;t.parentNode;)t=t.parentNode;for(t=t.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<t.length;e++){var r=t[e];if(r!==n&&r.form===n.form){var s=jp(r);if(!s)throw Error(ce(90));fk(r),vv(r,s)}}}break;case"textarea":gk(n,t);break;case"select":e=t.value,e!=null&&cl(n,!!t.multiple,e,!1)}};_k=cw;Sk=ca;var xj={usingClientEntryPoint:!1,Events:[md,Qa,jp,wk,bk,cw]},Fc={findFiberByHostInstance:Go,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},wj={bundleType:Fc.bundleType,version:Fc.version,rendererPackageName:Fc.rendererPackageName,rendererConfig:Fc.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:ui.ReactCurrentDispatcher,findHostInstanceByFiber:function(n){return n=kk(n),n===null?null:n.stateNode},findFiberByHostInstance:Fc.findFiberByHostInstance||vj,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var oh=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!oh.isDisabled&&oh.supportsFiber)try{Op=oh.inject(wj),ps=oh}catch{}}pr.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=xj;pr.createPortal=function(n,e){var t=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!mw(e))throw Error(ce(200));return mj(n,e,null,t)};pr.createRoot=function(n,e){if(!mw(n))throw Error(ce(299));var t=!1,r="",s=sT;return e!=null&&(e.unstable_strictMode===!0&&(t=!0),e.identifierPrefix!==void 0&&(r=e.identifierPrefix),e.onRecoverableError!==void 0&&(s=e.onRecoverableError)),e=fw(n,1,!1,null,null,t,!1,r,s),n[Qs]=e.current,ju(n.nodeType===8?n.parentNode:n),new gw(e)};pr.findDOMNode=function(n){if(n==null)return null;if(n.nodeType===1)return n;var e=n._reactInternals;if(e===void 0)throw typeof n.render=="function"?Error(ce(188)):(n=Object.keys(n).join(","),Error(ce(268,n)));return n=kk(e),n=n===null?null:n.stateNode,n};pr.flushSync=function(n){return ca(n)};pr.hydrate=function(n,e,t){if(!Hp(e))throw Error(ce(200));return Vp(null,n,e,!0,t)};pr.hydrateRoot=function(n,e,t){if(!mw(n))throw Error(ce(405));var r=t!=null&&t.hydratedSources||null,s=!1,i="",o=sT;if(t!=null&&(t.unstable_strictMode===!0&&(s=!0),t.identifierPrefix!==void 0&&(i=t.identifierPrefix),t.onRecoverableError!==void 0&&(o=t.onRecoverableError)),e=rT(e,null,n,1,t??null,s,!1,i,o),n[Qs]=e.current,ju(n),r)for(n=0;n<r.length;n++)t=r[n],s=t._getVersion,s=s(t._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[t,s]:e.mutableSourceEagerHydrationData.push(t,s);return new Wp(e)};pr.render=function(n,e,t){if(!Hp(e))throw Error(ce(200));return Vp(null,n,e,!1,t)};pr.unmountComponentAtNode=function(n){if(!Hp(n))throw Error(ce(40));return n._reactRootContainer?(ca(function(){Vp(null,null,n,!1,function(){n._reactRootContainer=null,n[Qs]=null})}),!0):!1};pr.unstable_batchedUpdates=cw;pr.unstable_renderSubtreeIntoContainer=function(n,e,t,r){if(!Hp(t))throw Error(ce(200));if(n==null||n._reactInternals===void 0)throw Error(ce(38));return Vp(n,e,t,!1,r)};pr.version="18.3.1-next-f1338f8080-20240426";function iT(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(iT)}catch(n){console.error(n)}}iT(),ik.exports=pr;var ba=ik.exports;const oT=Ap(ba);var aT,R_=ba;aT=R_.createRoot,R_.hydrateRoot;const bj="modulepreload",_j=function(n){return"/"+n},N_={},Ae=function(e,t,r){let s=Promise.resolve();if(t&&t.length>0){document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),a=(o==null?void 0:o.nonce)||(o==null?void 0:o.getAttribute("nonce"));s=Promise.allSettled(t.map(l=>{if(l=_j(l),l in N_)return;N_[l]=!0;const c=l.endsWith(".css"),u=c?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${l}"]${u}`))return;const h=document.createElement("link");if(h.rel=c?"stylesheet":bj,c||(h.as="script"),h.crossOrigin="",h.href=l,a&&h.setAttribute("nonce",a),document.head.appendChild(h),c)return new Promise((d,p)=>{h.addEventListener("load",d),h.addEventListener("error",()=>p(new Error(`Unable to preload CSS for ${l}`)))})}))}function i(o){const a=new Event("vite:preloadError",{cancelable:!0});if(a.payload=o,window.dispatchEvent(a),!a.defaultPrevented)throw o}return s.then(o=>{for(const a of o||[])a.status==="rejected"&&i(a.reason);return e().catch(i)})},Sj=1,Cj=1e6;let wg=0;function Ej(){return wg=(wg+1)%Number.MAX_SAFE_INTEGER,wg.toString()}const bg=new Map,j_=n=>{if(bg.has(n))return;const e=setTimeout(()=>{bg.delete(n),pu({type:"REMOVE_TOAST",toastId:n})},Cj);bg.set(n,e)},kj=(n,e)=>{switch(e.type){case"ADD_TOAST":return{...n,toasts:[e.toast,...n.toasts].slice(0,Sj)};case"UPDATE_TOAST":return{...n,toasts:n.toasts.map(t=>t.id===e.toast.id?{...t,...e.toast}:t)};case"DISMISS_TOAST":{const{toastId:t}=e;return t?j_(t):n.toasts.forEach(r=>{j_(r.id)}),{...n,toasts:n.toasts.map(r=>r.id===t||t===void 0?{...r,open:!1}:r)}}case"REMOVE_TOAST":return e.toastId===void 0?{...n,toasts:[]}:{...n,toasts:n.toasts.filter(t=>t.id!==e.toastId)}}},lf=[];let cf={toasts:[]};function pu(n){cf=kj(cf,n),lf.forEach(e=>{e(cf)})}function Pj({...n}){const e=Ej(),t=s=>pu({type:"UPDATE_TOAST",toast:{...s,id:e}}),r=()=>pu({type:"DISMISS_TOAST",toastId:e});return pu({type:"ADD_TOAST",toast:{...n,id:e,open:!0,onOpenChange:s=>{s||r()}}}),{id:e,dismiss:r,update:t}}function Bt(){const[n,e]=b.useState(cf);return b.useEffect(()=>(lf.push(e),()=>{const t=lf.indexOf(e);t>-1&&lf.splice(t,1)}),[n]),{...n,toast:Pj,dismiss:t=>pu({type:"DISMISS_TOAST",toastId:t})}}function De(n,e,{checkForDefaultPrevented:t=!0}={}){return function(s){if(n==null||n(s),t===!1||!s.defaultPrevented)return e==null?void 0:e(s)}}function Tj(n,e){typeof n=="function"?n(e):n!=null&&(n.current=e)}function lT(...n){return e=>n.forEach(t=>Tj(t,e))}function ct(...n){return b.useCallback(lT(...n),n)}function Aj(n,e=[]){let t=[];function r(i,o){const a=b.createContext(o),l=t.length;t=[...t,o];function c(h){const{scope:d,children:p,...m}=h,g=(d==null?void 0:d[n][l])||a,y=b.useMemo(()=>m,Object.values(m));return f.jsx(g.Provider,{value:y,children:p})}function u(h,d){const p=(d==null?void 0:d[n][l])||a,m=b.useContext(p);if(m)return m;if(o!==void 0)return o;throw new Error(`\`${h}\` must be used within \`${i}\``)}return c.displayName=i+"Provider",[c,u]}const s=()=>{const i=t.map(o=>b.createContext(o));return function(a){const l=(a==null?void 0:a[n])||i;return b.useMemo(()=>({[`__scope${n}`]:{...a,[n]:l}}),[a,l])}};return s.scopeName=n,[r,Dj(s,...e)]}function Dj(...n){const e=n[0];if(n.length===1)return e;const t=()=>{const r=n.map(s=>({useScope:s(),scopeName:s.scopeName}));return function(i){const o=r.reduce((a,{useScope:l,scopeName:c})=>{const h=l(i)[`__scope${c}`];return{...a,...h}},{});return b.useMemo(()=>({[`__scope${e.scopeName}`]:o}),[o])}};return t.scopeName=e.scopeName,t}var ua=b.forwardRef((n,e)=>{const{children:t,...r}=n,s=b.Children.toArray(t),i=s.find(Oj);if(i){const o=i.props.children,a=s.map(l=>l===i?b.Children.count(o)>1?b.Children.only(null):b.isValidElement(o)?o.props.children:null:l);return f.jsx(ry,{...r,ref:e,children:b.isValidElement(o)?b.cloneElement(o,void 0,a):null})}return f.jsx(ry,{...r,ref:e,children:t})});ua.displayName="Slot";var ry=b.forwardRef((n,e)=>{const{children:t,...r}=n;if(b.isValidElement(t)){const s=Rj(t);return b.cloneElement(t,{...Ij(r,t.props),ref:e?lT(e,s):s})}return b.Children.count(t)>1?b.Children.only(null):null});ry.displayName="SlotClone";var vw=({children:n})=>f.jsx(f.Fragment,{children:n});function Oj(n){return b.isValidElement(n)&&n.type===vw}function Ij(n,e){const t={...e};for(const r in e){const s=n[r],i=e[r];/^on[A-Z]/.test(r)?s&&i?t[r]=(...a)=>{i(...a),s(...a)}:s&&(t[r]=s):r==="style"?t[r]={...s,...i}:r==="className"&&(t[r]=[s,i].filter(Boolean).join(" "))}return{...n,...t}}function Rj(n){var r,s;let e=(r=Object.getOwnPropertyDescriptor(n.props,"ref"))==null?void 0:r.get,t=e&&"isReactWarning"in e&&e.isReactWarning;return t?n.ref:(e=(s=Object.getOwnPropertyDescriptor(n,"ref"))==null?void 0:s.get,t=e&&"isReactWarning"in e&&e.isReactWarning,t?n.props.ref:n.props.ref||n.ref)}function yw(n){const e=n+"CollectionProvider",[t,r]=Aj(e),[s,i]=t(e,{collectionRef:{current:null},itemMap:new Map}),o=p=>{const{scope:m,children:g}=p,y=Y.useRef(null),x=Y.useRef(new Map).current;return f.jsx(s,{scope:m,itemMap:x,collectionRef:y,children:g})};o.displayName=e;const a=n+"CollectionSlot",l=Y.forwardRef((p,m)=>{const{scope:g,children:y}=p,x=i(a,g),v=ct(m,x.collectionRef);return f.jsx(ua,{ref:v,children:y})});l.displayName=a;const c=n+"CollectionItemSlot",u="data-radix-collection-item",h=Y.forwardRef((p,m)=>{const{scope:g,children:y,...x}=p,v=Y.useRef(null),w=ct(m,v),_=i(c,g);return Y.useEffect(()=>(_.itemMap.set(v,{ref:v,...x}),()=>void _.itemMap.delete(v))),f.jsx(ua,{[u]:"",ref:w,children:y})});h.displayName=c;function d(p){const m=i(n+"CollectionConsumer",p);return Y.useCallback(()=>{const y=m.collectionRef.current;if(!y)return[];const x=Array.from(y.querySelectorAll(`[${u}]`));return Array.from(m.itemMap.values()).sort((_,S)=>x.indexOf(_.ref.current)-x.indexOf(S.ref.current))},[m.collectionRef,m.itemMap])}return[{Provider:o,Slot:l,ItemSlot:h},d,r]}function Nj(n,e){const t=b.createContext(e),r=i=>{const{children:o,...a}=i,l=b.useMemo(()=>a,Object.values(a));return f.jsx(t.Provider,{value:l,children:o})};r.displayName=n+"Provider";function s(i){const o=b.useContext(t);if(o)return o;if(e!==void 0)return e;throw new Error(`\`${i}\` must be used within \`${n}\``)}return[r,s]}function xo(n,e=[]){let t=[];function r(i,o){const a=b.createContext(o),l=t.length;t=[...t,o];const c=h=>{var x;const{scope:d,children:p,...m}=h,g=((x=d==null?void 0:d[n])==null?void 0:x[l])||a,y=b.useMemo(()=>m,Object.values(m));return f.jsx(g.Provider,{value:y,children:p})};c.displayName=i+"Provider";function u(h,d){var g;const p=((g=d==null?void 0:d[n])==null?void 0:g[l])||a,m=b.useContext(p);if(m)return m;if(o!==void 0)return o;throw new Error(`\`${h}\` must be used within \`${i}\``)}return[c,u]}const s=()=>{const i=t.map(o=>b.createContext(o));return function(a){const l=(a==null?void 0:a[n])||i;return b.useMemo(()=>({[`__scope${n}`]:{...a,[n]:l}}),[a,l])}};return s.scopeName=n,[r,jj(s,...e)]}function jj(...n){const e=n[0];if(n.length===1)return e;const t=()=>{const r=n.map(s=>({useScope:s(),scopeName:s.scopeName}));return function(i){const o=r.reduce((a,{useScope:l,scopeName:c})=>{const h=l(i)[`__scope${c}`];return{...a,...h}},{});return b.useMemo(()=>({[`__scope${e.scopeName}`]:o}),[o])}};return t.scopeName=e.scopeName,t}var Lj=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","span","svg","ul"],Le=Lj.reduce((n,e)=>{const t=b.forwardRef((r,s)=>{const{asChild:i,...o}=r,a=i?ua:e;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),f.jsx(a,{...o,ref:s})});return t.displayName=`Primitive.${e}`,{...n,[e]:t}},{});function cT(n,e){n&&ba.flushSync(()=>n.dispatchEvent(e))}function tr(n){const e=b.useRef(n);return b.useEffect(()=>{e.current=n}),b.useMemo(()=>(...t)=>{var r;return(r=e.current)==null?void 0:r.call(e,...t)},[])}function Mj(n,e=globalThis==null?void 0:globalThis.document){const t=tr(n);b.useEffect(()=>{const r=s=>{s.key==="Escape"&&t(s)};return e.addEventListener("keydown",r,{capture:!0}),()=>e.removeEventListener("keydown",r,{capture:!0})},[t,e])}var Fj="DismissableLayer",sy="dismissableLayer.update",Bj="dismissableLayer.pointerDownOutside",Uj="dismissableLayer.focusOutside",L_,uT=b.createContext({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),yd=b.forwardRef((n,e)=>{const{disableOutsidePointerEvents:t=!1,onEscapeKeyDown:r,onPointerDownOutside:s,onFocusOutside:i,onInteractOutside:o,onDismiss:a,...l}=n,c=b.useContext(uT),[u,h]=b.useState(null),d=(u==null?void 0:u.ownerDocument)??(globalThis==null?void 0:globalThis.document),[,p]=b.useState({}),m=ct(e,C=>h(C)),g=Array.from(c.layers),[y]=[...c.layersWithOutsidePointerEventsDisabled].slice(-1),x=g.indexOf(y),v=u?g.indexOf(u):-1,w=c.layersWithOutsidePointerEventsDisabled.size>0,_=v>=x,S=zj(C=>{const P=C.target,O=[...c.branches].some(A=>A.contains(P));!_||O||(s==null||s(C),o==null||o(C),C.defaultPrevented||a==null||a())},d),E=Wj(C=>{const P=C.target;[...c.branches].some(A=>A.contains(P))||(i==null||i(C),o==null||o(C),C.defaultPrevented||a==null||a())},d);return Mj(C=>{v===c.layers.size-1&&(r==null||r(C),!C.defaultPrevented&&a&&(C.preventDefault(),a()))},d),b.useEffect(()=>{if(u)return t&&(c.layersWithOutsidePointerEventsDisabled.size===0&&(L_=d.body.style.pointerEvents,d.body.style.pointerEvents="none"),c.layersWithOutsidePointerEventsDisabled.add(u)),c.layers.add(u),M_(),()=>{t&&c.layersWithOutsidePointerEventsDisabled.size===1&&(d.body.style.pointerEvents=L_)}},[u,d,t,c]),b.useEffect(()=>()=>{u&&(c.layers.delete(u),c.layersWithOutsidePointerEventsDisabled.delete(u),M_())},[u,c]),b.useEffect(()=>{const C=()=>p({});return document.addEventListener(sy,C),()=>document.removeEventListener(sy,C)},[]),f.jsx(Le.div,{...l,ref:m,style:{pointerEvents:w?_?"auto":"none":void 0,...n.style},onFocusCapture:De(n.onFocusCapture,E.onFocusCapture),onBlurCapture:De(n.onBlurCapture,E.onBlurCapture),onPointerDownCapture:De(n.onPointerDownCapture,S.onPointerDownCapture)})});yd.displayName=Fj;var $j="DismissableLayerBranch",dT=b.forwardRef((n,e)=>{const t=b.useContext(uT),r=b.useRef(null),s=ct(e,r);return b.useEffect(()=>{const i=r.current;if(i)return t.branches.add(i),()=>{t.branches.delete(i)}},[t.branches]),f.jsx(Le.div,{...n,ref:s})});dT.displayName=$j;function zj(n,e=globalThis==null?void 0:globalThis.document){const t=tr(n),r=b.useRef(!1),s=b.useRef(()=>{});return b.useEffect(()=>{const i=a=>{if(a.target&&!r.current){let l=function(){hT(Bj,t,c,{discrete:!0})};const c={originalEvent:a};a.pointerType==="touch"?(e.removeEventListener("click",s.current),s.current=l,e.addEventListener("click",s.current,{once:!0})):l()}else e.removeEventListener("click",s.current);r.current=!1},o=window.setTimeout(()=>{e.addEventListener("pointerdown",i)},0);return()=>{window.clearTimeout(o),e.removeEventListener("pointerdown",i),e.removeEventListener("click",s.current)}},[e,t]),{onPointerDownCapture:()=>r.current=!0}}function Wj(n,e=globalThis==null?void 0:globalThis.document){const t=tr(n),r=b.useRef(!1);return b.useEffect(()=>{const s=i=>{i.target&&!r.current&&hT(Uj,t,{originalEvent:i},{discrete:!1})};return e.addEventListener("focusin",s),()=>e.removeEventListener("focusin",s)},[e,t]),{onFocusCapture:()=>r.current=!0,onBlurCapture:()=>r.current=!1}}function M_(){const n=new CustomEvent(sy);document.dispatchEvent(n)}function hT(n,e,t,{discrete:r}){const s=t.originalEvent.target,i=new CustomEvent(n,{bubbles:!1,cancelable:!0,detail:t});e&&s.addEventListener(n,e,{once:!0}),r?cT(s,i):s.dispatchEvent(i)}var Hj=yd,Vj=dT,vn=globalThis!=null&&globalThis.document?b.useLayoutEffect:()=>{},Gj="Portal",Gp=b.forwardRef((n,e)=>{var a;const{container:t,...r}=n,[s,i]=b.useState(!1);vn(()=>i(!0),[]);const o=t||s&&((a=globalThis==null?void 0:globalThis.document)==null?void 0:a.body);return o?oT.createPortal(f.jsx(Le.div,{...r,ref:e}),o):null});Gp.displayName=Gj;function qj(n,e){return b.useReducer((t,r)=>e[t][r]??t,n)}var wo=n=>{const{present:e,children:t}=n,r=Yj(e),s=typeof t=="function"?t({present:r.isPresent}):b.Children.only(t),i=ct(r.ref,Xj(s));return typeof t=="function"||r.isPresent?b.cloneElement(s,{ref:i}):null};wo.displayName="Presence";function Yj(n){const[e,t]=b.useState(),r=b.useRef({}),s=b.useRef(n),i=b.useRef("none"),o=n?"mounted":"unmounted",[a,l]=qj(o,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}});return b.useEffect(()=>{const c=ah(r.current);i.current=a==="mounted"?c:"none"},[a]),vn(()=>{const c=r.current,u=s.current;if(u!==n){const d=i.current,p=ah(c);n?l("MOUNT"):p==="none"||(c==null?void 0:c.display)==="none"?l("UNMOUNT"):l(u&&d!==p?"ANIMATION_OUT":"UNMOUNT"),s.current=n}},[n,l]),vn(()=>{if(e){let c;const u=e.ownerDocument.defaultView??window,h=p=>{const g=ah(r.current).includes(p.animationName);if(p.target===e&&g&&(l("ANIMATION_END"),!s.current)){const y=e.style.animationFillMode;e.style.animationFillMode="forwards",c=u.setTimeout(()=>{e.style.animationFillMode==="forwards"&&(e.style.animationFillMode=y)})}},d=p=>{p.target===e&&(i.current=ah(r.current))};return e.addEventListener("animationstart",d),e.addEventListener("animationcancel",h),e.addEventListener("animationend",h),()=>{u.clearTimeout(c),e.removeEventListener("animationstart",d),e.removeEventListener("animationcancel",h),e.removeEventListener("animationend",h)}}else l("ANIMATION_END")},[e,l]),{isPresent:["mounted","unmountSuspended"].includes(a),ref:b.useCallback(c=>{c&&(r.current=getComputedStyle(c)),t(c)},[])}}function ah(n){return(n==null?void 0:n.animationName)||"none"}function Xj(n){var r,s;let e=(r=Object.getOwnPropertyDescriptor(n.props,"ref"))==null?void 0:r.get,t=e&&"isReactWarning"in e&&e.isReactWarning;return t?n.ref:(e=(s=Object.getOwnPropertyDescriptor(n,"ref"))==null?void 0:s.get,t=e&&"isReactWarning"in e&&e.isReactWarning,t?n.props.ref:n.props.ref||n.ref)}function ti({prop:n,defaultProp:e,onChange:t=()=>{}}){const[r,s]=Kj({defaultProp:e,onChange:t}),i=n!==void 0,o=i?n:r,a=tr(t),l=b.useCallback(c=>{if(i){const h=typeof c=="function"?c(n):c;h!==n&&a(h)}else s(c)},[i,n,s,a]);return[o,l]}function Kj({defaultProp:n,onChange:e}){const t=b.useState(n),[r]=t,s=b.useRef(r),i=tr(e);return b.useEffect(()=>{s.current!==r&&(i(r),s.current=r)},[r,s,i]),t}var Jj="VisuallyHidden",xd=b.forwardRef((n,e)=>f.jsx(Le.span,{...n,ref:e,style:{position:"absolute",border:0,width:1,height:1,padding:0,margin:-1,overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",wordWrap:"normal",...n.style}}));xd.displayName=Jj;var Qj=xd,xw="ToastProvider",[ww,Zj,eL]=yw("Toast"),[fT,UZ]=xo("Toast",[eL]),[tL,qp]=fT(xw),pT=n=>{const{__scopeToast:e,label:t="Notification",duration:r=5e3,swipeDirection:s="right",swipeThreshold:i=50,children:o}=n,[a,l]=b.useState(null),[c,u]=b.useState(0),h=b.useRef(!1),d=b.useRef(!1);return t.trim()||console.error(`Invalid prop \`label\` supplied to \`${xw}\`. Expected non-empty \`string\`.`),f.jsx(ww.Provider,{scope:e,children:f.jsx(tL,{scope:e,label:t,duration:r,swipeDirection:s,swipeThreshold:i,toastCount:c,viewport:a,onViewportChange:l,onToastAdd:b.useCallback(()=>u(p=>p+1),[]),onToastRemove:b.useCallback(()=>u(p=>p-1),[]),isFocusedToastEscapeKeyDownRef:h,isClosePausedRef:d,children:o})})};pT.displayName=xw;var gT="ToastViewport",nL=["F8"],iy="toast.viewportPause",oy="toast.viewportResume",mT=b.forwardRef((n,e)=>{const{__scopeToast:t,hotkey:r=nL,label:s="Notifications ({hotkey})",...i}=n,o=qp(gT,t),a=Zj(t),l=b.useRef(null),c=b.useRef(null),u=b.useRef(null),h=b.useRef(null),d=ct(e,h,o.onViewportChange),p=r.join("+").replace(/Key/g,"").replace(/Digit/g,""),m=o.toastCount>0;b.useEffect(()=>{const y=x=>{var w;r.length!==0&&r.every(_=>x[_]||x.code===_)&&((w=h.current)==null||w.focus())};return document.addEventListener("keydown",y),()=>document.removeEventListener("keydown",y)},[r]),b.useEffect(()=>{const y=l.current,x=h.current;if(m&&y&&x){const v=()=>{if(!o.isClosePausedRef.current){const E=new CustomEvent(iy);x.dispatchEvent(E),o.isClosePausedRef.current=!0}},w=()=>{if(o.isClosePausedRef.current){const E=new CustomEvent(oy);x.dispatchEvent(E),o.isClosePausedRef.current=!1}},_=E=>{!y.contains(E.relatedTarget)&&w()},S=()=>{y.contains(document.activeElement)||w()};return y.addEventListener("focusin",v),y.addEventListener("focusout",_),y.addEventListener("pointermove",v),y.addEventListener("pointerleave",S),window.addEventListener("blur",v),window.addEventListener("focus",w),()=>{y.removeEventListener("focusin",v),y.removeEventListener("focusout",_),y.removeEventListener("pointermove",v),y.removeEventListener("pointerleave",S),window.removeEventListener("blur",v),window.removeEventListener("focus",w)}}},[m,o.isClosePausedRef]);const g=b.useCallback(({tabbingDirection:y})=>{const v=a().map(w=>{const _=w.ref.current,S=[_,...gL(_)];return y==="forwards"?S:S.reverse()});return(y==="forwards"?v.reverse():v).flat()},[a]);return b.useEffect(()=>{const y=h.current;if(y){const x=v=>{var S,E,C;const w=v.altKey||v.ctrlKey||v.metaKey;if(v.key==="Tab"&&!w){const P=document.activeElement,O=v.shiftKey;if(v.target===y&&O){(S=c.current)==null||S.focus();return}const B=g({tabbingDirection:O?"backwards":"forwards"}),I=B.findIndex(L=>L===P);_g(B.slice(I+1))?v.preventDefault():O?(E=c.current)==null||E.focus():(C=u.current)==null||C.focus()}};return y.addEventListener("keydown",x),()=>y.removeEventListener("keydown",x)}},[a,g]),f.jsxs(Vj,{ref:l,role:"region","aria-label":s.replace("{hotkey}",p),tabIndex:-1,style:{pointerEvents:m?void 0:"none"},children:[m&&f.jsx(ay,{ref:c,onFocusFromOutsideViewport:()=>{const y=g({tabbingDirection:"forwards"});_g(y)}}),f.jsx(ww.Slot,{scope:t,children:f.jsx(Le.ol,{tabIndex:-1,...i,ref:d})}),m&&f.jsx(ay,{ref:u,onFocusFromOutsideViewport:()=>{const y=g({tabbingDirection:"backwards"});_g(y)}})]})});mT.displayName=gT;var vT="ToastFocusProxy",ay=b.forwardRef((n,e)=>{const{__scopeToast:t,onFocusFromOutsideViewport:r,...s}=n,i=qp(vT,t);return f.jsx(xd,{"aria-hidden":!0,tabIndex:0,...s,ref:e,style:{position:"fixed"},onFocus:o=>{var c;const a=o.relatedTarget;!((c=i.viewport)!=null&&c.contains(a))&&r()}})});ay.displayName=vT;var Yp="Toast",rL="toast.swipeStart",sL="toast.swipeMove",iL="toast.swipeCancel",oL="toast.swipeEnd",yT=b.forwardRef((n,e)=>{const{forceMount:t,open:r,defaultOpen:s,onOpenChange:i,...o}=n,[a=!0,l]=ti({prop:r,defaultProp:s,onChange:i});return f.jsx(wo,{present:t||a,children:f.jsx(cL,{open:a,...o,ref:e,onClose:()=>l(!1),onPause:tr(n.onPause),onResume:tr(n.onResume),onSwipeStart:De(n.onSwipeStart,c=>{c.currentTarget.setAttribute("data-swipe","start")}),onSwipeMove:De(n.onSwipeMove,c=>{const{x:u,y:h}=c.detail.delta;c.currentTarget.setAttribute("data-swipe","move"),c.currentTarget.style.setProperty("--radix-toast-swipe-move-x",`${u}px`),c.currentTarget.style.setProperty("--radix-toast-swipe-move-y",`${h}px`)}),onSwipeCancel:De(n.onSwipeCancel,c=>{c.currentTarget.setAttribute("data-swipe","cancel"),c.currentTarget.style.removeProperty("--radix-toast-swipe-move-x"),c.currentTarget.style.removeProperty("--radix-toast-swipe-move-y"),c.currentTarget.style.removeProperty("--radix-toast-swipe-end-x"),c.currentTarget.style.removeProperty("--radix-toast-swipe-end-y")}),onSwipeEnd:De(n.onSwipeEnd,c=>{const{x:u,y:h}=c.detail.delta;c.currentTarget.setAttribute("data-swipe","end"),c.currentTarget.style.removeProperty("--radix-toast-swipe-move-x"),c.currentTarget.style.removeProperty("--radix-toast-swipe-move-y"),c.currentTarget.style.setProperty("--radix-toast-swipe-end-x",`${u}px`),c.currentTarget.style.setProperty("--radix-toast-swipe-end-y",`${h}px`),l(!1)})})})});yT.displayName=Yp;var[aL,lL]=fT(Yp,{onClose(){}}),cL=b.forwardRef((n,e)=>{const{__scopeToast:t,type:r="foreground",duration:s,open:i,onClose:o,onEscapeKeyDown:a,onPause:l,onResume:c,onSwipeStart:u,onSwipeMove:h,onSwipeCancel:d,onSwipeEnd:p,...m}=n,g=qp(Yp,t),[y,x]=b.useState(null),v=ct(e,L=>x(L)),w=b.useRef(null),_=b.useRef(null),S=s||g.duration,E=b.useRef(0),C=b.useRef(S),P=b.useRef(0),{onToastAdd:O,onToastRemove:A}=g,R=tr(()=>{var U;(y==null?void 0:y.contains(document.activeElement))&&((U=g.viewport)==null||U.focus()),o()}),B=b.useCallback(L=>{!L||L===1/0||(window.clearTimeout(P.current),E.current=new Date().getTime(),P.current=window.setTimeout(R,L))},[R]);b.useEffect(()=>{const L=g.viewport;if(L){const U=()=>{B(C.current),c==null||c()},F=()=>{const D=new Date().getTime()-E.current;C.current=C.current-D,window.clearTimeout(P.current),l==null||l()};return L.addEventListener(iy,F),L.addEventListener(oy,U),()=>{L.removeEventListener(iy,F),L.removeEventListener(oy,U)}}},[g.viewport,S,l,c,B]),b.useEffect(()=>{i&&!g.isClosePausedRef.current&&B(S)},[i,S,g.isClosePausedRef,B]),b.useEffect(()=>(O(),()=>A()),[O,A]);const I=b.useMemo(()=>y?ET(y):null,[y]);return g.viewport?f.jsxs(f.Fragment,{children:[I&&f.jsx(uL,{__scopeToast:t,role:"status","aria-live":r==="foreground"?"assertive":"polite","aria-atomic":!0,children:I}),f.jsx(aL,{scope:t,onClose:R,children:ba.createPortal(f.jsx(ww.ItemSlot,{scope:t,children:f.jsx(Hj,{asChild:!0,onEscapeKeyDown:De(a,()=>{g.isFocusedToastEscapeKeyDownRef.current||R(),g.isFocusedToastEscapeKeyDownRef.current=!1}),children:f.jsx(Le.li,{role:"status","aria-live":"off","aria-atomic":!0,tabIndex:0,"data-state":i?"open":"closed","data-swipe-direction":g.swipeDirection,...m,ref:v,style:{userSelect:"none",touchAction:"none",...n.style},onKeyDown:De(n.onKeyDown,L=>{L.key==="Escape"&&(a==null||a(L.nativeEvent),L.nativeEvent.defaultPrevented||(g.isFocusedToastEscapeKeyDownRef.current=!0,R()))}),onPointerDown:De(n.onPointerDown,L=>{L.button===0&&(w.current={x:L.clientX,y:L.clientY})}),onPointerMove:De(n.onPointerMove,L=>{if(!w.current)return;const U=L.clientX-w.current.x,F=L.clientY-w.current.y,D=!!_.current,k=["left","right"].includes(g.swipeDirection),N=["left","up"].includes(g.swipeDirection)?Math.min:Math.max,M=k?N(0,U):0,T=k?0:N(0,F),j=L.pointerType==="touch"?10:2,$={x:M,y:T},z={originalEvent:L,delta:$};D?(_.current=$,lh(sL,h,z,{discrete:!1})):F_($,g.swipeDirection,j)?(_.current=$,lh(rL,u,z,{discrete:!1}),L.target.setPointerCapture(L.pointerId)):(Math.abs(U)>j||Math.abs(F)>j)&&(w.current=null)}),onPointerUp:De(n.onPointerUp,L=>{const U=_.current,F=L.target;if(F.hasPointerCapture(L.pointerId)&&F.releasePointerCapture(L.pointerId),_.current=null,w.current=null,U){const D=L.currentTarget,k={originalEvent:L,delta:U};F_(U,g.swipeDirection,g.swipeThreshold)?lh(oL,p,k,{discrete:!0}):lh(iL,d,k,{discrete:!0}),D.addEventListener("click",N=>N.preventDefault(),{once:!0})}})})})}),g.viewport)})]}):null}),uL=n=>{const{__scopeToast:e,children:t,...r}=n,s=qp(Yp,e),[i,o]=b.useState(!1),[a,l]=b.useState(!1);return fL(()=>o(!0)),b.useEffect(()=>{const c=window.setTimeout(()=>l(!0),1e3);return()=>window.clearTimeout(c)},[]),a?null:f.jsx(Gp,{asChild:!0,children:f.jsx(xd,{...r,children:i&&f.jsxs(f.Fragment,{children:[s.label," ",t]})})})},dL="ToastTitle",xT=b.forwardRef((n,e)=>{const{__scopeToast:t,...r}=n;return f.jsx(Le.div,{...r,ref:e})});xT.displayName=dL;var hL="ToastDescription",wT=b.forwardRef((n,e)=>{const{__scopeToast:t,...r}=n;return f.jsx(Le.div,{...r,ref:e})});wT.displayName=hL;var bT="ToastAction",_T=b.forwardRef((n,e)=>{const{altText:t,...r}=n;return t.trim()?f.jsx(CT,{altText:t,asChild:!0,children:f.jsx(bw,{...r,ref:e})}):(console.error(`Invalid prop \`altText\` supplied to \`${bT}\`. Expected non-empty \`string\`.`),null)});_T.displayName=bT;var ST="ToastClose",bw=b.forwardRef((n,e)=>{const{__scopeToast:t,...r}=n,s=lL(ST,t);return f.jsx(CT,{asChild:!0,children:f.jsx(Le.button,{type:"button",...r,ref:e,onClick:De(n.onClick,s.onClose)})})});bw.displayName=ST;var CT=b.forwardRef((n,e)=>{const{__scopeToast:t,altText:r,...s}=n;return f.jsx(Le.div,{"data-radix-toast-announce-exclude":"","data-radix-toast-announce-alt":r||void 0,...s,ref:e})});function ET(n){const e=[];return Array.from(n.childNodes).forEach(r=>{if(r.nodeType===r.TEXT_NODE&&r.textContent&&e.push(r.textContent),pL(r)){const s=r.ariaHidden||r.hidden||r.style.display==="none",i=r.dataset.radixToastAnnounceExclude==="";if(!s)if(i){const o=r.dataset.radixToastAnnounceAlt;o&&e.push(o)}else e.push(...ET(r))}}),e}function lh(n,e,t,{discrete:r}){const s=t.originalEvent.currentTarget,i=new CustomEvent(n,{bubbles:!0,cancelable:!0,detail:t});e&&s.addEventListener(n,e,{once:!0}),r?cT(s,i):s.dispatchEvent(i)}var F_=(n,e,t=0)=>{const r=Math.abs(n.x),s=Math.abs(n.y),i=r>s;return e==="left"||e==="right"?i&&r>t:!i&&s>t};function fL(n=()=>{}){const e=tr(n);vn(()=>{let t=0,r=0;return t=window.requestAnimationFrame(()=>r=window.requestAnimationFrame(e)),()=>{window.cancelAnimationFrame(t),window.cancelAnimationFrame(r)}},[e])}function pL(n){return n.nodeType===n.ELEMENT_NODE}function gL(n){const e=[],t=document.createTreeWalker(n,NodeFilter.SHOW_ELEMENT,{acceptNode:r=>{const s=r.tagName==="INPUT"&&r.type==="hidden";return r.disabled||r.hidden||s?NodeFilter.FILTER_SKIP:r.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;t.nextNode();)e.push(t.currentNode);return e}function _g(n){const e=document.activeElement;return n.some(t=>t===e?!0:(t.focus(),document.activeElement!==e))}var mL=pT,kT=mT,PT=yT,TT=xT,AT=wT,DT=_T,OT=bw;function IT(n){var e,t,r="";if(typeof n=="string"||typeof n=="number")r+=n;else if(typeof n=="object")if(Array.isArray(n)){var s=n.length;for(e=0;e<s;e++)n[e]&&(t=IT(n[e]))&&(r&&(r+=" "),r+=t)}else for(t in n)n[t]&&(r&&(r+=" "),r+=t);return r}function RT(){for(var n,e,t=0,r="",s=arguments.length;t<s;t++)(n=arguments[t])&&(e=IT(n))&&(r&&(r+=" "),r+=e);return r}const B_=n=>typeof n=="boolean"?`${n}`:n===0?"0":n,U_=RT,wd=(n,e)=>t=>{var r;if((e==null?void 0:e.variants)==null)return U_(n,t==null?void 0:t.class,t==null?void 0:t.className);const{variants:s,defaultVariants:i}=e,o=Object.keys(s).map(c=>{const u=t==null?void 0:t[c],h=i==null?void 0:i[c];if(u===null)return null;const d=B_(u)||B_(h);return s[c][d]}),a=t&&Object.entries(t).reduce((c,u)=>{let[h,d]=u;return d===void 0||(c[h]=d),c},{}),l=e==null||(r=e.compoundVariants)===null||r===void 0?void 0:r.reduce((c,u)=>{let{class:h,className:d,...p}=u;return Object.entries(p).every(m=>{let[g,y]=m;return Array.isArray(y)?y.includes({...i,...a}[g]):{...i,...a}[g]===y})?[...c,h,d]:c},[]);return U_(n,o,l,t==null?void 0:t.class,t==null?void 0:t.className)};/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vL=n=>n.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),NT=(...n)=>n.filter((e,t,r)=>!!e&&e.trim()!==""&&r.indexOf(e)===t).join(" ").trim();/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var yL={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xL=b.forwardRef(({color:n="currentColor",size:e=24,strokeWidth:t=2,absoluteStrokeWidth:r,className:s="",children:i,iconNode:o,...a},l)=>b.createElement("svg",{ref:l,...yL,width:e,height:e,stroke:n,strokeWidth:r?Number(t)*24/Number(e):t,className:NT("lucide",s),...a},[...o.map(([c,u])=>b.createElement(c,u)),...Array.isArray(i)?i:[i]]));/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const je=(n,e)=>{const t=b.forwardRef(({className:r,...s},i)=>b.createElement(xL,{ref:i,iconNode:e,className:NT(`lucide-${vL(n)}`,r),...s}));return t.displayName=`${n}`,t};/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _w=je("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wL=je("BellOff",[["path",{d:"M8.7 3A6 6 0 0 1 18 8a21.3 21.3 0 0 0 .6 5",key:"o7mx20"}],["path",{d:"M17 17H3s3-2 3-9a4.67 4.67 0 0 1 .3-1.7",key:"16f1lm"}],["path",{d:"M10.3 21a1.94 1.94 0 0 0 3.4 0",key:"qgo35s"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ly=je("Bell",[["path",{d:"M6 8a6 6 0 0 1 12 0c0 7 3 9 3 9H3s3-2 3-9",key:"1qo2s2"}],["path",{d:"M10.3 21a1.94 1.94 0 0 0 3.4 0",key:"qgo35s"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cy=je("Calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kr=je("Camera",[["path",{d:"M14.5 4h-5L7 7H4a2 2 0 0 0-2 2v9a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-3l-2.5-3z",key:"1tc9qg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bL=je("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Hu=je("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _L=je("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const SL=je("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const CL=je("ChevronUp",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jT=je("CircleAlert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const LT=je("CircleCheckBig",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const MT=je("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const EL=je("Copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $_=je("Crop",[["path",{d:"M6 2v14a2 2 0 0 0 2 2h14",key:"ron5a4"}],["path",{d:"M18 22V8a2 2 0 0 0-2-2H2",key:"7s9ehn"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gl=je("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Bc=je("EyeOff",[["path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49",key:"ct8e1f"}],["path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242",key:"151rxh"}],["path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143",key:"13bj9a"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Sg=je("Eye",[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kL=je("Flag",[["path",{d:"M4 15s1-1 4-1 5 2 8 2 4-1 4-1V3s-1 1-4 1-5-2-8-2-4 1-4 1z",key:"i9b6wo"}],["line",{x1:"4",x2:"4",y1:"22",y2:"15",key:"1cm3nv"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const PL=je("Heart",[["path",{d:"M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z",key:"c3ymky"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const TL=je("House",[["path",{d:"M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8",key:"5wwlr5"}],["path",{d:"M3 10a2 2 0 0 1 .709-1.528l7-5.999a2 2 0 0 1 2.582 0l7 5.999A2 2 0 0 1 21 10v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"1d0kgt"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ql=je("Image",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const z_=je("LoaderCircle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const W_=je("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const H_=je("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const V_=je("Monitor",[["rect",{width:"20",height:"14",x:"2",y:"3",rx:"2",key:"48i651"}],["line",{x1:"8",x2:"16",y1:"21",y2:"21",key:"1svkeh"}],["line",{x1:"12",x2:"12",y1:"17",y2:"21",key:"vw1qmm"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const AL=je("Palette",[["circle",{cx:"13.5",cy:"6.5",r:".5",fill:"currentColor",key:"1okk4w"}],["circle",{cx:"17.5",cy:"10.5",r:".5",fill:"currentColor",key:"f64h9f"}],["circle",{cx:"8.5",cy:"7.5",r:".5",fill:"currentColor",key:"fotxhn"}],["circle",{cx:"6.5",cy:"12.5",r:".5",fill:"currentColor",key:"qy21gx"}],["path",{d:"M12 2C6.5 2 2 6.5 2 12s4.5 10 10 10c.926 0 1.648-.746 1.648-1.688 0-.437-.18-.835-.437-1.125-.29-.289-.438-.652-.438-1.125a1.64 1.64 0 0 1 1.668-1.668h1.996c3.051 0 5.555-2.503 5.555-5.554C21.965 6.012 17.461 2 12 2z",key:"12rzf8"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const DL=je("Pause",[["rect",{x:"14",y:"4",width:"4",height:"16",rx:"1",key:"zuxfzm"}],["rect",{x:"6",y:"4",width:"4",height:"16",rx:"1",key:"1okwgv"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const OL=je("Play",[["polygon",{points:"6 3 20 12 6 21 6 3",key:"1oa8hb"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const no=je("QrCode",[["rect",{width:"5",height:"5",x:"3",y:"3",rx:"1",key:"1tu5fj"}],["rect",{width:"5",height:"5",x:"16",y:"3",rx:"1",key:"1v8r4q"}],["rect",{width:"5",height:"5",x:"3",y:"16",rx:"1",key:"1x03jg"}],["path",{d:"M21 16h-3a2 2 0 0 0-2 2v3",key:"177gqh"}],["path",{d:"M21 21v.01",key:"ents32"}],["path",{d:"M12 7v3a2 2 0 0 1-2 2H7",key:"8crl2c"}],["path",{d:"M3 12h.01",key:"nlz23k"}],["path",{d:"M12 3h.01",key:"n36tog"}],["path",{d:"M12 16v.01",key:"133mhm"}],["path",{d:"M16 12h1",key:"1slzba"}],["path",{d:"M21 12v.01",key:"1lwtk9"}],["path",{d:"M12 21v-1",key:"1880an"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const IL=je("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Sw=je("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Cw=je("Share2",[["circle",{cx:"18",cy:"5",r:"3",key:"gq8acd"}],["circle",{cx:"6",cy:"12",r:"3",key:"w7nqdw"}],["circle",{cx:"18",cy:"19",r:"3",key:"1xt0gg"}],["line",{x1:"8.59",x2:"15.42",y1:"13.51",y2:"17.49",key:"47mynk"}],["line",{x1:"15.41",x2:"8.59",y1:"6.51",y2:"10.49",key:"1n3mei"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const G_=je("Shield",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const FT=je("Smartphone",[["rect",{width:"14",height:"20",x:"5",y:"2",rx:"2",ry:"2",key:"1yt0o3"}],["path",{d:"M12 18h.01",key:"mhygvu"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const RL=je("Sparkles",[["path",{d:"M9.937 15.5A2 2 0 0 0 8.5 14.063l-6.135-1.582a.5.5 0 0 1 0-.962L8.5 9.936A2 2 0 0 0 9.937 8.5l1.582-6.135a.5.5 0 0 1 .963 0L14.063 8.5A2 2 0 0 0 15.5 9.937l6.135 1.581a.5.5 0 0 1 0 .964L15.5 14.063a2 2 0 0 0-1.437 1.437l-1.582 6.135a.5.5 0 0 1-.963 0z",key:"4pj2yx"}],["path",{d:"M20 3v4",key:"1olli1"}],["path",{d:"M22 5h-4",key:"1gvqau"}],["path",{d:"M4 17v2",key:"vumght"}],["path",{d:"M5 18H3",key:"zchphs"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const NL=je("SquareCheckBig",[["path",{d:"M21 10.5V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h12.5",key:"1uzm8b"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jL=je("Square",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Cg=je("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const uy=je("TriangleAlert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const da=je("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const q_=je("UserCheck",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["polyline",{points:"16 11 18 13 22 9",key:"1pwet4"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const BT=je("UserX",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"17",x2:"22",y1:"8",y2:"13",key:"3nzzx3"}],["line",{x1:"22",x2:"17",y1:"8",y2:"13",key:"1swrse"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ew=je("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xp=je("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Yf=je("WifiOff",[["path",{d:"M12 20h.01",key:"zekei9"}],["path",{d:"M8.5 16.429a5 5 0 0 1 7 0",key:"1bycff"}],["path",{d:"M5 12.859a10 10 0 0 1 5.17-2.69",key:"1dl1wf"}],["path",{d:"M19 12.859a10 10 0 0 0-2.007-1.523",key:"4k23kn"}],["path",{d:"M2 8.82a15 15 0 0 1 4.177-2.643",key:"1grhjp"}],["path",{d:"M22 8.82a15 15 0 0 0-11.288-3.764",key:"z3jwby"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const LL=je("Wifi",[["path",{d:"M12 20h.01",key:"zekei9"}],["path",{d:"M2 8.82a15 15 0 0 1 20 0",key:"dnpr2z"}],["path",{d:"M5 12.859a10 10 0 0 1 14 0",key:"1x1e6c"}],["path",{d:"M8.5 16.429a5 5 0 0 1 7 0",key:"1bycff"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ha=je("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ML=je("Zap",[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]]),kw="-",FL=n=>{const e=UL(n),{conflictingClassGroups:t,conflictingClassGroupModifiers:r}=n;return{getClassGroupId:o=>{const a=o.split(kw);return a[0]===""&&a.length!==1&&a.shift(),UT(a,e)||BL(o)},getConflictingClassGroupIds:(o,a)=>{const l=t[o]||[];return a&&r[o]?[...l,...r[o]]:l}}},UT=(n,e)=>{var o;if(n.length===0)return e.classGroupId;const t=n[0],r=e.nextPart.get(t),s=r?UT(n.slice(1),r):void 0;if(s)return s;if(e.validators.length===0)return;const i=n.join(kw);return(o=e.validators.find(({validator:a})=>a(i)))==null?void 0:o.classGroupId},Y_=/^\[(.+)\]$/,BL=n=>{if(Y_.test(n)){const e=Y_.exec(n)[1],t=e==null?void 0:e.substring(0,e.indexOf(":"));if(t)return"arbitrary.."+t}},UL=n=>{const{theme:e,prefix:t}=n,r={nextPart:new Map,validators:[]};return zL(Object.entries(n.classGroups),t).forEach(([i,o])=>{dy(o,r,i,e)}),r},dy=(n,e,t,r)=>{n.forEach(s=>{if(typeof s=="string"){const i=s===""?e:X_(e,s);i.classGroupId=t;return}if(typeof s=="function"){if($L(s)){dy(s(r),e,t,r);return}e.validators.push({validator:s,classGroupId:t});return}Object.entries(s).forEach(([i,o])=>{dy(o,X_(e,i),t,r)})})},X_=(n,e)=>{let t=n;return e.split(kw).forEach(r=>{t.nextPart.has(r)||t.nextPart.set(r,{nextPart:new Map,validators:[]}),t=t.nextPart.get(r)}),t},$L=n=>n.isThemeGetter,zL=(n,e)=>e?n.map(([t,r])=>{const s=r.map(i=>typeof i=="string"?e+i:typeof i=="object"?Object.fromEntries(Object.entries(i).map(([o,a])=>[e+o,a])):i);return[t,s]}):n,WL=n=>{if(n<1)return{get:()=>{},set:()=>{}};let e=0,t=new Map,r=new Map;const s=(i,o)=>{t.set(i,o),e++,e>n&&(e=0,r=t,t=new Map)};return{get(i){let o=t.get(i);if(o!==void 0)return o;if((o=r.get(i))!==void 0)return s(i,o),o},set(i,o){t.has(i)?t.set(i,o):s(i,o)}}},$T="!",HL=n=>{const{separator:e,experimentalParseClassName:t}=n,r=e.length===1,s=e[0],i=e.length,o=a=>{const l=[];let c=0,u=0,h;for(let y=0;y<a.length;y++){let x=a[y];if(c===0){if(x===s&&(r||a.slice(y,y+i)===e)){l.push(a.slice(u,y)),u=y+i;continue}if(x==="/"){h=y;continue}}x==="["?c++:x==="]"&&c--}const d=l.length===0?a:a.substring(u),p=d.startsWith($T),m=p?d.substring(1):d,g=h&&h>u?h-u:void 0;return{modifiers:l,hasImportantModifier:p,baseClassName:m,maybePostfixModifierPosition:g}};return t?a=>t({className:a,parseClassName:o}):o},VL=n=>{if(n.length<=1)return n;const e=[];let t=[];return n.forEach(r=>{r[0]==="["?(e.push(...t.sort(),r),t=[]):t.push(r)}),e.push(...t.sort()),e},GL=n=>({cache:WL(n.cacheSize),parseClassName:HL(n),...FL(n)}),qL=/\s+/,YL=(n,e)=>{const{parseClassName:t,getClassGroupId:r,getConflictingClassGroupIds:s}=e,i=[],o=n.trim().split(qL);let a="";for(let l=o.length-1;l>=0;l-=1){const c=o[l],{modifiers:u,hasImportantModifier:h,baseClassName:d,maybePostfixModifierPosition:p}=t(c);let m=!!p,g=r(m?d.substring(0,p):d);if(!g){if(!m){a=c+(a.length>0?" "+a:a);continue}if(g=r(d),!g){a=c+(a.length>0?" "+a:a);continue}m=!1}const y=VL(u).join(":"),x=h?y+$T:y,v=x+g;if(i.includes(v))continue;i.push(v);const w=s(g,m);for(let _=0;_<w.length;++_){const S=w[_];i.push(x+S)}a=c+(a.length>0?" "+a:a)}return a};function XL(){let n=0,e,t,r="";for(;n<arguments.length;)(e=arguments[n++])&&(t=zT(e))&&(r&&(r+=" "),r+=t);return r}const zT=n=>{if(typeof n=="string")return n;let e,t="";for(let r=0;r<n.length;r++)n[r]&&(e=zT(n[r]))&&(t&&(t+=" "),t+=e);return t};function KL(n,...e){let t,r,s,i=o;function o(l){const c=e.reduce((u,h)=>h(u),n());return t=GL(c),r=t.cache.get,s=t.cache.set,i=a,a(l)}function a(l){const c=r(l);if(c)return c;const u=YL(l,t);return s(l,u),u}return function(){return i(XL.apply(null,arguments))}}const wt=n=>{const e=t=>t[n]||[];return e.isThemeGetter=!0,e},WT=/^\[(?:([a-z-]+):)?(.+)\]$/i,JL=/^\d+\/\d+$/,QL=new Set(["px","full","screen"]),ZL=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,eM=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,tM=/^(rgba?|hsla?|hwb|(ok)?(lab|lch))\(.+\)$/,nM=/^(inset_)?-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/,rM=/^(url|image|image-set|cross-fade|element|(repeating-)?(linear|radial|conic)-gradient)\(.+\)$/,Es=n=>gl(n)||QL.has(n)||JL.test(n),yi=n=>oc(n,"length",dM),gl=n=>!!n&&!Number.isNaN(Number(n)),Eg=n=>oc(n,"number",gl),Uc=n=>!!n&&Number.isInteger(Number(n)),sM=n=>n.endsWith("%")&&gl(n.slice(0,-1)),$e=n=>WT.test(n),xi=n=>ZL.test(n),iM=new Set(["length","size","percentage"]),oM=n=>oc(n,iM,HT),aM=n=>oc(n,"position",HT),lM=new Set(["image","url"]),cM=n=>oc(n,lM,fM),uM=n=>oc(n,"",hM),$c=()=>!0,oc=(n,e,t)=>{const r=WT.exec(n);return r?r[1]?typeof e=="string"?r[1]===e:e.has(r[1]):t(r[2]):!1},dM=n=>eM.test(n)&&!tM.test(n),HT=()=>!1,hM=n=>nM.test(n),fM=n=>rM.test(n),pM=()=>{const n=wt("colors"),e=wt("spacing"),t=wt("blur"),r=wt("brightness"),s=wt("borderColor"),i=wt("borderRadius"),o=wt("borderSpacing"),a=wt("borderWidth"),l=wt("contrast"),c=wt("grayscale"),u=wt("hueRotate"),h=wt("invert"),d=wt("gap"),p=wt("gradientColorStops"),m=wt("gradientColorStopPositions"),g=wt("inset"),y=wt("margin"),x=wt("opacity"),v=wt("padding"),w=wt("saturate"),_=wt("scale"),S=wt("sepia"),E=wt("skew"),C=wt("space"),P=wt("translate"),O=()=>["auto","contain","none"],A=()=>["auto","hidden","clip","visible","scroll"],R=()=>["auto",$e,e],B=()=>[$e,e],I=()=>["",Es,yi],L=()=>["auto",gl,$e],U=()=>["bottom","center","left","left-bottom","left-top","right","right-bottom","right-top","top"],F=()=>["solid","dashed","dotted","double","none"],D=()=>["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"],k=()=>["start","end","center","between","around","evenly","stretch"],N=()=>["","0",$e],M=()=>["auto","avoid","all","avoid-page","page","left","right","column"],T=()=>[gl,$e];return{cacheSize:500,separator:":",theme:{colors:[$c],spacing:[Es,yi],blur:["none","",xi,$e],brightness:T(),borderColor:[n],borderRadius:["none","","full",xi,$e],borderSpacing:B(),borderWidth:I(),contrast:T(),grayscale:N(),hueRotate:T(),invert:N(),gap:B(),gradientColorStops:[n],gradientColorStopPositions:[sM,yi],inset:R(),margin:R(),opacity:T(),padding:B(),saturate:T(),scale:T(),sepia:N(),skew:T(),space:B(),translate:B()},classGroups:{aspect:[{aspect:["auto","square","video",$e]}],container:["container"],columns:[{columns:[xi]}],"break-after":[{"break-after":M()}],"break-before":[{"break-before":M()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],float:[{float:["right","left","none","start","end"]}],clear:[{clear:["left","right","both","none","start","end"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:[...U(),$e]}],overflow:[{overflow:A()}],"overflow-x":[{"overflow-x":A()}],"overflow-y":[{"overflow-y":A()}],overscroll:[{overscroll:O()}],"overscroll-x":[{"overscroll-x":O()}],"overscroll-y":[{"overscroll-y":O()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:[g]}],"inset-x":[{"inset-x":[g]}],"inset-y":[{"inset-y":[g]}],start:[{start:[g]}],end:[{end:[g]}],top:[{top:[g]}],right:[{right:[g]}],bottom:[{bottom:[g]}],left:[{left:[g]}],visibility:["visible","invisible","collapse"],z:[{z:["auto",Uc,$e]}],basis:[{basis:R()}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["wrap","wrap-reverse","nowrap"]}],flex:[{flex:["1","auto","initial","none",$e]}],grow:[{grow:N()}],shrink:[{shrink:N()}],order:[{order:["first","last","none",Uc,$e]}],"grid-cols":[{"grid-cols":[$c]}],"col-start-end":[{col:["auto",{span:["full",Uc,$e]},$e]}],"col-start":[{"col-start":L()}],"col-end":[{"col-end":L()}],"grid-rows":[{"grid-rows":[$c]}],"row-start-end":[{row:["auto",{span:[Uc,$e]},$e]}],"row-start":[{"row-start":L()}],"row-end":[{"row-end":L()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":["auto","min","max","fr",$e]}],"auto-rows":[{"auto-rows":["auto","min","max","fr",$e]}],gap:[{gap:[d]}],"gap-x":[{"gap-x":[d]}],"gap-y":[{"gap-y":[d]}],"justify-content":[{justify:["normal",...k()]}],"justify-items":[{"justify-items":["start","end","center","stretch"]}],"justify-self":[{"justify-self":["auto","start","end","center","stretch"]}],"align-content":[{content:["normal",...k(),"baseline"]}],"align-items":[{items:["start","end","center","baseline","stretch"]}],"align-self":[{self:["auto","start","end","center","stretch","baseline"]}],"place-content":[{"place-content":[...k(),"baseline"]}],"place-items":[{"place-items":["start","end","center","baseline","stretch"]}],"place-self":[{"place-self":["auto","start","end","center","stretch"]}],p:[{p:[v]}],px:[{px:[v]}],py:[{py:[v]}],ps:[{ps:[v]}],pe:[{pe:[v]}],pt:[{pt:[v]}],pr:[{pr:[v]}],pb:[{pb:[v]}],pl:[{pl:[v]}],m:[{m:[y]}],mx:[{mx:[y]}],my:[{my:[y]}],ms:[{ms:[y]}],me:[{me:[y]}],mt:[{mt:[y]}],mr:[{mr:[y]}],mb:[{mb:[y]}],ml:[{ml:[y]}],"space-x":[{"space-x":[C]}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":[C]}],"space-y-reverse":["space-y-reverse"],w:[{w:["auto","min","max","fit","svw","lvw","dvw",$e,e]}],"min-w":[{"min-w":[$e,e,"min","max","fit"]}],"max-w":[{"max-w":[$e,e,"none","full","min","max","fit","prose",{screen:[xi]},xi]}],h:[{h:[$e,e,"auto","min","max","fit","svh","lvh","dvh"]}],"min-h":[{"min-h":[$e,e,"min","max","fit","svh","lvh","dvh"]}],"max-h":[{"max-h":[$e,e,"min","max","fit","svh","lvh","dvh"]}],size:[{size:[$e,e,"auto","min","max","fit"]}],"font-size":[{text:["base",xi,yi]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:["thin","extralight","light","normal","medium","semibold","bold","extrabold","black",Eg]}],"font-family":[{font:[$c]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractons"],tracking:[{tracking:["tighter","tight","normal","wide","wider","widest",$e]}],"line-clamp":[{"line-clamp":["none",gl,Eg]}],leading:[{leading:["none","tight","snug","normal","relaxed","loose",Es,$e]}],"list-image":[{"list-image":["none",$e]}],"list-style-type":[{list:["none","disc","decimal",$e]}],"list-style-position":[{list:["inside","outside"]}],"placeholder-color":[{placeholder:[n]}],"placeholder-opacity":[{"placeholder-opacity":[x]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"text-color":[{text:[n]}],"text-opacity":[{"text-opacity":[x]}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[...F(),"wavy"]}],"text-decoration-thickness":[{decoration:["auto","from-font",Es,yi]}],"underline-offset":[{"underline-offset":["auto",Es,$e]}],"text-decoration-color":[{decoration:[n]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],"text-wrap":[{text:["wrap","nowrap","balance","pretty"]}],indent:[{indent:B()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",$e]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",$e]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-opacity":[{"bg-opacity":[x]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:[...U(),aM]}],"bg-repeat":[{bg:["no-repeat",{repeat:["","x","y","round","space"]}]}],"bg-size":[{bg:["auto","cover","contain",oM]}],"bg-image":[{bg:["none",{"gradient-to":["t","tr","r","br","b","bl","l","tl"]},cM]}],"bg-color":[{bg:[n]}],"gradient-from-pos":[{from:[m]}],"gradient-via-pos":[{via:[m]}],"gradient-to-pos":[{to:[m]}],"gradient-from":[{from:[p]}],"gradient-via":[{via:[p]}],"gradient-to":[{to:[p]}],rounded:[{rounded:[i]}],"rounded-s":[{"rounded-s":[i]}],"rounded-e":[{"rounded-e":[i]}],"rounded-t":[{"rounded-t":[i]}],"rounded-r":[{"rounded-r":[i]}],"rounded-b":[{"rounded-b":[i]}],"rounded-l":[{"rounded-l":[i]}],"rounded-ss":[{"rounded-ss":[i]}],"rounded-se":[{"rounded-se":[i]}],"rounded-ee":[{"rounded-ee":[i]}],"rounded-es":[{"rounded-es":[i]}],"rounded-tl":[{"rounded-tl":[i]}],"rounded-tr":[{"rounded-tr":[i]}],"rounded-br":[{"rounded-br":[i]}],"rounded-bl":[{"rounded-bl":[i]}],"border-w":[{border:[a]}],"border-w-x":[{"border-x":[a]}],"border-w-y":[{"border-y":[a]}],"border-w-s":[{"border-s":[a]}],"border-w-e":[{"border-e":[a]}],"border-w-t":[{"border-t":[a]}],"border-w-r":[{"border-r":[a]}],"border-w-b":[{"border-b":[a]}],"border-w-l":[{"border-l":[a]}],"border-opacity":[{"border-opacity":[x]}],"border-style":[{border:[...F(),"hidden"]}],"divide-x":[{"divide-x":[a]}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":[a]}],"divide-y-reverse":["divide-y-reverse"],"divide-opacity":[{"divide-opacity":[x]}],"divide-style":[{divide:F()}],"border-color":[{border:[s]}],"border-color-x":[{"border-x":[s]}],"border-color-y":[{"border-y":[s]}],"border-color-s":[{"border-s":[s]}],"border-color-e":[{"border-e":[s]}],"border-color-t":[{"border-t":[s]}],"border-color-r":[{"border-r":[s]}],"border-color-b":[{"border-b":[s]}],"border-color-l":[{"border-l":[s]}],"divide-color":[{divide:[s]}],"outline-style":[{outline:["",...F()]}],"outline-offset":[{"outline-offset":[Es,$e]}],"outline-w":[{outline:[Es,yi]}],"outline-color":[{outline:[n]}],"ring-w":[{ring:I()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:[n]}],"ring-opacity":[{"ring-opacity":[x]}],"ring-offset-w":[{"ring-offset":[Es,yi]}],"ring-offset-color":[{"ring-offset":[n]}],shadow:[{shadow:["","inner","none",xi,uM]}],"shadow-color":[{shadow:[$c]}],opacity:[{opacity:[x]}],"mix-blend":[{"mix-blend":[...D(),"plus-lighter","plus-darker"]}],"bg-blend":[{"bg-blend":D()}],filter:[{filter:["","none"]}],blur:[{blur:[t]}],brightness:[{brightness:[r]}],contrast:[{contrast:[l]}],"drop-shadow":[{"drop-shadow":["","none",xi,$e]}],grayscale:[{grayscale:[c]}],"hue-rotate":[{"hue-rotate":[u]}],invert:[{invert:[h]}],saturate:[{saturate:[w]}],sepia:[{sepia:[S]}],"backdrop-filter":[{"backdrop-filter":["","none"]}],"backdrop-blur":[{"backdrop-blur":[t]}],"backdrop-brightness":[{"backdrop-brightness":[r]}],"backdrop-contrast":[{"backdrop-contrast":[l]}],"backdrop-grayscale":[{"backdrop-grayscale":[c]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[u]}],"backdrop-invert":[{"backdrop-invert":[h]}],"backdrop-opacity":[{"backdrop-opacity":[x]}],"backdrop-saturate":[{"backdrop-saturate":[w]}],"backdrop-sepia":[{"backdrop-sepia":[S]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":[o]}],"border-spacing-x":[{"border-spacing-x":[o]}],"border-spacing-y":[{"border-spacing-y":[o]}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["none","all","","colors","opacity","shadow","transform",$e]}],duration:[{duration:T()}],ease:[{ease:["linear","in","out","in-out",$e]}],delay:[{delay:T()}],animate:[{animate:["none","spin","ping","pulse","bounce",$e]}],transform:[{transform:["","gpu","none"]}],scale:[{scale:[_]}],"scale-x":[{"scale-x":[_]}],"scale-y":[{"scale-y":[_]}],rotate:[{rotate:[Uc,$e]}],"translate-x":[{"translate-x":[P]}],"translate-y":[{"translate-y":[P]}],"skew-x":[{"skew-x":[E]}],"skew-y":[{"skew-y":[E]}],"transform-origin":[{origin:["center","top","top-right","right","bottom-right","bottom","bottom-left","left","top-left",$e]}],accent:[{accent:["auto",n]}],appearance:[{appearance:["none","auto"]}],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",$e]}],"caret-color":[{caret:[n]}],"pointer-events":[{"pointer-events":["none","auto"]}],resize:[{resize:["none","y","x",""]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":B()}],"scroll-mx":[{"scroll-mx":B()}],"scroll-my":[{"scroll-my":B()}],"scroll-ms":[{"scroll-ms":B()}],"scroll-me":[{"scroll-me":B()}],"scroll-mt":[{"scroll-mt":B()}],"scroll-mr":[{"scroll-mr":B()}],"scroll-mb":[{"scroll-mb":B()}],"scroll-ml":[{"scroll-ml":B()}],"scroll-p":[{"scroll-p":B()}],"scroll-px":[{"scroll-px":B()}],"scroll-py":[{"scroll-py":B()}],"scroll-ps":[{"scroll-ps":B()}],"scroll-pe":[{"scroll-pe":B()}],"scroll-pt":[{"scroll-pt":B()}],"scroll-pr":[{"scroll-pr":B()}],"scroll-pb":[{"scroll-pb":B()}],"scroll-pl":[{"scroll-pl":B()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","manipulation"]}],"touch-x":[{"touch-pan":["x","left","right"]}],"touch-y":[{"touch-pan":["y","up","down"]}],"touch-pz":["touch-pinch-zoom"],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",$e]}],fill:[{fill:[n,"none"]}],"stroke-w":[{stroke:[Es,yi,Eg]}],stroke:[{stroke:[n,"none"]}],sr:["sr-only","not-sr-only"],"forced-color-adjust":[{"forced-color-adjust":["auto","none"]}]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],size:["w","h"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],"line-clamp":["display","overflow"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-s","border-color-e","border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"],touch:["touch-x","touch-y","touch-pz"],"touch-x":["touch"],"touch-y":["touch"],"touch-pz":["touch"]},conflictingClassGroupModifiers:{"font-size":["leading"]}}},gM=KL(pM);function Oe(...n){return gM(RT(n))}function hy(n){if(typeof n!="string")return n;const e=document.createElement("textarea");return e.innerHTML=n,e.value}const mM=mL,VT=b.forwardRef(({className:n,...e},t)=>f.jsx(kT,{ref:t,className:Oe("fixed top-0 z-[100] flex max-h-screen w-full flex-col-reverse p-4 sm:bottom-0 sm:right-0 sm:top-auto sm:flex-col md:max-w-[420px]",n),...e}));VT.displayName=kT.displayName;const vM=wd("group pointer-events-auto relative flex w-full items-center justify-between space-x-4 overflow-hidden rounded-md border p-6 pr-8 shadow-lg transition-all data-[swipe=cancel]:translate-x-0 data-[swipe=end]:translate-x-[var(--radix-toast-swipe-end-x)] data-[swipe=move]:translate-x-[var(--radix-toast-swipe-move-x)] data-[swipe=move]:transition-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[swipe=end]:animate-out data-[state=closed]:fade-out-80 data-[state=closed]:slide-out-to-right-full data-[state=open]:slide-in-from-top-full data-[state=open]:sm:slide-in-from-bottom-full",{variants:{variant:{default:"border bg-background text-foreground",destructive:"destructive group border-destructive bg-destructive text-destructive-foreground"}},defaultVariants:{variant:"default"}}),GT=b.forwardRef(({className:n,variant:e,...t},r)=>f.jsx(PT,{ref:r,className:Oe(vM({variant:e}),n),...t}));GT.displayName=PT.displayName;const yM=b.forwardRef(({className:n,...e},t)=>f.jsx(DT,{ref:t,className:Oe("inline-flex h-12 shrink-0 items-center justify-center rounded-md border bg-transparent px-3 text-sm font-medium ring-offset-background transition-colors hover:bg-secondary focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 group-[.destructive]:border-muted/40 group-[.destructive]:hover:border-destructive/30 group-[.destructive]:hover:bg-destructive group-[.destructive]:hover:text-destructive-foreground group-[.destructive]:focus:ring-destructive",n),...e}));yM.displayName=DT.displayName;const qT=b.forwardRef(({className:n,...e},t)=>f.jsx(OT,{ref:t,className:Oe("absolute right-2 top-2 rounded-md p-1 text-foreground/50 opacity-0 transition-opacity hover:text-foreground focus:opacity-100 focus:outline-none focus:ring-2 group-hover:opacity-100 group-[.destructive]:text-red-300 group-[.destructive]:hover:text-red-50 group-[.destructive]:focus:ring-red-400 group-[.destructive]:focus:ring-offset-red-600",n),"toast-close":"",...e,children:f.jsx(ha,{className:"h-4 w-4"})}));qT.displayName=OT.displayName;const YT=b.forwardRef(({className:n,...e},t)=>f.jsx(TT,{ref:t,className:Oe("text-sm font-semibold",n),...e}));YT.displayName=TT.displayName;const XT=b.forwardRef(({className:n,...e},t)=>f.jsx(AT,{ref:t,className:Oe("text-sm opacity-90",n),...e}));XT.displayName=AT.displayName;function xM(){const{toasts:n}=Bt();return f.jsxs(mM,{children:[n.map(function({id:e,title:t,description:r,action:s,...i}){return f.jsxs(GT,{...i,children:[f.jsxs("div",{className:"grid gap-1",children:[t&&f.jsx(YT,{children:t}),r&&f.jsx(XT,{children:r})]}),s,f.jsx(qT,{})]},e)}),f.jsx(VT,{})]})}var Xf=["light","dark"],Pw="(prefers-color-scheme: dark)",wM=typeof window>"u",Tw=b.createContext(void 0),bM={setTheme:n=>{},themes:[]},_M=()=>{var n;return(n=b.useContext(Tw))!=null?n:bM},SM=n=>b.useContext(Tw)?n.children:b.createElement(EM,{...n}),CM=["light","dark"],EM=({forcedTheme:n,disableTransitionOnChange:e=!1,enableSystem:t=!0,enableColorScheme:r=!0,storageKey:s="theme",themes:i=CM,defaultTheme:o=t?"system":"light",attribute:a="data-theme",value:l,children:c,nonce:u})=>{let[h,d]=b.useState(()=>K_(s,o)),[p,m]=b.useState(()=>K_(s)),g=l?Object.values(l):i,y=b.useCallback(_=>{let S=_;if(!S)return;_==="system"&&t&&(S=J_());let E=l?l[S]:S,C=e?PM():null,P=document.documentElement;if(a==="class"?(P.classList.remove(...g),E&&P.classList.add(E)):E?P.setAttribute(a,E):P.removeAttribute(a),r){let O=Xf.includes(o)?o:null,A=Xf.includes(S)?S:O;P.style.colorScheme=A}C==null||C()},[]),x=b.useCallback(_=>{let S=typeof _=="function"?_(_):_;d(S);try{localStorage.setItem(s,S)}catch{}},[n]),v=b.useCallback(_=>{let S=J_(_);m(S),h==="system"&&t&&!n&&y("system")},[h,n]);b.useEffect(()=>{let _=window.matchMedia(Pw);return _.addListener(v),v(_),()=>_.removeListener(v)},[v]),b.useEffect(()=>{let _=S=>{if(S.key!==s)return;let E=S.newValue||o;x(E)};return window.addEventListener("storage",_),()=>window.removeEventListener("storage",_)},[x]),b.useEffect(()=>{y(n??h)},[n,h]);let w=b.useMemo(()=>({theme:h,setTheme:x,forcedTheme:n,resolvedTheme:h==="system"?p:h,themes:t?[...i,"system"]:i,systemTheme:t?p:void 0}),[h,x,n,p,t,i]);return b.createElement(Tw.Provider,{value:w},b.createElement(kM,{forcedTheme:n,disableTransitionOnChange:e,enableSystem:t,enableColorScheme:r,storageKey:s,themes:i,defaultTheme:o,attribute:a,value:l,children:c,attrs:g,nonce:u}),c)},kM=b.memo(({forcedTheme:n,storageKey:e,attribute:t,enableSystem:r,enableColorScheme:s,defaultTheme:i,value:o,attrs:a,nonce:l})=>{let c=i==="system",u=t==="class"?`var d=document.documentElement,c=d.classList;${`c.remove(${a.map(m=>`'${m}'`).join(",")})`};`:`var d=document.documentElement,n='${t}',s='setAttribute';`,h=s?Xf.includes(i)&&i?`if(e==='light'||e==='dark'||!e)d.style.colorScheme=e||'${i}'`:"if(e==='light'||e==='dark')d.style.colorScheme=e":"",d=(m,g=!1,y=!0)=>{let x=o?o[m]:m,v=g?m+"|| ''":`'${x}'`,w="";return s&&y&&!g&&Xf.includes(m)&&(w+=`d.style.colorScheme = '${m}';`),t==="class"?g||x?w+=`c.add(${v})`:w+="null":x&&(w+=`d[s](n,${v})`),w},p=n?`!function(){${u}${d(n)}}()`:r?`!function(){try{${u}var e=localStorage.getItem('${e}');if('system'===e||(!e&&${c})){var t='${Pw}',m=window.matchMedia(t);if(m.media!==t||m.matches){${d("dark")}}else{${d("light")}}}else if(e){${o?`var x=${JSON.stringify(o)};`:""}${d(o?"x[e]":"e",!0)}}${c?"":"else{"+d(i,!1,!1)+"}"}${h}}catch(e){}}()`:`!function(){try{${u}var e=localStorage.getItem('${e}');if(e){${o?`var x=${JSON.stringify(o)};`:""}${d(o?"x[e]":"e",!0)}}else{${d(i,!1,!1)};}${h}}catch(t){}}();`;return b.createElement("script",{nonce:l,dangerouslySetInnerHTML:{__html:p}})}),K_=(n,e)=>{if(wM)return;let t;try{t=localStorage.getItem(n)||void 0}catch{}return t||e},PM=()=>{let n=document.createElement("style");return n.appendChild(document.createTextNode("*{-webkit-transition:none!important;-moz-transition:none!important;-o-transition:none!important;-ms-transition:none!important;transition:none!important}")),document.head.appendChild(n),()=>{window.getComputedStyle(document.body),setTimeout(()=>{document.head.removeChild(n)},1)}},J_=n=>(n||(n=window.matchMedia(Pw)),n.matches?"dark":"light"),TM=n=>{switch(n){case"success":return OM;case"info":return RM;case"warning":return IM;case"error":return NM;default:return null}},AM=Array(12).fill(0),DM=({visible:n})=>Y.createElement("div",{className:"sonner-loading-wrapper","data-visible":n},Y.createElement("div",{className:"sonner-spinner"},AM.map((e,t)=>Y.createElement("div",{className:"sonner-loading-bar",key:`spinner-bar-${t}`})))),OM=Y.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},Y.createElement("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.857-9.809a.75.75 0 00-1.214-.882l-3.483 4.79-1.88-1.88a.75.75 0 10-1.06 1.061l2.5 2.5a.75.75 0 001.137-.089l4-5.5z",clipRule:"evenodd"})),IM=Y.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",height:"20",width:"20"},Y.createElement("path",{fillRule:"evenodd",d:"M9.401 3.003c1.155-2 4.043-2 5.197 0l7.355 12.748c1.154 2-.29 4.5-2.599 4.5H4.645c-2.309 0-3.752-2.5-2.598-4.5L9.4 3.003zM12 8.25a.75.75 0 01.75.75v3.75a.75.75 0 01-1.5 0V9a.75.75 0 01.75-.75zm0 8.25a.75.75 0 100-1.5.75.75 0 000 1.5z",clipRule:"evenodd"})),RM=Y.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},Y.createElement("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a.75.75 0 000 1.5h.253a.25.25 0 01.244.304l-.459 2.066A1.75 1.75 0 0010.747 15H11a.75.75 0 000-1.5h-.253a.25.25 0 01-.244-.304l.459-2.066A1.75 1.75 0 009.253 9H9z",clipRule:"evenodd"})),NM=Y.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},Y.createElement("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-8-5a.75.75 0 01.75.75v4.5a.75.75 0 01-1.5 0v-4.5A.75.75 0 0110 5zm0 10a1 1 0 100-2 1 1 0 000 2z",clipRule:"evenodd"})),jM=()=>{let[n,e]=Y.useState(document.hidden);return Y.useEffect(()=>{let t=()=>{e(document.hidden)};return document.addEventListener("visibilitychange",t),()=>window.removeEventListener("visibilitychange",t)},[]),n},fy=1,LM=class{constructor(){this.subscribe=e=>(this.subscribers.push(e),()=>{let t=this.subscribers.indexOf(e);this.subscribers.splice(t,1)}),this.publish=e=>{this.subscribers.forEach(t=>t(e))},this.addToast=e=>{this.publish(e),this.toasts=[...this.toasts,e]},this.create=e=>{var t;let{message:r,...s}=e,i=typeof(e==null?void 0:e.id)=="number"||((t=e.id)==null?void 0:t.length)>0?e.id:fy++,o=this.toasts.find(l=>l.id===i),a=e.dismissible===void 0?!0:e.dismissible;return o?this.toasts=this.toasts.map(l=>l.id===i?(this.publish({...l,...e,id:i,title:r}),{...l,...e,id:i,dismissible:a,title:r}):l):this.addToast({title:r,...s,dismissible:a,id:i}),i},this.dismiss=e=>(e||this.toasts.forEach(t=>{this.subscribers.forEach(r=>r({id:t.id,dismiss:!0}))}),this.subscribers.forEach(t=>t({id:e,dismiss:!0})),e),this.message=(e,t)=>this.create({...t,message:e}),this.error=(e,t)=>this.create({...t,message:e,type:"error"}),this.success=(e,t)=>this.create({...t,type:"success",message:e}),this.info=(e,t)=>this.create({...t,type:"info",message:e}),this.warning=(e,t)=>this.create({...t,type:"warning",message:e}),this.loading=(e,t)=>this.create({...t,type:"loading",message:e}),this.promise=(e,t)=>{if(!t)return;let r;t.loading!==void 0&&(r=this.create({...t,promise:e,type:"loading",message:t.loading,description:typeof t.description!="function"?t.description:void 0}));let s=e instanceof Promise?e:e(),i=r!==void 0;return s.then(async o=>{if(FM(o)&&!o.ok){i=!1;let a=typeof t.error=="function"?await t.error(`HTTP error! status: ${o.status}`):t.error,l=typeof t.description=="function"?await t.description(`HTTP error! status: ${o.status}`):t.description;this.create({id:r,type:"error",message:a,description:l})}else if(t.success!==void 0){i=!1;let a=typeof t.success=="function"?await t.success(o):t.success,l=typeof t.description=="function"?await t.description(o):t.description;this.create({id:r,type:"success",message:a,description:l})}}).catch(async o=>{if(t.error!==void 0){i=!1;let a=typeof t.error=="function"?await t.error(o):t.error,l=typeof t.description=="function"?await t.description(o):t.description;this.create({id:r,type:"error",message:a,description:l})}}).finally(()=>{var o;i&&(this.dismiss(r),r=void 0),(o=t.finally)==null||o.call(t)}),r},this.custom=(e,t)=>{let r=(t==null?void 0:t.id)||fy++;return this.create({jsx:e(r),id:r,...t}),r},this.subscribers=[],this.toasts=[]}},ar=new LM,MM=(n,e)=>{let t=(e==null?void 0:e.id)||fy++;return ar.addToast({title:n,...e,id:t}),t},FM=n=>n&&typeof n=="object"&&"ok"in n&&typeof n.ok=="boolean"&&"status"in n&&typeof n.status=="number",BM=MM,UM=()=>ar.toasts,zZ=Object.assign(BM,{success:ar.success,info:ar.info,warning:ar.warning,error:ar.error,custom:ar.custom,message:ar.message,promise:ar.promise,dismiss:ar.dismiss,loading:ar.loading},{getHistory:UM});function $M(n,{insertAt:e}={}){if(typeof document>"u")return;let t=document.head||document.getElementsByTagName("head")[0],r=document.createElement("style");r.type="text/css",e==="top"&&t.firstChild?t.insertBefore(r,t.firstChild):t.appendChild(r),r.styleSheet?r.styleSheet.cssText=n:r.appendChild(document.createTextNode(n))}$M(`:where(html[dir="ltr"]),:where([data-sonner-toaster][dir="ltr"]){--toast-icon-margin-start: -3px;--toast-icon-margin-end: 4px;--toast-svg-margin-start: -1px;--toast-svg-margin-end: 0px;--toast-button-margin-start: auto;--toast-button-margin-end: 0;--toast-close-button-start: 0;--toast-close-button-end: unset;--toast-close-button-transform: translate(-35%, -35%)}:where(html[dir="rtl"]),:where([data-sonner-toaster][dir="rtl"]){--toast-icon-margin-start: 4px;--toast-icon-margin-end: -3px;--toast-svg-margin-start: 0px;--toast-svg-margin-end: -1px;--toast-button-margin-start: 0;--toast-button-margin-end: auto;--toast-close-button-start: unset;--toast-close-button-end: 0;--toast-close-button-transform: translate(35%, -35%)}:where([data-sonner-toaster]){position:fixed;width:var(--width);font-family:ui-sans-serif,system-ui,-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Arial,Noto Sans,sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol,Noto Color Emoji;--gray1: hsl(0, 0%, 99%);--gray2: hsl(0, 0%, 97.3%);--gray3: hsl(0, 0%, 95.1%);--gray4: hsl(0, 0%, 93%);--gray5: hsl(0, 0%, 90.9%);--gray6: hsl(0, 0%, 88.7%);--gray7: hsl(0, 0%, 85.8%);--gray8: hsl(0, 0%, 78%);--gray9: hsl(0, 0%, 56.1%);--gray10: hsl(0, 0%, 52.3%);--gray11: hsl(0, 0%, 43.5%);--gray12: hsl(0, 0%, 9%);--border-radius: 8px;box-sizing:border-box;padding:0;margin:0;list-style:none;outline:none;z-index:999999999}:where([data-sonner-toaster][data-x-position="right"]){right:max(var(--offset),env(safe-area-inset-right))}:where([data-sonner-toaster][data-x-position="left"]){left:max(var(--offset),env(safe-area-inset-left))}:where([data-sonner-toaster][data-x-position="center"]){left:50%;transform:translate(-50%)}:where([data-sonner-toaster][data-y-position="top"]){top:max(var(--offset),env(safe-area-inset-top))}:where([data-sonner-toaster][data-y-position="bottom"]){bottom:max(var(--offset),env(safe-area-inset-bottom))}:where([data-sonner-toast]){--y: translateY(100%);--lift-amount: calc(var(--lift) * var(--gap));z-index:var(--z-index);position:absolute;opacity:0;transform:var(--y);filter:blur(0);touch-action:none;transition:transform .4s,opacity .4s,height .4s,box-shadow .2s;box-sizing:border-box;outline:none;overflow-wrap:anywhere}:where([data-sonner-toast][data-styled="true"]){padding:16px;background:var(--normal-bg);border:1px solid var(--normal-border);color:var(--normal-text);border-radius:var(--border-radius);box-shadow:0 4px 12px #0000001a;width:var(--width);font-size:13px;display:flex;align-items:center;gap:6px}:where([data-sonner-toast]:focus-visible){box-shadow:0 4px 12px #0000001a,0 0 0 2px #0003}:where([data-sonner-toast][data-y-position="top"]){top:0;--y: translateY(-100%);--lift: 1;--lift-amount: calc(1 * var(--gap))}:where([data-sonner-toast][data-y-position="bottom"]){bottom:0;--y: translateY(100%);--lift: -1;--lift-amount: calc(var(--lift) * var(--gap))}:where([data-sonner-toast]) :where([data-description]){font-weight:400;line-height:1.4;color:inherit}:where([data-sonner-toast]) :where([data-title]){font-weight:500;line-height:1.5;color:inherit}:where([data-sonner-toast]) :where([data-icon]){display:flex;height:16px;width:16px;position:relative;justify-content:flex-start;align-items:center;flex-shrink:0;margin-left:var(--toast-icon-margin-start);margin-right:var(--toast-icon-margin-end)}:where([data-sonner-toast][data-promise="true"]) :where([data-icon])>svg{opacity:0;transform:scale(.8);transform-origin:center;animation:sonner-fade-in .3s ease forwards}:where([data-sonner-toast]) :where([data-icon])>*{flex-shrink:0}:where([data-sonner-toast]) :where([data-icon]) svg{margin-left:var(--toast-svg-margin-start);margin-right:var(--toast-svg-margin-end)}:where([data-sonner-toast]) :where([data-content]){display:flex;flex-direction:column;gap:2px}[data-sonner-toast][data-styled=true] [data-button]{border-radius:4px;padding-left:8px;padding-right:8px;height:24px;font-size:12px;color:var(--normal-bg);background:var(--normal-text);margin-left:var(--toast-button-margin-start);margin-right:var(--toast-button-margin-end);border:none;cursor:pointer;outline:none;display:flex;align-items:center;flex-shrink:0;transition:opacity .4s,box-shadow .2s}:where([data-sonner-toast]) :where([data-button]):focus-visible{box-shadow:0 0 0 2px #0006}:where([data-sonner-toast]) :where([data-button]):first-of-type{margin-left:var(--toast-button-margin-start);margin-right:var(--toast-button-margin-end)}:where([data-sonner-toast]) :where([data-cancel]){color:var(--normal-text);background:rgba(0,0,0,.08)}:where([data-sonner-toast][data-theme="dark"]) :where([data-cancel]){background:rgba(255,255,255,.3)}:where([data-sonner-toast]) :where([data-close-button]){position:absolute;left:var(--toast-close-button-start);right:var(--toast-close-button-end);top:0;height:20px;width:20px;display:flex;justify-content:center;align-items:center;padding:0;background:var(--gray1);color:var(--gray12);border:1px solid var(--gray4);transform:var(--toast-close-button-transform);border-radius:50%;cursor:pointer;z-index:1;transition:opacity .1s,background .2s,border-color .2s}:where([data-sonner-toast]) :where([data-close-button]):focus-visible{box-shadow:0 4px 12px #0000001a,0 0 0 2px #0003}:where([data-sonner-toast]) :where([data-disabled="true"]){cursor:not-allowed}:where([data-sonner-toast]):hover :where([data-close-button]):hover{background:var(--gray2);border-color:var(--gray5)}:where([data-sonner-toast][data-swiping="true"]):before{content:"";position:absolute;left:0;right:0;height:100%;z-index:-1}:where([data-sonner-toast][data-y-position="top"][data-swiping="true"]):before{bottom:50%;transform:scaleY(3) translateY(50%)}:where([data-sonner-toast][data-y-position="bottom"][data-swiping="true"]):before{top:50%;transform:scaleY(3) translateY(-50%)}:where([data-sonner-toast][data-swiping="false"][data-removed="true"]):before{content:"";position:absolute;inset:0;transform:scaleY(2)}:where([data-sonner-toast]):after{content:"";position:absolute;left:0;height:calc(var(--gap) + 1px);bottom:100%;width:100%}:where([data-sonner-toast][data-mounted="true"]){--y: translateY(0);opacity:1}:where([data-sonner-toast][data-expanded="false"][data-front="false"]){--scale: var(--toasts-before) * .05 + 1;--y: translateY(calc(var(--lift-amount) * var(--toasts-before))) scale(calc(-1 * var(--scale)));height:var(--front-toast-height)}:where([data-sonner-toast])>*{transition:opacity .4s}:where([data-sonner-toast][data-expanded="false"][data-front="false"][data-styled="true"])>*{opacity:0}:where([data-sonner-toast][data-visible="false"]){opacity:0;pointer-events:none}:where([data-sonner-toast][data-mounted="true"][data-expanded="true"]){--y: translateY(calc(var(--lift) * var(--offset)));height:var(--initial-height)}:where([data-sonner-toast][data-removed="true"][data-front="true"][data-swipe-out="false"]){--y: translateY(calc(var(--lift) * -100%));opacity:0}:where([data-sonner-toast][data-removed="true"][data-front="false"][data-swipe-out="false"][data-expanded="true"]){--y: translateY(calc(var(--lift) * var(--offset) + var(--lift) * -100%));opacity:0}:where([data-sonner-toast][data-removed="true"][data-front="false"][data-swipe-out="false"][data-expanded="false"]){--y: translateY(40%);opacity:0;transition:transform .5s,opacity .2s}:where([data-sonner-toast][data-removed="true"][data-front="false"]):before{height:calc(var(--initial-height) + 20%)}[data-sonner-toast][data-swiping=true]{transform:var(--y) translateY(var(--swipe-amount, 0px));transition:none}[data-sonner-toast][data-swipe-out=true][data-y-position=bottom],[data-sonner-toast][data-swipe-out=true][data-y-position=top]{animation:swipe-out .2s ease-out forwards}@keyframes swipe-out{0%{transform:translateY(calc(var(--lift) * var(--offset) + var(--swipe-amount)));opacity:1}to{transform:translateY(calc(var(--lift) * var(--offset) + var(--swipe-amount) + var(--lift) * -100%));opacity:0}}@media (max-width: 600px){[data-sonner-toaster]{position:fixed;--mobile-offset: 16px;right:var(--mobile-offset);left:var(--mobile-offset);width:100%}[data-sonner-toaster] [data-sonner-toast]{left:0;right:0;width:calc(100% - var(--mobile-offset) * 2)}[data-sonner-toaster][data-x-position=left]{left:var(--mobile-offset)}[data-sonner-toaster][data-y-position=bottom]{bottom:20px}[data-sonner-toaster][data-y-position=top]{top:20px}[data-sonner-toaster][data-x-position=center]{left:var(--mobile-offset);right:var(--mobile-offset);transform:none}}[data-sonner-toaster][data-theme=light]{--normal-bg: #fff;--normal-border: var(--gray4);--normal-text: var(--gray12);--success-bg: hsl(143, 85%, 96%);--success-border: hsl(145, 92%, 91%);--success-text: hsl(140, 100%, 27%);--info-bg: hsl(208, 100%, 97%);--info-border: hsl(221, 91%, 91%);--info-text: hsl(210, 92%, 45%);--warning-bg: hsl(49, 100%, 97%);--warning-border: hsl(49, 91%, 91%);--warning-text: hsl(31, 92%, 45%);--error-bg: hsl(359, 100%, 97%);--error-border: hsl(359, 100%, 94%);--error-text: hsl(360, 100%, 45%)}[data-sonner-toaster][data-theme=light] [data-sonner-toast][data-invert=true]{--normal-bg: #000;--normal-border: hsl(0, 0%, 20%);--normal-text: var(--gray1)}[data-sonner-toaster][data-theme=dark] [data-sonner-toast][data-invert=true]{--normal-bg: #fff;--normal-border: var(--gray3);--normal-text: var(--gray12)}[data-sonner-toaster][data-theme=dark]{--normal-bg: #000;--normal-border: hsl(0, 0%, 20%);--normal-text: var(--gray1);--success-bg: hsl(150, 100%, 6%);--success-border: hsl(147, 100%, 12%);--success-text: hsl(150, 86%, 65%);--info-bg: hsl(215, 100%, 6%);--info-border: hsl(223, 100%, 12%);--info-text: hsl(216, 87%, 65%);--warning-bg: hsl(64, 100%, 6%);--warning-border: hsl(60, 100%, 12%);--warning-text: hsl(46, 87%, 65%);--error-bg: hsl(358, 76%, 10%);--error-border: hsl(357, 89%, 16%);--error-text: hsl(358, 100%, 81%)}[data-rich-colors=true][data-sonner-toast][data-type=success],[data-rich-colors=true][data-sonner-toast][data-type=success] [data-close-button]{background:var(--success-bg);border-color:var(--success-border);color:var(--success-text)}[data-rich-colors=true][data-sonner-toast][data-type=info],[data-rich-colors=true][data-sonner-toast][data-type=info] [data-close-button]{background:var(--info-bg);border-color:var(--info-border);color:var(--info-text)}[data-rich-colors=true][data-sonner-toast][data-type=warning],[data-rich-colors=true][data-sonner-toast][data-type=warning] [data-close-button]{background:var(--warning-bg);border-color:var(--warning-border);color:var(--warning-text)}[data-rich-colors=true][data-sonner-toast][data-type=error],[data-rich-colors=true][data-sonner-toast][data-type=error] [data-close-button]{background:var(--error-bg);border-color:var(--error-border);color:var(--error-text)}.sonner-loading-wrapper{--size: 16px;height:var(--size);width:var(--size);position:absolute;inset:0;z-index:10}.sonner-loading-wrapper[data-visible=false]{transform-origin:center;animation:sonner-fade-out .2s ease forwards}.sonner-spinner{position:relative;top:50%;left:50%;height:var(--size);width:var(--size)}.sonner-loading-bar{animation:sonner-spin 1.2s linear infinite;background:var(--gray11);border-radius:6px;height:8%;left:-10%;position:absolute;top:-3.9%;width:24%}.sonner-loading-bar:nth-child(1){animation-delay:-1.2s;transform:rotate(.0001deg) translate(146%)}.sonner-loading-bar:nth-child(2){animation-delay:-1.1s;transform:rotate(30deg) translate(146%)}.sonner-loading-bar:nth-child(3){animation-delay:-1s;transform:rotate(60deg) translate(146%)}.sonner-loading-bar:nth-child(4){animation-delay:-.9s;transform:rotate(90deg) translate(146%)}.sonner-loading-bar:nth-child(5){animation-delay:-.8s;transform:rotate(120deg) translate(146%)}.sonner-loading-bar:nth-child(6){animation-delay:-.7s;transform:rotate(150deg) translate(146%)}.sonner-loading-bar:nth-child(7){animation-delay:-.6s;transform:rotate(180deg) translate(146%)}.sonner-loading-bar:nth-child(8){animation-delay:-.5s;transform:rotate(210deg) translate(146%)}.sonner-loading-bar:nth-child(9){animation-delay:-.4s;transform:rotate(240deg) translate(146%)}.sonner-loading-bar:nth-child(10){animation-delay:-.3s;transform:rotate(270deg) translate(146%)}.sonner-loading-bar:nth-child(11){animation-delay:-.2s;transform:rotate(300deg) translate(146%)}.sonner-loading-bar:nth-child(12){animation-delay:-.1s;transform:rotate(330deg) translate(146%)}@keyframes sonner-fade-in{0%{opacity:0;transform:scale(.8)}to{opacity:1;transform:scale(1)}}@keyframes sonner-fade-out{0%{opacity:1;transform:scale(1)}to{opacity:0;transform:scale(.8)}}@keyframes sonner-spin{0%{opacity:1}to{opacity:.15}}@media (prefers-reduced-motion){[data-sonner-toast],[data-sonner-toast]>*,.sonner-loading-bar{transition:none!important;animation:none!important}}.sonner-loader{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);transform-origin:center;transition:opacity .2s,transform .2s}.sonner-loader[data-visible=false]{opacity:0;transform:scale(.8) translate(-50%,-50%)}
`);function ch(n){return n.label!==void 0}var zM=3,WM="32px",HM=4e3,VM=356,GM=14,qM=20,YM=200;function XM(...n){return n.filter(Boolean).join(" ")}var KM=n=>{var e,t,r,s,i,o,a,l,c,u;let{invert:h,toast:d,unstyled:p,interacting:m,setHeights:g,visibleToasts:y,heights:x,index:v,toasts:w,expanded:_,removeToast:S,defaultRichColors:E,closeButton:C,style:P,cancelButtonStyle:O,actionButtonStyle:A,className:R="",descriptionClassName:B="",duration:I,position:L,gap:U,loadingIcon:F,expandByDefault:D,classNames:k,icons:N,closeButtonAriaLabel:M="Close toast",pauseWhenPageIsHidden:T,cn:j}=n,[$,z]=Y.useState(!1),[ee,X]=Y.useState(!1),[J,K]=Y.useState(!1),[ne,ie]=Y.useState(!1),[ae,W]=Y.useState(0),[H,G]=Y.useState(0),Q=Y.useRef(null),te=Y.useRef(null),he=v===0,xe=v+1<=y,fe=d.type,be=d.dismissible!==!1,Pe=d.className||"",Se=d.descriptionClassName||"",Ye=Y.useMemo(()=>x.findIndex(le=>le.toastId===d.id)||0,[x,d.id]),Ve=Y.useMemo(()=>{var le;return(le=d.closeButton)!=null?le:C},[d.closeButton,C]),Ge=Y.useMemo(()=>d.duration||I||HM,[d.duration,I]),Re=Y.useRef(0),ge=Y.useRef(0),et=Y.useRef(0),tt=Y.useRef(null),[ke,st]=L.split("-"),it=Y.useMemo(()=>x.reduce((le,Ce,we)=>we>=Ye?le:le+Ce.height,0),[x,Ye]),xt=jM(),Tn=d.invert||h,yn=fe==="loading";ge.current=Y.useMemo(()=>Ye*U+it,[Ye,it]),Y.useEffect(()=>{z(!0)},[]),Y.useLayoutEffect(()=>{if(!$)return;let le=te.current,Ce=le.style.height;le.style.height="auto";let we=le.getBoundingClientRect().height;le.style.height=Ce,G(we),g(Me=>Me.find(Ne=>Ne.toastId===d.id)?Me.map(Ne=>Ne.toastId===d.id?{...Ne,height:we}:Ne):[{toastId:d.id,height:we,position:d.position},...Me])},[$,d.title,d.description,g,d.id]);let gt=Y.useCallback(()=>{X(!0),W(ge.current),g(le=>le.filter(Ce=>Ce.toastId!==d.id)),setTimeout(()=>{S(d)},YM)},[d,S,g,ge]);Y.useEffect(()=>{if(d.promise&&fe==="loading"||d.duration===1/0||d.type==="loading")return;let le,Ce=Ge;return _||m||T&&xt?(()=>{if(et.current<Re.current){let we=new Date().getTime()-Re.current;Ce=Ce-we}et.current=new Date().getTime()})():Ce!==1/0&&(Re.current=new Date().getTime(),le=setTimeout(()=>{var we;(we=d.onAutoClose)==null||we.call(d,d),gt()},Ce)),()=>clearTimeout(le)},[_,m,D,d,Ge,gt,d.promise,fe,T,xt]),Y.useEffect(()=>{let le=te.current;if(le){let Ce=le.getBoundingClientRect().height;return G(Ce),g(we=>[{toastId:d.id,height:Ce,position:d.position},...we]),()=>g(we=>we.filter(Me=>Me.toastId!==d.id))}},[g,d.id]),Y.useEffect(()=>{d.delete&&gt()},[gt,d.delete]);function Ao(){return N!=null&&N.loading?Y.createElement("div",{className:"sonner-loader","data-visible":fe==="loading"},N.loading):F?Y.createElement("div",{className:"sonner-loader","data-visible":fe==="loading"},F):Y.createElement(DM,{visible:fe==="loading"})}return Y.createElement("li",{"aria-live":d.important?"assertive":"polite","aria-atomic":"true",role:"status",tabIndex:0,ref:te,className:j(R,Pe,k==null?void 0:k.toast,(e=d==null?void 0:d.classNames)==null?void 0:e.toast,k==null?void 0:k.default,k==null?void 0:k[fe],(t=d==null?void 0:d.classNames)==null?void 0:t[fe]),"data-sonner-toast":"","data-rich-colors":(r=d.richColors)!=null?r:E,"data-styled":!(d.jsx||d.unstyled||p),"data-mounted":$,"data-promise":!!d.promise,"data-removed":ee,"data-visible":xe,"data-y-position":ke,"data-x-position":st,"data-index":v,"data-front":he,"data-swiping":J,"data-dismissible":be,"data-type":fe,"data-invert":Tn,"data-swipe-out":ne,"data-expanded":!!(_||D&&$),style:{"--index":v,"--toasts-before":v,"--z-index":w.length-v,"--offset":`${ee?ae:ge.current}px`,"--initial-height":D?"auto":`${H}px`,...P,...d.style},onPointerDown:le=>{yn||!be||(Q.current=new Date,W(ge.current),le.target.setPointerCapture(le.pointerId),le.target.tagName!=="BUTTON"&&(K(!0),tt.current={x:le.clientX,y:le.clientY}))},onPointerUp:()=>{var le,Ce,we,Me;if(ne||!be)return;tt.current=null;let Ne=Number(((le=te.current)==null?void 0:le.style.getPropertyValue("--swipe-amount").replace("px",""))||0),jt=new Date().getTime()-((Ce=Q.current)==null?void 0:Ce.getTime()),Ot=Math.abs(Ne)/jt;if(Math.abs(Ne)>=qM||Ot>.11){W(ge.current),(we=d.onDismiss)==null||we.call(d,d),gt(),ie(!0);return}(Me=te.current)==null||Me.style.setProperty("--swipe-amount","0px"),K(!1)},onPointerMove:le=>{var Ce;if(!tt.current||!be)return;let we=le.clientY-tt.current.y,Me=le.clientX-tt.current.x,Ne=(ke==="top"?Math.min:Math.max)(0,we),jt=le.pointerType==="touch"?10:2;Math.abs(Ne)>jt?(Ce=te.current)==null||Ce.style.setProperty("--swipe-amount",`${we}px`):Math.abs(Me)>jt&&(tt.current=null)}},Ve&&!d.jsx?Y.createElement("button",{"aria-label":M,"data-disabled":yn,"data-close-button":!0,onClick:yn||!be?()=>{}:()=>{var le;gt(),(le=d.onDismiss)==null||le.call(d,d)},className:j(k==null?void 0:k.closeButton,(s=d==null?void 0:d.classNames)==null?void 0:s.closeButton)},Y.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"},Y.createElement("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),Y.createElement("line",{x1:"6",y1:"6",x2:"18",y2:"18"}))):null,d.jsx||Y.isValidElement(d.title)?d.jsx||d.title:Y.createElement(Y.Fragment,null,fe||d.icon||d.promise?Y.createElement("div",{"data-icon":"",className:j(k==null?void 0:k.icon,(i=d==null?void 0:d.classNames)==null?void 0:i.icon)},d.promise||d.type==="loading"&&!d.icon?d.icon||Ao():null,d.type!=="loading"?d.icon||(N==null?void 0:N[fe])||TM(fe):null):null,Y.createElement("div",{"data-content":"",className:j(k==null?void 0:k.content,(o=d==null?void 0:d.classNames)==null?void 0:o.content)},Y.createElement("div",{"data-title":"",className:j(k==null?void 0:k.title,(a=d==null?void 0:d.classNames)==null?void 0:a.title)},d.title),d.description?Y.createElement("div",{"data-description":"",className:j(B,Se,k==null?void 0:k.description,(l=d==null?void 0:d.classNames)==null?void 0:l.description)},d.description):null),Y.isValidElement(d.cancel)?d.cancel:d.cancel&&ch(d.cancel)?Y.createElement("button",{"data-button":!0,"data-cancel":!0,style:d.cancelButtonStyle||O,onClick:le=>{var Ce,we;ch(d.cancel)&&be&&((we=(Ce=d.cancel).onClick)==null||we.call(Ce,le),gt())},className:j(k==null?void 0:k.cancelButton,(c=d==null?void 0:d.classNames)==null?void 0:c.cancelButton)},d.cancel.label):null,Y.isValidElement(d.action)?d.action:d.action&&ch(d.action)?Y.createElement("button",{"data-button":!0,"data-action":!0,style:d.actionButtonStyle||A,onClick:le=>{var Ce,we;ch(d.action)&&(le.defaultPrevented||((we=(Ce=d.action).onClick)==null||we.call(Ce,le),gt()))},className:j(k==null?void 0:k.actionButton,(u=d==null?void 0:d.classNames)==null?void 0:u.actionButton)},d.action.label):null))};function Q_(){if(typeof window>"u"||typeof document>"u")return"ltr";let n=document.documentElement.getAttribute("dir");return n==="auto"||!n?window.getComputedStyle(document.documentElement).direction:n}var JM=n=>{let{invert:e,position:t="bottom-right",hotkey:r=["altKey","KeyT"],expand:s,closeButton:i,className:o,offset:a,theme:l="light",richColors:c,duration:u,style:h,visibleToasts:d=zM,toastOptions:p,dir:m=Q_(),gap:g=GM,loadingIcon:y,icons:x,containerAriaLabel:v="Notifications",pauseWhenPageIsHidden:w,cn:_=XM}=n,[S,E]=Y.useState([]),C=Y.useMemo(()=>Array.from(new Set([t].concat(S.filter(T=>T.position).map(T=>T.position)))),[S,t]),[P,O]=Y.useState([]),[A,R]=Y.useState(!1),[B,I]=Y.useState(!1),[L,U]=Y.useState(l!=="system"?l:typeof window<"u"&&window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"),F=Y.useRef(null),D=r.join("+").replace(/Key/g,"").replace(/Digit/g,""),k=Y.useRef(null),N=Y.useRef(!1),M=Y.useCallback(T=>{var j;(j=S.find($=>$.id===T.id))!=null&&j.delete||ar.dismiss(T.id),E($=>$.filter(({id:z})=>z!==T.id))},[S]);return Y.useEffect(()=>ar.subscribe(T=>{if(T.dismiss){E(j=>j.map($=>$.id===T.id?{...$,delete:!0}:$));return}setTimeout(()=>{oT.flushSync(()=>{E(j=>{let $=j.findIndex(z=>z.id===T.id);return $!==-1?[...j.slice(0,$),{...j[$],...T},...j.slice($+1)]:[T,...j]})})})}),[]),Y.useEffect(()=>{if(l!=="system"){U(l);return}l==="system"&&(window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?U("dark"):U("light")),typeof window<"u"&&window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",({matches:T})=>{U(T?"dark":"light")})},[l]),Y.useEffect(()=>{S.length<=1&&R(!1)},[S]),Y.useEffect(()=>{let T=j=>{var $,z;r.every(ee=>j[ee]||j.code===ee)&&(R(!0),($=F.current)==null||$.focus()),j.code==="Escape"&&(document.activeElement===F.current||(z=F.current)!=null&&z.contains(document.activeElement))&&R(!1)};return document.addEventListener("keydown",T),()=>document.removeEventListener("keydown",T)},[r]),Y.useEffect(()=>{if(F.current)return()=>{k.current&&(k.current.focus({preventScroll:!0}),k.current=null,N.current=!1)}},[F.current]),S.length?Y.createElement("section",{"aria-label":`${v} ${D}`,tabIndex:-1},C.map((T,j)=>{var $;let[z,ee]=T.split("-");return Y.createElement("ol",{key:T,dir:m==="auto"?Q_():m,tabIndex:-1,ref:F,className:o,"data-sonner-toaster":!0,"data-theme":L,"data-y-position":z,"data-x-position":ee,style:{"--front-toast-height":`${(($=P[0])==null?void 0:$.height)||0}px`,"--offset":typeof a=="number"?`${a}px`:a||WM,"--width":`${VM}px`,"--gap":`${g}px`,...h},onBlur:X=>{N.current&&!X.currentTarget.contains(X.relatedTarget)&&(N.current=!1,k.current&&(k.current.focus({preventScroll:!0}),k.current=null))},onFocus:X=>{X.target instanceof HTMLElement&&X.target.dataset.dismissible==="false"||N.current||(N.current=!0,k.current=X.relatedTarget)},onMouseEnter:()=>R(!0),onMouseMove:()=>R(!0),onMouseLeave:()=>{B||R(!1)},onPointerDown:X=>{X.target instanceof HTMLElement&&X.target.dataset.dismissible==="false"||I(!0)},onPointerUp:()=>I(!1)},S.filter(X=>!X.position&&j===0||X.position===T).map((X,J)=>{var K,ne;return Y.createElement(KM,{key:X.id,icons:x,index:J,toast:X,defaultRichColors:c,duration:(K=p==null?void 0:p.duration)!=null?K:u,className:p==null?void 0:p.className,descriptionClassName:p==null?void 0:p.descriptionClassName,invert:e,visibleToasts:d,closeButton:(ne=p==null?void 0:p.closeButton)!=null?ne:i,interacting:B,position:T,style:p==null?void 0:p.style,unstyled:p==null?void 0:p.unstyled,classNames:p==null?void 0:p.classNames,cancelButtonStyle:p==null?void 0:p.cancelButtonStyle,actionButtonStyle:p==null?void 0:p.actionButtonStyle,removeToast:M,toasts:S.filter(ie=>ie.position==X.position),heights:P.filter(ie=>ie.position==X.position),setHeights:O,expandByDefault:s,gap:g,loadingIcon:y,expanded:A,pauseWhenPageIsHidden:w,cn:_})}))})):null};const QM=({...n})=>{const{theme:e="system"}=_M();return f.jsx(JM,{theme:e,className:"toaster group",toastOptions:{classNames:{toast:"group toast group-[.toaster]:bg-background group-[.toaster]:text-foreground group-[.toaster]:border-border group-[.toaster]:shadow-lg",description:"group-[.toast]:text-muted-foreground",actionButton:"group-[.toast]:bg-primary group-[.toast]:text-primary-foreground",cancelButton:"group-[.toast]:bg-muted group-[.toast]:text-muted-foreground"}},...n})};var ZM=rk.useId||(()=>{}),e8=0;function Hs(n){const[e,t]=b.useState(ZM());return vn(()=>{n||t(r=>r??String(e8++))},[n]),n||(e?`radix-${e}`:"")}const t8=["top","right","bottom","left"],lo=Math.min,cr=Math.max,Kf=Math.round,uh=Math.floor,co=n=>({x:n,y:n}),n8={left:"right",right:"left",bottom:"top",top:"bottom"},r8={start:"end",end:"start"};function py(n,e,t){return cr(n,lo(e,t))}function ni(n,e){return typeof n=="function"?n(e):n}function ri(n){return n.split("-")[0]}function ac(n){return n.split("-")[1]}function Aw(n){return n==="x"?"y":"x"}function Dw(n){return n==="y"?"height":"width"}function uo(n){return["top","bottom"].includes(ri(n))?"y":"x"}function Ow(n){return Aw(uo(n))}function s8(n,e,t){t===void 0&&(t=!1);const r=ac(n),s=Ow(n),i=Dw(s);let o=s==="x"?r===(t?"end":"start")?"right":"left":r==="start"?"bottom":"top";return e.reference[i]>e.floating[i]&&(o=Jf(o)),[o,Jf(o)]}function i8(n){const e=Jf(n);return[gy(n),e,gy(e)]}function gy(n){return n.replace(/start|end/g,e=>r8[e])}function o8(n,e,t){const r=["left","right"],s=["right","left"],i=["top","bottom"],o=["bottom","top"];switch(n){case"top":case"bottom":return t?e?s:r:e?r:s;case"left":case"right":return e?i:o;default:return[]}}function a8(n,e,t,r){const s=ac(n);let i=o8(ri(n),t==="start",r);return s&&(i=i.map(o=>o+"-"+s),e&&(i=i.concat(i.map(gy)))),i}function Jf(n){return n.replace(/left|right|bottom|top/g,e=>n8[e])}function l8(n){return{top:0,right:0,bottom:0,left:0,...n}}function KT(n){return typeof n!="number"?l8(n):{top:n,right:n,bottom:n,left:n}}function Qf(n){const{x:e,y:t,width:r,height:s}=n;return{width:r,height:s,top:t,left:e,right:e+r,bottom:t+s,x:e,y:t}}function Z_(n,e,t){let{reference:r,floating:s}=n;const i=uo(e),o=Ow(e),a=Dw(o),l=ri(e),c=i==="y",u=r.x+r.width/2-s.width/2,h=r.y+r.height/2-s.height/2,d=r[a]/2-s[a]/2;let p;switch(l){case"top":p={x:u,y:r.y-s.height};break;case"bottom":p={x:u,y:r.y+r.height};break;case"right":p={x:r.x+r.width,y:h};break;case"left":p={x:r.x-s.width,y:h};break;default:p={x:r.x,y:r.y}}switch(ac(e)){case"start":p[o]-=d*(t&&c?-1:1);break;case"end":p[o]+=d*(t&&c?-1:1);break}return p}const c8=async(n,e,t)=>{const{placement:r="bottom",strategy:s="absolute",middleware:i=[],platform:o}=t,a=i.filter(Boolean),l=await(o.isRTL==null?void 0:o.isRTL(e));let c=await o.getElementRects({reference:n,floating:e,strategy:s}),{x:u,y:h}=Z_(c,r,l),d=r,p={},m=0;for(let g=0;g<a.length;g++){const{name:y,fn:x}=a[g],{x:v,y:w,data:_,reset:S}=await x({x:u,y:h,initialPlacement:r,placement:d,strategy:s,middlewareData:p,rects:c,platform:o,elements:{reference:n,floating:e}});u=v??u,h=w??h,p={...p,[y]:{...p[y],..._}},S&&m<=50&&(m++,typeof S=="object"&&(S.placement&&(d=S.placement),S.rects&&(c=S.rects===!0?await o.getElementRects({reference:n,floating:e,strategy:s}):S.rects),{x:u,y:h}=Z_(c,d,l)),g=-1)}return{x:u,y:h,placement:d,strategy:s,middlewareData:p}};async function Vu(n,e){var t;e===void 0&&(e={});const{x:r,y:s,platform:i,rects:o,elements:a,strategy:l}=n,{boundary:c="clippingAncestors",rootBoundary:u="viewport",elementContext:h="floating",altBoundary:d=!1,padding:p=0}=ni(e,n),m=KT(p),y=a[d?h==="floating"?"reference":"floating":h],x=Qf(await i.getClippingRect({element:(t=await(i.isElement==null?void 0:i.isElement(y)))==null||t?y:y.contextElement||await(i.getDocumentElement==null?void 0:i.getDocumentElement(a.floating)),boundary:c,rootBoundary:u,strategy:l})),v=h==="floating"?{x:r,y:s,width:o.floating.width,height:o.floating.height}:o.reference,w=await(i.getOffsetParent==null?void 0:i.getOffsetParent(a.floating)),_=await(i.isElement==null?void 0:i.isElement(w))?await(i.getScale==null?void 0:i.getScale(w))||{x:1,y:1}:{x:1,y:1},S=Qf(i.convertOffsetParentRelativeRectToViewportRelativeRect?await i.convertOffsetParentRelativeRectToViewportRelativeRect({elements:a,rect:v,offsetParent:w,strategy:l}):v);return{top:(x.top-S.top+m.top)/_.y,bottom:(S.bottom-x.bottom+m.bottom)/_.y,left:(x.left-S.left+m.left)/_.x,right:(S.right-x.right+m.right)/_.x}}const u8=n=>({name:"arrow",options:n,async fn(e){const{x:t,y:r,placement:s,rects:i,platform:o,elements:a,middlewareData:l}=e,{element:c,padding:u=0}=ni(n,e)||{};if(c==null)return{};const h=KT(u),d={x:t,y:r},p=Ow(s),m=Dw(p),g=await o.getDimensions(c),y=p==="y",x=y?"top":"left",v=y?"bottom":"right",w=y?"clientHeight":"clientWidth",_=i.reference[m]+i.reference[p]-d[p]-i.floating[m],S=d[p]-i.reference[p],E=await(o.getOffsetParent==null?void 0:o.getOffsetParent(c));let C=E?E[w]:0;(!C||!await(o.isElement==null?void 0:o.isElement(E)))&&(C=a.floating[w]||i.floating[m]);const P=_/2-S/2,O=C/2-g[m]/2-1,A=lo(h[x],O),R=lo(h[v],O),B=A,I=C-g[m]-R,L=C/2-g[m]/2+P,U=py(B,L,I),F=!l.arrow&&ac(s)!=null&&L!==U&&i.reference[m]/2-(L<B?A:R)-g[m]/2<0,D=F?L<B?L-B:L-I:0;return{[p]:d[p]+D,data:{[p]:U,centerOffset:L-U-D,...F&&{alignmentOffset:D}},reset:F}}}),d8=function(n){return n===void 0&&(n={}),{name:"flip",options:n,async fn(e){var t,r;const{placement:s,middlewareData:i,rects:o,initialPlacement:a,platform:l,elements:c}=e,{mainAxis:u=!0,crossAxis:h=!0,fallbackPlacements:d,fallbackStrategy:p="bestFit",fallbackAxisSideDirection:m="none",flipAlignment:g=!0,...y}=ni(n,e);if((t=i.arrow)!=null&&t.alignmentOffset)return{};const x=ri(s),v=uo(a),w=ri(a)===a,_=await(l.isRTL==null?void 0:l.isRTL(c.floating)),S=d||(w||!g?[Jf(a)]:i8(a)),E=m!=="none";!d&&E&&S.push(...a8(a,g,m,_));const C=[a,...S],P=await Vu(e,y),O=[];let A=((r=i.flip)==null?void 0:r.overflows)||[];if(u&&O.push(P[x]),h){const L=s8(s,o,_);O.push(P[L[0]],P[L[1]])}if(A=[...A,{placement:s,overflows:O}],!O.every(L=>L<=0)){var R,B;const L=(((R=i.flip)==null?void 0:R.index)||0)+1,U=C[L];if(U)return{data:{index:L,overflows:A},reset:{placement:U}};let F=(B=A.filter(D=>D.overflows[0]<=0).sort((D,k)=>D.overflows[1]-k.overflows[1])[0])==null?void 0:B.placement;if(!F)switch(p){case"bestFit":{var I;const D=(I=A.filter(k=>{if(E){const N=uo(k.placement);return N===v||N==="y"}return!0}).map(k=>[k.placement,k.overflows.filter(N=>N>0).reduce((N,M)=>N+M,0)]).sort((k,N)=>k[1]-N[1])[0])==null?void 0:I[0];D&&(F=D);break}case"initialPlacement":F=a;break}if(s!==F)return{reset:{placement:F}}}return{}}}};function eS(n,e){return{top:n.top-e.height,right:n.right-e.width,bottom:n.bottom-e.height,left:n.left-e.width}}function tS(n){return t8.some(e=>n[e]>=0)}const h8=function(n){return n===void 0&&(n={}),{name:"hide",options:n,async fn(e){const{rects:t}=e,{strategy:r="referenceHidden",...s}=ni(n,e);switch(r){case"referenceHidden":{const i=await Vu(e,{...s,elementContext:"reference"}),o=eS(i,t.reference);return{data:{referenceHiddenOffsets:o,referenceHidden:tS(o)}}}case"escaped":{const i=await Vu(e,{...s,altBoundary:!0}),o=eS(i,t.floating);return{data:{escapedOffsets:o,escaped:tS(o)}}}default:return{}}}}};async function f8(n,e){const{placement:t,platform:r,elements:s}=n,i=await(r.isRTL==null?void 0:r.isRTL(s.floating)),o=ri(t),a=ac(t),l=uo(t)==="y",c=["left","top"].includes(o)?-1:1,u=i&&l?-1:1,h=ni(e,n);let{mainAxis:d,crossAxis:p,alignmentAxis:m}=typeof h=="number"?{mainAxis:h,crossAxis:0,alignmentAxis:null}:{mainAxis:h.mainAxis||0,crossAxis:h.crossAxis||0,alignmentAxis:h.alignmentAxis};return a&&typeof m=="number"&&(p=a==="end"?m*-1:m),l?{x:p*u,y:d*c}:{x:d*c,y:p*u}}const p8=function(n){return n===void 0&&(n=0),{name:"offset",options:n,async fn(e){var t,r;const{x:s,y:i,placement:o,middlewareData:a}=e,l=await f8(e,n);return o===((t=a.offset)==null?void 0:t.placement)&&(r=a.arrow)!=null&&r.alignmentOffset?{}:{x:s+l.x,y:i+l.y,data:{...l,placement:o}}}}},g8=function(n){return n===void 0&&(n={}),{name:"shift",options:n,async fn(e){const{x:t,y:r,placement:s}=e,{mainAxis:i=!0,crossAxis:o=!1,limiter:a={fn:y=>{let{x,y:v}=y;return{x,y:v}}},...l}=ni(n,e),c={x:t,y:r},u=await Vu(e,l),h=uo(ri(s)),d=Aw(h);let p=c[d],m=c[h];if(i){const y=d==="y"?"top":"left",x=d==="y"?"bottom":"right",v=p+u[y],w=p-u[x];p=py(v,p,w)}if(o){const y=h==="y"?"top":"left",x=h==="y"?"bottom":"right",v=m+u[y],w=m-u[x];m=py(v,m,w)}const g=a.fn({...e,[d]:p,[h]:m});return{...g,data:{x:g.x-t,y:g.y-r,enabled:{[d]:i,[h]:o}}}}}},m8=function(n){return n===void 0&&(n={}),{options:n,fn(e){const{x:t,y:r,placement:s,rects:i,middlewareData:o}=e,{offset:a=0,mainAxis:l=!0,crossAxis:c=!0}=ni(n,e),u={x:t,y:r},h=uo(s),d=Aw(h);let p=u[d],m=u[h];const g=ni(a,e),y=typeof g=="number"?{mainAxis:g,crossAxis:0}:{mainAxis:0,crossAxis:0,...g};if(l){const w=d==="y"?"height":"width",_=i.reference[d]-i.floating[w]+y.mainAxis,S=i.reference[d]+i.reference[w]-y.mainAxis;p<_?p=_:p>S&&(p=S)}if(c){var x,v;const w=d==="y"?"width":"height",_=["top","left"].includes(ri(s)),S=i.reference[h]-i.floating[w]+(_&&((x=o.offset)==null?void 0:x[h])||0)+(_?0:y.crossAxis),E=i.reference[h]+i.reference[w]+(_?0:((v=o.offset)==null?void 0:v[h])||0)-(_?y.crossAxis:0);m<S?m=S:m>E&&(m=E)}return{[d]:p,[h]:m}}}},v8=function(n){return n===void 0&&(n={}),{name:"size",options:n,async fn(e){var t,r;const{placement:s,rects:i,platform:o,elements:a}=e,{apply:l=()=>{},...c}=ni(n,e),u=await Vu(e,c),h=ri(s),d=ac(s),p=uo(s)==="y",{width:m,height:g}=i.floating;let y,x;h==="top"||h==="bottom"?(y=h,x=d===(await(o.isRTL==null?void 0:o.isRTL(a.floating))?"start":"end")?"left":"right"):(x=h,y=d==="end"?"top":"bottom");const v=g-u.top-u.bottom,w=m-u.left-u.right,_=lo(g-u[y],v),S=lo(m-u[x],w),E=!e.middlewareData.shift;let C=_,P=S;if((t=e.middlewareData.shift)!=null&&t.enabled.x&&(P=w),(r=e.middlewareData.shift)!=null&&r.enabled.y&&(C=v),E&&!d){const A=cr(u.left,0),R=cr(u.right,0),B=cr(u.top,0),I=cr(u.bottom,0);p?P=m-2*(A!==0||R!==0?A+R:cr(u.left,u.right)):C=g-2*(B!==0||I!==0?B+I:cr(u.top,u.bottom))}await l({...e,availableWidth:P,availableHeight:C});const O=await o.getDimensions(a.floating);return m!==O.width||g!==O.height?{reset:{rects:!0}}:{}}}};function Kp(){return typeof window<"u"}function lc(n){return JT(n)?(n.nodeName||"").toLowerCase():"#document"}function hr(n){var e;return(n==null||(e=n.ownerDocument)==null?void 0:e.defaultView)||window}function bs(n){var e;return(e=(JT(n)?n.ownerDocument:n.document)||window.document)==null?void 0:e.documentElement}function JT(n){return Kp()?n instanceof Node||n instanceof hr(n).Node:!1}function ts(n){return Kp()?n instanceof Element||n instanceof hr(n).Element:!1}function ms(n){return Kp()?n instanceof HTMLElement||n instanceof hr(n).HTMLElement:!1}function nS(n){return!Kp()||typeof ShadowRoot>"u"?!1:n instanceof ShadowRoot||n instanceof hr(n).ShadowRoot}function bd(n){const{overflow:e,overflowX:t,overflowY:r,display:s}=ns(n);return/auto|scroll|overlay|hidden|clip/.test(e+r+t)&&!["inline","contents"].includes(s)}function y8(n){return["table","td","th"].includes(lc(n))}function Jp(n){return[":popover-open",":modal"].some(e=>{try{return n.matches(e)}catch{return!1}})}function Iw(n){const e=Rw(),t=ts(n)?ns(n):n;return t.transform!=="none"||t.perspective!=="none"||(t.containerType?t.containerType!=="normal":!1)||!e&&(t.backdropFilter?t.backdropFilter!=="none":!1)||!e&&(t.filter?t.filter!=="none":!1)||["transform","perspective","filter"].some(r=>(t.willChange||"").includes(r))||["paint","layout","strict","content"].some(r=>(t.contain||"").includes(r))}function x8(n){let e=ho(n);for(;ms(e)&&!Yl(e);){if(Iw(e))return e;if(Jp(e))return null;e=ho(e)}return null}function Rw(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}function Yl(n){return["html","body","#document"].includes(lc(n))}function ns(n){return hr(n).getComputedStyle(n)}function Qp(n){return ts(n)?{scrollLeft:n.scrollLeft,scrollTop:n.scrollTop}:{scrollLeft:n.scrollX,scrollTop:n.scrollY}}function ho(n){if(lc(n)==="html")return n;const e=n.assignedSlot||n.parentNode||nS(n)&&n.host||bs(n);return nS(e)?e.host:e}function QT(n){const e=ho(n);return Yl(e)?n.ownerDocument?n.ownerDocument.body:n.body:ms(e)&&bd(e)?e:QT(e)}function Gu(n,e,t){var r;e===void 0&&(e=[]),t===void 0&&(t=!0);const s=QT(n),i=s===((r=n.ownerDocument)==null?void 0:r.body),o=hr(s);if(i){const a=my(o);return e.concat(o,o.visualViewport||[],bd(s)?s:[],a&&t?Gu(a):[])}return e.concat(s,Gu(s,[],t))}function my(n){return n.parent&&Object.getPrototypeOf(n.parent)?n.frameElement:null}function ZT(n){const e=ns(n);let t=parseFloat(e.width)||0,r=parseFloat(e.height)||0;const s=ms(n),i=s?n.offsetWidth:t,o=s?n.offsetHeight:r,a=Kf(t)!==i||Kf(r)!==o;return a&&(t=i,r=o),{width:t,height:r,$:a}}function Nw(n){return ts(n)?n:n.contextElement}function ml(n){const e=Nw(n);if(!ms(e))return co(1);const t=e.getBoundingClientRect(),{width:r,height:s,$:i}=ZT(e);let o=(i?Kf(t.width):t.width)/r,a=(i?Kf(t.height):t.height)/s;return(!o||!Number.isFinite(o))&&(o=1),(!a||!Number.isFinite(a))&&(a=1),{x:o,y:a}}const w8=co(0);function eA(n){const e=hr(n);return!Rw()||!e.visualViewport?w8:{x:e.visualViewport.offsetLeft,y:e.visualViewport.offsetTop}}function b8(n,e,t){return e===void 0&&(e=!1),!t||e&&t!==hr(n)?!1:e}function fa(n,e,t,r){e===void 0&&(e=!1),t===void 0&&(t=!1);const s=n.getBoundingClientRect(),i=Nw(n);let o=co(1);e&&(r?ts(r)&&(o=ml(r)):o=ml(n));const a=b8(i,t,r)?eA(i):co(0);let l=(s.left+a.x)/o.x,c=(s.top+a.y)/o.y,u=s.width/o.x,h=s.height/o.y;if(i){const d=hr(i),p=r&&ts(r)?hr(r):r;let m=d,g=my(m);for(;g&&r&&p!==m;){const y=ml(g),x=g.getBoundingClientRect(),v=ns(g),w=x.left+(g.clientLeft+parseFloat(v.paddingLeft))*y.x,_=x.top+(g.clientTop+parseFloat(v.paddingTop))*y.y;l*=y.x,c*=y.y,u*=y.x,h*=y.y,l+=w,c+=_,m=hr(g),g=my(m)}}return Qf({width:u,height:h,x:l,y:c})}function _8(n){let{elements:e,rect:t,offsetParent:r,strategy:s}=n;const i=s==="fixed",o=bs(r),a=e?Jp(e.floating):!1;if(r===o||a&&i)return t;let l={scrollLeft:0,scrollTop:0},c=co(1);const u=co(0),h=ms(r);if((h||!h&&!i)&&((lc(r)!=="body"||bd(o))&&(l=Qp(r)),ms(r))){const d=fa(r);c=ml(r),u.x=d.x+r.clientLeft,u.y=d.y+r.clientTop}return{width:t.width*c.x,height:t.height*c.y,x:t.x*c.x-l.scrollLeft*c.x+u.x,y:t.y*c.y-l.scrollTop*c.y+u.y}}function S8(n){return Array.from(n.getClientRects())}function vy(n,e){const t=Qp(n).scrollLeft;return e?e.left+t:fa(bs(n)).left+t}function C8(n){const e=bs(n),t=Qp(n),r=n.ownerDocument.body,s=cr(e.scrollWidth,e.clientWidth,r.scrollWidth,r.clientWidth),i=cr(e.scrollHeight,e.clientHeight,r.scrollHeight,r.clientHeight);let o=-t.scrollLeft+vy(n);const a=-t.scrollTop;return ns(r).direction==="rtl"&&(o+=cr(e.clientWidth,r.clientWidth)-s),{width:s,height:i,x:o,y:a}}function E8(n,e){const t=hr(n),r=bs(n),s=t.visualViewport;let i=r.clientWidth,o=r.clientHeight,a=0,l=0;if(s){i=s.width,o=s.height;const c=Rw();(!c||c&&e==="fixed")&&(a=s.offsetLeft,l=s.offsetTop)}return{width:i,height:o,x:a,y:l}}function k8(n,e){const t=fa(n,!0,e==="fixed"),r=t.top+n.clientTop,s=t.left+n.clientLeft,i=ms(n)?ml(n):co(1),o=n.clientWidth*i.x,a=n.clientHeight*i.y,l=s*i.x,c=r*i.y;return{width:o,height:a,x:l,y:c}}function rS(n,e,t){let r;if(e==="viewport")r=E8(n,t);else if(e==="document")r=C8(bs(n));else if(ts(e))r=k8(e,t);else{const s=eA(n);r={...e,x:e.x-s.x,y:e.y-s.y}}return Qf(r)}function tA(n,e){const t=ho(n);return t===e||!ts(t)||Yl(t)?!1:ns(t).position==="fixed"||tA(t,e)}function P8(n,e){const t=e.get(n);if(t)return t;let r=Gu(n,[],!1).filter(a=>ts(a)&&lc(a)!=="body"),s=null;const i=ns(n).position==="fixed";let o=i?ho(n):n;for(;ts(o)&&!Yl(o);){const a=ns(o),l=Iw(o);!l&&a.position==="fixed"&&(s=null),(i?!l&&!s:!l&&a.position==="static"&&!!s&&["absolute","fixed"].includes(s.position)||bd(o)&&!l&&tA(n,o))?r=r.filter(u=>u!==o):s=a,o=ho(o)}return e.set(n,r),r}function T8(n){let{element:e,boundary:t,rootBoundary:r,strategy:s}=n;const o=[...t==="clippingAncestors"?Jp(e)?[]:P8(e,this._c):[].concat(t),r],a=o[0],l=o.reduce((c,u)=>{const h=rS(e,u,s);return c.top=cr(h.top,c.top),c.right=lo(h.right,c.right),c.bottom=lo(h.bottom,c.bottom),c.left=cr(h.left,c.left),c},rS(e,a,s));return{width:l.right-l.left,height:l.bottom-l.top,x:l.left,y:l.top}}function A8(n){const{width:e,height:t}=ZT(n);return{width:e,height:t}}function D8(n,e,t){const r=ms(e),s=bs(e),i=t==="fixed",o=fa(n,!0,i,e);let a={scrollLeft:0,scrollTop:0};const l=co(0);if(r||!r&&!i)if((lc(e)!=="body"||bd(s))&&(a=Qp(e)),r){const p=fa(e,!0,i,e);l.x=p.x+e.clientLeft,l.y=p.y+e.clientTop}else s&&(l.x=vy(s));let c=0,u=0;if(s&&!r&&!i){const p=s.getBoundingClientRect();u=p.top+a.scrollTop,c=p.left+a.scrollLeft-vy(s,p)}const h=o.left+a.scrollLeft-l.x-c,d=o.top+a.scrollTop-l.y-u;return{x:h,y:d,width:o.width,height:o.height}}function kg(n){return ns(n).position==="static"}function sS(n,e){if(!ms(n)||ns(n).position==="fixed")return null;if(e)return e(n);let t=n.offsetParent;return bs(n)===t&&(t=t.ownerDocument.body),t}function nA(n,e){const t=hr(n);if(Jp(n))return t;if(!ms(n)){let s=ho(n);for(;s&&!Yl(s);){if(ts(s)&&!kg(s))return s;s=ho(s)}return t}let r=sS(n,e);for(;r&&y8(r)&&kg(r);)r=sS(r,e);return r&&Yl(r)&&kg(r)&&!Iw(r)?t:r||x8(n)||t}const O8=async function(n){const e=this.getOffsetParent||nA,t=this.getDimensions,r=await t(n.floating);return{reference:D8(n.reference,await e(n.floating),n.strategy),floating:{x:0,y:0,width:r.width,height:r.height}}};function I8(n){return ns(n).direction==="rtl"}const R8={convertOffsetParentRelativeRectToViewportRelativeRect:_8,getDocumentElement:bs,getClippingRect:T8,getOffsetParent:nA,getElementRects:O8,getClientRects:S8,getDimensions:A8,getScale:ml,isElement:ts,isRTL:I8};function N8(n,e){let t=null,r;const s=bs(n);function i(){var a;clearTimeout(r),(a=t)==null||a.disconnect(),t=null}function o(a,l){a===void 0&&(a=!1),l===void 0&&(l=1),i();const{left:c,top:u,width:h,height:d}=n.getBoundingClientRect();if(a||e(),!h||!d)return;const p=uh(u),m=uh(s.clientWidth-(c+h)),g=uh(s.clientHeight-(u+d)),y=uh(c),v={rootMargin:-p+"px "+-m+"px "+-g+"px "+-y+"px",threshold:cr(0,lo(1,l))||1};let w=!0;function _(S){const E=S[0].intersectionRatio;if(E!==l){if(!w)return o();E?o(!1,E):r=setTimeout(()=>{o(!1,1e-7)},1e3)}w=!1}try{t=new IntersectionObserver(_,{...v,root:s.ownerDocument})}catch{t=new IntersectionObserver(_,v)}t.observe(n)}return o(!0),i}function j8(n,e,t,r){r===void 0&&(r={});const{ancestorScroll:s=!0,ancestorResize:i=!0,elementResize:o=typeof ResizeObserver=="function",layoutShift:a=typeof IntersectionObserver=="function",animationFrame:l=!1}=r,c=Nw(n),u=s||i?[...c?Gu(c):[],...Gu(e)]:[];u.forEach(x=>{s&&x.addEventListener("scroll",t,{passive:!0}),i&&x.addEventListener("resize",t)});const h=c&&a?N8(c,t):null;let d=-1,p=null;o&&(p=new ResizeObserver(x=>{let[v]=x;v&&v.target===c&&p&&(p.unobserve(e),cancelAnimationFrame(d),d=requestAnimationFrame(()=>{var w;(w=p)==null||w.observe(e)})),t()}),c&&!l&&p.observe(c),p.observe(e));let m,g=l?fa(n):null;l&&y();function y(){const x=fa(n);g&&(x.x!==g.x||x.y!==g.y||x.width!==g.width||x.height!==g.height)&&t(),g=x,m=requestAnimationFrame(y)}return t(),()=>{var x;u.forEach(v=>{s&&v.removeEventListener("scroll",t),i&&v.removeEventListener("resize",t)}),h==null||h(),(x=p)==null||x.disconnect(),p=null,l&&cancelAnimationFrame(m)}}const L8=p8,M8=g8,F8=d8,B8=v8,U8=h8,iS=u8,$8=m8,z8=(n,e,t)=>{const r=new Map,s={platform:R8,...t},i={...s.platform,_c:r};return c8(n,e,{...s,platform:i})};var uf=typeof document<"u"?b.useLayoutEffect:b.useEffect;function Zf(n,e){if(n===e)return!0;if(typeof n!=typeof e)return!1;if(typeof n=="function"&&n.toString()===e.toString())return!0;let t,r,s;if(n&&e&&typeof n=="object"){if(Array.isArray(n)){if(t=n.length,t!==e.length)return!1;for(r=t;r--!==0;)if(!Zf(n[r],e[r]))return!1;return!0}if(s=Object.keys(n),t=s.length,t!==Object.keys(e).length)return!1;for(r=t;r--!==0;)if(!{}.hasOwnProperty.call(e,s[r]))return!1;for(r=t;r--!==0;){const i=s[r];if(!(i==="_owner"&&n.$$typeof)&&!Zf(n[i],e[i]))return!1}return!0}return n!==n&&e!==e}function rA(n){return typeof window>"u"?1:(n.ownerDocument.defaultView||window).devicePixelRatio||1}function oS(n,e){const t=rA(n);return Math.round(e*t)/t}function Pg(n){const e=b.useRef(n);return uf(()=>{e.current=n}),e}function W8(n){n===void 0&&(n={});const{placement:e="bottom",strategy:t="absolute",middleware:r=[],platform:s,elements:{reference:i,floating:o}={},transform:a=!0,whileElementsMounted:l,open:c}=n,[u,h]=b.useState({x:0,y:0,strategy:t,placement:e,middlewareData:{},isPositioned:!1}),[d,p]=b.useState(r);Zf(d,r)||p(r);const[m,g]=b.useState(null),[y,x]=b.useState(null),v=b.useCallback(k=>{k!==E.current&&(E.current=k,g(k))},[]),w=b.useCallback(k=>{k!==C.current&&(C.current=k,x(k))},[]),_=i||m,S=o||y,E=b.useRef(null),C=b.useRef(null),P=b.useRef(u),O=l!=null,A=Pg(l),R=Pg(s),B=Pg(c),I=b.useCallback(()=>{if(!E.current||!C.current)return;const k={placement:e,strategy:t,middleware:d};R.current&&(k.platform=R.current),z8(E.current,C.current,k).then(N=>{const M={...N,isPositioned:B.current!==!1};L.current&&!Zf(P.current,M)&&(P.current=M,ba.flushSync(()=>{h(M)}))})},[d,e,t,R,B]);uf(()=>{c===!1&&P.current.isPositioned&&(P.current.isPositioned=!1,h(k=>({...k,isPositioned:!1})))},[c]);const L=b.useRef(!1);uf(()=>(L.current=!0,()=>{L.current=!1}),[]),uf(()=>{if(_&&(E.current=_),S&&(C.current=S),_&&S){if(A.current)return A.current(_,S,I);I()}},[_,S,I,A,O]);const U=b.useMemo(()=>({reference:E,floating:C,setReference:v,setFloating:w}),[v,w]),F=b.useMemo(()=>({reference:_,floating:S}),[_,S]),D=b.useMemo(()=>{const k={position:t,left:0,top:0};if(!F.floating)return k;const N=oS(F.floating,u.x),M=oS(F.floating,u.y);return a?{...k,transform:"translate("+N+"px, "+M+"px)",...rA(F.floating)>=1.5&&{willChange:"transform"}}:{position:t,left:N,top:M}},[t,a,F.floating,u.x,u.y]);return b.useMemo(()=>({...u,update:I,refs:U,elements:F,floatingStyles:D}),[u,I,U,F,D])}const H8=n=>{function e(t){return{}.hasOwnProperty.call(t,"current")}return{name:"arrow",options:n,fn(t){const{element:r,padding:s}=typeof n=="function"?n(t):n;return r&&e(r)?r.current!=null?iS({element:r.current,padding:s}).fn(t):{}:r?iS({element:r,padding:s}).fn(t):{}}}},V8=(n,e)=>({...L8(n),options:[n,e]}),G8=(n,e)=>({...M8(n),options:[n,e]}),q8=(n,e)=>({...$8(n),options:[n,e]}),Y8=(n,e)=>({...F8(n),options:[n,e]}),X8=(n,e)=>({...B8(n),options:[n,e]}),K8=(n,e)=>({...U8(n),options:[n,e]}),J8=(n,e)=>({...H8(n),options:[n,e]});var Q8="Arrow",sA=b.forwardRef((n,e)=>{const{children:t,width:r=10,height:s=5,...i}=n;return f.jsx(Le.svg,{...i,ref:e,width:r,height:s,viewBox:"0 0 30 10",preserveAspectRatio:"none",children:n.asChild?t:f.jsx("polygon",{points:"0,0 30,0 15,10"})})});sA.displayName=Q8;var Z8=sA;function eF(n,e=[]){let t=[];function r(i,o){const a=b.createContext(o),l=t.length;t=[...t,o];function c(h){const{scope:d,children:p,...m}=h,g=(d==null?void 0:d[n][l])||a,y=b.useMemo(()=>m,Object.values(m));return f.jsx(g.Provider,{value:y,children:p})}function u(h,d){const p=(d==null?void 0:d[n][l])||a,m=b.useContext(p);if(m)return m;if(o!==void 0)return o;throw new Error(`\`${h}\` must be used within \`${i}\``)}return c.displayName=i+"Provider",[c,u]}const s=()=>{const i=t.map(o=>b.createContext(o));return function(a){const l=(a==null?void 0:a[n])||i;return b.useMemo(()=>({[`__scope${n}`]:{...a,[n]:l}}),[a,l])}};return s.scopeName=n,[r,tF(s,...e)]}function tF(...n){const e=n[0];if(n.length===1)return e;const t=()=>{const r=n.map(s=>({useScope:s(),scopeName:s.scopeName}));return function(i){const o=r.reduce((a,{useScope:l,scopeName:c})=>{const h=l(i)[`__scope${c}`];return{...a,...h}},{});return b.useMemo(()=>({[`__scope${e.scopeName}`]:o}),[o])}};return t.scopeName=e.scopeName,t}function iA(n){const[e,t]=b.useState(void 0);return vn(()=>{if(n){t({width:n.offsetWidth,height:n.offsetHeight});const r=new ResizeObserver(s=>{if(!Array.isArray(s)||!s.length)return;const i=s[0];let o,a;if("borderBoxSize"in i){const l=i.borderBoxSize,c=Array.isArray(l)?l[0]:l;o=c.inlineSize,a=c.blockSize}else o=n.offsetWidth,a=n.offsetHeight;t({width:o,height:a})});return r.observe(n,{box:"border-box"}),()=>r.unobserve(n)}else t(void 0)},[n]),e}var jw="Popper",[oA,Zp]=eF(jw),[nF,aA]=oA(jw),lA=n=>{const{__scopePopper:e,children:t}=n,[r,s]=b.useState(null);return f.jsx(nF,{scope:e,anchor:r,onAnchorChange:s,children:t})};lA.displayName=jw;var cA="PopperAnchor",uA=b.forwardRef((n,e)=>{const{__scopePopper:t,virtualRef:r,...s}=n,i=aA(cA,t),o=b.useRef(null),a=ct(e,o);return b.useEffect(()=>{i.onAnchorChange((r==null?void 0:r.current)||o.current)}),r?null:f.jsx(Le.div,{...s,ref:a})});uA.displayName=cA;var Lw="PopperContent",[rF,sF]=oA(Lw),dA=b.forwardRef((n,e)=>{var J,K,ne,ie,ae,W;const{__scopePopper:t,side:r="bottom",sideOffset:s=0,align:i="center",alignOffset:o=0,arrowPadding:a=0,avoidCollisions:l=!0,collisionBoundary:c=[],collisionPadding:u=0,sticky:h="partial",hideWhenDetached:d=!1,updatePositionStrategy:p="optimized",onPlaced:m,...g}=n,y=aA(Lw,t),[x,v]=b.useState(null),w=ct(e,H=>v(H)),[_,S]=b.useState(null),E=iA(_),C=(E==null?void 0:E.width)??0,P=(E==null?void 0:E.height)??0,O=r+(i!=="center"?"-"+i:""),A=typeof u=="number"?u:{top:0,right:0,bottom:0,left:0,...u},R=Array.isArray(c)?c:[c],B=R.length>0,I={padding:A,boundary:R.filter(oF),altBoundary:B},{refs:L,floatingStyles:U,placement:F,isPositioned:D,middlewareData:k}=W8({strategy:"fixed",placement:O,whileElementsMounted:(...H)=>j8(...H,{animationFrame:p==="always"}),elements:{reference:y.anchor},middleware:[V8({mainAxis:s+P,alignmentAxis:o}),l&&G8({mainAxis:!0,crossAxis:!1,limiter:h==="partial"?q8():void 0,...I}),l&&Y8({...I}),X8({...I,apply:({elements:H,rects:G,availableWidth:Q,availableHeight:te})=>{const{width:he,height:xe}=G.reference,fe=H.floating.style;fe.setProperty("--radix-popper-available-width",`${Q}px`),fe.setProperty("--radix-popper-available-height",`${te}px`),fe.setProperty("--radix-popper-anchor-width",`${he}px`),fe.setProperty("--radix-popper-anchor-height",`${xe}px`)}}),_&&J8({element:_,padding:a}),aF({arrowWidth:C,arrowHeight:P}),d&&K8({strategy:"referenceHidden",...I})]}),[N,M]=pA(F),T=tr(m);vn(()=>{D&&(T==null||T())},[D,T]);const j=(J=k.arrow)==null?void 0:J.x,$=(K=k.arrow)==null?void 0:K.y,z=((ne=k.arrow)==null?void 0:ne.centerOffset)!==0,[ee,X]=b.useState();return vn(()=>{x&&X(window.getComputedStyle(x).zIndex)},[x]),f.jsx("div",{ref:L.setFloating,"data-radix-popper-content-wrapper":"",style:{...U,transform:D?U.transform:"translate(0, -200%)",minWidth:"max-content",zIndex:ee,"--radix-popper-transform-origin":[(ie=k.transformOrigin)==null?void 0:ie.x,(ae=k.transformOrigin)==null?void 0:ae.y].join(" "),...((W=k.hide)==null?void 0:W.referenceHidden)&&{visibility:"hidden",pointerEvents:"none"}},dir:n.dir,children:f.jsx(rF,{scope:t,placedSide:N,onArrowChange:S,arrowX:j,arrowY:$,shouldHideArrow:z,children:f.jsx(Le.div,{"data-side":N,"data-align":M,...g,ref:w,style:{...g.style,animation:D?void 0:"none"}})})})});dA.displayName=Lw;var hA="PopperArrow",iF={top:"bottom",right:"left",bottom:"top",left:"right"},fA=b.forwardRef(function(e,t){const{__scopePopper:r,...s}=e,i=sF(hA,r),o=iF[i.placedSide];return f.jsx("span",{ref:i.onArrowChange,style:{position:"absolute",left:i.arrowX,top:i.arrowY,[o]:0,transformOrigin:{top:"",right:"0 0",bottom:"center 0",left:"100% 0"}[i.placedSide],transform:{top:"translateY(100%)",right:"translateY(50%) rotate(90deg) translateX(-50%)",bottom:"rotate(180deg)",left:"translateY(50%) rotate(-90deg) translateX(50%)"}[i.placedSide],visibility:i.shouldHideArrow?"hidden":void 0},children:f.jsx(Z8,{...s,ref:t,style:{...s.style,display:"block"}})})});fA.displayName=hA;function oF(n){return n!==null}var aF=n=>({name:"transformOrigin",options:n,fn(e){var y,x,v;const{placement:t,rects:r,middlewareData:s}=e,o=((y=s.arrow)==null?void 0:y.centerOffset)!==0,a=o?0:n.arrowWidth,l=o?0:n.arrowHeight,[c,u]=pA(t),h={start:"0%",center:"50%",end:"100%"}[u],d=(((x=s.arrow)==null?void 0:x.x)??0)+a/2,p=(((v=s.arrow)==null?void 0:v.y)??0)+l/2;let m="",g="";return c==="bottom"?(m=o?h:`${d}px`,g=`${-l}px`):c==="top"?(m=o?h:`${d}px`,g=`${r.floating.height+l}px`):c==="right"?(m=`${-l}px`,g=o?h:`${p}px`):c==="left"&&(m=`${r.floating.width+l}px`,g=o?h:`${p}px`),{data:{x:m,y:g}}}});function pA(n){const[e,t="center"]=n.split("-");return[e,t]}var lF=lA,gA=uA,mA=dA,vA=fA,[e0,WZ]=xo("Tooltip",[Zp]),Mw=Zp(),yA="TooltipProvider",cF=700,aS="tooltip.open",[uF,xA]=e0(yA),wA=n=>{const{__scopeTooltip:e,delayDuration:t=cF,skipDelayDuration:r=300,disableHoverableContent:s=!1,children:i}=n,[o,a]=b.useState(!0),l=b.useRef(!1),c=b.useRef(0);return b.useEffect(()=>{const u=c.current;return()=>window.clearTimeout(u)},[]),f.jsx(uF,{scope:e,isOpenDelayed:o,delayDuration:t,onOpen:b.useCallback(()=>{window.clearTimeout(c.current),a(!1)},[]),onClose:b.useCallback(()=>{window.clearTimeout(c.current),c.current=window.setTimeout(()=>a(!0),r)},[r]),isPointerInTransitRef:l,onPointerInTransitChange:b.useCallback(u=>{l.current=u},[]),disableHoverableContent:s,children:i})};wA.displayName=yA;var bA="Tooltip",[HZ,t0]=e0(bA),yy="TooltipTrigger",dF=b.forwardRef((n,e)=>{const{__scopeTooltip:t,...r}=n,s=t0(yy,t),i=xA(yy,t),o=Mw(t),a=b.useRef(null),l=ct(e,a,s.onTriggerChange),c=b.useRef(!1),u=b.useRef(!1),h=b.useCallback(()=>c.current=!1,[]);return b.useEffect(()=>()=>document.removeEventListener("pointerup",h),[h]),f.jsx(gA,{asChild:!0,...o,children:f.jsx(Le.button,{"aria-describedby":s.open?s.contentId:void 0,"data-state":s.stateAttribute,...r,ref:l,onPointerMove:De(n.onPointerMove,d=>{d.pointerType!=="touch"&&!u.current&&!i.isPointerInTransitRef.current&&(s.onTriggerEnter(),u.current=!0)}),onPointerLeave:De(n.onPointerLeave,()=>{s.onTriggerLeave(),u.current=!1}),onPointerDown:De(n.onPointerDown,()=>{c.current=!0,document.addEventListener("pointerup",h,{once:!0})}),onFocus:De(n.onFocus,()=>{c.current||s.onOpen()}),onBlur:De(n.onBlur,s.onClose),onClick:De(n.onClick,s.onClose)})})});dF.displayName=yy;var hF="TooltipPortal",[VZ,fF]=e0(hF,{forceMount:void 0}),Xl="TooltipContent",_A=b.forwardRef((n,e)=>{const t=fF(Xl,n.__scopeTooltip),{forceMount:r=t.forceMount,side:s="top",...i}=n,o=t0(Xl,n.__scopeTooltip);return f.jsx(wo,{present:r||o.open,children:o.disableHoverableContent?f.jsx(SA,{side:s,...i,ref:e}):f.jsx(pF,{side:s,...i,ref:e})})}),pF=b.forwardRef((n,e)=>{const t=t0(Xl,n.__scopeTooltip),r=xA(Xl,n.__scopeTooltip),s=b.useRef(null),i=ct(e,s),[o,a]=b.useState(null),{trigger:l,onClose:c}=t,u=s.current,{onPointerInTransitChange:h}=r,d=b.useCallback(()=>{a(null),h(!1)},[h]),p=b.useCallback((m,g)=>{const y=m.currentTarget,x={x:m.clientX,y:m.clientY},v=yF(x,y.getBoundingClientRect()),w=xF(x,v),_=wF(g.getBoundingClientRect()),S=_F([...w,..._]);a(S),h(!0)},[h]);return b.useEffect(()=>()=>d(),[d]),b.useEffect(()=>{if(l&&u){const m=y=>p(y,u),g=y=>p(y,l);return l.addEventListener("pointerleave",m),u.addEventListener("pointerleave",g),()=>{l.removeEventListener("pointerleave",m),u.removeEventListener("pointerleave",g)}}},[l,u,p,d]),b.useEffect(()=>{if(o){const m=g=>{const y=g.target,x={x:g.clientX,y:g.clientY},v=(l==null?void 0:l.contains(y))||(u==null?void 0:u.contains(y)),w=!bF(x,o);v?d():w&&(d(),c())};return document.addEventListener("pointermove",m),()=>document.removeEventListener("pointermove",m)}},[l,u,o,c,d]),f.jsx(SA,{...n,ref:i})}),[gF,mF]=e0(bA,{isInside:!1}),SA=b.forwardRef((n,e)=>{const{__scopeTooltip:t,children:r,"aria-label":s,onEscapeKeyDown:i,onPointerDownOutside:o,...a}=n,l=t0(Xl,t),c=Mw(t),{onClose:u}=l;return b.useEffect(()=>(document.addEventListener(aS,u),()=>document.removeEventListener(aS,u)),[u]),b.useEffect(()=>{if(l.trigger){const h=d=>{const p=d.target;p!=null&&p.contains(l.trigger)&&u()};return window.addEventListener("scroll",h,{capture:!0}),()=>window.removeEventListener("scroll",h,{capture:!0})}},[l.trigger,u]),f.jsx(yd,{asChild:!0,disableOutsidePointerEvents:!1,onEscapeKeyDown:i,onPointerDownOutside:o,onFocusOutside:h=>h.preventDefault(),onDismiss:u,children:f.jsxs(mA,{"data-state":l.stateAttribute,...c,...a,ref:e,style:{...a.style,"--radix-tooltip-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-tooltip-content-available-width":"var(--radix-popper-available-width)","--radix-tooltip-content-available-height":"var(--radix-popper-available-height)","--radix-tooltip-trigger-width":"var(--radix-popper-anchor-width)","--radix-tooltip-trigger-height":"var(--radix-popper-anchor-height)"},children:[f.jsx(vw,{children:r}),f.jsx(gF,{scope:t,isInside:!0,children:f.jsx(Qj,{id:l.contentId,role:"tooltip",children:s||r})})]})})});_A.displayName=Xl;var CA="TooltipArrow",vF=b.forwardRef((n,e)=>{const{__scopeTooltip:t,...r}=n,s=Mw(t);return mF(CA,t).isInside?null:f.jsx(vA,{...s,...r,ref:e})});vF.displayName=CA;function yF(n,e){const t=Math.abs(e.top-n.y),r=Math.abs(e.bottom-n.y),s=Math.abs(e.right-n.x),i=Math.abs(e.left-n.x);switch(Math.min(t,r,s,i)){case i:return"left";case s:return"right";case t:return"top";case r:return"bottom";default:throw new Error("unreachable")}}function xF(n,e,t=5){const r=[];switch(e){case"top":r.push({x:n.x-t,y:n.y+t},{x:n.x+t,y:n.y+t});break;case"bottom":r.push({x:n.x-t,y:n.y-t},{x:n.x+t,y:n.y-t});break;case"left":r.push({x:n.x+t,y:n.y-t},{x:n.x+t,y:n.y+t});break;case"right":r.push({x:n.x-t,y:n.y-t},{x:n.x-t,y:n.y+t});break}return r}function wF(n){const{top:e,right:t,bottom:r,left:s}=n;return[{x:s,y:e},{x:t,y:e},{x:t,y:r},{x:s,y:r}]}function bF(n,e){const{x:t,y:r}=n;let s=!1;for(let i=0,o=e.length-1;i<e.length;o=i++){const a=e[i].x,l=e[i].y,c=e[o].x,u=e[o].y;l>r!=u>r&&t<(c-a)*(r-l)/(u-l)+a&&(s=!s)}return s}function _F(n){const e=n.slice();return e.sort((t,r)=>t.x<r.x?-1:t.x>r.x?1:t.y<r.y?-1:t.y>r.y?1:0),SF(e)}function SF(n){if(n.length<=1)return n.slice();const e=[];for(let r=0;r<n.length;r++){const s=n[r];for(;e.length>=2;){const i=e[e.length-1],o=e[e.length-2];if((i.x-o.x)*(s.y-o.y)>=(i.y-o.y)*(s.x-o.x))e.pop();else break}e.push(s)}e.pop();const t=[];for(let r=n.length-1;r>=0;r--){const s=n[r];for(;t.length>=2;){const i=t[t.length-1],o=t[t.length-2];if((i.x-o.x)*(s.y-o.y)>=(i.y-o.y)*(s.x-o.x))t.pop();else break}t.push(s)}return t.pop(),e.length===1&&t.length===1&&e[0].x===t[0].x&&e[0].y===t[0].y?e:e.concat(t)}var CF=wA,EA=_A;const EF=CF,kF=b.forwardRef(({className:n,sideOffset:e=4,...t},r)=>f.jsx(EA,{ref:r,sideOffset:e,className:Oe("z-50 overflow-hidden rounded-md border bg-popover px-3 py-1.5 text-sm text-popover-foreground shadow-md animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",n),...t}));kF.displayName=EA.displayName;var n0=class{constructor(){this.listeners=new Set,this.subscribe=this.subscribe.bind(this)}subscribe(n){return this.listeners.add(n),this.onSubscribe(),()=>{this.listeners.delete(n),this.onUnsubscribe()}}hasListeners(){return this.listeners.size>0}onSubscribe(){}onUnsubscribe(){}},r0=typeof window>"u"||"Deno"in globalThis;function Fr(){}function PF(n,e){return typeof n=="function"?n(e):n}function TF(n){return typeof n=="number"&&n>=0&&n!==1/0}function AF(n,e){return Math.max(n+(e||0)-Date.now(),0)}function lS(n,e){return typeof n=="function"?n(e):n}function DF(n,e){return typeof n=="function"?n(e):n}function cS(n,e){const{type:t="all",exact:r,fetchStatus:s,predicate:i,queryKey:o,stale:a}=n;if(o){if(r){if(e.queryHash!==Fw(o,e.options))return!1}else if(!Yu(e.queryKey,o))return!1}if(t!=="all"){const l=e.isActive();if(t==="active"&&!l||t==="inactive"&&l)return!1}return!(typeof a=="boolean"&&e.isStale()!==a||s&&s!==e.state.fetchStatus||i&&!i(e))}function uS(n,e){const{exact:t,status:r,predicate:s,mutationKey:i}=n;if(i){if(!e.options.mutationKey)return!1;if(t){if(qu(e.options.mutationKey)!==qu(i))return!1}else if(!Yu(e.options.mutationKey,i))return!1}return!(r&&e.state.status!==r||s&&!s(e))}function Fw(n,e){return((e==null?void 0:e.queryKeyHashFn)||qu)(n)}function qu(n){return JSON.stringify(n,(e,t)=>xy(t)?Object.keys(t).sort().reduce((r,s)=>(r[s]=t[s],r),{}):t)}function Yu(n,e){return n===e?!0:typeof n!=typeof e?!1:n&&e&&typeof n=="object"&&typeof e=="object"?!Object.keys(e).some(t=>!Yu(n[t],e[t])):!1}function kA(n,e){if(n===e)return n;const t=dS(n)&&dS(e);if(t||xy(n)&&xy(e)){const r=t?n:Object.keys(n),s=r.length,i=t?e:Object.keys(e),o=i.length,a=t?[]:{};let l=0;for(let c=0;c<o;c++){const u=t?c:i[c];(!t&&r.includes(u)||t)&&n[u]===void 0&&e[u]===void 0?(a[u]=void 0,l++):(a[u]=kA(n[u],e[u]),a[u]===n[u]&&n[u]!==void 0&&l++)}return s===o&&l===s?n:a}return e}function dS(n){return Array.isArray(n)&&n.length===Object.keys(n).length}function xy(n){if(!hS(n))return!1;const e=n.constructor;if(e===void 0)return!0;const t=e.prototype;return!(!hS(t)||!t.hasOwnProperty("isPrototypeOf")||Object.getPrototypeOf(n)!==Object.prototype)}function hS(n){return Object.prototype.toString.call(n)==="[object Object]"}function OF(n){return new Promise(e=>{setTimeout(e,n)})}function IF(n,e,t){return typeof t.structuralSharing=="function"?t.structuralSharing(n,e):t.structuralSharing!==!1?kA(n,e):e}function RF(n,e,t=0){const r=[...n,e];return t&&r.length>t?r.slice(1):r}function NF(n,e,t=0){const r=[e,...n];return t&&r.length>t?r.slice(0,-1):r}var Bw=Symbol();function PA(n,e){return!n.queryFn&&(e!=null&&e.initialPromise)?()=>e.initialPromise:!n.queryFn||n.queryFn===Bw?()=>Promise.reject(new Error(`Missing queryFn: '${n.queryHash}'`)):n.queryFn}var Qo,Bi,Dl,M2,jF=(M2=class extends n0{constructor(){super();at(this,Qo);at(this,Bi);at(this,Dl);He(this,Dl,e=>{if(!r0&&window.addEventListener){const t=()=>e();return window.addEventListener("visibilitychange",t,!1),()=>{window.removeEventListener("visibilitychange",t)}}})}onSubscribe(){se(this,Bi)||this.setEventListener(se(this,Dl))}onUnsubscribe(){var e;this.hasListeners()||((e=se(this,Bi))==null||e.call(this),He(this,Bi,void 0))}setEventListener(e){var t;He(this,Dl,e),(t=se(this,Bi))==null||t.call(this),He(this,Bi,e(r=>{typeof r=="boolean"?this.setFocused(r):this.onFocus()}))}setFocused(e){se(this,Qo)!==e&&(He(this,Qo,e),this.onFocus())}onFocus(){const e=this.isFocused();this.listeners.forEach(t=>{t(e)})}isFocused(){var e;return typeof se(this,Qo)=="boolean"?se(this,Qo):((e=globalThis.document)==null?void 0:e.visibilityState)!=="hidden"}},Qo=new WeakMap,Bi=new WeakMap,Dl=new WeakMap,M2),TA=new jF,Ol,Ui,Il,F2,LF=(F2=class extends n0{constructor(){super();at(this,Ol,!0);at(this,Ui);at(this,Il);He(this,Il,e=>{if(!r0&&window.addEventListener){const t=()=>e(!0),r=()=>e(!1);return window.addEventListener("online",t,!1),window.addEventListener("offline",r,!1),()=>{window.removeEventListener("online",t),window.removeEventListener("offline",r)}}})}onSubscribe(){se(this,Ui)||this.setEventListener(se(this,Il))}onUnsubscribe(){var e;this.hasListeners()||((e=se(this,Ui))==null||e.call(this),He(this,Ui,void 0))}setEventListener(e){var t;He(this,Il,e),(t=se(this,Ui))==null||t.call(this),He(this,Ui,e(this.setOnline.bind(this)))}setOnline(e){se(this,Ol)!==e&&(He(this,Ol,e),this.listeners.forEach(r=>{r(e)}))}isOnline(){return se(this,Ol)}},Ol=new WeakMap,Ui=new WeakMap,Il=new WeakMap,F2),ep=new LF;function MF(){let n,e;const t=new Promise((s,i)=>{n=s,e=i});t.status="pending",t.catch(()=>{});function r(s){Object.assign(t,s),delete t.resolve,delete t.reject}return t.resolve=s=>{r({status:"fulfilled",value:s}),n(s)},t.reject=s=>{r({status:"rejected",reason:s}),e(s)},t}function FF(n){return Math.min(1e3*2**n,3e4)}function AA(n){return(n??"online")==="online"?ep.isOnline():!0}var DA=class extends Error{constructor(n){super("CancelledError"),this.revert=n==null?void 0:n.revert,this.silent=n==null?void 0:n.silent}};function Tg(n){return n instanceof DA}function OA(n){let e=!1,t=0,r=!1,s;const i=MF(),o=g=>{var y;r||(d(new DA(g)),(y=n.abort)==null||y.call(n))},a=()=>{e=!0},l=()=>{e=!1},c=()=>TA.isFocused()&&(n.networkMode==="always"||ep.isOnline())&&n.canRun(),u=()=>AA(n.networkMode)&&n.canRun(),h=g=>{var y;r||(r=!0,(y=n.onSuccess)==null||y.call(n,g),s==null||s(),i.resolve(g))},d=g=>{var y;r||(r=!0,(y=n.onError)==null||y.call(n,g),s==null||s(),i.reject(g))},p=()=>new Promise(g=>{var y;s=x=>{(r||c())&&g(x)},(y=n.onPause)==null||y.call(n)}).then(()=>{var g;s=void 0,r||(g=n.onContinue)==null||g.call(n)}),m=()=>{if(r)return;let g;const y=t===0?n.initialPromise:void 0;try{g=y??n.fn()}catch(x){g=Promise.reject(x)}Promise.resolve(g).then(h).catch(x=>{var E;if(r)return;const v=n.retry??(r0?0:3),w=n.retryDelay??FF,_=typeof w=="function"?w(t,x):w,S=v===!0||typeof v=="number"&&t<v||typeof v=="function"&&v(t,x);if(e||!S){d(x);return}t++,(E=n.onFail)==null||E.call(n,t,x),OF(_).then(()=>c()?void 0:p()).then(()=>{e?d(x):m()})})};return{promise:i,cancel:o,continue:()=>(s==null||s(),i),cancelRetry:a,continueRetry:l,canStart:u,start:()=>(u()?m():p().then(m),i)}}function BF(){let n=[],e=0,t=a=>{a()},r=a=>{a()},s=a=>setTimeout(a,0);const i=a=>{e?n.push(a):s(()=>{t(a)})},o=()=>{const a=n;n=[],a.length&&s(()=>{r(()=>{a.forEach(l=>{t(l)})})})};return{batch:a=>{let l;e++;try{l=a()}finally{e--,e||o()}return l},batchCalls:a=>(...l)=>{i(()=>{a(...l)})},schedule:i,setNotifyFunction:a=>{t=a},setBatchNotifyFunction:a=>{r=a},setScheduler:a=>{s=a}}}var In=BF(),Zo,B2,IA=(B2=class{constructor(){at(this,Zo)}destroy(){this.clearGcTimeout()}scheduleGc(){this.clearGcTimeout(),TF(this.gcTime)&&He(this,Zo,setTimeout(()=>{this.optionalRemove()},this.gcTime))}updateGcTime(n){this.gcTime=Math.max(this.gcTime||0,n??(r0?1/0:5*60*1e3))}clearGcTimeout(){se(this,Zo)&&(clearTimeout(se(this,Zo)),He(this,Zo,void 0))}},Zo=new WeakMap,B2),Rl,Nl,wr,Sn,dd,ea,Br,ks,U2,UF=(U2=class extends IA{constructor(e){super();at(this,Br);at(this,Rl);at(this,Nl);at(this,wr);at(this,Sn);at(this,dd);at(this,ea);He(this,ea,!1),He(this,dd,e.defaultOptions),this.setOptions(e.options),this.observers=[],He(this,wr,e.cache),this.queryKey=e.queryKey,this.queryHash=e.queryHash,He(this,Rl,zF(this.options)),this.state=e.state??se(this,Rl),this.scheduleGc()}get meta(){return this.options.meta}get promise(){var e;return(e=se(this,Sn))==null?void 0:e.promise}setOptions(e){this.options={...se(this,dd),...e},this.updateGcTime(this.options.gcTime)}optionalRemove(){!this.observers.length&&this.state.fetchStatus==="idle"&&se(this,wr).remove(this)}setData(e,t){const r=IF(this.state.data,e,this.options);return xn(this,Br,ks).call(this,{data:r,type:"success",dataUpdatedAt:t==null?void 0:t.updatedAt,manual:t==null?void 0:t.manual}),r}setState(e,t){xn(this,Br,ks).call(this,{type:"setState",state:e,setStateOptions:t})}cancel(e){var r,s;const t=(r=se(this,Sn))==null?void 0:r.promise;return(s=se(this,Sn))==null||s.cancel(e),t?t.then(Fr).catch(Fr):Promise.resolve()}destroy(){super.destroy(),this.cancel({silent:!0})}reset(){this.destroy(),this.setState(se(this,Rl))}isActive(){return this.observers.some(e=>DF(e.options.enabled,this)!==!1)}isDisabled(){return this.getObserversCount()>0?!this.isActive():this.options.queryFn===Bw||this.state.dataUpdateCount+this.state.errorUpdateCount===0}isStale(){return this.state.isInvalidated?!0:this.getObserversCount()>0?this.observers.some(e=>e.getCurrentResult().isStale):this.state.data===void 0}isStaleByTime(e=0){return this.state.isInvalidated||this.state.data===void 0||!AF(this.state.dataUpdatedAt,e)}onFocus(){var t;const e=this.observers.find(r=>r.shouldFetchOnWindowFocus());e==null||e.refetch({cancelRefetch:!1}),(t=se(this,Sn))==null||t.continue()}onOnline(){var t;const e=this.observers.find(r=>r.shouldFetchOnReconnect());e==null||e.refetch({cancelRefetch:!1}),(t=se(this,Sn))==null||t.continue()}addObserver(e){this.observers.includes(e)||(this.observers.push(e),this.clearGcTimeout(),se(this,wr).notify({type:"observerAdded",query:this,observer:e}))}removeObserver(e){this.observers.includes(e)&&(this.observers=this.observers.filter(t=>t!==e),this.observers.length||(se(this,Sn)&&(se(this,ea)?se(this,Sn).cancel({revert:!0}):se(this,Sn).cancelRetry()),this.scheduleGc()),se(this,wr).notify({type:"observerRemoved",query:this,observer:e}))}getObserversCount(){return this.observers.length}invalidate(){this.state.isInvalidated||xn(this,Br,ks).call(this,{type:"invalidate"})}fetch(e,t){var l,c,u;if(this.state.fetchStatus!=="idle"){if(this.state.data!==void 0&&(t!=null&&t.cancelRefetch))this.cancel({silent:!0});else if(se(this,Sn))return se(this,Sn).continueRetry(),se(this,Sn).promise}if(e&&this.setOptions(e),!this.options.queryFn){const h=this.observers.find(d=>d.options.queryFn);h&&this.setOptions(h.options)}const r=new AbortController,s=h=>{Object.defineProperty(h,"signal",{enumerable:!0,get:()=>(He(this,ea,!0),r.signal)})},i=()=>{const h=PA(this.options,t),d={queryKey:this.queryKey,meta:this.meta};return s(d),He(this,ea,!1),this.options.persister?this.options.persister(h,d,this):h(d)},o={fetchOptions:t,options:this.options,queryKey:this.queryKey,state:this.state,fetchFn:i};s(o),(l=this.options.behavior)==null||l.onFetch(o,this),He(this,Nl,this.state),(this.state.fetchStatus==="idle"||this.state.fetchMeta!==((c=o.fetchOptions)==null?void 0:c.meta))&&xn(this,Br,ks).call(this,{type:"fetch",meta:(u=o.fetchOptions)==null?void 0:u.meta});const a=h=>{var d,p,m,g;Tg(h)&&h.silent||xn(this,Br,ks).call(this,{type:"error",error:h}),Tg(h)||((p=(d=se(this,wr).config).onError)==null||p.call(d,h,this),(g=(m=se(this,wr).config).onSettled)==null||g.call(m,this.state.data,h,this)),this.scheduleGc()};return He(this,Sn,OA({initialPromise:t==null?void 0:t.initialPromise,fn:o.fetchFn,abort:r.abort.bind(r),onSuccess:h=>{var d,p,m,g;if(h===void 0){a(new Error(`${this.queryHash} data is undefined`));return}try{this.setData(h)}catch(y){a(y);return}(p=(d=se(this,wr).config).onSuccess)==null||p.call(d,h,this),(g=(m=se(this,wr).config).onSettled)==null||g.call(m,h,this.state.error,this),this.scheduleGc()},onError:a,onFail:(h,d)=>{xn(this,Br,ks).call(this,{type:"failed",failureCount:h,error:d})},onPause:()=>{xn(this,Br,ks).call(this,{type:"pause"})},onContinue:()=>{xn(this,Br,ks).call(this,{type:"continue"})},retry:o.options.retry,retryDelay:o.options.retryDelay,networkMode:o.options.networkMode,canRun:()=>!0})),se(this,Sn).start()}},Rl=new WeakMap,Nl=new WeakMap,wr=new WeakMap,Sn=new WeakMap,dd=new WeakMap,ea=new WeakMap,Br=new WeakSet,ks=function(e){const t=r=>{switch(e.type){case"failed":return{...r,fetchFailureCount:e.failureCount,fetchFailureReason:e.error};case"pause":return{...r,fetchStatus:"paused"};case"continue":return{...r,fetchStatus:"fetching"};case"fetch":return{...r,...$F(r.data,this.options),fetchMeta:e.meta??null};case"success":return{...r,data:e.data,dataUpdateCount:r.dataUpdateCount+1,dataUpdatedAt:e.dataUpdatedAt??Date.now(),error:null,isInvalidated:!1,status:"success",...!e.manual&&{fetchStatus:"idle",fetchFailureCount:0,fetchFailureReason:null}};case"error":const s=e.error;return Tg(s)&&s.revert&&se(this,Nl)?{...se(this,Nl),fetchStatus:"idle"}:{...r,error:s,errorUpdateCount:r.errorUpdateCount+1,errorUpdatedAt:Date.now(),fetchFailureCount:r.fetchFailureCount+1,fetchFailureReason:s,fetchStatus:"idle",status:"error"};case"invalidate":return{...r,isInvalidated:!0};case"setState":return{...r,...e.state}}};this.state=t(this.state),In.batch(()=>{this.observers.forEach(r=>{r.onQueryUpdate()}),se(this,wr).notify({query:this,type:"updated",action:e})})},U2);function $F(n,e){return{fetchFailureCount:0,fetchFailureReason:null,fetchStatus:AA(e.networkMode)?"fetching":"paused",...n===void 0&&{error:null,status:"pending"}}}function zF(n){const e=typeof n.initialData=="function"?n.initialData():n.initialData,t=e!==void 0,r=t?typeof n.initialDataUpdatedAt=="function"?n.initialDataUpdatedAt():n.initialDataUpdatedAt:0;return{data:e,dataUpdateCount:0,dataUpdatedAt:t?r??Date.now():0,error:null,errorUpdateCount:0,errorUpdatedAt:0,fetchFailureCount:0,fetchFailureReason:null,fetchMeta:null,isInvalidated:!1,status:t?"success":"pending",fetchStatus:"idle"}}var as,$2,WF=($2=class extends n0{constructor(e={}){super();at(this,as);this.config=e,He(this,as,new Map)}build(e,t,r){const s=t.queryKey,i=t.queryHash??Fw(s,t);let o=this.get(i);return o||(o=new UF({cache:this,queryKey:s,queryHash:i,options:e.defaultQueryOptions(t),state:r,defaultOptions:e.getQueryDefaults(s)}),this.add(o)),o}add(e){se(this,as).has(e.queryHash)||(se(this,as).set(e.queryHash,e),this.notify({type:"added",query:e}))}remove(e){const t=se(this,as).get(e.queryHash);t&&(e.destroy(),t===e&&se(this,as).delete(e.queryHash),this.notify({type:"removed",query:e}))}clear(){In.batch(()=>{this.getAll().forEach(e=>{this.remove(e)})})}get(e){return se(this,as).get(e)}getAll(){return[...se(this,as).values()]}find(e){const t={exact:!0,...e};return this.getAll().find(r=>cS(t,r))}findAll(e={}){const t=this.getAll();return Object.keys(e).length>0?t.filter(r=>cS(e,r)):t}notify(e){In.batch(()=>{this.listeners.forEach(t=>{t(e)})})}onFocus(){In.batch(()=>{this.getAll().forEach(e=>{e.onFocus()})})}onOnline(){In.batch(()=>{this.getAll().forEach(e=>{e.onOnline()})})}},as=new WeakMap,$2),ls,Dn,ta,cs,Ei,z2,HF=(z2=class extends IA{constructor(e){super();at(this,cs);at(this,ls);at(this,Dn);at(this,ta);this.mutationId=e.mutationId,He(this,Dn,e.mutationCache),He(this,ls,[]),this.state=e.state||VF(),this.setOptions(e.options),this.scheduleGc()}setOptions(e){this.options=e,this.updateGcTime(this.options.gcTime)}get meta(){return this.options.meta}addObserver(e){se(this,ls).includes(e)||(se(this,ls).push(e),this.clearGcTimeout(),se(this,Dn).notify({type:"observerAdded",mutation:this,observer:e}))}removeObserver(e){He(this,ls,se(this,ls).filter(t=>t!==e)),this.scheduleGc(),se(this,Dn).notify({type:"observerRemoved",mutation:this,observer:e})}optionalRemove(){se(this,ls).length||(this.state.status==="pending"?this.scheduleGc():se(this,Dn).remove(this))}continue(){var e;return((e=se(this,ta))==null?void 0:e.continue())??this.execute(this.state.variables)}async execute(e){var s,i,o,a,l,c,u,h,d,p,m,g,y,x,v,w,_,S,E,C;He(this,ta,OA({fn:()=>this.options.mutationFn?this.options.mutationFn(e):Promise.reject(new Error("No mutationFn found")),onFail:(P,O)=>{xn(this,cs,Ei).call(this,{type:"failed",failureCount:P,error:O})},onPause:()=>{xn(this,cs,Ei).call(this,{type:"pause"})},onContinue:()=>{xn(this,cs,Ei).call(this,{type:"continue"})},retry:this.options.retry??0,retryDelay:this.options.retryDelay,networkMode:this.options.networkMode,canRun:()=>se(this,Dn).canRun(this)}));const t=this.state.status==="pending",r=!se(this,ta).canStart();try{if(!t){xn(this,cs,Ei).call(this,{type:"pending",variables:e,isPaused:r}),await((i=(s=se(this,Dn).config).onMutate)==null?void 0:i.call(s,e,this));const O=await((a=(o=this.options).onMutate)==null?void 0:a.call(o,e));O!==this.state.context&&xn(this,cs,Ei).call(this,{type:"pending",context:O,variables:e,isPaused:r})}const P=await se(this,ta).start();return await((c=(l=se(this,Dn).config).onSuccess)==null?void 0:c.call(l,P,e,this.state.context,this)),await((h=(u=this.options).onSuccess)==null?void 0:h.call(u,P,e,this.state.context)),await((p=(d=se(this,Dn).config).onSettled)==null?void 0:p.call(d,P,null,this.state.variables,this.state.context,this)),await((g=(m=this.options).onSettled)==null?void 0:g.call(m,P,null,e,this.state.context)),xn(this,cs,Ei).call(this,{type:"success",data:P}),P}catch(P){try{throw await((x=(y=se(this,Dn).config).onError)==null?void 0:x.call(y,P,e,this.state.context,this)),await((w=(v=this.options).onError)==null?void 0:w.call(v,P,e,this.state.context)),await((S=(_=se(this,Dn).config).onSettled)==null?void 0:S.call(_,void 0,P,this.state.variables,this.state.context,this)),await((C=(E=this.options).onSettled)==null?void 0:C.call(E,void 0,P,e,this.state.context)),P}finally{xn(this,cs,Ei).call(this,{type:"error",error:P})}}finally{se(this,Dn).runNext(this)}}},ls=new WeakMap,Dn=new WeakMap,ta=new WeakMap,cs=new WeakSet,Ei=function(e){const t=r=>{switch(e.type){case"failed":return{...r,failureCount:e.failureCount,failureReason:e.error};case"pause":return{...r,isPaused:!0};case"continue":return{...r,isPaused:!1};case"pending":return{...r,context:e.context,data:void 0,failureCount:0,failureReason:null,error:null,isPaused:e.isPaused,status:"pending",variables:e.variables,submittedAt:Date.now()};case"success":return{...r,data:e.data,failureCount:0,failureReason:null,error:null,status:"success",isPaused:!1};case"error":return{...r,data:void 0,error:e.error,failureCount:r.failureCount+1,failureReason:e.error,isPaused:!1,status:"error"}}};this.state=t(this.state),In.batch(()=>{se(this,ls).forEach(r=>{r.onMutationUpdate(e)}),se(this,Dn).notify({mutation:this,type:"updated",action:e})})},z2);function VF(){return{context:void 0,data:void 0,error:null,failureCount:0,failureReason:null,isPaused:!1,status:"idle",variables:void 0,submittedAt:0}}var or,hd,W2,GF=(W2=class extends n0{constructor(e={}){super();at(this,or);at(this,hd);this.config=e,He(this,or,new Map),He(this,hd,Date.now())}build(e,t,r){const s=new HF({mutationCache:this,mutationId:++Wd(this,hd)._,options:e.defaultMutationOptions(t),state:r});return this.add(s),s}add(e){const t=dh(e),r=se(this,or).get(t)??[];r.push(e),se(this,or).set(t,r),this.notify({type:"added",mutation:e})}remove(e){var r;const t=dh(e);if(se(this,or).has(t)){const s=(r=se(this,or).get(t))==null?void 0:r.filter(i=>i!==e);s&&(s.length===0?se(this,or).delete(t):se(this,or).set(t,s))}this.notify({type:"removed",mutation:e})}canRun(e){var r;const t=(r=se(this,or).get(dh(e)))==null?void 0:r.find(s=>s.state.status==="pending");return!t||t===e}runNext(e){var r;const t=(r=se(this,or).get(dh(e)))==null?void 0:r.find(s=>s!==e&&s.state.isPaused);return(t==null?void 0:t.continue())??Promise.resolve()}clear(){In.batch(()=>{this.getAll().forEach(e=>{this.remove(e)})})}getAll(){return[...se(this,or).values()].flat()}find(e){const t={exact:!0,...e};return this.getAll().find(r=>uS(t,r))}findAll(e={}){return this.getAll().filter(t=>uS(e,t))}notify(e){In.batch(()=>{this.listeners.forEach(t=>{t(e)})})}resumePausedMutations(){const e=this.getAll().filter(t=>t.state.isPaused);return In.batch(()=>Promise.all(e.map(t=>t.continue().catch(Fr))))}},or=new WeakMap,hd=new WeakMap,W2);function dh(n){var e;return((e=n.options.scope)==null?void 0:e.id)??String(n.mutationId)}function fS(n){return{onFetch:(e,t)=>{var u,h,d,p,m;const r=e.options,s=(d=(h=(u=e.fetchOptions)==null?void 0:u.meta)==null?void 0:h.fetchMore)==null?void 0:d.direction,i=((p=e.state.data)==null?void 0:p.pages)||[],o=((m=e.state.data)==null?void 0:m.pageParams)||[];let a={pages:[],pageParams:[]},l=0;const c=async()=>{let g=!1;const y=w=>{Object.defineProperty(w,"signal",{enumerable:!0,get:()=>(e.signal.aborted?g=!0:e.signal.addEventListener("abort",()=>{g=!0}),e.signal)})},x=PA(e.options,e.fetchOptions),v=async(w,_,S)=>{if(g)return Promise.reject();if(_==null&&w.pages.length)return Promise.resolve(w);const E={queryKey:e.queryKey,pageParam:_,direction:S?"backward":"forward",meta:e.options.meta};y(E);const C=await x(E),{maxPages:P}=e.options,O=S?NF:RF;return{pages:O(w.pages,C,P),pageParams:O(w.pageParams,_,P)}};if(s&&i.length){const w=s==="backward",_=w?qF:pS,S={pages:i,pageParams:o},E=_(r,S);a=await v(S,E,w)}else{const w=n??i.length;do{const _=l===0?o[0]??r.initialPageParam:pS(r,a);if(l>0&&_==null)break;a=await v(a,_),l++}while(l<w)}return a};e.options.persister?e.fetchFn=()=>{var g,y;return(y=(g=e.options).persister)==null?void 0:y.call(g,c,{queryKey:e.queryKey,meta:e.options.meta,signal:e.signal},t)}:e.fetchFn=c}}}function pS(n,{pages:e,pageParams:t}){const r=e.length-1;return e.length>0?n.getNextPageParam(e[r],e,t[r],t):void 0}function qF(n,{pages:e,pageParams:t}){var r;return e.length>0?(r=n.getPreviousPageParam)==null?void 0:r.call(n,e[0],e,t[0],t):void 0}var Rt,$i,zi,jl,Ll,Wi,Ml,Fl,H2,YF=(H2=class{constructor(n={}){at(this,Rt);at(this,$i);at(this,zi);at(this,jl);at(this,Ll);at(this,Wi);at(this,Ml);at(this,Fl);He(this,Rt,n.queryCache||new WF),He(this,$i,n.mutationCache||new GF),He(this,zi,n.defaultOptions||{}),He(this,jl,new Map),He(this,Ll,new Map),He(this,Wi,0)}mount(){Wd(this,Wi)._++,se(this,Wi)===1&&(He(this,Ml,TA.subscribe(async n=>{n&&(await this.resumePausedMutations(),se(this,Rt).onFocus())})),He(this,Fl,ep.subscribe(async n=>{n&&(await this.resumePausedMutations(),se(this,Rt).onOnline())})))}unmount(){var n,e;Wd(this,Wi)._--,se(this,Wi)===0&&((n=se(this,Ml))==null||n.call(this),He(this,Ml,void 0),(e=se(this,Fl))==null||e.call(this),He(this,Fl,void 0))}isFetching(n){return se(this,Rt).findAll({...n,fetchStatus:"fetching"}).length}isMutating(n){return se(this,$i).findAll({...n,status:"pending"}).length}getQueryData(n){var t;const e=this.defaultQueryOptions({queryKey:n});return(t=se(this,Rt).get(e.queryHash))==null?void 0:t.state.data}ensureQueryData(n){const e=this.getQueryData(n.queryKey);if(e===void 0)return this.fetchQuery(n);{const t=this.defaultQueryOptions(n),r=se(this,Rt).build(this,t);return n.revalidateIfStale&&r.isStaleByTime(lS(t.staleTime,r))&&this.prefetchQuery(t),Promise.resolve(e)}}getQueriesData(n){return se(this,Rt).findAll(n).map(({queryKey:e,state:t})=>{const r=t.data;return[e,r]})}setQueryData(n,e,t){const r=this.defaultQueryOptions({queryKey:n}),s=se(this,Rt).get(r.queryHash),i=s==null?void 0:s.state.data,o=PF(e,i);if(o!==void 0)return se(this,Rt).build(this,r).setData(o,{...t,manual:!0})}setQueriesData(n,e,t){return In.batch(()=>se(this,Rt).findAll(n).map(({queryKey:r})=>[r,this.setQueryData(r,e,t)]))}getQueryState(n){var t;const e=this.defaultQueryOptions({queryKey:n});return(t=se(this,Rt).get(e.queryHash))==null?void 0:t.state}removeQueries(n){const e=se(this,Rt);In.batch(()=>{e.findAll(n).forEach(t=>{e.remove(t)})})}resetQueries(n,e){const t=se(this,Rt),r={type:"active",...n};return In.batch(()=>(t.findAll(n).forEach(s=>{s.reset()}),this.refetchQueries(r,e)))}cancelQueries(n={},e={}){const t={revert:!0,...e},r=In.batch(()=>se(this,Rt).findAll(n).map(s=>s.cancel(t)));return Promise.all(r).then(Fr).catch(Fr)}invalidateQueries(n={},e={}){return In.batch(()=>{if(se(this,Rt).findAll(n).forEach(r=>{r.invalidate()}),n.refetchType==="none")return Promise.resolve();const t={...n,type:n.refetchType??n.type??"active"};return this.refetchQueries(t,e)})}refetchQueries(n={},e){const t={...e,cancelRefetch:(e==null?void 0:e.cancelRefetch)??!0},r=In.batch(()=>se(this,Rt).findAll(n).filter(s=>!s.isDisabled()).map(s=>{let i=s.fetch(void 0,t);return t.throwOnError||(i=i.catch(Fr)),s.state.fetchStatus==="paused"?Promise.resolve():i}));return Promise.all(r).then(Fr)}fetchQuery(n){const e=this.defaultQueryOptions(n);e.retry===void 0&&(e.retry=!1);const t=se(this,Rt).build(this,e);return t.isStaleByTime(lS(e.staleTime,t))?t.fetch(e):Promise.resolve(t.state.data)}prefetchQuery(n){return this.fetchQuery(n).then(Fr).catch(Fr)}fetchInfiniteQuery(n){return n.behavior=fS(n.pages),this.fetchQuery(n)}prefetchInfiniteQuery(n){return this.fetchInfiniteQuery(n).then(Fr).catch(Fr)}ensureInfiniteQueryData(n){return n.behavior=fS(n.pages),this.ensureQueryData(n)}resumePausedMutations(){return ep.isOnline()?se(this,$i).resumePausedMutations():Promise.resolve()}getQueryCache(){return se(this,Rt)}getMutationCache(){return se(this,$i)}getDefaultOptions(){return se(this,zi)}setDefaultOptions(n){He(this,zi,n)}setQueryDefaults(n,e){se(this,jl).set(qu(n),{queryKey:n,defaultOptions:e})}getQueryDefaults(n){const e=[...se(this,jl).values()];let t={};return e.forEach(r=>{Yu(n,r.queryKey)&&(t={...t,...r.defaultOptions})}),t}setMutationDefaults(n,e){se(this,Ll).set(qu(n),{mutationKey:n,defaultOptions:e})}getMutationDefaults(n){const e=[...se(this,Ll).values()];let t={};return e.forEach(r=>{Yu(n,r.mutationKey)&&(t={...t,...r.defaultOptions})}),t}defaultQueryOptions(n){if(n._defaulted)return n;const e={...se(this,zi).queries,...this.getQueryDefaults(n.queryKey),...n,_defaulted:!0};return e.queryHash||(e.queryHash=Fw(e.queryKey,e)),e.refetchOnReconnect===void 0&&(e.refetchOnReconnect=e.networkMode!=="always"),e.throwOnError===void 0&&(e.throwOnError=!!e.suspense),!e.networkMode&&e.persister&&(e.networkMode="offlineFirst"),e.enabled!==!0&&e.queryFn===Bw&&(e.enabled=!1),e}defaultMutationOptions(n){return n!=null&&n._defaulted?n:{...se(this,zi).mutations,...(n==null?void 0:n.mutationKey)&&this.getMutationDefaults(n.mutationKey),...n,_defaulted:!0}}clear(){se(this,Rt).clear(),se(this,$i).clear()}},Rt=new WeakMap,$i=new WeakMap,zi=new WeakMap,jl=new WeakMap,Ll=new WeakMap,Wi=new WeakMap,Ml=new WeakMap,Fl=new WeakMap,H2),XF=b.createContext(void 0),KF=({client:n,children:e})=>(b.useEffect(()=>(n.mount(),()=>{n.unmount()}),[n]),f.jsx(XF.Provider,{value:n,children:e}));/**
 * @remix-run/router v1.20.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Xu(){return Xu=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},Xu.apply(this,arguments)}var Gi;(function(n){n.Pop="POP",n.Push="PUSH",n.Replace="REPLACE"})(Gi||(Gi={}));const gS="popstate";function JF(n){n===void 0&&(n={});function e(r,s){let{pathname:i,search:o,hash:a}=r.location;return wy("",{pathname:i,search:o,hash:a},s.state&&s.state.usr||null,s.state&&s.state.key||"default")}function t(r,s){return typeof s=="string"?s:tp(s)}return ZF(e,t,null,n)}function Vt(n,e){if(n===!1||n===null||typeof n>"u")throw new Error(e)}function RA(n,e){if(!n){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function QF(){return Math.random().toString(36).substr(2,8)}function mS(n,e){return{usr:n.state,key:n.key,idx:e}}function wy(n,e,t,r){return t===void 0&&(t=null),Xu({pathname:typeof n=="string"?n:n.pathname,search:"",hash:""},typeof e=="string"?cc(e):e,{state:t,key:e&&e.key||r||QF()})}function tp(n){let{pathname:e="/",search:t="",hash:r=""}=n;return t&&t!=="?"&&(e+=t.charAt(0)==="?"?t:"?"+t),r&&r!=="#"&&(e+=r.charAt(0)==="#"?r:"#"+r),e}function cc(n){let e={};if(n){let t=n.indexOf("#");t>=0&&(e.hash=n.substr(t),n=n.substr(0,t));let r=n.indexOf("?");r>=0&&(e.search=n.substr(r),n=n.substr(0,r)),n&&(e.pathname=n)}return e}function ZF(n,e,t,r){r===void 0&&(r={});let{window:s=document.defaultView,v5Compat:i=!1}=r,o=s.history,a=Gi.Pop,l=null,c=u();c==null&&(c=0,o.replaceState(Xu({},o.state,{idx:c}),""));function u(){return(o.state||{idx:null}).idx}function h(){a=Gi.Pop;let y=u(),x=y==null?null:y-c;c=y,l&&l({action:a,location:g.location,delta:x})}function d(y,x){a=Gi.Push;let v=wy(g.location,y,x);c=u()+1;let w=mS(v,c),_=g.createHref(v);try{o.pushState(w,"",_)}catch(S){if(S instanceof DOMException&&S.name==="DataCloneError")throw S;s.location.assign(_)}i&&l&&l({action:a,location:g.location,delta:1})}function p(y,x){a=Gi.Replace;let v=wy(g.location,y,x);c=u();let w=mS(v,c),_=g.createHref(v);o.replaceState(w,"",_),i&&l&&l({action:a,location:g.location,delta:0})}function m(y){let x=s.location.origin!=="null"?s.location.origin:s.location.href,v=typeof y=="string"?y:tp(y);return v=v.replace(/ $/,"%20"),Vt(x,"No window.location.(origin|href) available to create URL for href: "+v),new URL(v,x)}let g={get action(){return a},get location(){return n(s,o)},listen(y){if(l)throw new Error("A history only accepts one active listener");return s.addEventListener(gS,h),l=y,()=>{s.removeEventListener(gS,h),l=null}},createHref(y){return e(s,y)},createURL:m,encodeLocation(y){let x=m(y);return{pathname:x.pathname,search:x.search,hash:x.hash}},push:d,replace:p,go(y){return o.go(y)}};return g}var vS;(function(n){n.data="data",n.deferred="deferred",n.redirect="redirect",n.error="error"})(vS||(vS={}));function e6(n,e,t){return t===void 0&&(t="/"),t6(n,e,t,!1)}function t6(n,e,t,r){let s=typeof e=="string"?cc(e):e,i=Uw(s.pathname||"/",t);if(i==null)return null;let o=NA(n);n6(o);let a=null;for(let l=0;a==null&&l<o.length;++l){let c=f6(i);a=d6(o[l],c,r)}return a}function NA(n,e,t,r){e===void 0&&(e=[]),t===void 0&&(t=[]),r===void 0&&(r="");let s=(i,o,a)=>{let l={relativePath:a===void 0?i.path||"":a,caseSensitive:i.caseSensitive===!0,childrenIndex:o,route:i};l.relativePath.startsWith("/")&&(Vt(l.relativePath.startsWith(r),'Absolute route path "'+l.relativePath+'" nested under path '+('"'+r+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),l.relativePath=l.relativePath.slice(r.length));let c=ro([r,l.relativePath]),u=t.concat(l);i.children&&i.children.length>0&&(Vt(i.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+c+'".')),NA(i.children,e,u,c)),!(i.path==null&&!i.index)&&e.push({path:c,score:c6(c,i.index),routesMeta:u})};return n.forEach((i,o)=>{var a;if(i.path===""||!((a=i.path)!=null&&a.includes("?")))s(i,o);else for(let l of jA(i.path))s(i,o,l)}),e}function jA(n){let e=n.split("/");if(e.length===0)return[];let[t,...r]=e,s=t.endsWith("?"),i=t.replace(/\?$/,"");if(r.length===0)return s?[i,""]:[i];let o=jA(r.join("/")),a=[];return a.push(...o.map(l=>l===""?i:[i,l].join("/"))),s&&a.push(...o),a.map(l=>n.startsWith("/")&&l===""?"/":l)}function n6(n){n.sort((e,t)=>e.score!==t.score?t.score-e.score:u6(e.routesMeta.map(r=>r.childrenIndex),t.routesMeta.map(r=>r.childrenIndex)))}const r6=/^:[\w-]+$/,s6=3,i6=2,o6=1,a6=10,l6=-2,yS=n=>n==="*";function c6(n,e){let t=n.split("/"),r=t.length;return t.some(yS)&&(r+=l6),e&&(r+=i6),t.filter(s=>!yS(s)).reduce((s,i)=>s+(r6.test(i)?s6:i===""?o6:a6),r)}function u6(n,e){return n.length===e.length&&n.slice(0,-1).every((r,s)=>r===e[s])?n[n.length-1]-e[e.length-1]:0}function d6(n,e,t){let{routesMeta:r}=n,s={},i="/",o=[];for(let a=0;a<r.length;++a){let l=r[a],c=a===r.length-1,u=i==="/"?e:e.slice(i.length)||"/",h=xS({path:l.relativePath,caseSensitive:l.caseSensitive,end:c},u),d=l.route;if(!h&&c&&t&&!r[r.length-1].route.index&&(h=xS({path:l.relativePath,caseSensitive:l.caseSensitive,end:!1},u)),!h)return null;Object.assign(s,h.params),o.push({params:s,pathname:ro([i,h.pathname]),pathnameBase:v6(ro([i,h.pathnameBase])),route:d}),h.pathnameBase!=="/"&&(i=ro([i,h.pathnameBase]))}return o}function xS(n,e){typeof n=="string"&&(n={path:n,caseSensitive:!1,end:!0});let[t,r]=h6(n.path,n.caseSensitive,n.end),s=e.match(t);if(!s)return null;let i=s[0],o=i.replace(/(.)\/+$/,"$1"),a=s.slice(1);return{params:r.reduce((c,u,h)=>{let{paramName:d,isOptional:p}=u;if(d==="*"){let g=a[h]||"";o=i.slice(0,i.length-g.length).replace(/(.)\/+$/,"$1")}const m=a[h];return p&&!m?c[d]=void 0:c[d]=(m||"").replace(/%2F/g,"/"),c},{}),pathname:i,pathnameBase:o,pattern:n}}function h6(n,e,t){e===void 0&&(e=!1),t===void 0&&(t=!0),RA(n==="*"||!n.endsWith("*")||n.endsWith("/*"),'Route path "'+n+'" will be treated as if it were '+('"'+n.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+n.replace(/\*$/,"/*")+'".'));let r=[],s="^"+n.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(o,a,l)=>(r.push({paramName:a,isOptional:l!=null}),l?"/?([^\\/]+)?":"/([^\\/]+)"));return n.endsWith("*")?(r.push({paramName:"*"}),s+=n==="*"||n==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):t?s+="\\/*$":n!==""&&n!=="/"&&(s+="(?:(?=\\/|$))"),[new RegExp(s,e?void 0:"i"),r]}function f6(n){try{return n.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return RA(!1,'The URL path "'+n+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+e+").")),n}}function Uw(n,e){if(e==="/")return n;if(!n.toLowerCase().startsWith(e.toLowerCase()))return null;let t=e.endsWith("/")?e.length-1:e.length,r=n.charAt(t);return r&&r!=="/"?null:n.slice(t)||"/"}function p6(n,e){e===void 0&&(e="/");let{pathname:t,search:r="",hash:s=""}=typeof n=="string"?cc(n):n;return{pathname:t?t.startsWith("/")?t:g6(t,e):e,search:y6(r),hash:x6(s)}}function g6(n,e){let t=e.replace(/\/+$/,"").split("/");return n.split("/").forEach(s=>{s===".."?t.length>1&&t.pop():s!=="."&&t.push(s)}),t.length>1?t.join("/"):"/"}function Ag(n,e,t,r){return"Cannot include a '"+n+"' character in a manually specified "+("`to."+e+"` field ["+JSON.stringify(r)+"].  Please separate it out to the ")+("`to."+t+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function m6(n){return n.filter((e,t)=>t===0||e.route.path&&e.route.path.length>0)}function LA(n,e){let t=m6(n);return e?t.map((r,s)=>s===t.length-1?r.pathname:r.pathnameBase):t.map(r=>r.pathnameBase)}function MA(n,e,t,r){r===void 0&&(r=!1);let s;typeof n=="string"?s=cc(n):(s=Xu({},n),Vt(!s.pathname||!s.pathname.includes("?"),Ag("?","pathname","search",s)),Vt(!s.pathname||!s.pathname.includes("#"),Ag("#","pathname","hash",s)),Vt(!s.search||!s.search.includes("#"),Ag("#","search","hash",s)));let i=n===""||s.pathname==="",o=i?"/":s.pathname,a;if(o==null)a=t;else{let h=e.length-1;if(!r&&o.startsWith("..")){let d=o.split("/");for(;d[0]==="..";)d.shift(),h-=1;s.pathname=d.join("/")}a=h>=0?e[h]:"/"}let l=p6(s,a),c=o&&o!=="/"&&o.endsWith("/"),u=(i||o===".")&&t.endsWith("/");return!l.pathname.endsWith("/")&&(c||u)&&(l.pathname+="/"),l}const ro=n=>n.join("/").replace(/\/\/+/g,"/"),v6=n=>n.replace(/\/+$/,"").replace(/^\/*/,"/"),y6=n=>!n||n==="?"?"":n.startsWith("?")?n:"?"+n,x6=n=>!n||n==="#"?"":n.startsWith("#")?n:"#"+n;function w6(n){return n!=null&&typeof n.status=="number"&&typeof n.statusText=="string"&&typeof n.internal=="boolean"&&"data"in n}const FA=["post","put","patch","delete"];new Set(FA);const b6=["get",...FA];new Set(b6);/**
 * React Router v6.27.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Ku(){return Ku=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},Ku.apply(this,arguments)}const $w=b.createContext(null),_6=b.createContext(null),_a=b.createContext(null),s0=b.createContext(null),bo=b.createContext({outlet:null,matches:[],isDataRoute:!1}),BA=b.createContext(null);function S6(n,e){let{relative:t}=e===void 0?{}:e;_d()||Vt(!1);let{basename:r,navigator:s}=b.useContext(_a),{hash:i,pathname:o,search:a}=$A(n,{relative:t}),l=o;return r!=="/"&&(l=o==="/"?r:ro([r,o])),s.createHref({pathname:l,search:a,hash:i})}function _d(){return b.useContext(s0)!=null}function Sa(){return _d()||Vt(!1),b.useContext(s0).location}function UA(n){b.useContext(_a).static||b.useLayoutEffect(n)}function vs(){let{isDataRoute:n}=b.useContext(bo);return n?M6():C6()}function C6(){_d()||Vt(!1);let n=b.useContext($w),{basename:e,future:t,navigator:r}=b.useContext(_a),{matches:s}=b.useContext(bo),{pathname:i}=Sa(),o=JSON.stringify(LA(s,t.v7_relativeSplatPath)),a=b.useRef(!1);return UA(()=>{a.current=!0}),b.useCallback(function(c,u){if(u===void 0&&(u={}),!a.current)return;if(typeof c=="number"){r.go(c);return}let h=MA(c,JSON.parse(o),i,u.relative==="path");n==null&&e!=="/"&&(h.pathname=h.pathname==="/"?e:ro([e,h.pathname])),(u.replace?r.replace:r.push)(h,u.state,u)},[e,r,o,i,n])}function E6(){let{matches:n}=b.useContext(bo),e=n[n.length-1];return e?e.params:{}}function $A(n,e){let{relative:t}=e===void 0?{}:e,{future:r}=b.useContext(_a),{matches:s}=b.useContext(bo),{pathname:i}=Sa(),o=JSON.stringify(LA(s,r.v7_relativeSplatPath));return b.useMemo(()=>MA(n,JSON.parse(o),i,t==="path"),[n,o,i,t])}function k6(n,e){return P6(n,e)}function P6(n,e,t,r){_d()||Vt(!1);let{navigator:s}=b.useContext(_a),{matches:i}=b.useContext(bo),o=i[i.length-1],a=o?o.params:{};o&&o.pathname;let l=o?o.pathnameBase:"/";o&&o.route;let c=Sa(),u;if(e){var h;let y=typeof e=="string"?cc(e):e;l==="/"||(h=y.pathname)!=null&&h.startsWith(l)||Vt(!1),u=y}else u=c;let d=u.pathname||"/",p=d;if(l!=="/"){let y=l.replace(/^\//,"").split("/");p="/"+d.replace(/^\//,"").split("/").slice(y.length).join("/")}let m=e6(n,{pathname:p}),g=I6(m&&m.map(y=>Object.assign({},y,{params:Object.assign({},a,y.params),pathname:ro([l,s.encodeLocation?s.encodeLocation(y.pathname).pathname:y.pathname]),pathnameBase:y.pathnameBase==="/"?l:ro([l,s.encodeLocation?s.encodeLocation(y.pathnameBase).pathname:y.pathnameBase])})),i,t,r);return e&&g?b.createElement(s0.Provider,{value:{location:Ku({pathname:"/",search:"",hash:"",state:null,key:"default"},u),navigationType:Gi.Pop}},g):g}function T6(){let n=L6(),e=w6(n)?n.status+" "+n.statusText:n instanceof Error?n.message:JSON.stringify(n),t=n instanceof Error?n.stack:null,s={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return b.createElement(b.Fragment,null,b.createElement("h2",null,"Unexpected Application Error!"),b.createElement("h3",{style:{fontStyle:"italic"}},e),t?b.createElement("pre",{style:s},t):null,null)}const A6=b.createElement(T6,null);class D6 extends b.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,t){return t.location!==e.location||t.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:t.error,location:t.location,revalidation:e.revalidation||t.revalidation}}componentDidCatch(e,t){console.error("React Router caught the following error during render",e,t)}render(){return this.state.error!==void 0?b.createElement(bo.Provider,{value:this.props.routeContext},b.createElement(BA.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function O6(n){let{routeContext:e,match:t,children:r}=n,s=b.useContext($w);return s&&s.static&&s.staticContext&&(t.route.errorElement||t.route.ErrorBoundary)&&(s.staticContext._deepestRenderedBoundaryId=t.route.id),b.createElement(bo.Provider,{value:e},r)}function I6(n,e,t,r){var s;if(e===void 0&&(e=[]),t===void 0&&(t=null),r===void 0&&(r=null),n==null){var i;if(!t)return null;if(t.errors)n=t.matches;else if((i=r)!=null&&i.v7_partialHydration&&e.length===0&&!t.initialized&&t.matches.length>0)n=t.matches;else return null}let o=n,a=(s=t)==null?void 0:s.errors;if(a!=null){let u=o.findIndex(h=>h.route.id&&(a==null?void 0:a[h.route.id])!==void 0);u>=0||Vt(!1),o=o.slice(0,Math.min(o.length,u+1))}let l=!1,c=-1;if(t&&r&&r.v7_partialHydration)for(let u=0;u<o.length;u++){let h=o[u];if((h.route.HydrateFallback||h.route.hydrateFallbackElement)&&(c=u),h.route.id){let{loaderData:d,errors:p}=t,m=h.route.loader&&d[h.route.id]===void 0&&(!p||p[h.route.id]===void 0);if(h.route.lazy||m){l=!0,c>=0?o=o.slice(0,c+1):o=[o[0]];break}}}return o.reduceRight((u,h,d)=>{let p,m=!1,g=null,y=null;t&&(p=a&&h.route.id?a[h.route.id]:void 0,g=h.route.errorElement||A6,l&&(c<0&&d===0?(m=!0,y=null):c===d&&(m=!0,y=h.route.hydrateFallbackElement||null)));let x=e.concat(o.slice(0,d+1)),v=()=>{let w;return p?w=g:m?w=y:h.route.Component?w=b.createElement(h.route.Component,null):h.route.element?w=h.route.element:w=u,b.createElement(O6,{match:h,routeContext:{outlet:u,matches:x,isDataRoute:t!=null},children:w})};return t&&(h.route.ErrorBoundary||h.route.errorElement||d===0)?b.createElement(D6,{location:t.location,revalidation:t.revalidation,component:g,error:p,children:v(),routeContext:{outlet:null,matches:x,isDataRoute:!0}}):v()},null)}var zA=function(n){return n.UseBlocker="useBlocker",n.UseRevalidator="useRevalidator",n.UseNavigateStable="useNavigate",n}(zA||{}),np=function(n){return n.UseBlocker="useBlocker",n.UseLoaderData="useLoaderData",n.UseActionData="useActionData",n.UseRouteError="useRouteError",n.UseNavigation="useNavigation",n.UseRouteLoaderData="useRouteLoaderData",n.UseMatches="useMatches",n.UseRevalidator="useRevalidator",n.UseNavigateStable="useNavigate",n.UseRouteId="useRouteId",n}(np||{});function R6(n){let e=b.useContext($w);return e||Vt(!1),e}function N6(n){let e=b.useContext(_6);return e||Vt(!1),e}function j6(n){let e=b.useContext(bo);return e||Vt(!1),e}function WA(n){let e=j6(),t=e.matches[e.matches.length-1];return t.route.id||Vt(!1),t.route.id}function L6(){var n;let e=b.useContext(BA),t=N6(np.UseRouteError),r=WA(np.UseRouteError);return e!==void 0?e:(n=t.errors)==null?void 0:n[r]}function M6(){let{router:n}=R6(zA.UseNavigateStable),e=WA(np.UseNavigateStable),t=b.useRef(!1);return UA(()=>{t.current=!0}),b.useCallback(function(s,i){i===void 0&&(i={}),t.current&&(typeof s=="number"?n.navigate(s):n.navigate(s,Ku({fromRouteId:e},i)))},[n,e])}function ze(n){Vt(!1)}function F6(n){let{basename:e="/",children:t=null,location:r,navigationType:s=Gi.Pop,navigator:i,static:o=!1,future:a}=n;_d()&&Vt(!1);let l=e.replace(/^\/*/,"/"),c=b.useMemo(()=>({basename:l,navigator:i,static:o,future:Ku({v7_relativeSplatPath:!1},a)}),[l,a,i,o]);typeof r=="string"&&(r=cc(r));let{pathname:u="/",search:h="",hash:d="",state:p=null,key:m="default"}=r,g=b.useMemo(()=>{let y=Uw(u,l);return y==null?null:{location:{pathname:y,search:h,hash:d,state:p,key:m},navigationType:s}},[l,u,h,d,p,m,s]);return g==null?null:b.createElement(_a.Provider,{value:c},b.createElement(s0.Provider,{children:t,value:g}))}function B6(n){let{children:e,location:t}=n;return k6(by(e),t)}new Promise(()=>{});function by(n,e){e===void 0&&(e=[]);let t=[];return b.Children.forEach(n,(r,s)=>{if(!b.isValidElement(r))return;let i=[...e,s];if(r.type===b.Fragment){t.push.apply(t,by(r.props.children,i));return}r.type!==ze&&Vt(!1),!r.props.index||!r.props.children||Vt(!1);let o={id:r.props.id||i.join("-"),caseSensitive:r.props.caseSensitive,element:r.props.element,Component:r.props.Component,index:r.props.index,path:r.props.path,loader:r.props.loader,action:r.props.action,errorElement:r.props.errorElement,ErrorBoundary:r.props.ErrorBoundary,hasErrorBoundary:r.props.ErrorBoundary!=null||r.props.errorElement!=null,shouldRevalidate:r.props.shouldRevalidate,handle:r.props.handle,lazy:r.props.lazy};r.props.children&&(o.children=by(r.props.children,i)),t.push(o)}),t}/**
 * React Router DOM v6.27.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function _y(){return _y=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},_y.apply(this,arguments)}function U6(n,e){if(n==null)return{};var t={},r=Object.keys(n),s,i;for(i=0;i<r.length;i++)s=r[i],!(e.indexOf(s)>=0)&&(t[s]=n[s]);return t}function $6(n){return!!(n.metaKey||n.altKey||n.ctrlKey||n.shiftKey)}function z6(n,e){return n.button===0&&(!e||e==="_self")&&!$6(n)}function Sy(n){return n===void 0&&(n=""),new URLSearchParams(typeof n=="string"||Array.isArray(n)||n instanceof URLSearchParams?n:Object.keys(n).reduce((e,t)=>{let r=n[t];return e.concat(Array.isArray(r)?r.map(s=>[t,s]):[[t,r]])},[]))}function W6(n,e){let t=Sy(n);return e&&e.forEach((r,s)=>{t.has(s)||e.getAll(s).forEach(i=>{t.append(s,i)})}),t}const H6=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],V6="6";try{window.__reactRouterVersion=V6}catch{}const G6="startTransition",wS=rk[G6];function q6(n){let{basename:e,children:t,future:r,window:s}=n,i=b.useRef();i.current==null&&(i.current=JF({window:s,v5Compat:!0}));let o=i.current,[a,l]=b.useState({action:o.action,location:o.location}),{v7_startTransition:c}=r||{},u=b.useCallback(h=>{c&&wS?wS(()=>l(h)):l(h)},[l,c]);return b.useLayoutEffect(()=>o.listen(u),[o,u]),b.createElement(F6,{basename:e,children:t,location:a.location,navigationType:a.action,navigator:o,future:r})}const Y6=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",X6=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,GZ=b.forwardRef(function(e,t){let{onClick:r,relative:s,reloadDocument:i,replace:o,state:a,target:l,to:c,preventScrollReset:u,viewTransition:h}=e,d=U6(e,H6),{basename:p}=b.useContext(_a),m,g=!1;if(typeof c=="string"&&X6.test(c)&&(m=c,Y6))try{let w=new URL(window.location.href),_=c.startsWith("//")?new URL(w.protocol+c):new URL(c),S=Uw(_.pathname,p);_.origin===w.origin&&S!=null?c=S+_.search+_.hash:g=!0}catch{}let y=S6(c,{relative:s}),x=K6(c,{replace:o,state:a,target:l,preventScrollReset:u,relative:s,viewTransition:h});function v(w){r&&r(w),w.defaultPrevented||x(w)}return b.createElement("a",_y({},d,{href:m||y,onClick:g||i?r:v,ref:t,target:l}))});var bS;(function(n){n.UseScrollRestoration="useScrollRestoration",n.UseSubmit="useSubmit",n.UseSubmitFetcher="useSubmitFetcher",n.UseFetcher="useFetcher",n.useViewTransitionState="useViewTransitionState"})(bS||(bS={}));var _S;(function(n){n.UseFetcher="useFetcher",n.UseFetchers="useFetchers",n.UseScrollRestoration="useScrollRestoration"})(_S||(_S={}));function K6(n,e){let{target:t,replace:r,state:s,preventScrollReset:i,relative:o,viewTransition:a}=e===void 0?{}:e,l=vs(),c=Sa(),u=$A(n,{relative:o});return b.useCallback(h=>{if(z6(h,t)){h.preventDefault();let d=r!==void 0?r:tp(c)===tp(u);l(n,{replace:d,state:s,preventScrollReset:i,relative:o,viewTransition:a})}},[c,l,u,r,s,t,n,i,o,a])}function J6(n){let e=b.useRef(Sy(n)),t=b.useRef(!1),r=Sa(),s=b.useMemo(()=>W6(r.search,t.current?null:e.current),[r.search]),i=vs(),o=b.useCallback((a,l)=>{const c=Sy(typeof a=="function"?a(s):a);t.current=!0,i("?"+c,l)},[i,s]);return[s,o]}const Q6=n=>{let e;return n?e=n:typeof fetch>"u"?e=(...t)=>Ae(async()=>{const{default:r}=await Promise.resolve().then(()=>uc);return{default:r}},void 0).then(({default:r})=>r(...t)):e=fetch,(...t)=>e(...t)};class zw extends Error{constructor(e,t="FunctionsError",r){super(e),this.name=t,this.context=r}}class Z6 extends zw{constructor(e){super("Failed to send a request to the Edge Function","FunctionsFetchError",e)}}class SS extends zw{constructor(e){super("Relay Error invoking the Edge Function","FunctionsRelayError",e)}}class CS extends zw{constructor(e){super("Edge Function returned a non-2xx status code","FunctionsHttpError",e)}}var Cy;(function(n){n.Any="any",n.ApNortheast1="ap-northeast-1",n.ApNortheast2="ap-northeast-2",n.ApSouth1="ap-south-1",n.ApSoutheast1="ap-southeast-1",n.ApSoutheast2="ap-southeast-2",n.CaCentral1="ca-central-1",n.EuCentral1="eu-central-1",n.EuWest1="eu-west-1",n.EuWest2="eu-west-2",n.EuWest3="eu-west-3",n.SaEast1="sa-east-1",n.UsEast1="us-east-1",n.UsWest1="us-west-1",n.UsWest2="us-west-2"})(Cy||(Cy={}));var eB=function(n,e,t,r){function s(i){return i instanceof t?i:new t(function(o){o(i)})}return new(t||(t=Promise))(function(i,o){function a(u){try{c(r.next(u))}catch(h){o(h)}}function l(u){try{c(r.throw(u))}catch(h){o(h)}}function c(u){u.done?i(u.value):s(u.value).then(a,l)}c((r=r.apply(n,e||[])).next())})};class tB{constructor(e,{headers:t={},customFetch:r,region:s=Cy.Any}={}){this.url=e,this.headers=t,this.region=s,this.fetch=Q6(r)}setAuth(e){this.headers.Authorization=`Bearer ${e}`}invoke(e,t={}){var r;return eB(this,void 0,void 0,function*(){try{const{headers:s,method:i,body:o}=t;let a={},{region:l}=t;l||(l=this.region);const c=new URL(`${this.url}/${e}`);l&&l!=="any"&&(a["x-region"]=l,c.searchParams.set("forceFunctionRegion",l));let u;o&&(s&&!Object.prototype.hasOwnProperty.call(s,"Content-Type")||!s)&&(typeof Blob<"u"&&o instanceof Blob||o instanceof ArrayBuffer?(a["Content-Type"]="application/octet-stream",u=o):typeof o=="string"?(a["Content-Type"]="text/plain",u=o):typeof FormData<"u"&&o instanceof FormData?u=o:(a["Content-Type"]="application/json",u=JSON.stringify(o)));const h=yield this.fetch(c.toString(),{method:i||"POST",headers:Object.assign(Object.assign(Object.assign({},a),this.headers),s),body:u}).catch(g=>{throw new Z6(g)}),d=h.headers.get("x-relay-error");if(d&&d==="true")throw new SS(h);if(!h.ok)throw new CS(h);let p=((r=h.headers.get("Content-Type"))!==null&&r!==void 0?r:"text/plain").split(";")[0].trim(),m;return p==="application/json"?m=yield h.json():p==="application/octet-stream"?m=yield h.blob():p==="text/event-stream"?m=h:p==="multipart/form-data"?m=yield h.formData():m=yield h.text(),{data:m,error:null,response:h}}catch(s){return{data:null,error:s,response:s instanceof CS||s instanceof SS?s.context:void 0}}})}}var Gn={},Ww={},i0={},Sd={},o0={},a0={},nB=function(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("unable to locate global object")},Kl=nB();const rB=Kl.fetch,HA=Kl.fetch.bind(Kl),VA=Kl.Headers,sB=Kl.Request,iB=Kl.Response,uc=Object.freeze(Object.defineProperty({__proto__:null,Headers:VA,Request:sB,Response:iB,default:HA,fetch:rB},Symbol.toStringTag,{value:"Module"})),oB=G2(uc);var l0={};Object.defineProperty(l0,"__esModule",{value:!0});let aB=class extends Error{constructor(e){super(e.message),this.name="PostgrestError",this.details=e.details,this.hint=e.hint,this.code=e.code}};l0.default=aB;var GA=Ie&&Ie.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(a0,"__esModule",{value:!0});const lB=GA(oB),cB=GA(l0);let uB=class{constructor(e){this.shouldThrowOnError=!1,this.method=e.method,this.url=e.url,this.headers=e.headers,this.schema=e.schema,this.body=e.body,this.shouldThrowOnError=e.shouldThrowOnError,this.signal=e.signal,this.isMaybeSingle=e.isMaybeSingle,e.fetch?this.fetch=e.fetch:typeof fetch>"u"?this.fetch=lB.default:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(e,t){return this.headers=Object.assign({},this.headers),this.headers[e]=t,this}then(e,t){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers["Accept-Profile"]=this.schema:this.headers["Content-Profile"]=this.schema),this.method!=="GET"&&this.method!=="HEAD"&&(this.headers["Content-Type"]="application/json");const r=this.fetch;let s=r(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async i=>{var o,a,l;let c=null,u=null,h=null,d=i.status,p=i.statusText;if(i.ok){if(this.method!=="HEAD"){const x=await i.text();x===""||(this.headers.Accept==="text/csv"||this.headers.Accept&&this.headers.Accept.includes("application/vnd.pgrst.plan+text")?u=x:u=JSON.parse(x))}const g=(o=this.headers.Prefer)===null||o===void 0?void 0:o.match(/count=(exact|planned|estimated)/),y=(a=i.headers.get("content-range"))===null||a===void 0?void 0:a.split("/");g&&y&&y.length>1&&(h=parseInt(y[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(u)&&(u.length>1?(c={code:"PGRST116",details:`Results contain ${u.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},u=null,h=null,d=406,p="Not Acceptable"):u.length===1?u=u[0]:u=null)}else{const g=await i.text();try{c=JSON.parse(g),Array.isArray(c)&&i.status===404&&(u=[],c=null,d=200,p="OK")}catch{i.status===404&&g===""?(d=204,p="No Content"):c={message:g}}if(c&&this.isMaybeSingle&&(!((l=c==null?void 0:c.details)===null||l===void 0)&&l.includes("0 rows"))&&(c=null,d=200,p="OK"),c&&this.shouldThrowOnError)throw new cB.default(c)}return{error:c,data:u,count:h,status:d,statusText:p}});return this.shouldThrowOnError||(s=s.catch(i=>{var o,a,l;return{error:{message:`${(o=i==null?void 0:i.name)!==null&&o!==void 0?o:"FetchError"}: ${i==null?void 0:i.message}`,details:`${(a=i==null?void 0:i.stack)!==null&&a!==void 0?a:""}`,hint:"",code:`${(l=i==null?void 0:i.code)!==null&&l!==void 0?l:""}`},data:null,count:null,status:0,statusText:""}})),s.then(e,t)}returns(){return this}overrideTypes(){return this}};a0.default=uB;var dB=Ie&&Ie.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(o0,"__esModule",{value:!0});const hB=dB(a0);let fB=class extends hB.default{select(e){let t=!1;const r=(e??"*").split("").map(s=>/\s/.test(s)&&!t?"":(s==='"'&&(t=!t),s)).join("");return this.url.searchParams.set("select",r),this.headers.Prefer&&(this.headers.Prefer+=","),this.headers.Prefer+="return=representation",this}order(e,{ascending:t=!0,nullsFirst:r,foreignTable:s,referencedTable:i=s}={}){const o=i?`${i}.order`:"order",a=this.url.searchParams.get(o);return this.url.searchParams.set(o,`${a?`${a},`:""}${e}.${t?"asc":"desc"}${r===void 0?"":r?".nullsfirst":".nullslast"}`),this}limit(e,{foreignTable:t,referencedTable:r=t}={}){const s=typeof r>"u"?"limit":`${r}.limit`;return this.url.searchParams.set(s,`${e}`),this}range(e,t,{foreignTable:r,referencedTable:s=r}={}){const i=typeof s>"u"?"offset":`${s}.offset`,o=typeof s>"u"?"limit":`${s}.limit`;return this.url.searchParams.set(i,`${e}`),this.url.searchParams.set(o,`${t-e+1}`),this}abortSignal(e){return this.signal=e,this}single(){return this.headers.Accept="application/vnd.pgrst.object+json",this}maybeSingle(){return this.method==="GET"?this.headers.Accept="application/json":this.headers.Accept="application/vnd.pgrst.object+json",this.isMaybeSingle=!0,this}csv(){return this.headers.Accept="text/csv",this}geojson(){return this.headers.Accept="application/geo+json",this}explain({analyze:e=!1,verbose:t=!1,settings:r=!1,buffers:s=!1,wal:i=!1,format:o="text"}={}){var a;const l=[e?"analyze":null,t?"verbose":null,r?"settings":null,s?"buffers":null,i?"wal":null].filter(Boolean).join("|"),c=(a=this.headers.Accept)!==null&&a!==void 0?a:"application/json";return this.headers.Accept=`application/vnd.pgrst.plan+${o}; for="${c}"; options=${l};`,o==="json"?this:this}rollback(){var e;return((e=this.headers.Prefer)!==null&&e!==void 0?e:"").trim().length>0?this.headers.Prefer+=",tx=rollback":this.headers.Prefer="tx=rollback",this}returns(){return this}};o0.default=fB;var pB=Ie&&Ie.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(Sd,"__esModule",{value:!0});const gB=pB(o0);let mB=class extends gB.default{eq(e,t){return this.url.searchParams.append(e,`eq.${t}`),this}neq(e,t){return this.url.searchParams.append(e,`neq.${t}`),this}gt(e,t){return this.url.searchParams.append(e,`gt.${t}`),this}gte(e,t){return this.url.searchParams.append(e,`gte.${t}`),this}lt(e,t){return this.url.searchParams.append(e,`lt.${t}`),this}lte(e,t){return this.url.searchParams.append(e,`lte.${t}`),this}like(e,t){return this.url.searchParams.append(e,`like.${t}`),this}likeAllOf(e,t){return this.url.searchParams.append(e,`like(all).{${t.join(",")}}`),this}likeAnyOf(e,t){return this.url.searchParams.append(e,`like(any).{${t.join(",")}}`),this}ilike(e,t){return this.url.searchParams.append(e,`ilike.${t}`),this}ilikeAllOf(e,t){return this.url.searchParams.append(e,`ilike(all).{${t.join(",")}}`),this}ilikeAnyOf(e,t){return this.url.searchParams.append(e,`ilike(any).{${t.join(",")}}`),this}is(e,t){return this.url.searchParams.append(e,`is.${t}`),this}in(e,t){const r=Array.from(new Set(t)).map(s=>typeof s=="string"&&new RegExp("[,()]").test(s)?`"${s}"`:`${s}`).join(",");return this.url.searchParams.append(e,`in.(${r})`),this}contains(e,t){return typeof t=="string"?this.url.searchParams.append(e,`cs.${t}`):Array.isArray(t)?this.url.searchParams.append(e,`cs.{${t.join(",")}}`):this.url.searchParams.append(e,`cs.${JSON.stringify(t)}`),this}containedBy(e,t){return typeof t=="string"?this.url.searchParams.append(e,`cd.${t}`):Array.isArray(t)?this.url.searchParams.append(e,`cd.{${t.join(",")}}`):this.url.searchParams.append(e,`cd.${JSON.stringify(t)}`),this}rangeGt(e,t){return this.url.searchParams.append(e,`sr.${t}`),this}rangeGte(e,t){return this.url.searchParams.append(e,`nxl.${t}`),this}rangeLt(e,t){return this.url.searchParams.append(e,`sl.${t}`),this}rangeLte(e,t){return this.url.searchParams.append(e,`nxr.${t}`),this}rangeAdjacent(e,t){return this.url.searchParams.append(e,`adj.${t}`),this}overlaps(e,t){return typeof t=="string"?this.url.searchParams.append(e,`ov.${t}`):this.url.searchParams.append(e,`ov.{${t.join(",")}}`),this}textSearch(e,t,{config:r,type:s}={}){let i="";s==="plain"?i="pl":s==="phrase"?i="ph":s==="websearch"&&(i="w");const o=r===void 0?"":`(${r})`;return this.url.searchParams.append(e,`${i}fts${o}.${t}`),this}match(e){return Object.entries(e).forEach(([t,r])=>{this.url.searchParams.append(t,`eq.${r}`)}),this}not(e,t,r){return this.url.searchParams.append(e,`not.${t}.${r}`),this}or(e,{foreignTable:t,referencedTable:r=t}={}){const s=r?`${r}.or`:"or";return this.url.searchParams.append(s,`(${e})`),this}filter(e,t,r){return this.url.searchParams.append(e,`${t}.${r}`),this}};Sd.default=mB;var vB=Ie&&Ie.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(i0,"__esModule",{value:!0});const zc=vB(Sd);let yB=class{constructor(e,{headers:t={},schema:r,fetch:s}){this.url=e,this.headers=t,this.schema=r,this.fetch=s}select(e,{head:t=!1,count:r}={}){const s=t?"HEAD":"GET";let i=!1;const o=(e??"*").split("").map(a=>/\s/.test(a)&&!i?"":(a==='"'&&(i=!i),a)).join("");return this.url.searchParams.set("select",o),r&&(this.headers.Prefer=`count=${r}`),new zc.default({method:s,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}insert(e,{count:t,defaultToNull:r=!0}={}){const s="POST",i=[];if(this.headers.Prefer&&i.push(this.headers.Prefer),t&&i.push(`count=${t}`),r||i.push("missing=default"),this.headers.Prefer=i.join(","),Array.isArray(e)){const o=e.reduce((a,l)=>a.concat(Object.keys(l)),[]);if(o.length>0){const a=[...new Set(o)].map(l=>`"${l}"`);this.url.searchParams.set("columns",a.join(","))}}return new zc.default({method:s,url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:this.fetch,allowEmpty:!1})}upsert(e,{onConflict:t,ignoreDuplicates:r=!1,count:s,defaultToNull:i=!0}={}){const o="POST",a=[`resolution=${r?"ignore":"merge"}-duplicates`];if(t!==void 0&&this.url.searchParams.set("on_conflict",t),this.headers.Prefer&&a.push(this.headers.Prefer),s&&a.push(`count=${s}`),i||a.push("missing=default"),this.headers.Prefer=a.join(","),Array.isArray(e)){const l=e.reduce((c,u)=>c.concat(Object.keys(u)),[]);if(l.length>0){const c=[...new Set(l)].map(u=>`"${u}"`);this.url.searchParams.set("columns",c.join(","))}}return new zc.default({method:o,url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:this.fetch,allowEmpty:!1})}update(e,{count:t}={}){const r="PATCH",s=[];return this.headers.Prefer&&s.push(this.headers.Prefer),t&&s.push(`count=${t}`),this.headers.Prefer=s.join(","),new zc.default({method:r,url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:this.fetch,allowEmpty:!1})}delete({count:e}={}){const t="DELETE",r=[];return e&&r.push(`count=${e}`),this.headers.Prefer&&r.unshift(this.headers.Prefer),this.headers.Prefer=r.join(","),new zc.default({method:t,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}};i0.default=yB;var c0={},u0={};Object.defineProperty(u0,"__esModule",{value:!0});u0.version=void 0;u0.version="0.0.0-automated";Object.defineProperty(c0,"__esModule",{value:!0});c0.DEFAULT_HEADERS=void 0;const xB=u0;c0.DEFAULT_HEADERS={"X-Client-Info":`postgrest-js/${xB.version}`};var qA=Ie&&Ie.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(Ww,"__esModule",{value:!0});const wB=qA(i0),bB=qA(Sd),_B=c0;let SB=class YA{constructor(e,{headers:t={},schema:r,fetch:s}={}){this.url=e,this.headers=Object.assign(Object.assign({},_B.DEFAULT_HEADERS),t),this.schemaName=r,this.fetch=s}from(e){const t=new URL(`${this.url}/${e}`);return new wB.default(t,{headers:Object.assign({},this.headers),schema:this.schemaName,fetch:this.fetch})}schema(e){return new YA(this.url,{headers:this.headers,schema:e,fetch:this.fetch})}rpc(e,t={},{head:r=!1,get:s=!1,count:i}={}){let o;const a=new URL(`${this.url}/rpc/${e}`);let l;r||s?(o=r?"HEAD":"GET",Object.entries(t).filter(([u,h])=>h!==void 0).map(([u,h])=>[u,Array.isArray(h)?`{${h.join(",")}}`:`${h}`]).forEach(([u,h])=>{a.searchParams.append(u,h)})):(o="POST",l=t);const c=Object.assign({},this.headers);return i&&(c.Prefer=`count=${i}`),new bB.default({method:o,url:a,headers:c,schema:this.schemaName,body:l,fetch:this.fetch,allowEmpty:!1})}};Ww.default=SB;var dc=Ie&&Ie.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(Gn,"__esModule",{value:!0});Gn.PostgrestError=Gn.PostgrestBuilder=Gn.PostgrestTransformBuilder=Gn.PostgrestFilterBuilder=Gn.PostgrestQueryBuilder=Gn.PostgrestClient=void 0;const XA=dc(Ww);Gn.PostgrestClient=XA.default;const KA=dc(i0);Gn.PostgrestQueryBuilder=KA.default;const JA=dc(Sd);Gn.PostgrestFilterBuilder=JA.default;const QA=dc(o0);Gn.PostgrestTransformBuilder=QA.default;const ZA=dc(a0);Gn.PostgrestBuilder=ZA.default;const eD=dc(l0);Gn.PostgrestError=eD.default;var CB=Gn.default={PostgrestClient:XA.default,PostgrestQueryBuilder:KA.default,PostgrestFilterBuilder:JA.default,PostgrestTransformBuilder:QA.default,PostgrestBuilder:ZA.default,PostgrestError:eD.default};const{PostgrestClient:EB,PostgrestQueryBuilder:QZ,PostgrestFilterBuilder:ZZ,PostgrestTransformBuilder:eee,PostgrestBuilder:tee,PostgrestError:nee}=CB;function kB(){if(typeof WebSocket<"u")return WebSocket;if(typeof global.WebSocket<"u")return global.WebSocket;if(typeof window.WebSocket<"u")return window.WebSocket;if(typeof self.WebSocket<"u")return self.WebSocket;throw new Error("`WebSocket` is not supported in this environment")}const PB=kB(),TB="2.11.15",AB=`realtime-js/${TB}`,DB="1.0.0",tD=1e4,OB=1e3;var gu;(function(n){n[n.connecting=0]="connecting",n[n.open=1]="open",n[n.closing=2]="closing",n[n.closed=3]="closed"})(gu||(gu={}));var _n;(function(n){n.closed="closed",n.errored="errored",n.joined="joined",n.joining="joining",n.leaving="leaving"})(_n||(_n={}));var $r;(function(n){n.close="phx_close",n.error="phx_error",n.join="phx_join",n.reply="phx_reply",n.leave="phx_leave",n.access_token="access_token"})($r||($r={}));var Ey;(function(n){n.websocket="websocket"})(Ey||(Ey={}));var $o;(function(n){n.Connecting="connecting",n.Open="open",n.Closing="closing",n.Closed="closed"})($o||($o={}));class IB{constructor(){this.HEADER_LENGTH=1}decode(e,t){return e.constructor===ArrayBuffer?t(this._binaryDecode(e)):t(typeof e=="string"?JSON.parse(e):{})}_binaryDecode(e){const t=new DataView(e),r=new TextDecoder;return this._decodeBroadcast(e,t,r)}_decodeBroadcast(e,t,r){const s=t.getUint8(1),i=t.getUint8(2);let o=this.HEADER_LENGTH+2;const a=r.decode(e.slice(o,o+s));o=o+s;const l=r.decode(e.slice(o,o+i));o=o+i;const c=JSON.parse(r.decode(e.slice(o,e.byteLength)));return{ref:null,topic:a,event:l,payload:c}}}class nD{constructor(e,t){this.callback=e,this.timerCalc=t,this.timer=void 0,this.tries=0,this.callback=e,this.timerCalc=t}reset(){this.tries=0,clearTimeout(this.timer)}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var mt;(function(n){n.abstime="abstime",n.bool="bool",n.date="date",n.daterange="daterange",n.float4="float4",n.float8="float8",n.int2="int2",n.int4="int4",n.int4range="int4range",n.int8="int8",n.int8range="int8range",n.json="json",n.jsonb="jsonb",n.money="money",n.numeric="numeric",n.oid="oid",n.reltime="reltime",n.text="text",n.time="time",n.timestamp="timestamp",n.timestamptz="timestamptz",n.timetz="timetz",n.tsrange="tsrange",n.tstzrange="tstzrange"})(mt||(mt={}));const ES=(n,e,t={})=>{var r;const s=(r=t.skipTypes)!==null&&r!==void 0?r:[];return Object.keys(e).reduce((i,o)=>(i[o]=RB(o,n,e,s),i),{})},RB=(n,e,t,r)=>{const s=e.find(a=>a.name===n),i=s==null?void 0:s.type,o=t[n];return i&&!r.includes(i)?rD(i,o):ky(o)},rD=(n,e)=>{if(n.charAt(0)==="_"){const t=n.slice(1,n.length);return MB(e,t)}switch(n){case mt.bool:return NB(e);case mt.float4:case mt.float8:case mt.int2:case mt.int4:case mt.int8:case mt.numeric:case mt.oid:return jB(e);case mt.json:case mt.jsonb:return LB(e);case mt.timestamp:return FB(e);case mt.abstime:case mt.date:case mt.daterange:case mt.int4range:case mt.int8range:case mt.money:case mt.reltime:case mt.text:case mt.time:case mt.timestamptz:case mt.timetz:case mt.tsrange:case mt.tstzrange:return ky(e);default:return ky(e)}},ky=n=>n,NB=n=>{switch(n){case"t":return!0;case"f":return!1;default:return n}},jB=n=>{if(typeof n=="string"){const e=parseFloat(n);if(!Number.isNaN(e))return e}return n},LB=n=>{if(typeof n=="string")try{return JSON.parse(n)}catch(e){return console.log(`JSON parse error: ${e}`),n}return n},MB=(n,e)=>{if(typeof n!="string")return n;const t=n.length-1,r=n[t];if(n[0]==="{"&&r==="}"){let i;const o=n.slice(1,t);try{i=JSON.parse("["+o+"]")}catch{i=o?o.split(","):[]}return i.map(a=>rD(e,a))}return n},FB=n=>typeof n=="string"?n.replace(" ","T"):n,sD=n=>{let e=n;return e=e.replace(/^ws/i,"http"),e=e.replace(/(\/socket\/websocket|\/socket|\/websocket)\/?$/i,""),e.replace(/\/+$/,"")};class Dg{constructor(e,t,r={},s=tD){this.channel=e,this.event=t,this.payload=r,this.timeout=s,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(e){this.timeout=e,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(e){this.payload=Object.assign(Object.assign({},this.payload),e)}receive(e,t){var r;return this._hasReceived(e)&&t((r=this.receivedResp)===null||r===void 0?void 0:r.response),this.recHooks.push({status:e,callback:t}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const e=t=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=t,this._matchReceive(t)};this.channel._on(this.refEvent,{},e),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(e,t){this.refEvent&&this.channel._trigger(this.refEvent,{status:e,response:t})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:e,response:t}){this.recHooks.filter(r=>r.status===e).forEach(r=>r.callback(t))}_hasReceived(e){return this.receivedResp&&this.receivedResp.status===e}}var kS;(function(n){n.SYNC="sync",n.JOIN="join",n.LEAVE="leave"})(kS||(kS={}));class mu{constructor(e,t){this.channel=e,this.state={},this.pendingDiffs=[],this.joinRef=null,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const r=(t==null?void 0:t.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(r.state,{},s=>{const{onJoin:i,onLeave:o,onSync:a}=this.caller;this.joinRef=this.channel._joinRef(),this.state=mu.syncState(this.state,s,i,o),this.pendingDiffs.forEach(l=>{this.state=mu.syncDiff(this.state,l,i,o)}),this.pendingDiffs=[],a()}),this.channel._on(r.diff,{},s=>{const{onJoin:i,onLeave:o,onSync:a}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(s):(this.state=mu.syncDiff(this.state,s,i,o),a())}),this.onJoin((s,i,o)=>{this.channel._trigger("presence",{event:"join",key:s,currentPresences:i,newPresences:o})}),this.onLeave((s,i,o)=>{this.channel._trigger("presence",{event:"leave",key:s,currentPresences:i,leftPresences:o})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(e,t,r,s){const i=this.cloneDeep(e),o=this.transformState(t),a={},l={};return this.map(i,(c,u)=>{o[c]||(l[c]=u)}),this.map(o,(c,u)=>{const h=i[c];if(h){const d=u.map(y=>y.presence_ref),p=h.map(y=>y.presence_ref),m=u.filter(y=>p.indexOf(y.presence_ref)<0),g=h.filter(y=>d.indexOf(y.presence_ref)<0);m.length>0&&(a[c]=m),g.length>0&&(l[c]=g)}else a[c]=u}),this.syncDiff(i,{joins:a,leaves:l},r,s)}static syncDiff(e,t,r,s){const{joins:i,leaves:o}={joins:this.transformState(t.joins),leaves:this.transformState(t.leaves)};return r||(r=()=>{}),s||(s=()=>{}),this.map(i,(a,l)=>{var c;const u=(c=e[a])!==null&&c!==void 0?c:[];if(e[a]=this.cloneDeep(l),u.length>0){const h=e[a].map(p=>p.presence_ref),d=u.filter(p=>h.indexOf(p.presence_ref)<0);e[a].unshift(...d)}r(a,u,l)}),this.map(o,(a,l)=>{let c=e[a];if(!c)return;const u=l.map(h=>h.presence_ref);c=c.filter(h=>u.indexOf(h.presence_ref)<0),e[a]=c,s(a,c,l),c.length===0&&delete e[a]}),e}static map(e,t){return Object.getOwnPropertyNames(e).map(r=>t(r,e[r]))}static transformState(e){return e=this.cloneDeep(e),Object.getOwnPropertyNames(e).reduce((t,r)=>{const s=e[r];return"metas"in s?t[r]=s.metas.map(i=>(i.presence_ref=i.phx_ref,delete i.phx_ref,delete i.phx_ref_prev,i)):t[r]=s,t},{})}static cloneDeep(e){return JSON.parse(JSON.stringify(e))}onJoin(e){this.caller.onJoin=e}onLeave(e){this.caller.onLeave=e}onSync(e){this.caller.onSync=e}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var PS;(function(n){n.ALL="*",n.INSERT="INSERT",n.UPDATE="UPDATE",n.DELETE="DELETE"})(PS||(PS={}));var TS;(function(n){n.BROADCAST="broadcast",n.PRESENCE="presence",n.POSTGRES_CHANGES="postgres_changes",n.SYSTEM="system"})(TS||(TS={}));var Os;(function(n){n.SUBSCRIBED="SUBSCRIBED",n.TIMED_OUT="TIMED_OUT",n.CLOSED="CLOSED",n.CHANNEL_ERROR="CHANNEL_ERROR"})(Os||(Os={}));class Hw{constructor(e,t={config:{}},r){this.topic=e,this.params=t,this.socket=r,this.bindings={},this.state=_n.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=e.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:""},private:!1},t.config),this.timeout=this.socket.timeout,this.joinPush=new Dg(this,$r.join,this.params,this.timeout),this.rejoinTimer=new nD(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=_n.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(s=>s.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=_n.closed,this.socket._remove(this)}),this._onError(s=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,s),this.state=_n.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=_n.errored,this.rejoinTimer.scheduleTimeout())}),this._on($r.reply,{},(s,i)=>{this._trigger(this._replyEventName(i),s)}),this.presence=new mu(this),this.broadcastEndpointURL=sD(this.socket.endPoint)+"/api/broadcast",this.private=this.params.config.private||!1}subscribe(e,t=this.timeout){var r,s;if(this.socket.isConnected()||this.socket.connect(),this.state==_n.closed){const{config:{broadcast:i,presence:o,private:a}}=this.params;this._onError(u=>e==null?void 0:e(Os.CHANNEL_ERROR,u)),this._onClose(()=>e==null?void 0:e(Os.CLOSED));const l={},c={broadcast:i,presence:o,postgres_changes:(s=(r=this.bindings.postgres_changes)===null||r===void 0?void 0:r.map(u=>u.filter))!==null&&s!==void 0?s:[],private:a};this.socket.accessTokenValue&&(l.access_token=this.socket.accessTokenValue),this.updateJoinPayload(Object.assign({config:c},l)),this.joinedOnce=!0,this._rejoin(t),this.joinPush.receive("ok",async({postgres_changes:u})=>{var h;if(this.socket.setAuth(),u===void 0){e==null||e(Os.SUBSCRIBED);return}else{const d=this.bindings.postgres_changes,p=(h=d==null?void 0:d.length)!==null&&h!==void 0?h:0,m=[];for(let g=0;g<p;g++){const y=d[g],{filter:{event:x,schema:v,table:w,filter:_}}=y,S=u&&u[g];if(S&&S.event===x&&S.schema===v&&S.table===w&&S.filter===_)m.push(Object.assign(Object.assign({},y),{id:S.id}));else{this.unsubscribe(),this.state=_n.errored,e==null||e(Os.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=m,e&&e(Os.SUBSCRIBED);return}}).receive("error",u=>{this.state=_n.errored,e==null||e(Os.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(u).join(", ")||"error")))}).receive("timeout",()=>{e==null||e(Os.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(e,t={}){return await this.send({type:"presence",event:"track",payload:e},t.timeout||this.timeout)}async untrack(e={}){return await this.send({type:"presence",event:"untrack"},e)}on(e,t,r){return this._on(e,t,r)}async send(e,t={}){var r,s;if(!this._canPush()&&e.type==="broadcast"){const{event:i,payload:o}=e,l={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:i,payload:o,private:this.private}]})};try{const c=await this._fetchWithTimeout(this.broadcastEndpointURL,l,(r=t.timeout)!==null&&r!==void 0?r:this.timeout);return await((s=c.body)===null||s===void 0?void 0:s.cancel()),c.ok?"ok":"error"}catch(c){return c.name==="AbortError"?"timed out":"error"}}else return new Promise(i=>{var o,a,l;const c=this._push(e.type,e,t.timeout||this.timeout);e.type==="broadcast"&&!(!((l=(a=(o=this.params)===null||o===void 0?void 0:o.config)===null||a===void 0?void 0:a.broadcast)===null||l===void 0)&&l.ack)&&i("ok"),c.receive("ok",()=>i("ok")),c.receive("error",()=>i("error")),c.receive("timeout",()=>i("timed out"))})}updateJoinPayload(e){this.joinPush.updatePayload(e)}unsubscribe(e=this.timeout){this.state=_n.leaving;const t=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger($r.close,"leave",this._joinRef())};this.joinPush.destroy();let r=null;return new Promise(s=>{r=new Dg(this,$r.leave,{},e),r.receive("ok",()=>{t(),s("ok")}).receive("timeout",()=>{t(),s("timed out")}).receive("error",()=>{s("error")}),r.send(),this._canPush()||r.trigger("ok",{})}).finally(()=>{r==null||r.destroy()})}teardown(){this.pushBuffer.forEach(e=>e.destroy()),this.rejoinTimer&&clearTimeout(this.rejoinTimer.timer),this.joinPush.destroy()}async _fetchWithTimeout(e,t,r){const s=new AbortController,i=setTimeout(()=>s.abort(),r),o=await this.socket.fetch(e,Object.assign(Object.assign({},t),{signal:s.signal}));return clearTimeout(i),o}_push(e,t,r=this.timeout){if(!this.joinedOnce)throw`tried to push '${e}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let s=new Dg(this,e,t,r);return this._canPush()?s.send():(s.startTimeout(),this.pushBuffer.push(s)),s}_onMessage(e,t,r){return t}_isMember(e){return this.topic===e}_joinRef(){return this.joinPush.ref}_trigger(e,t,r){var s,i;const o=e.toLocaleLowerCase(),{close:a,error:l,leave:c,join:u}=$r;if(r&&[a,l,c,u].indexOf(o)>=0&&r!==this._joinRef())return;let d=this._onMessage(o,t,r);if(t&&!d)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(o)?(s=this.bindings.postgres_changes)===null||s===void 0||s.filter(p=>{var m,g,y;return((m=p.filter)===null||m===void 0?void 0:m.event)==="*"||((y=(g=p.filter)===null||g===void 0?void 0:g.event)===null||y===void 0?void 0:y.toLocaleLowerCase())===o}).map(p=>p.callback(d,r)):(i=this.bindings[o])===null||i===void 0||i.filter(p=>{var m,g,y,x,v,w;if(["broadcast","presence","postgres_changes"].includes(o))if("id"in p){const _=p.id,S=(m=p.filter)===null||m===void 0?void 0:m.event;return _&&((g=t.ids)===null||g===void 0?void 0:g.includes(_))&&(S==="*"||(S==null?void 0:S.toLocaleLowerCase())===((y=t.data)===null||y===void 0?void 0:y.type.toLocaleLowerCase()))}else{const _=(v=(x=p==null?void 0:p.filter)===null||x===void 0?void 0:x.event)===null||v===void 0?void 0:v.toLocaleLowerCase();return _==="*"||_===((w=t==null?void 0:t.event)===null||w===void 0?void 0:w.toLocaleLowerCase())}else return p.type.toLocaleLowerCase()===o}).map(p=>{if(typeof d=="object"&&"ids"in d){const m=d.data,{schema:g,table:y,commit_timestamp:x,type:v,errors:w}=m;d=Object.assign(Object.assign({},{schema:g,table:y,commit_timestamp:x,eventType:v,new:{},old:{},errors:w}),this._getPayloadRecords(m))}p.callback(d,r)})}_isClosed(){return this.state===_n.closed}_isJoined(){return this.state===_n.joined}_isJoining(){return this.state===_n.joining}_isLeaving(){return this.state===_n.leaving}_replyEventName(e){return`chan_reply_${e}`}_on(e,t,r){const s=e.toLocaleLowerCase(),i={type:s,filter:t,callback:r};return this.bindings[s]?this.bindings[s].push(i):this.bindings[s]=[i],this}_off(e,t){const r=e.toLocaleLowerCase();return this.bindings[r]=this.bindings[r].filter(s=>{var i;return!(((i=s.type)===null||i===void 0?void 0:i.toLocaleLowerCase())===r&&Hw.isEqual(s.filter,t))}),this}static isEqual(e,t){if(Object.keys(e).length!==Object.keys(t).length)return!1;for(const r in e)if(e[r]!==t[r])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(e){this._on($r.close,{},e)}_onError(e){this._on($r.error,{},t=>e(t))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(e=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=_n.joining,this.joinPush.resend(e))}_getPayloadRecords(e){const t={new:{},old:{}};return(e.type==="INSERT"||e.type==="UPDATE")&&(t.new=ES(e.columns,e.record)),(e.type==="UPDATE"||e.type==="DELETE")&&(t.old=ES(e.columns,e.old_record)),t}}const AS=()=>{},BB=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class UB{constructor(e,t){var r;this.accessTokenValue=null,this.apiKey=null,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=tD,this.heartbeatIntervalMs=25e3,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=AS,this.ref=0,this.logger=AS,this.conn=null,this.sendBuffer=[],this.serializer=new IB,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._resolveFetch=i=>{let o;return i?o=i:typeof fetch>"u"?o=(...a)=>Ae(async()=>{const{default:l}=await Promise.resolve().then(()=>uc);return{default:l}},void 0).then(({default:l})=>l(...a)):o=fetch,(...a)=>o(...a)},this.endPoint=`${e}/${Ey.websocket}`,this.httpEndpoint=sD(e),t!=null&&t.transport?this.transport=t.transport:this.transport=null,t!=null&&t.params&&(this.params=t.params),t!=null&&t.timeout&&(this.timeout=t.timeout),t!=null&&t.logger&&(this.logger=t.logger),(t!=null&&t.logLevel||t!=null&&t.log_level)&&(this.logLevel=t.logLevel||t.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),t!=null&&t.heartbeatIntervalMs&&(this.heartbeatIntervalMs=t.heartbeatIntervalMs);const s=(r=t==null?void 0:t.params)===null||r===void 0?void 0:r.apikey;if(s&&(this.accessTokenValue=s,this.apiKey=s),this.reconnectAfterMs=t!=null&&t.reconnectAfterMs?t.reconnectAfterMs:i=>[1e3,2e3,5e3,1e4][i-1]||1e4,this.encode=t!=null&&t.encode?t.encode:(i,o)=>o(JSON.stringify(i)),this.decode=t!=null&&t.decode?t.decode:this.serializer.decode.bind(this.serializer),this.reconnectTimer=new nD(async()=>{this.disconnect(),this.connect()},this.reconnectAfterMs),this.fetch=this._resolveFetch(t==null?void 0:t.fetch),t!=null&&t.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.worker=(t==null?void 0:t.worker)||!1,this.workerUrl=t==null?void 0:t.workerUrl}this.accessToken=(t==null?void 0:t.accessToken)||null}connect(){if(!this.conn){if(this.transport||(this.transport=PB),!this.transport)throw new Error("No transport provided");this.conn=new this.transport(this.endpointURL()),this.setupConnection()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:DB}))}disconnect(e,t){this.conn&&(this.conn.onclose=function(){},e?this.conn.close(e,t??""):this.conn.close(),this.conn=null,this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.reset(),this.channels.forEach(r=>r.teardown()))}getChannels(){return this.channels}async removeChannel(e){const t=await e.unsubscribe();return this.channels.length===0&&this.disconnect(),t}async removeAllChannels(){const e=await Promise.all(this.channels.map(t=>t.unsubscribe()));return this.channels=[],this.disconnect(),e}log(e,t,r){this.logger(e,t,r)}connectionState(){switch(this.conn&&this.conn.readyState){case gu.connecting:return $o.Connecting;case gu.open:return $o.Open;case gu.closing:return $o.Closing;default:return $o.Closed}}isConnected(){return this.connectionState()===$o.Open}channel(e,t={config:{}}){const r=`realtime:${e}`,s=this.getChannels().find(i=>i.topic===r);if(s)return s;{const i=new Hw(`realtime:${e}`,t,this);return this.channels.push(i),i}}push(e){const{topic:t,event:r,payload:s,ref:i}=e,o=()=>{this.encode(e,a=>{var l;(l=this.conn)===null||l===void 0||l.send(a)})};this.log("push",`${t} ${r} (${i})`,s),this.isConnected()?o():this.sendBuffer.push(o)}async setAuth(e=null){let t=e||this.accessToken&&await this.accessToken()||this.accessTokenValue;this.accessTokenValue!=t&&(this.accessTokenValue=t,this.channels.forEach(r=>{const s={access_token:t,version:AB};t&&r.updateJoinPayload(s),r.joinedOnce&&r._isJoined()&&r._push($r.access_token,{access_token:t})}))}async sendHeartbeat(){var e;if(!this.isConnected()){this.heartbeatCallback("disconnected");return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection"),this.heartbeatCallback("timeout"),(e=this.conn)===null||e===void 0||e.close(OB,"hearbeat timeout");return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef}),this.heartbeatCallback("sent"),await this.setAuth()}onHeartbeat(e){this.heartbeatCallback=e}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(e=>e()),this.sendBuffer=[])}_makeRef(){let e=this.ref+1;return e===this.ref?this.ref=0:this.ref=e,this.ref.toString()}_leaveOpenTopic(e){let t=this.channels.find(r=>r.topic===e&&(r._isJoined()||r._isJoining()));t&&(this.log("transport",`leaving duplicate topic "${e}"`),t.unsubscribe())}_remove(e){this.channels=this.channels.filter(t=>t.topic!==e.topic)}setupConnection(){this.conn&&(this.conn.binaryType="arraybuffer",this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=e=>this._onConnError(e),this.conn.onmessage=e=>this._onConnMessage(e),this.conn.onclose=e=>this._onConnClose(e))}_onConnMessage(e){this.decode(e.data,t=>{let{topic:r,event:s,payload:i,ref:o}=t;r==="phoenix"&&s==="phx_reply"&&this.heartbeatCallback(t.payload.status=="ok"?"ok":"error"),o&&o===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null),this.log("receive",`${i.status||""} ${r} ${s} ${o&&"("+o+")"||""}`,i),Array.from(this.channels).filter(a=>a._isMember(r)).forEach(a=>a._trigger(s,i,o)),this.stateChangeCallbacks.message.forEach(a=>a(t))})}_onConnOpen(){this.log("transport",`connected to ${this.endpointURL()}`),this.flushSendBuffer(),this.reconnectTimer.reset(),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this.stateChangeCallbacks.open.forEach(e=>e())}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const e=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(e),this.workerRef.onerror=t=>{this.log("worker","worker error",t.message),this.workerRef.terminate()},this.workerRef.onmessage=t=>{t.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_onConnClose(e){this.log("transport","close",e),this._triggerChanError(),this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.scheduleTimeout(),this.stateChangeCallbacks.close.forEach(t=>t(e))}_onConnError(e){this.log("transport",`${e}`),this._triggerChanError(),this.stateChangeCallbacks.error.forEach(t=>t(e))}_triggerChanError(){this.channels.forEach(e=>e._trigger($r.error))}_appendParams(e,t){if(Object.keys(t).length===0)return e;const r=e.match(/\?/)?"&":"?",s=new URLSearchParams(t);return`${e}${r}${s}`}_workerObjectUrl(e){let t;if(e)t=e;else{const r=new Blob([BB],{type:"application/javascript"});t=URL.createObjectURL(r)}return t}}class Vw extends Error{constructor(e){super(e),this.__isStorageError=!0,this.name="StorageError"}}function sn(n){return typeof n=="object"&&n!==null&&"__isStorageError"in n}class $B extends Vw{constructor(e,t){super(e),this.name="StorageApiError",this.status=t}toJSON(){return{name:this.name,message:this.message,status:this.status}}}class Py extends Vw{constructor(e,t){super(e),this.name="StorageUnknownError",this.originalError=t}}var zB=function(n,e,t,r){function s(i){return i instanceof t?i:new t(function(o){o(i)})}return new(t||(t=Promise))(function(i,o){function a(u){try{c(r.next(u))}catch(h){o(h)}}function l(u){try{c(r.throw(u))}catch(h){o(h)}}function c(u){u.done?i(u.value):s(u.value).then(a,l)}c((r=r.apply(n,e||[])).next())})};const iD=n=>{let e;return n?e=n:typeof fetch>"u"?e=(...t)=>Ae(async()=>{const{default:r}=await Promise.resolve().then(()=>uc);return{default:r}},void 0).then(({default:r})=>r(...t)):e=fetch,(...t)=>e(...t)},WB=()=>zB(void 0,void 0,void 0,function*(){return typeof Response>"u"?(yield Ae(()=>Promise.resolve().then(()=>uc),void 0)).Response:Response}),Ty=n=>{if(Array.isArray(n))return n.map(t=>Ty(t));if(typeof n=="function"||n!==Object(n))return n;const e={};return Object.entries(n).forEach(([t,r])=>{const s=t.replace(/([-_][a-z])/gi,i=>i.toUpperCase().replace(/[-_]/g,""));e[s]=Ty(r)}),e};var Ca=function(n,e,t,r){function s(i){return i instanceof t?i:new t(function(o){o(i)})}return new(t||(t=Promise))(function(i,o){function a(u){try{c(r.next(u))}catch(h){o(h)}}function l(u){try{c(r.throw(u))}catch(h){o(h)}}function c(u){u.done?i(u.value):s(u.value).then(a,l)}c((r=r.apply(n,e||[])).next())})};const Og=n=>n.msg||n.message||n.error_description||n.error||JSON.stringify(n),HB=(n,e,t)=>Ca(void 0,void 0,void 0,function*(){const r=yield WB();n instanceof r&&!(t!=null&&t.noResolveJson)?n.json().then(s=>{e(new $B(Og(s),n.status||500))}).catch(s=>{e(new Py(Og(s),s))}):e(new Py(Og(n),n))}),VB=(n,e,t,r)=>{const s={method:n,headers:(e==null?void 0:e.headers)||{}};return n==="GET"?s:(s.headers=Object.assign({"Content-Type":"application/json"},e==null?void 0:e.headers),r&&(s.body=JSON.stringify(r)),Object.assign(Object.assign({},s),t))};function Cd(n,e,t,r,s,i){return Ca(this,void 0,void 0,function*(){return new Promise((o,a)=>{n(t,VB(e,r,s,i)).then(l=>{if(!l.ok)throw l;return r!=null&&r.noResolveJson?l:l.json()}).then(l=>o(l)).catch(l=>HB(l,a,r))})})}function rp(n,e,t,r){return Ca(this,void 0,void 0,function*(){return Cd(n,"GET",e,t,r)})}function Oi(n,e,t,r,s){return Ca(this,void 0,void 0,function*(){return Cd(n,"POST",e,r,s,t)})}function GB(n,e,t,r,s){return Ca(this,void 0,void 0,function*(){return Cd(n,"PUT",e,r,s,t)})}function qB(n,e,t,r){return Ca(this,void 0,void 0,function*(){return Cd(n,"HEAD",e,Object.assign(Object.assign({},t),{noResolveJson:!0}),r)})}function oD(n,e,t,r,s){return Ca(this,void 0,void 0,function*(){return Cd(n,"DELETE",e,r,s,t)})}var zn=function(n,e,t,r){function s(i){return i instanceof t?i:new t(function(o){o(i)})}return new(t||(t=Promise))(function(i,o){function a(u){try{c(r.next(u))}catch(h){o(h)}}function l(u){try{c(r.throw(u))}catch(h){o(h)}}function c(u){u.done?i(u.value):s(u.value).then(a,l)}c((r=r.apply(n,e||[])).next())})};const YB={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},DS={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class XB{constructor(e,t={},r,s){this.url=e,this.headers=t,this.bucketId=r,this.fetch=iD(s)}uploadOrUpdate(e,t,r,s){return zn(this,void 0,void 0,function*(){try{let i;const o=Object.assign(Object.assign({},DS),s);let a=Object.assign(Object.assign({},this.headers),e==="POST"&&{"x-upsert":String(o.upsert)});const l=o.metadata;typeof Blob<"u"&&r instanceof Blob?(i=new FormData,i.append("cacheControl",o.cacheControl),l&&i.append("metadata",this.encodeMetadata(l)),i.append("",r)):typeof FormData<"u"&&r instanceof FormData?(i=r,i.append("cacheControl",o.cacheControl),l&&i.append("metadata",this.encodeMetadata(l))):(i=r,a["cache-control"]=`max-age=${o.cacheControl}`,a["content-type"]=o.contentType,l&&(a["x-metadata"]=this.toBase64(this.encodeMetadata(l)))),s!=null&&s.headers&&(a=Object.assign(Object.assign({},a),s.headers));const c=this._removeEmptyFolders(t),u=this._getFinalPath(c),h=yield this.fetch(`${this.url}/object/${u}`,Object.assign({method:e,body:i,headers:a},o!=null&&o.duplex?{duplex:o.duplex}:{})),d=yield h.json();return h.ok?{data:{path:c,id:d.Id,fullPath:d.Key},error:null}:{data:null,error:d}}catch(i){if(sn(i))return{data:null,error:i};throw i}})}upload(e,t,r){return zn(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",e,t,r)})}uploadToSignedUrl(e,t,r,s){return zn(this,void 0,void 0,function*(){const i=this._removeEmptyFolders(e),o=this._getFinalPath(i),a=new URL(this.url+`/object/upload/sign/${o}`);a.searchParams.set("token",t);try{let l;const c=Object.assign({upsert:DS.upsert},s),u=Object.assign(Object.assign({},this.headers),{"x-upsert":String(c.upsert)});typeof Blob<"u"&&r instanceof Blob?(l=new FormData,l.append("cacheControl",c.cacheControl),l.append("",r)):typeof FormData<"u"&&r instanceof FormData?(l=r,l.append("cacheControl",c.cacheControl)):(l=r,u["cache-control"]=`max-age=${c.cacheControl}`,u["content-type"]=c.contentType);const h=yield this.fetch(a.toString(),{method:"PUT",body:l,headers:u}),d=yield h.json();return h.ok?{data:{path:i,fullPath:d.Key},error:null}:{data:null,error:d}}catch(l){if(sn(l))return{data:null,error:l};throw l}})}createSignedUploadUrl(e,t){return zn(this,void 0,void 0,function*(){try{let r=this._getFinalPath(e);const s=Object.assign({},this.headers);t!=null&&t.upsert&&(s["x-upsert"]="true");const i=yield Oi(this.fetch,`${this.url}/object/upload/sign/${r}`,{},{headers:s}),o=new URL(this.url+i.url),a=o.searchParams.get("token");if(!a)throw new Vw("No token returned by API");return{data:{signedUrl:o.toString(),path:e,token:a},error:null}}catch(r){if(sn(r))return{data:null,error:r};throw r}})}update(e,t,r){return zn(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",e,t,r)})}move(e,t,r){return zn(this,void 0,void 0,function*(){try{return{data:yield Oi(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:e,destinationKey:t,destinationBucket:r==null?void 0:r.destinationBucket},{headers:this.headers}),error:null}}catch(s){if(sn(s))return{data:null,error:s};throw s}})}copy(e,t,r){return zn(this,void 0,void 0,function*(){try{return{data:{path:(yield Oi(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:e,destinationKey:t,destinationBucket:r==null?void 0:r.destinationBucket},{headers:this.headers})).Key},error:null}}catch(s){if(sn(s))return{data:null,error:s};throw s}})}createSignedUrl(e,t,r){return zn(this,void 0,void 0,function*(){try{let s=this._getFinalPath(e),i=yield Oi(this.fetch,`${this.url}/object/sign/${s}`,Object.assign({expiresIn:t},r!=null&&r.transform?{transform:r.transform}:{}),{headers:this.headers});const o=r!=null&&r.download?`&download=${r.download===!0?"":r.download}`:"";return i={signedUrl:encodeURI(`${this.url}${i.signedURL}${o}`)},{data:i,error:null}}catch(s){if(sn(s))return{data:null,error:s};throw s}})}createSignedUrls(e,t,r){return zn(this,void 0,void 0,function*(){try{const s=yield Oi(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:t,paths:e},{headers:this.headers}),i=r!=null&&r.download?`&download=${r.download===!0?"":r.download}`:"";return{data:s.map(o=>Object.assign(Object.assign({},o),{signedUrl:o.signedURL?encodeURI(`${this.url}${o.signedURL}${i}`):null})),error:null}}catch(s){if(sn(s))return{data:null,error:s};throw s}})}download(e,t){return zn(this,void 0,void 0,function*(){const s=typeof(t==null?void 0:t.transform)<"u"?"render/image/authenticated":"object",i=this.transformOptsToQueryString((t==null?void 0:t.transform)||{}),o=i?`?${i}`:"";try{const a=this._getFinalPath(e);return{data:yield(yield rp(this.fetch,`${this.url}/${s}/${a}${o}`,{headers:this.headers,noResolveJson:!0})).blob(),error:null}}catch(a){if(sn(a))return{data:null,error:a};throw a}})}info(e){return zn(this,void 0,void 0,function*(){const t=this._getFinalPath(e);try{const r=yield rp(this.fetch,`${this.url}/object/info/${t}`,{headers:this.headers});return{data:Ty(r),error:null}}catch(r){if(sn(r))return{data:null,error:r};throw r}})}exists(e){return zn(this,void 0,void 0,function*(){const t=this._getFinalPath(e);try{return yield qB(this.fetch,`${this.url}/object/${t}`,{headers:this.headers}),{data:!0,error:null}}catch(r){if(sn(r)&&r instanceof Py){const s=r.originalError;if([400,404].includes(s==null?void 0:s.status))return{data:!1,error:r}}throw r}})}getPublicUrl(e,t){const r=this._getFinalPath(e),s=[],i=t!=null&&t.download?`download=${t.download===!0?"":t.download}`:"";i!==""&&s.push(i);const a=typeof(t==null?void 0:t.transform)<"u"?"render/image":"object",l=this.transformOptsToQueryString((t==null?void 0:t.transform)||{});l!==""&&s.push(l);let c=s.join("&");return c!==""&&(c=`?${c}`),{data:{publicUrl:encodeURI(`${this.url}/${a}/public/${r}${c}`)}}}remove(e){return zn(this,void 0,void 0,function*(){try{return{data:yield oD(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:e},{headers:this.headers}),error:null}}catch(t){if(sn(t))return{data:null,error:t};throw t}})}list(e,t,r){return zn(this,void 0,void 0,function*(){try{const s=Object.assign(Object.assign(Object.assign({},YB),t),{prefix:e||""});return{data:yield Oi(this.fetch,`${this.url}/object/list/${this.bucketId}`,s,{headers:this.headers},r),error:null}}catch(s){if(sn(s))return{data:null,error:s};throw s}})}encodeMetadata(e){return JSON.stringify(e)}toBase64(e){return typeof Buffer<"u"?Buffer.from(e).toString("base64"):btoa(e)}_getFinalPath(e){return`${this.bucketId}/${e}`}_removeEmptyFolders(e){return e.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(e){const t=[];return e.width&&t.push(`width=${e.width}`),e.height&&t.push(`height=${e.height}`),e.resize&&t.push(`resize=${e.resize}`),e.format&&t.push(`format=${e.format}`),e.quality&&t.push(`quality=${e.quality}`),t.join("&")}}const KB="2.7.1",JB={"X-Client-Info":`storage-js/${KB}`};var Oa=function(n,e,t,r){function s(i){return i instanceof t?i:new t(function(o){o(i)})}return new(t||(t=Promise))(function(i,o){function a(u){try{c(r.next(u))}catch(h){o(h)}}function l(u){try{c(r.throw(u))}catch(h){o(h)}}function c(u){u.done?i(u.value):s(u.value).then(a,l)}c((r=r.apply(n,e||[])).next())})};class QB{constructor(e,t={},r){this.url=e,this.headers=Object.assign(Object.assign({},JB),t),this.fetch=iD(r)}listBuckets(){return Oa(this,void 0,void 0,function*(){try{return{data:yield rp(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(e){if(sn(e))return{data:null,error:e};throw e}})}getBucket(e){return Oa(this,void 0,void 0,function*(){try{return{data:yield rp(this.fetch,`${this.url}/bucket/${e}`,{headers:this.headers}),error:null}}catch(t){if(sn(t))return{data:null,error:t};throw t}})}createBucket(e,t={public:!1}){return Oa(this,void 0,void 0,function*(){try{return{data:yield Oi(this.fetch,`${this.url}/bucket`,{id:e,name:e,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:this.headers}),error:null}}catch(r){if(sn(r))return{data:null,error:r};throw r}})}updateBucket(e,t){return Oa(this,void 0,void 0,function*(){try{return{data:yield GB(this.fetch,`${this.url}/bucket/${e}`,{id:e,name:e,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:this.headers}),error:null}}catch(r){if(sn(r))return{data:null,error:r};throw r}})}emptyBucket(e){return Oa(this,void 0,void 0,function*(){try{return{data:yield Oi(this.fetch,`${this.url}/bucket/${e}/empty`,{},{headers:this.headers}),error:null}}catch(t){if(sn(t))return{data:null,error:t};throw t}})}deleteBucket(e){return Oa(this,void 0,void 0,function*(){try{return{data:yield oD(this.fetch,`${this.url}/bucket/${e}`,{},{headers:this.headers}),error:null}}catch(t){if(sn(t))return{data:null,error:t};throw t}})}}class ZB extends QB{constructor(e,t={},r){super(e,t,r)}from(e){return new XB(this.url,this.headers,e,this.fetch)}}const e7="2.51.0";let Zc="";typeof Deno<"u"?Zc="deno":typeof document<"u"?Zc="web":typeof navigator<"u"&&navigator.product==="ReactNative"?Zc="react-native":Zc="node";const t7={"X-Client-Info":`supabase-js-${Zc}/${e7}`},n7={headers:t7},r7={schema:"public"},s7={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},i7={};var o7=function(n,e,t,r){function s(i){return i instanceof t?i:new t(function(o){o(i)})}return new(t||(t=Promise))(function(i,o){function a(u){try{c(r.next(u))}catch(h){o(h)}}function l(u){try{c(r.throw(u))}catch(h){o(h)}}function c(u){u.done?i(u.value):s(u.value).then(a,l)}c((r=r.apply(n,e||[])).next())})};const a7=n=>{let e;return n?e=n:typeof fetch>"u"?e=HA:e=fetch,(...t)=>e(...t)},l7=()=>typeof Headers>"u"?VA:Headers,c7=(n,e,t)=>{const r=a7(t),s=l7();return(i,o)=>o7(void 0,void 0,void 0,function*(){var a;const l=(a=yield e())!==null&&a!==void 0?a:n;let c=new s(o==null?void 0:o.headers);return c.has("apikey")||c.set("apikey",n),c.has("Authorization")||c.set("Authorization",`Bearer ${l}`),r(i,Object.assign(Object.assign({},o),{headers:c}))})};var u7=function(n,e,t,r){function s(i){return i instanceof t?i:new t(function(o){o(i)})}return new(t||(t=Promise))(function(i,o){function a(u){try{c(r.next(u))}catch(h){o(h)}}function l(u){try{c(r.throw(u))}catch(h){o(h)}}function c(u){u.done?i(u.value):s(u.value).then(a,l)}c((r=r.apply(n,e||[])).next())})};function d7(n){return n.endsWith("/")?n:n+"/"}function h7(n,e){var t,r;const{db:s,auth:i,realtime:o,global:a}=n,{db:l,auth:c,realtime:u,global:h}=e,d={db:Object.assign(Object.assign({},l),s),auth:Object.assign(Object.assign({},c),i),realtime:Object.assign(Object.assign({},u),o),global:Object.assign(Object.assign(Object.assign({},h),a),{headers:Object.assign(Object.assign({},(t=h==null?void 0:h.headers)!==null&&t!==void 0?t:{}),(r=a==null?void 0:a.headers)!==null&&r!==void 0?r:{})}),accessToken:()=>u7(this,void 0,void 0,function*(){return""})};return n.accessToken?d.accessToken=n.accessToken:delete d.accessToken,d}const aD="2.71.0",Wa=30*1e3,Ay=3,Ig=Ay*Wa,f7="http://localhost:9999",p7="supabase.auth.token",g7={"X-Client-Info":`gotrue-js/${aD}`},Dy="X-Supabase-Api-Version",lD={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},m7=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,v7=10*60*1e3;class Gw extends Error{constructor(e,t,r){super(e),this.__isAuthError=!0,this.name="AuthError",this.status=t,this.code=r}}function Be(n){return typeof n=="object"&&n!==null&&"__isAuthError"in n}class y7 extends Gw{constructor(e,t,r){super(e,t,r),this.name="AuthApiError",this.status=t,this.code=r}}function x7(n){return Be(n)&&n.name==="AuthApiError"}class cD extends Gw{constructor(e,t){super(e),this.name="AuthUnknownError",this.originalError=t}}class _o extends Gw{constructor(e,t,r,s){super(e,r,s),this.name=t,this.status=r}}class ki extends _o{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function w7(n){return Be(n)&&n.name==="AuthSessionMissingError"}class hh extends _o{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class fh extends _o{constructor(e){super(e,"AuthInvalidCredentialsError",400,void 0)}}class ph extends _o{constructor(e,t=null){super(e,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function b7(n){return Be(n)&&n.name==="AuthImplicitGrantRedirectError"}class OS extends _o{constructor(e,t=null){super(e,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class Oy extends _o{constructor(e,t){super(e,"AuthRetryableFetchError",t,void 0)}}function Rg(n){return Be(n)&&n.name==="AuthRetryableFetchError"}class IS extends _o{constructor(e,t,r){super(e,"AuthWeakPasswordError",t,"weak_password"),this.reasons=r}}class Iy extends _o{constructor(e){super(e,"AuthInvalidJwtError",400,"invalid_jwt")}}const sp="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),RS=` 	
\r=`.split(""),_7=(()=>{const n=new Array(128);for(let e=0;e<n.length;e+=1)n[e]=-1;for(let e=0;e<RS.length;e+=1)n[RS[e].charCodeAt(0)]=-2;for(let e=0;e<sp.length;e+=1)n[sp[e].charCodeAt(0)]=e;return n})();function NS(n,e,t){if(n!==null)for(e.queue=e.queue<<8|n,e.queuedBits+=8;e.queuedBits>=6;){const r=e.queue>>e.queuedBits-6&63;t(sp[r]),e.queuedBits-=6}else if(e.queuedBits>0)for(e.queue=e.queue<<6-e.queuedBits,e.queuedBits=6;e.queuedBits>=6;){const r=e.queue>>e.queuedBits-6&63;t(sp[r]),e.queuedBits-=6}}function uD(n,e,t){const r=_7[n];if(r>-1)for(e.queue=e.queue<<6|r,e.queuedBits+=6;e.queuedBits>=8;)t(e.queue>>e.queuedBits-8&255),e.queuedBits-=8;else{if(r===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(n)}"`)}}function jS(n){const e=[],t=o=>{e.push(String.fromCodePoint(o))},r={utf8seq:0,codepoint:0},s={queue:0,queuedBits:0},i=o=>{E7(o,r,t)};for(let o=0;o<n.length;o+=1)uD(n.charCodeAt(o),s,i);return e.join("")}function S7(n,e){if(n<=127){e(n);return}else if(n<=2047){e(192|n>>6),e(128|n&63);return}else if(n<=65535){e(224|n>>12),e(128|n>>6&63),e(128|n&63);return}else if(n<=1114111){e(240|n>>18),e(128|n>>12&63),e(128|n>>6&63),e(128|n&63);return}throw new Error(`Unrecognized Unicode codepoint: ${n.toString(16)}`)}function C7(n,e){for(let t=0;t<n.length;t+=1){let r=n.charCodeAt(t);if(r>55295&&r<=56319){const s=(r-55296)*1024&65535;r=(n.charCodeAt(t+1)-56320&65535|s)+65536,t+=1}S7(r,e)}}function E7(n,e,t){if(e.utf8seq===0){if(n<=127){t(n);return}for(let r=1;r<6;r+=1)if(!(n>>7-r&1)){e.utf8seq=r;break}if(e.utf8seq===2)e.codepoint=n&31;else if(e.utf8seq===3)e.codepoint=n&15;else if(e.utf8seq===4)e.codepoint=n&7;else throw new Error("Invalid UTF-8 sequence");e.utf8seq-=1}else if(e.utf8seq>0){if(n<=127)throw new Error("Invalid UTF-8 sequence");e.codepoint=e.codepoint<<6|n&63,e.utf8seq-=1,e.utf8seq===0&&t(e.codepoint)}}function k7(n){const e=[],t={queue:0,queuedBits:0},r=s=>{e.push(s)};for(let s=0;s<n.length;s+=1)uD(n.charCodeAt(s),t,r);return new Uint8Array(e)}function P7(n){const e=[];return C7(n,t=>e.push(t)),new Uint8Array(e)}function T7(n){const e=[],t={queue:0,queuedBits:0},r=s=>{e.push(s)};return n.forEach(s=>NS(s,t,r)),NS(null,t,r),e.join("")}function A7(n){return Math.round(Date.now()/1e3)+n}function D7(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(n){const e=Math.random()*16|0;return(n=="x"?e:e&3|8).toString(16)})}const Nr=()=>typeof window<"u"&&typeof document<"u",Oo={tested:!1,writable:!1},dD=()=>{if(!Nr())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(Oo.tested)return Oo.writable;const n=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(n,n),globalThis.localStorage.removeItem(n),Oo.tested=!0,Oo.writable=!0}catch{Oo.tested=!0,Oo.writable=!1}return Oo.writable};function O7(n){const e={},t=new URL(n);if(t.hash&&t.hash[0]==="#")try{new URLSearchParams(t.hash.substring(1)).forEach((s,i)=>{e[i]=s})}catch{}return t.searchParams.forEach((r,s)=>{e[s]=r}),e}const hD=n=>{let e;return n?e=n:typeof fetch>"u"?e=(...t)=>Ae(async()=>{const{default:r}=await Promise.resolve().then(()=>uc);return{default:r}},void 0).then(({default:r})=>r(...t)):e=fetch,(...t)=>e(...t)},I7=n=>typeof n=="object"&&n!==null&&"status"in n&&"ok"in n&&"json"in n&&typeof n.json=="function",Ha=async(n,e,t)=>{await n.setItem(e,JSON.stringify(t))},Io=async(n,e)=>{const t=await n.getItem(e);if(!t)return null;try{return JSON.parse(t)}catch{return t}},wi=async(n,e)=>{await n.removeItem(e)};let fD=class pD{constructor(){this.promise=new pD.promiseConstructor((e,t)=>{this.resolve=e,this.reject=t})}};fD.promiseConstructor=Promise;function Ng(n){const e=n.split(".");if(e.length!==3)throw new Iy("Invalid JWT structure");for(let r=0;r<e.length;r++)if(!m7.test(e[r]))throw new Iy("JWT not in base64url format");return{header:JSON.parse(jS(e[0])),payload:JSON.parse(jS(e[1])),signature:k7(e[2]),raw:{header:e[0],payload:e[1]}}}async function R7(n){return await new Promise(e=>{setTimeout(()=>e(null),n)})}function N7(n,e){return new Promise((r,s)=>{(async()=>{for(let i=0;i<1/0;i++)try{const o=await n(i);if(!e(i,null,o)){r(o);return}}catch(o){if(!e(i,o)){s(o);return}}})()})}function j7(n){return("0"+n.toString(16)).substr(-2)}function L7(){const e=new Uint32Array(56);if(typeof crypto>"u"){const t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",r=t.length;let s="";for(let i=0;i<56;i++)s+=t.charAt(Math.floor(Math.random()*r));return s}return crypto.getRandomValues(e),Array.from(e,j7).join("")}async function M7(n){const t=new TextEncoder().encode(n),r=await crypto.subtle.digest("SHA-256",t),s=new Uint8Array(r);return Array.from(s).map(i=>String.fromCharCode(i)).join("")}async function F7(n){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),n;const t=await M7(n);return btoa(t).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function Ia(n,e,t=!1){const r=L7();let s=r;t&&(s+="/PASSWORD_RECOVERY"),await Ha(n,`${e}-code-verifier`,s);const i=await F7(r);return[i,r===i?"plain":"s256"]}const B7=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function U7(n){const e=n.headers.get(Dy);if(!e||!e.match(B7))return null;try{return new Date(`${e}T00:00:00.0Z`)}catch{return null}}function $7(n){if(!n)throw new Error("Missing exp claim");const e=Math.floor(Date.now()/1e3);if(n<=e)throw new Error("JWT has expired")}function z7(n){switch(n){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const W7=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function Ra(n){if(!W7.test(n))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function jg(){const n={};return new Proxy(n,{get:(e,t)=>{if(t==="__isUserNotAvailableProxy")return!0;if(typeof t=="symbol"){const r=t.toString();if(r==="Symbol(Symbol.toPrimitive)"||r==="Symbol(Symbol.toStringTag)"||r==="Symbol(util.inspect.custom)")return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${t}" property of the session object is not supported. Please use getUser() instead.`)},set:(e,t)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${t}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(e,t)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${t}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}var H7=function(n,e){var t={};for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&e.indexOf(r)<0&&(t[r]=n[r]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,r=Object.getOwnPropertySymbols(n);s<r.length;s++)e.indexOf(r[s])<0&&Object.prototype.propertyIsEnumerable.call(n,r[s])&&(t[r[s]]=n[r[s]]);return t};const Fo=n=>n.msg||n.message||n.error_description||n.error||JSON.stringify(n),V7=[502,503,504];async function LS(n){var e;if(!I7(n))throw new Oy(Fo(n),0);if(V7.includes(n.status))throw new Oy(Fo(n),n.status);let t;try{t=await n.json()}catch(i){throw new cD(Fo(i),i)}let r;const s=U7(n);if(s&&s.getTime()>=lD["2024-01-01"].timestamp&&typeof t=="object"&&t&&typeof t.code=="string"?r=t.code:typeof t=="object"&&t&&typeof t.error_code=="string"&&(r=t.error_code),r){if(r==="weak_password")throw new IS(Fo(t),n.status,((e=t.weak_password)===null||e===void 0?void 0:e.reasons)||[]);if(r==="session_not_found")throw new ki}else if(typeof t=="object"&&t&&typeof t.weak_password=="object"&&t.weak_password&&Array.isArray(t.weak_password.reasons)&&t.weak_password.reasons.length&&t.weak_password.reasons.reduce((i,o)=>i&&typeof o=="string",!0))throw new IS(Fo(t),n.status,t.weak_password.reasons);throw new y7(Fo(t),n.status||500,r)}const G7=(n,e,t,r)=>{const s={method:n,headers:(e==null?void 0:e.headers)||{}};return n==="GET"?s:(s.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},e==null?void 0:e.headers),s.body=JSON.stringify(r),Object.assign(Object.assign({},s),t))};async function Ke(n,e,t,r){var s;const i=Object.assign({},r==null?void 0:r.headers);i[Dy]||(i[Dy]=lD["2024-01-01"].name),r!=null&&r.jwt&&(i.Authorization=`Bearer ${r.jwt}`);const o=(s=r==null?void 0:r.query)!==null&&s!==void 0?s:{};r!=null&&r.redirectTo&&(o.redirect_to=r.redirectTo);const a=Object.keys(o).length?"?"+new URLSearchParams(o).toString():"",l=await q7(n,e,t+a,{headers:i,noResolveJson:r==null?void 0:r.noResolveJson},{},r==null?void 0:r.body);return r!=null&&r.xform?r==null?void 0:r.xform(l):{data:Object.assign({},l),error:null}}async function q7(n,e,t,r,s,i){const o=G7(e,r,s,i);let a;try{a=await n(t,Object.assign({},o))}catch(l){throw console.error(l),new Oy(Fo(l),0)}if(a.ok||await LS(a),r!=null&&r.noResolveJson)return a;try{return await a.json()}catch(l){await LS(l)}}function Ps(n){var e;let t=null;J7(n)&&(t=Object.assign({},n),n.expires_at||(t.expires_at=A7(n.expires_in)));const r=(e=n.user)!==null&&e!==void 0?e:n;return{data:{session:t,user:r},error:null}}function MS(n){const e=Ps(n);return!e.error&&n.weak_password&&typeof n.weak_password=="object"&&Array.isArray(n.weak_password.reasons)&&n.weak_password.reasons.length&&n.weak_password.message&&typeof n.weak_password.message=="string"&&n.weak_password.reasons.reduce((t,r)=>t&&typeof r=="string",!0)&&(e.data.weak_password=n.weak_password),e}function Ni(n){var e;return{data:{user:(e=n.user)!==null&&e!==void 0?e:n},error:null}}function Y7(n){return{data:n,error:null}}function X7(n){const{action_link:e,email_otp:t,hashed_token:r,redirect_to:s,verification_type:i}=n,o=H7(n,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),a={action_link:e,email_otp:t,hashed_token:r,redirect_to:s,verification_type:i},l=Object.assign({},o);return{data:{properties:a,user:l},error:null}}function K7(n){return n}function J7(n){return n.access_token&&n.refresh_token&&n.expires_in}const Lg=["global","local","others"];var Q7=function(n,e){var t={};for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&e.indexOf(r)<0&&(t[r]=n[r]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,r=Object.getOwnPropertySymbols(n);s<r.length;s++)e.indexOf(r[s])<0&&Object.prototype.propertyIsEnumerable.call(n,r[s])&&(t[r[s]]=n[r[s]]);return t};class Z7{constructor({url:e="",headers:t={},fetch:r}){this.url=e,this.headers=t,this.fetch=hD(r),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)}}async signOut(e,t=Lg[0]){if(Lg.indexOf(t)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${Lg.join(", ")}`);try{return await Ke(this.fetch,"POST",`${this.url}/logout?scope=${t}`,{headers:this.headers,jwt:e,noResolveJson:!0}),{data:null,error:null}}catch(r){if(Be(r))return{data:null,error:r};throw r}}async inviteUserByEmail(e,t={}){try{return await Ke(this.fetch,"POST",`${this.url}/invite`,{body:{email:e,data:t.data},headers:this.headers,redirectTo:t.redirectTo,xform:Ni})}catch(r){if(Be(r))return{data:{user:null},error:r};throw r}}async generateLink(e){try{const{options:t}=e,r=Q7(e,["options"]),s=Object.assign(Object.assign({},r),t);return"newEmail"in r&&(s.new_email=r==null?void 0:r.newEmail,delete s.newEmail),await Ke(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:s,headers:this.headers,xform:X7,redirectTo:t==null?void 0:t.redirectTo})}catch(t){if(Be(t))return{data:{properties:null,user:null},error:t};throw t}}async createUser(e){try{return await Ke(this.fetch,"POST",`${this.url}/admin/users`,{body:e,headers:this.headers,xform:Ni})}catch(t){if(Be(t))return{data:{user:null},error:t};throw t}}async listUsers(e){var t,r,s,i,o,a,l;try{const c={nextPage:null,lastPage:0,total:0},u=await Ke(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(r=(t=e==null?void 0:e.page)===null||t===void 0?void 0:t.toString())!==null&&r!==void 0?r:"",per_page:(i=(s=e==null?void 0:e.perPage)===null||s===void 0?void 0:s.toString())!==null&&i!==void 0?i:""},xform:K7});if(u.error)throw u.error;const h=await u.json(),d=(o=u.headers.get("x-total-count"))!==null&&o!==void 0?o:0,p=(l=(a=u.headers.get("link"))===null||a===void 0?void 0:a.split(","))!==null&&l!==void 0?l:[];return p.length>0&&(p.forEach(m=>{const g=parseInt(m.split(";")[0].split("=")[1].substring(0,1)),y=JSON.parse(m.split(";")[1].split("=")[1]);c[`${y}Page`]=g}),c.total=parseInt(d)),{data:Object.assign(Object.assign({},h),c),error:null}}catch(c){if(Be(c))return{data:{users:[]},error:c};throw c}}async getUserById(e){Ra(e);try{return await Ke(this.fetch,"GET",`${this.url}/admin/users/${e}`,{headers:this.headers,xform:Ni})}catch(t){if(Be(t))return{data:{user:null},error:t};throw t}}async updateUserById(e,t){Ra(e);try{return await Ke(this.fetch,"PUT",`${this.url}/admin/users/${e}`,{body:t,headers:this.headers,xform:Ni})}catch(r){if(Be(r))return{data:{user:null},error:r};throw r}}async deleteUser(e,t=!1){Ra(e);try{return await Ke(this.fetch,"DELETE",`${this.url}/admin/users/${e}`,{headers:this.headers,body:{should_soft_delete:t},xform:Ni})}catch(r){if(Be(r))return{data:{user:null},error:r};throw r}}async _listFactors(e){Ra(e.userId);try{const{data:t,error:r}=await Ke(this.fetch,"GET",`${this.url}/admin/users/${e.userId}/factors`,{headers:this.headers,xform:s=>({data:{factors:s},error:null})});return{data:t,error:r}}catch(t){if(Be(t))return{data:null,error:t};throw t}}async _deleteFactor(e){Ra(e.userId),Ra(e.id);try{return{data:await Ke(this.fetch,"DELETE",`${this.url}/admin/users/${e.userId}/factors/${e.id}`,{headers:this.headers}),error:null}}catch(t){if(Be(t))return{data:null,error:t};throw t}}}function FS(n={}){return{getItem:e=>n[e]||null,setItem:(e,t)=>{n[e]=t},removeItem:e=>{delete n[e]}}}function eU(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}const Na={debug:!!(globalThis&&dD()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class gD extends Error{constructor(e){super(e),this.isAcquireTimeout=!0}}class tU extends gD{}async function nU(n,e,t){Na.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",n,e);const r=new globalThis.AbortController;return e>0&&setTimeout(()=>{r.abort(),Na.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",n)},e),await Promise.resolve().then(()=>globalThis.navigator.locks.request(n,e===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:r.signal},async s=>{if(s){Na.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",n,s.name);try{return await t()}finally{Na.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",n,s.name)}}else{if(e===0)throw Na.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",n),new tU(`Acquiring an exclusive Navigator LockManager lock "${n}" immediately failed`);if(Na.debug)try{const i=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(i,null,"  "))}catch(i){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",i)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await t()}}))}eU();const rU={url:f7,storageKey:p7,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:g7,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1};async function BS(n,e,t){return await t()}const ja={};class Ju{constructor(e){var t,r;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=Ju.nextInstanceID,Ju.nextInstanceID+=1,this.instanceID>0&&Nr()&&console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");const s=Object.assign(Object.assign({},rU),e);if(this.logDebugMessages=!!s.debug,typeof s.debug=="function"&&(this.logger=s.debug),this.persistSession=s.persistSession,this.storageKey=s.storageKey,this.autoRefreshToken=s.autoRefreshToken,this.admin=new Z7({url:s.url,headers:s.headers,fetch:s.fetch}),this.url=s.url,this.headers=s.headers,this.fetch=hD(s.fetch),this.lock=s.lock||BS,this.detectSessionInUrl=s.detectSessionInUrl,this.flowType=s.flowType,this.hasCustomAuthorizationHeader=s.hasCustomAuthorizationHeader,s.lock?this.lock=s.lock:Nr()&&(!((t=globalThis==null?void 0:globalThis.navigator)===null||t===void 0)&&t.locks)?this.lock=nU:this.lock=BS,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this)},this.persistSession?(s.storage?this.storage=s.storage:dD()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=FS(this.memoryStorage)),s.userStorage&&(this.userStorage=s.userStorage)):(this.memoryStorage={},this.storage=FS(this.memoryStorage)),Nr()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(i){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",i)}(r=this.broadcastChannel)===null||r===void 0||r.addEventListener("message",async i=>{this._debug("received broadcast notification from other tab or client",i),await this._notifyAllSubscribers(i.data.event,i.data.session,!1)})}this.initialize()}get jwks(){var e,t;return(t=(e=ja[this.storageKey])===null||e===void 0?void 0:e.jwks)!==null&&t!==void 0?t:{keys:[]}}set jwks(e){ja[this.storageKey]=Object.assign(Object.assign({},ja[this.storageKey]),{jwks:e})}get jwks_cached_at(){var e,t;return(t=(e=ja[this.storageKey])===null||e===void 0?void 0:e.cachedAt)!==null&&t!==void 0?t:Number.MIN_SAFE_INTEGER}set jwks_cached_at(e){ja[this.storageKey]=Object.assign(Object.assign({},ja[this.storageKey]),{cachedAt:e})}_debug(...e){return this.logDebugMessages&&this.logger(`GoTrueClient@${this.instanceID} (${aD}) ${new Date().toISOString()}`,...e),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var e;try{const t=O7(window.location.href);let r="none";if(this._isImplicitGrantCallback(t)?r="implicit":await this._isPKCECallback(t)&&(r="pkce"),Nr()&&this.detectSessionInUrl&&r!=="none"){const{data:s,error:i}=await this._getSessionFromURL(t,r);if(i){if(this._debug("#_initialize()","error detecting session from URL",i),b7(i)){const l=(e=i.details)===null||e===void 0?void 0:e.code;if(l==="identity_already_exists"||l==="identity_not_found"||l==="single_identity_not_deletable")return{error:i}}return await this._removeSession(),{error:i}}const{session:o,redirectType:a}=s;return this._debug("#_initialize()","detected session in URL",o,"redirect type",a),await this._saveSession(o),setTimeout(async()=>{a==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",o):await this._notifyAllSubscribers("SIGNED_IN",o)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(t){return Be(t)?{error:t}:{error:new cD("Unexpected error during initialization",t)}}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(e){var t,r,s;try{const i=await Ke(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(r=(t=e==null?void 0:e.options)===null||t===void 0?void 0:t.data)!==null&&r!==void 0?r:{},gotrue_meta_security:{captcha_token:(s=e==null?void 0:e.options)===null||s===void 0?void 0:s.captchaToken}},xform:Ps}),{data:o,error:a}=i;if(a||!o)return{data:{user:null,session:null},error:a};const l=o.session,c=o.user;return o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",l)),{data:{user:c,session:l},error:null}}catch(i){if(Be(i))return{data:{user:null,session:null},error:i};throw i}}async signUp(e){var t,r,s;try{let i;if("email"in e){const{email:u,password:h,options:d}=e;let p=null,m=null;this.flowType==="pkce"&&([p,m]=await Ia(this.storage,this.storageKey)),i=await Ke(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:d==null?void 0:d.emailRedirectTo,body:{email:u,password:h,data:(t=d==null?void 0:d.data)!==null&&t!==void 0?t:{},gotrue_meta_security:{captcha_token:d==null?void 0:d.captchaToken},code_challenge:p,code_challenge_method:m},xform:Ps})}else if("phone"in e){const{phone:u,password:h,options:d}=e;i=await Ke(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:u,password:h,data:(r=d==null?void 0:d.data)!==null&&r!==void 0?r:{},channel:(s=d==null?void 0:d.channel)!==null&&s!==void 0?s:"sms",gotrue_meta_security:{captcha_token:d==null?void 0:d.captchaToken}},xform:Ps})}else throw new fh("You must provide either an email or phone number and a password");const{data:o,error:a}=i;if(a||!o)return{data:{user:null,session:null},error:a};const l=o.session,c=o.user;return o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",l)),{data:{user:c,session:l},error:null}}catch(i){if(Be(i))return{data:{user:null,session:null},error:i};throw i}}async signInWithPassword(e){try{let t;if("email"in e){const{email:i,password:o,options:a}=e;t=await Ke(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:i,password:o,gotrue_meta_security:{captcha_token:a==null?void 0:a.captchaToken}},xform:MS})}else if("phone"in e){const{phone:i,password:o,options:a}=e;t=await Ke(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:i,password:o,gotrue_meta_security:{captcha_token:a==null?void 0:a.captchaToken}},xform:MS})}else throw new fh("You must provide either an email or phone number and a password");const{data:r,error:s}=t;return s?{data:{user:null,session:null},error:s}:!r||!r.session||!r.user?{data:{user:null,session:null},error:new hh}:(r.session&&(await this._saveSession(r.session),await this._notifyAllSubscribers("SIGNED_IN",r.session)),{data:Object.assign({user:r.user,session:r.session},r.weak_password?{weakPassword:r.weak_password}:null),error:s})}catch(t){if(Be(t))return{data:{user:null,session:null},error:t};throw t}}async signInWithOAuth(e){var t,r,s,i;return await this._handleProviderSignIn(e.provider,{redirectTo:(t=e.options)===null||t===void 0?void 0:t.redirectTo,scopes:(r=e.options)===null||r===void 0?void 0:r.scopes,queryParams:(s=e.options)===null||s===void 0?void 0:s.queryParams,skipBrowserRedirect:(i=e.options)===null||i===void 0?void 0:i.skipBrowserRedirect})}async exchangeCodeForSession(e){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(e))}async signInWithWeb3(e){const{chain:t}=e;if(t==="solana")return await this.signInWithSolana(e);throw new Error(`@supabase/auth-js: Unsupported chain "${t}"`)}async signInWithSolana(e){var t,r,s,i,o,a,l,c,u,h,d,p;let m,g;if("message"in e)m=e.message,g=e.signature;else{const{chain:y,wallet:x,statement:v,options:w}=e;let _;if(Nr())if(typeof x=="object")_=x;else{const E=window;if("solana"in E&&typeof E.solana=="object"&&("signIn"in E.solana&&typeof E.solana.signIn=="function"||"signMessage"in E.solana&&typeof E.solana.signMessage=="function"))_=E.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof x!="object"||!(w!=null&&w.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");_=x}const S=new URL((t=w==null?void 0:w.url)!==null&&t!==void 0?t:window.location.href);if("signIn"in _&&_.signIn){const E=await _.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},w==null?void 0:w.signInWithSolana),{version:"1",domain:S.host,uri:S.href}),v?{statement:v}:null));let C;if(Array.isArray(E)&&E[0]&&typeof E[0]=="object")C=E[0];else if(E&&typeof E=="object"&&"signedMessage"in E&&"signature"in E)C=E;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in C&&"signature"in C&&(typeof C.signedMessage=="string"||C.signedMessage instanceof Uint8Array)&&C.signature instanceof Uint8Array)m=typeof C.signedMessage=="string"?C.signedMessage:new TextDecoder().decode(C.signedMessage),g=C.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in _)||typeof _.signMessage!="function"||!("publicKey"in _)||typeof _!="object"||!_.publicKey||!("toBase58"in _.publicKey)||typeof _.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");m=[`${S.host} wants you to sign in with your Solana account:`,_.publicKey.toBase58(),...v?["",v,""]:[""],"Version: 1",`URI: ${S.href}`,`Issued At: ${(s=(r=w==null?void 0:w.signInWithSolana)===null||r===void 0?void 0:r.issuedAt)!==null&&s!==void 0?s:new Date().toISOString()}`,...!((i=w==null?void 0:w.signInWithSolana)===null||i===void 0)&&i.notBefore?[`Not Before: ${w.signInWithSolana.notBefore}`]:[],...!((o=w==null?void 0:w.signInWithSolana)===null||o===void 0)&&o.expirationTime?[`Expiration Time: ${w.signInWithSolana.expirationTime}`]:[],...!((a=w==null?void 0:w.signInWithSolana)===null||a===void 0)&&a.chainId?[`Chain ID: ${w.signInWithSolana.chainId}`]:[],...!((l=w==null?void 0:w.signInWithSolana)===null||l===void 0)&&l.nonce?[`Nonce: ${w.signInWithSolana.nonce}`]:[],...!((c=w==null?void 0:w.signInWithSolana)===null||c===void 0)&&c.requestId?[`Request ID: ${w.signInWithSolana.requestId}`]:[],...!((h=(u=w==null?void 0:w.signInWithSolana)===null||u===void 0?void 0:u.resources)===null||h===void 0)&&h.length?["Resources",...w.signInWithSolana.resources.map(C=>`- ${C}`)]:[]].join(`
`);const E=await _.signMessage(new TextEncoder().encode(m),"utf8");if(!E||!(E instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");g=E}}try{const{data:y,error:x}=await Ke(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:m,signature:T7(g)},!((d=e.options)===null||d===void 0)&&d.captchaToken?{gotrue_meta_security:{captcha_token:(p=e.options)===null||p===void 0?void 0:p.captchaToken}}:null),xform:Ps});if(x)throw x;return!y||!y.session||!y.user?{data:{user:null,session:null},error:new hh}:(y.session&&(await this._saveSession(y.session),await this._notifyAllSubscribers("SIGNED_IN",y.session)),{data:Object.assign({},y),error:x})}catch(y){if(Be(y))return{data:{user:null,session:null},error:y};throw y}}async _exchangeCodeForSession(e){const t=await Io(this.storage,`${this.storageKey}-code-verifier`),[r,s]=(t??"").split("/");try{const{data:i,error:o}=await Ke(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:e,code_verifier:r},xform:Ps});if(await wi(this.storage,`${this.storageKey}-code-verifier`),o)throw o;return!i||!i.session||!i.user?{data:{user:null,session:null,redirectType:null},error:new hh}:(i.session&&(await this._saveSession(i.session),await this._notifyAllSubscribers("SIGNED_IN",i.session)),{data:Object.assign(Object.assign({},i),{redirectType:s??null}),error:o})}catch(i){if(Be(i))return{data:{user:null,session:null,redirectType:null},error:i};throw i}}async signInWithIdToken(e){try{const{options:t,provider:r,token:s,access_token:i,nonce:o}=e,a=await Ke(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:r,id_token:s,access_token:i,nonce:o,gotrue_meta_security:{captcha_token:t==null?void 0:t.captchaToken}},xform:Ps}),{data:l,error:c}=a;return c?{data:{user:null,session:null},error:c}:!l||!l.session||!l.user?{data:{user:null,session:null},error:new hh}:(l.session&&(await this._saveSession(l.session),await this._notifyAllSubscribers("SIGNED_IN",l.session)),{data:l,error:c})}catch(t){if(Be(t))return{data:{user:null,session:null},error:t};throw t}}async signInWithOtp(e){var t,r,s,i,o;try{if("email"in e){const{email:a,options:l}=e;let c=null,u=null;this.flowType==="pkce"&&([c,u]=await Ia(this.storage,this.storageKey));const{error:h}=await Ke(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:a,data:(t=l==null?void 0:l.data)!==null&&t!==void 0?t:{},create_user:(r=l==null?void 0:l.shouldCreateUser)!==null&&r!==void 0?r:!0,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken},code_challenge:c,code_challenge_method:u},redirectTo:l==null?void 0:l.emailRedirectTo});return{data:{user:null,session:null},error:h}}if("phone"in e){const{phone:a,options:l}=e,{data:c,error:u}=await Ke(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:a,data:(s=l==null?void 0:l.data)!==null&&s!==void 0?s:{},create_user:(i=l==null?void 0:l.shouldCreateUser)!==null&&i!==void 0?i:!0,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken},channel:(o=l==null?void 0:l.channel)!==null&&o!==void 0?o:"sms"}});return{data:{user:null,session:null,messageId:c==null?void 0:c.message_id},error:u}}throw new fh("You must provide either an email or phone number.")}catch(a){if(Be(a))return{data:{user:null,session:null},error:a};throw a}}async verifyOtp(e){var t,r;try{let s,i;"options"in e&&(s=(t=e.options)===null||t===void 0?void 0:t.redirectTo,i=(r=e.options)===null||r===void 0?void 0:r.captchaToken);const{data:o,error:a}=await Ke(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},e),{gotrue_meta_security:{captcha_token:i}}),redirectTo:s,xform:Ps});if(a)throw a;if(!o)throw new Error("An error occurred on token verification.");const l=o.session,c=o.user;return l!=null&&l.access_token&&(await this._saveSession(l),await this._notifyAllSubscribers(e.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",l)),{data:{user:c,session:l},error:null}}catch(s){if(Be(s))return{data:{user:null,session:null},error:s};throw s}}async signInWithSSO(e){var t,r,s;try{let i=null,o=null;return this.flowType==="pkce"&&([i,o]=await Ia(this.storage,this.storageKey)),await Ke(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in e?{provider_id:e.providerId}:null),"domain"in e?{domain:e.domain}:null),{redirect_to:(r=(t=e.options)===null||t===void 0?void 0:t.redirectTo)!==null&&r!==void 0?r:void 0}),!((s=e==null?void 0:e.options)===null||s===void 0)&&s.captchaToken?{gotrue_meta_security:{captcha_token:e.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:i,code_challenge_method:o}),headers:this.headers,xform:Y7})}catch(i){if(Be(i))return{data:null,error:i};throw i}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async e=>{const{data:{session:t},error:r}=e;if(r)throw r;if(!t)throw new ki;const{error:s}=await Ke(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:t.access_token});return{data:{user:null,session:null},error:s}})}catch(e){if(Be(e))return{data:{user:null,session:null},error:e};throw e}}async resend(e){try{const t=`${this.url}/resend`;if("email"in e){const{email:r,type:s,options:i}=e,{error:o}=await Ke(this.fetch,"POST",t,{headers:this.headers,body:{email:r,type:s,gotrue_meta_security:{captcha_token:i==null?void 0:i.captchaToken}},redirectTo:i==null?void 0:i.emailRedirectTo});return{data:{user:null,session:null},error:o}}else if("phone"in e){const{phone:r,type:s,options:i}=e,{data:o,error:a}=await Ke(this.fetch,"POST",t,{headers:this.headers,body:{phone:r,type:s,gotrue_meta_security:{captcha_token:i==null?void 0:i.captchaToken}}});return{data:{user:null,session:null,messageId:o==null?void 0:o.message_id},error:a}}throw new fh("You must provide either an email or phone number and a type")}catch(t){if(Be(t))return{data:{user:null,session:null},error:t};throw t}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async t=>t))}async _acquireLock(e,t){this._debug("#_acquireLock","begin",e);try{if(this.lockAcquired){const r=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),s=(async()=>(await r,await t()))();return this.pendingInLock.push((async()=>{try{await s}catch{}})()),s}return await this.lock(`lock:${this.storageKey}`,e,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const r=t();for(this.pendingInLock.push((async()=>{try{await r}catch{}})()),await r;this.pendingInLock.length;){const s=[...this.pendingInLock];await Promise.all(s),this.pendingInLock.splice(0,s.length)}return await r}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(e){this._debug("#_useSession","begin");try{const t=await this.__loadSession();return await e(t)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let e=null;const t=await Io(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",t),t!==null&&(this._isValidSession(t)?e=t:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!e)return{data:{session:null},error:null};const r=e.expires_at?e.expires_at*1e3-Date.now()<Ig:!1;if(this._debug("#__loadSession()",`session has${r?"":" not"} expired`,"expires_at",e.expires_at),!r){if(this.userStorage){const o=await Io(this.userStorage,this.storageKey+"-user");o!=null&&o.user?e.user=o.user:e.user=jg()}if(this.storage.isServer&&e.user){let o=this.suppressGetSessionWarning;e=new Proxy(e,{get:(l,c,u)=>(!o&&c==="user"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),o=!0,this.suppressGetSessionWarning=!0),Reflect.get(l,c,u))})}return{data:{session:e},error:null}}const{session:s,error:i}=await this._callRefreshToken(e.refresh_token);return i?{data:{session:null},error:i}:{data:{session:s},error:null}}finally{this._debug("#__loadSession()","end")}}async getUser(e){return e?await this._getUser(e):(await this.initializePromise,await this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(e){try{return e?await Ke(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:e,xform:Ni}):await this._useSession(async t=>{var r,s,i;const{data:o,error:a}=t;if(a)throw a;return!(!((r=o.session)===null||r===void 0)&&r.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new ki}:await Ke(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(i=(s=o.session)===null||s===void 0?void 0:s.access_token)!==null&&i!==void 0?i:void 0,xform:Ni})})}catch(t){if(Be(t))return w7(t)&&(await this._removeSession(),await wi(this.storage,`${this.storageKey}-code-verifier`)),{data:{user:null},error:t};throw t}}async updateUser(e,t={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(e,t))}async _updateUser(e,t={}){try{return await this._useSession(async r=>{const{data:s,error:i}=r;if(i)throw i;if(!s.session)throw new ki;const o=s.session;let a=null,l=null;this.flowType==="pkce"&&e.email!=null&&([a,l]=await Ia(this.storage,this.storageKey));const{data:c,error:u}=await Ke(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:t==null?void 0:t.emailRedirectTo,body:Object.assign(Object.assign({},e),{code_challenge:a,code_challenge_method:l}),jwt:o.access_token,xform:Ni});if(u)throw u;return o.user=c.user,await this._saveSession(o),await this._notifyAllSubscribers("USER_UPDATED",o),{data:{user:o.user},error:null}})}catch(r){if(Be(r))return{data:{user:null},error:r};throw r}}async setSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(e))}async _setSession(e){try{if(!e.access_token||!e.refresh_token)throw new ki;const t=Date.now()/1e3;let r=t,s=!0,i=null;const{payload:o}=Ng(e.access_token);if(o.exp&&(r=o.exp,s=r<=t),s){const{session:a,error:l}=await this._callRefreshToken(e.refresh_token);if(l)return{data:{user:null,session:null},error:l};if(!a)return{data:{user:null,session:null},error:null};i=a}else{const{data:a,error:l}=await this._getUser(e.access_token);if(l)throw l;i={access_token:e.access_token,refresh_token:e.refresh_token,user:a.user,token_type:"bearer",expires_in:r-t,expires_at:r},await this._saveSession(i),await this._notifyAllSubscribers("SIGNED_IN",i)}return{data:{user:i.user,session:i},error:null}}catch(t){if(Be(t))return{data:{session:null,user:null},error:t};throw t}}async refreshSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(e))}async _refreshSession(e){try{return await this._useSession(async t=>{var r;if(!e){const{data:o,error:a}=t;if(a)throw a;e=(r=o.session)!==null&&r!==void 0?r:void 0}if(!(e!=null&&e.refresh_token))throw new ki;const{session:s,error:i}=await this._callRefreshToken(e.refresh_token);return i?{data:{user:null,session:null},error:i}:s?{data:{user:s.user,session:s},error:null}:{data:{user:null,session:null},error:null}})}catch(t){if(Be(t))return{data:{user:null,session:null},error:t};throw t}}async _getSessionFromURL(e,t){try{if(!Nr())throw new ph("No browser detected.");if(e.error||e.error_description||e.error_code)throw new ph(e.error_description||"Error in URL with unspecified error_description",{error:e.error||"unspecified_error",code:e.error_code||"unspecified_code"});switch(t){case"implicit":if(this.flowType==="pkce")throw new OS("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new ph("Not a valid implicit grant flow url.");break;default:}if(t==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!e.code)throw new OS("No code detected.");const{data:v,error:w}=await this._exchangeCodeForSession(e.code);if(w)throw w;const _=new URL(window.location.href);return _.searchParams.delete("code"),window.history.replaceState(window.history.state,"",_.toString()),{data:{session:v.session,redirectType:null},error:null}}const{provider_token:r,provider_refresh_token:s,access_token:i,refresh_token:o,expires_in:a,expires_at:l,token_type:c}=e;if(!i||!a||!o||!c)throw new ph("No session defined in URL");const u=Math.round(Date.now()/1e3),h=parseInt(a);let d=u+h;l&&(d=parseInt(l));const p=d-u;p*1e3<=Wa&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${p}s, should have been closer to ${h}s`);const m=d-h;u-m>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",m,d,u):u-m<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",m,d,u);const{data:g,error:y}=await this._getUser(i);if(y)throw y;const x={provider_token:r,provider_refresh_token:s,access_token:i,expires_in:h,expires_at:d,refresh_token:o,token_type:c,user:g.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),{data:{session:x,redirectType:e.type},error:null}}catch(r){if(Be(r))return{data:{session:null,redirectType:null},error:r};throw r}}_isImplicitGrantCallback(e){return!!(e.access_token||e.error_description)}async _isPKCECallback(e){const t=await Io(this.storage,`${this.storageKey}-code-verifier`);return!!(e.code&&t)}async signOut(e={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(e))}async _signOut({scope:e}={scope:"global"}){return await this._useSession(async t=>{var r;const{data:s,error:i}=t;if(i)return{error:i};const o=(r=s.session)===null||r===void 0?void 0:r.access_token;if(o){const{error:a}=await this.admin.signOut(o,e);if(a&&!(x7(a)&&(a.status===404||a.status===401||a.status===403)))return{error:a}}return e!=="others"&&(await this._removeSession(),await wi(this.storage,`${this.storageKey}-code-verifier`)),{error:null}})}onAuthStateChange(e){const t=D7(),r={id:t,callback:e,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",t),this.stateChangeEmitters.delete(t)}};return this._debug("#onAuthStateChange()","registered callback with id",t),this.stateChangeEmitters.set(t,r),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(t)})))(),{data:{subscription:r}}}async _emitInitialSession(e){return await this._useSession(async t=>{var r,s;try{const{data:{session:i},error:o}=t;if(o)throw o;await((r=this.stateChangeEmitters.get(e))===null||r===void 0?void 0:r.callback("INITIAL_SESSION",i)),this._debug("INITIAL_SESSION","callback id",e,"session",i)}catch(i){await((s=this.stateChangeEmitters.get(e))===null||s===void 0?void 0:s.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",e,"error",i),console.error(i)}})}async resetPasswordForEmail(e,t={}){let r=null,s=null;this.flowType==="pkce"&&([r,s]=await Ia(this.storage,this.storageKey,!0));try{return await Ke(this.fetch,"POST",`${this.url}/recover`,{body:{email:e,code_challenge:r,code_challenge_method:s,gotrue_meta_security:{captcha_token:t.captchaToken}},headers:this.headers,redirectTo:t.redirectTo})}catch(i){if(Be(i))return{data:null,error:i};throw i}}async getUserIdentities(){var e;try{const{data:t,error:r}=await this.getUser();if(r)throw r;return{data:{identities:(e=t.user.identities)!==null&&e!==void 0?e:[]},error:null}}catch(t){if(Be(t))return{data:null,error:t};throw t}}async linkIdentity(e){var t;try{const{data:r,error:s}=await this._useSession(async i=>{var o,a,l,c,u;const{data:h,error:d}=i;if(d)throw d;const p=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,e.provider,{redirectTo:(o=e.options)===null||o===void 0?void 0:o.redirectTo,scopes:(a=e.options)===null||a===void 0?void 0:a.scopes,queryParams:(l=e.options)===null||l===void 0?void 0:l.queryParams,skipBrowserRedirect:!0});return await Ke(this.fetch,"GET",p,{headers:this.headers,jwt:(u=(c=h.session)===null||c===void 0?void 0:c.access_token)!==null&&u!==void 0?u:void 0})});if(s)throw s;return Nr()&&!(!((t=e.options)===null||t===void 0)&&t.skipBrowserRedirect)&&window.location.assign(r==null?void 0:r.url),{data:{provider:e.provider,url:r==null?void 0:r.url},error:null}}catch(r){if(Be(r))return{data:{provider:e.provider,url:null},error:r};throw r}}async unlinkIdentity(e){try{return await this._useSession(async t=>{var r,s;const{data:i,error:o}=t;if(o)throw o;return await Ke(this.fetch,"DELETE",`${this.url}/user/identities/${e.identity_id}`,{headers:this.headers,jwt:(s=(r=i.session)===null||r===void 0?void 0:r.access_token)!==null&&s!==void 0?s:void 0})})}catch(t){if(Be(t))return{data:null,error:t};throw t}}async _refreshAccessToken(e){const t=`#_refreshAccessToken(${e.substring(0,5)}...)`;this._debug(t,"begin");try{const r=Date.now();return await N7(async s=>(s>0&&await R7(200*Math.pow(2,s-1)),this._debug(t,"refreshing attempt",s),await Ke(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:e},headers:this.headers,xform:Ps})),(s,i)=>{const o=200*Math.pow(2,s);return i&&Rg(i)&&Date.now()+o-r<Wa})}catch(r){if(this._debug(t,"error",r),Be(r))return{data:{session:null,user:null},error:r};throw r}finally{this._debug(t,"end")}}_isValidSession(e){return typeof e=="object"&&e!==null&&"access_token"in e&&"refresh_token"in e&&"expires_at"in e}async _handleProviderSignIn(e,t){const r=await this._getUrlForProvider(`${this.url}/authorize`,e,{redirectTo:t.redirectTo,scopes:t.scopes,queryParams:t.queryParams});return this._debug("#_handleProviderSignIn()","provider",e,"options",t,"url",r),Nr()&&!t.skipBrowserRedirect&&window.location.assign(r),{data:{provider:e,url:r},error:null}}async _recoverAndRefresh(){var e,t;const r="#_recoverAndRefresh()";this._debug(r,"begin");try{const s=await Io(this.storage,this.storageKey);if(s&&this.userStorage){let o=await Io(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!o&&(o={user:s.user},await Ha(this.userStorage,this.storageKey+"-user",o)),s.user=(e=o==null?void 0:o.user)!==null&&e!==void 0?e:jg()}else if(s&&!s.user&&!s.user){const o=await Io(this.storage,this.storageKey+"-user");o&&(o!=null&&o.user)?(s.user=o.user,await wi(this.storage,this.storageKey+"-user"),await Ha(this.storage,this.storageKey,s)):s.user=jg()}if(this._debug(r,"session from storage",s),!this._isValidSession(s)){this._debug(r,"session is not valid"),s!==null&&await this._removeSession();return}const i=((t=s.expires_at)!==null&&t!==void 0?t:1/0)*1e3-Date.now()<Ig;if(this._debug(r,`session has${i?"":" not"} expired with margin of ${Ig}s`),i){if(this.autoRefreshToken&&s.refresh_token){const{error:o}=await this._callRefreshToken(s.refresh_token);o&&(console.error(o),Rg(o)||(this._debug(r,"refresh failed with a non-retryable error, removing the session",o),await this._removeSession()))}}else if(s.user&&s.user.__isUserNotAvailableProxy===!0)try{const{data:o,error:a}=await this._getUser(s.access_token);!a&&(o!=null&&o.user)?(s.user=o.user,await this._saveSession(s),await this._notifyAllSubscribers("SIGNED_IN",s)):this._debug(r,"could not get user data, skipping SIGNED_IN notification")}catch(o){console.error("Error getting user data:",o),this._debug(r,"error getting user data, skipping SIGNED_IN notification",o)}else await this._notifyAllSubscribers("SIGNED_IN",s)}catch(s){this._debug(r,"error",s),console.error(s);return}finally{this._debug(r,"end")}}async _callRefreshToken(e){var t,r;if(!e)throw new ki;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const s=`#_callRefreshToken(${e.substring(0,5)}...)`;this._debug(s,"begin");try{this.refreshingDeferred=new fD;const{data:i,error:o}=await this._refreshAccessToken(e);if(o)throw o;if(!i.session)throw new ki;await this._saveSession(i.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",i.session);const a={session:i.session,error:null};return this.refreshingDeferred.resolve(a),a}catch(i){if(this._debug(s,"error",i),Be(i)){const o={session:null,error:i};return Rg(i)||await this._removeSession(),(t=this.refreshingDeferred)===null||t===void 0||t.resolve(o),o}throw(r=this.refreshingDeferred)===null||r===void 0||r.reject(i),i}finally{this.refreshingDeferred=null,this._debug(s,"end")}}async _notifyAllSubscribers(e,t,r=!0){const s=`#_notifyAllSubscribers(${e})`;this._debug(s,"begin",t,`broadcast = ${r}`);try{this.broadcastChannel&&r&&this.broadcastChannel.postMessage({event:e,session:t});const i=[],o=Array.from(this.stateChangeEmitters.values()).map(async a=>{try{await a.callback(e,t)}catch(l){i.push(l)}});if(await Promise.all(o),i.length>0){for(let a=0;a<i.length;a+=1)console.error(i[a]);throw i[0]}}finally{this._debug(s,"end")}}async _saveSession(e){this._debug("#_saveSession()",e),this.suppressGetSessionWarning=!0;const t=Object.assign({},e),r=t.user&&t.user.__isUserNotAvailableProxy===!0;if(this.userStorage){!r&&t.user&&await Ha(this.userStorage,this.storageKey+"-user",{user:t.user});const s=Object.assign({},t);delete s.user;const i=structuredClone(s);await Ha(this.storage,this.storageKey,i)}else{const s=structuredClone(t);await Ha(this.storage,this.storageKey,s)}}async _removeSession(){this._debug("#_removeSession()"),await wi(this.storage,this.storageKey),await wi(this.storage,this.storageKey+"-code-verifier"),await wi(this.storage,this.storageKey+"-user"),this.userStorage&&await wi(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const e=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{e&&Nr()&&(window!=null&&window.removeEventListener)&&window.removeEventListener("visibilitychange",e)}catch(t){console.error("removing visibilitychange callback failed",t)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const e=setInterval(()=>this._autoRefreshTokenTick(),Wa);this.autoRefreshTicker=e,e&&typeof e=="object"&&typeof e.unref=="function"?e.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(e),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const e=this.autoRefreshTicker;this.autoRefreshTicker=null,e&&clearInterval(e)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const e=Date.now();try{return await this._useSession(async t=>{const{data:{session:r}}=t;if(!r||!r.refresh_token||!r.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const s=Math.floor((r.expires_at*1e3-e)/Wa);this._debug("#_autoRefreshTokenTick()",`access token expires in ${s} ticks, a tick lasts ${Wa}ms, refresh threshold is ${Ay} ticks`),s<=Ay&&await this._callRefreshToken(r.refresh_token)})}catch(t){console.error("Auto refresh tick failed with error. This is likely a transient error.",t)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(e){if(e.isAcquireTimeout||e instanceof gD)this._debug("auto refresh token tick lock not available");else throw e}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!Nr()||!(window!=null&&window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window==null||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(e){console.error("_handleVisibilityChange",e)}}async _onVisibilityChanged(e){const t=`#_onVisibilityChanged(${e})`;this._debug(t,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),e||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(t,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(e,t,r){const s=[`provider=${encodeURIComponent(t)}`];if(r!=null&&r.redirectTo&&s.push(`redirect_to=${encodeURIComponent(r.redirectTo)}`),r!=null&&r.scopes&&s.push(`scopes=${encodeURIComponent(r.scopes)}`),this.flowType==="pkce"){const[i,o]=await Ia(this.storage,this.storageKey),a=new URLSearchParams({code_challenge:`${encodeURIComponent(i)}`,code_challenge_method:`${encodeURIComponent(o)}`});s.push(a.toString())}if(r!=null&&r.queryParams){const i=new URLSearchParams(r.queryParams);s.push(i.toString())}return r!=null&&r.skipBrowserRedirect&&s.push(`skip_http_redirect=${r.skipBrowserRedirect}`),`${e}?${s.join("&")}`}async _unenroll(e){try{return await this._useSession(async t=>{var r;const{data:s,error:i}=t;return i?{data:null,error:i}:await Ke(this.fetch,"DELETE",`${this.url}/factors/${e.factorId}`,{headers:this.headers,jwt:(r=s==null?void 0:s.session)===null||r===void 0?void 0:r.access_token})})}catch(t){if(Be(t))return{data:null,error:t};throw t}}async _enroll(e){try{return await this._useSession(async t=>{var r,s;const{data:i,error:o}=t;if(o)return{data:null,error:o};const a=Object.assign({friendly_name:e.friendlyName,factor_type:e.factorType},e.factorType==="phone"?{phone:e.phone}:{issuer:e.issuer}),{data:l,error:c}=await Ke(this.fetch,"POST",`${this.url}/factors`,{body:a,headers:this.headers,jwt:(r=i==null?void 0:i.session)===null||r===void 0?void 0:r.access_token});return c?{data:null,error:c}:(e.factorType==="totp"&&(!((s=l==null?void 0:l.totp)===null||s===void 0)&&s.qr_code)&&(l.totp.qr_code=`data:image/svg+xml;utf-8,${l.totp.qr_code}`),{data:l,error:null})})}catch(t){if(Be(t))return{data:null,error:t};throw t}}async _verify(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async t=>{var r;const{data:s,error:i}=t;if(i)return{data:null,error:i};const{data:o,error:a}=await Ke(this.fetch,"POST",`${this.url}/factors/${e.factorId}/verify`,{body:{code:e.code,challenge_id:e.challengeId},headers:this.headers,jwt:(r=s==null?void 0:s.session)===null||r===void 0?void 0:r.access_token});return a?{data:null,error:a}:(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+o.expires_in},o)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",o),{data:o,error:a})})}catch(t){if(Be(t))return{data:null,error:t};throw t}})}async _challenge(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async t=>{var r;const{data:s,error:i}=t;return i?{data:null,error:i}:await Ke(this.fetch,"POST",`${this.url}/factors/${e.factorId}/challenge`,{body:{channel:e.channel},headers:this.headers,jwt:(r=s==null?void 0:s.session)===null||r===void 0?void 0:r.access_token})})}catch(t){if(Be(t))return{data:null,error:t};throw t}})}async _challengeAndVerify(e){const{data:t,error:r}=await this._challenge({factorId:e.factorId});return r?{data:null,error:r}:await this._verify({factorId:e.factorId,challengeId:t.id,code:e.code})}async _listFactors(){const{data:{user:e},error:t}=await this.getUser();if(t)return{data:null,error:t};const r=(e==null?void 0:e.factors)||[],s=r.filter(o=>o.factor_type==="totp"&&o.status==="verified"),i=r.filter(o=>o.factor_type==="phone"&&o.status==="verified");return{data:{all:r,totp:s,phone:i},error:null}}async _getAuthenticatorAssuranceLevel(){return this._acquireLock(-1,async()=>await this._useSession(async e=>{var t,r;const{data:{session:s},error:i}=e;if(i)return{data:null,error:i};if(!s)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:o}=Ng(s.access_token);let a=null;o.aal&&(a=o.aal);let l=a;((r=(t=s.user.factors)===null||t===void 0?void 0:t.filter(h=>h.status==="verified"))!==null&&r!==void 0?r:[]).length>0&&(l="aal2");const u=o.amr||[];return{data:{currentLevel:a,nextLevel:l,currentAuthenticationMethods:u},error:null}}))}async fetchJwk(e,t={keys:[]}){let r=t.keys.find(a=>a.kid===e);if(r)return r;const s=Date.now();if(r=this.jwks.keys.find(a=>a.kid===e),r&&this.jwks_cached_at+v7>s)return r;const{data:i,error:o}=await Ke(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(o)throw o;return!i.keys||i.keys.length===0||(this.jwks=i,this.jwks_cached_at=s,r=i.keys.find(a=>a.kid===e),!r)?null:r}async getClaims(e,t={}){try{let r=e;if(!r){const{data:p,error:m}=await this.getSession();if(m||!p.session)return{data:null,error:m};r=p.session.access_token}const{header:s,payload:i,signature:o,raw:{header:a,payload:l}}=Ng(r);t!=null&&t.allowExpired||$7(i.exp);const c=!s.alg||s.alg.startsWith("HS")||!s.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:await this.fetchJwk(s.kid,t!=null&&t.keys?{keys:t.keys}:t==null?void 0:t.jwks);if(!c){const{error:p}=await this.getUser(r);if(p)throw p;return{data:{claims:i,header:s,signature:o},error:null}}const u=z7(s.alg),h=await crypto.subtle.importKey("jwk",c,u,!0,["verify"]);if(!await crypto.subtle.verify(u,h,o,P7(`${a}.${l}`)))throw new Iy("Invalid JWT signature");return{data:{claims:i,header:s,signature:o},error:null}}catch(r){if(Be(r))return{data:null,error:r};throw r}}}Ju.nextInstanceID=0;const sU=Ju;class iU extends sU{constructor(e){super(e)}}var oU=function(n,e,t,r){function s(i){return i instanceof t?i:new t(function(o){o(i)})}return new(t||(t=Promise))(function(i,o){function a(u){try{c(r.next(u))}catch(h){o(h)}}function l(u){try{c(r.throw(u))}catch(h){o(h)}}function c(u){u.done?i(u.value):s(u.value).then(a,l)}c((r=r.apply(n,e||[])).next())})};class aU{constructor(e,t,r){var s,i,o;if(this.supabaseUrl=e,this.supabaseKey=t,!e)throw new Error("supabaseUrl is required.");if(!t)throw new Error("supabaseKey is required.");const a=d7(e),l=new URL(a);this.realtimeUrl=new URL("realtime/v1",l),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",l),this.storageUrl=new URL("storage/v1",l),this.functionsUrl=new URL("functions/v1",l);const c=`sb-${l.hostname.split(".")[0]}-auth-token`,u={db:r7,realtime:i7,auth:Object.assign(Object.assign({},s7),{storageKey:c}),global:n7},h=h7(r??{},u);this.storageKey=(s=h.auth.storageKey)!==null&&s!==void 0?s:"",this.headers=(i=h.global.headers)!==null&&i!==void 0?i:{},h.accessToken?(this.accessToken=h.accessToken,this.auth=new Proxy({},{get:(d,p)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(p)} is not possible`)}})):this.auth=this._initSupabaseAuthClient((o=h.auth)!==null&&o!==void 0?o:{},this.headers,h.global.fetch),this.fetch=c7(t,this._getAccessToken.bind(this),h.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},h.realtime)),this.rest=new EB(new URL("rest/v1",l).href,{headers:this.headers,schema:h.db.schema,fetch:this.fetch}),h.accessToken||this._listenForAuthEvents()}get functions(){return new tB(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}get storage(){return new ZB(this.storageUrl.href,this.headers,this.fetch)}from(e){return this.rest.from(e)}schema(e){return this.rest.schema(e)}rpc(e,t={},r={}){return this.rest.rpc(e,t,r)}channel(e,t={config:{}}){return this.realtime.channel(e,t)}getChannels(){return this.realtime.getChannels()}removeChannel(e){return this.realtime.removeChannel(e)}removeAllChannels(){return this.realtime.removeAllChannels()}_getAccessToken(){var e,t;return oU(this,void 0,void 0,function*(){if(this.accessToken)return yield this.accessToken();const{data:r}=yield this.auth.getSession();return(t=(e=r.session)===null||e===void 0?void 0:e.access_token)!==null&&t!==void 0?t:null})}_initSupabaseAuthClient({autoRefreshToken:e,persistSession:t,detectSessionInUrl:r,storage:s,storageKey:i,flowType:o,lock:a,debug:l},c,u){const h={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new iU({url:this.authUrl.href,headers:Object.assign(Object.assign({},h),c),storageKey:i,autoRefreshToken:e,persistSession:t,detectSessionInUrl:r,storage:s,flowType:o,lock:a,debug:l,fetch:u,hasCustomAuthorizationHeader:"Authorization"in this.headers})}_initRealtimeClient(e){return new UB(this.realtimeUrl.href,Object.assign(Object.assign({},e),{params:Object.assign({apikey:this.supabaseKey},e==null?void 0:e.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((t,r)=>{this._handleTokenChanged(t,"CLIENT",r==null?void 0:r.access_token)})}_handleTokenChanged(e,t,r){(e==="TOKEN_REFRESHED"||e==="SIGNED_IN")&&this.changedAccessToken!==r?this.changedAccessToken=r:e==="SIGNED_OUT"&&(this.realtime.setAuth(),t=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const lU=(n,e,t)=>new aU(n,e,t);/*! Capacitor: https://capacitorjs.com/ - MIT License */var Jl;(function(n){n.Unimplemented="UNIMPLEMENTED",n.Unavailable="UNAVAILABLE"})(Jl||(Jl={}));class vl extends Error{constructor(e,t,r){super(e),this.message=e,this.code=t,this.data=r}}const cU=n=>{var e,t;return n!=null&&n.androidBridge?"android":!((t=(e=n==null?void 0:n.webkit)===null||e===void 0?void 0:e.messageHandlers)===null||t===void 0)&&t.bridge?"ios":"web"},uU=n=>{const e=n.CapacitorCustomPlatform||null,t=n.Capacitor||{},r=t.Plugins=t.Plugins||{},s=()=>e!==null?e.name:cU(n),i=()=>s()!=="web",o=h=>{const d=c.get(h);return!!(d!=null&&d.platforms.has(s())||a(h))},a=h=>{var d;return(d=t.PluginHeaders)===null||d===void 0?void 0:d.find(p=>p.name===h)},l=h=>n.console.error(h),c=new Map,u=(h,d={})=>{const p=c.get(h);if(p)return console.warn(`Capacitor plugin "${h}" already registered. Cannot register plugins twice.`),p.proxy;const m=s(),g=a(h);let y;const x=async()=>(!y&&m in d?y=typeof d[m]=="function"?y=await d[m]():y=d[m]:e!==null&&!y&&"web"in d&&(y=typeof d.web=="function"?y=await d.web():y=d.web),y),v=(P,O)=>{var A,R;if(g){const B=g==null?void 0:g.methods.find(I=>O===I.name);if(B)return B.rtype==="promise"?I=>t.nativePromise(h,O.toString(),I):(I,L)=>t.nativeCallback(h,O.toString(),I,L);if(P)return(A=P[O])===null||A===void 0?void 0:A.bind(P)}else{if(P)return(R=P[O])===null||R===void 0?void 0:R.bind(P);throw new vl(`"${h}" plugin is not implemented on ${m}`,Jl.Unimplemented)}},w=P=>{let O;const A=(...R)=>{const B=x().then(I=>{const L=v(I,P);if(L){const U=L(...R);return O=U==null?void 0:U.remove,U}else throw new vl(`"${h}.${P}()" is not implemented on ${m}`,Jl.Unimplemented)});return P==="addListener"&&(B.remove=async()=>O()),B};return A.toString=()=>`${P.toString()}() { [capacitor code] }`,Object.defineProperty(A,"name",{value:P,writable:!1,configurable:!1}),A},_=w("addListener"),S=w("removeListener"),E=(P,O)=>{const A=_({eventName:P},O),R=async()=>{const I=await A;S({eventName:P,callbackId:I},O)},B=new Promise(I=>A.then(()=>I({remove:R})));return B.remove=async()=>{console.warn("Using addListener() without 'await' is deprecated."),await R()},B},C=new Proxy({},{get(P,O){switch(O){case"$$typeof":return;case"toJSON":return()=>({});case"addListener":return g?E:_;case"removeListener":return S;default:return w(O)}}});return r[h]=C,c.set(h,{name:h,proxy:C,platforms:new Set([...Object.keys(d),...g?[m]:[]])}),C};return t.convertFileSrc||(t.convertFileSrc=h=>h),t.getPlatform=s,t.handleError=l,t.isNativePlatform=i,t.isPluginAvailable=o,t.registerPlugin=u,t.Exception=vl,t.DEBUG=!!t.DEBUG,t.isLoggingEnabled=!!t.isLoggingEnabled,t},dU=n=>n.Capacitor=uU(n),de=dU(typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{}),Pn=de.registerPlugin;class qw{constructor(){this.listeners={},this.retainedEventArguments={},this.windowListeners={}}addListener(e,t){let r=!1;this.listeners[e]||(this.listeners[e]=[],r=!0),this.listeners[e].push(t);const i=this.windowListeners[e];i&&!i.registered&&this.addWindowListener(i),r&&this.sendRetainedArgumentsForEvent(e);const o=async()=>this.removeListener(e,t);return Promise.resolve({remove:o})}async removeAllListeners(){this.listeners={};for(const e in this.windowListeners)this.removeWindowListener(this.windowListeners[e]);this.windowListeners={}}notifyListeners(e,t,r){const s=this.listeners[e];if(!s){if(r){let i=this.retainedEventArguments[e];i||(i=[]),i.push(t),this.retainedEventArguments[e]=i}return}s.forEach(i=>i(t))}hasListeners(e){var t;return!!(!((t=this.listeners[e])===null||t===void 0)&&t.length)}registerWindowListener(e,t){this.windowListeners[t]={registered:!1,windowEventName:e,pluginEventName:t,handler:r=>{this.notifyListeners(t,r)}}}unimplemented(e="not implemented"){return new de.Exception(e,Jl.Unimplemented)}unavailable(e="not available"){return new de.Exception(e,Jl.Unavailable)}async removeListener(e,t){const r=this.listeners[e];if(!r)return;const s=r.indexOf(t);this.listeners[e].splice(s,1),this.listeners[e].length||this.removeWindowListener(this.windowListeners[e])}addWindowListener(e){window.addEventListener(e.windowEventName,e.handler),e.registered=!0}removeWindowListener(e){e&&(window.removeEventListener(e.windowEventName,e.handler),e.registered=!1)}sendRetainedArgumentsForEvent(e){const t=this.retainedEventArguments[e];t&&(delete this.retainedEventArguments[e],t.forEach(r=>{this.notifyListeners(e,r)}))}}const US=n=>encodeURIComponent(n).replace(/%(2[346B]|5E|60|7C)/g,decodeURIComponent).replace(/[()]/g,escape),$S=n=>n.replace(/(%[\dA-F]{2})+/gi,decodeURIComponent);class hU extends qw{async getCookies(){const e=document.cookie,t={};return e.split(";").forEach(r=>{if(r.length<=0)return;let[s,i]=r.replace(/=/,"CAP_COOKIE").split("CAP_COOKIE");s=$S(s).trim(),i=$S(i).trim(),t[s]=i}),t}async setCookie(e){try{const t=US(e.key),r=US(e.value),s=`; expires=${(e.expires||"").replace("expires=","")}`,i=(e.path||"/").replace("path=",""),o=e.url!=null&&e.url.length>0?`domain=${e.url}`:"";document.cookie=`${t}=${r||""}${s}; path=${i}; ${o};`}catch(t){return Promise.reject(t)}}async deleteCookie(e){try{document.cookie=`${e.key}=; Max-Age=0`}catch(t){return Promise.reject(t)}}async clearCookies(){try{const e=document.cookie.split(";")||[];for(const t of e)document.cookie=t.replace(/^ +/,"").replace(/=.*/,`=;expires=${new Date().toUTCString()};path=/`)}catch(e){return Promise.reject(e)}}async clearAllCookies(){try{await this.clearCookies()}catch(e){return Promise.reject(e)}}}Pn("CapacitorCookies",{web:()=>new hU});const fU=async n=>new Promise((e,t)=>{const r=new FileReader;r.onload=()=>{const s=r.result;e(s.indexOf(",")>=0?s.split(",")[1]:s)},r.onerror=s=>t(s),r.readAsDataURL(n)}),pU=(n={})=>{const e=Object.keys(n);return Object.keys(n).map(s=>s.toLocaleLowerCase()).reduce((s,i,o)=>(s[i]=n[e[o]],s),{})},gU=(n,e=!0)=>n?Object.entries(n).reduce((r,s)=>{const[i,o]=s;let a,l;return Array.isArray(o)?(l="",o.forEach(c=>{a=e?encodeURIComponent(c):c,l+=`${i}=${a}&`}),l.slice(0,-1)):(a=e?encodeURIComponent(o):o,l=`${i}=${a}`),`${r}&${l}`},"").substr(1):null,mU=(n,e={})=>{const t=Object.assign({method:n.method||"GET",headers:n.headers},e),s=pU(n.headers)["content-type"]||"";if(typeof n.data=="string")t.body=n.data;else if(s.includes("application/x-www-form-urlencoded")){const i=new URLSearchParams;for(const[o,a]of Object.entries(n.data||{}))i.set(o,a);t.body=i.toString()}else if(s.includes("multipart/form-data")||n.data instanceof FormData){const i=new FormData;if(n.data instanceof FormData)n.data.forEach((a,l)=>{i.append(l,a)});else for(const a of Object.keys(n.data))i.append(a,n.data[a]);t.body=i;const o=new Headers(t.headers);o.delete("content-type"),t.headers=o}else(s.includes("application/json")||typeof n.data=="object")&&(t.body=JSON.stringify(n.data));return t};class vU extends qw{async request(e){const t=mU(e,e.webFetchExtra),r=gU(e.params,e.shouldEncodeUrlParams),s=r?`${e.url}?${r}`:e.url,i=await fetch(s,t),o=i.headers.get("content-type")||"";let{responseType:a="text"}=i.ok?e:{};o.includes("application/json")&&(a="json");let l,c;switch(a){case"arraybuffer":case"blob":c=await i.blob(),l=await fU(c);break;case"json":l=await i.json();break;case"document":case"text":default:l=await i.text()}const u={};return i.headers.forEach((h,d)=>{u[d]=h}),{data:l,headers:u,status:i.status,url:i.url}}async get(e){return this.request(Object.assign(Object.assign({},e),{method:"GET"}))}async post(e){return this.request(Object.assign(Object.assign({},e),{method:"POST"}))}async put(e){return this.request(Object.assign(Object.assign({},e),{method:"PUT"}))}async patch(e){return this.request(Object.assign(Object.assign({},e),{method:"PATCH"}))}async delete(e){return this.request(Object.assign(Object.assign({},e),{method:"DELETE"}))}}Pn("CapacitorHttp",{web:()=>new vU});const yU=()=>{const n=de.getPlatform();let e;return n==="ios"?e="Mozilla/5.0 (iPhone; CPU iPhone OS 17_0 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/17.0 Mobile/15E148 Safari/604.1":n==="android"?e="Mozilla/5.0 (Linux; Android 13; Pixel 7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/120.0.0.0 Mobile Safari/537.36":e=navigator.userAgent,{"User-Agent":e,Accept:"application/json, text/plain, */*","Accept-Language":"en-US,en;q=0.9","Accept-Encoding":"gzip, deflate, br",Origin:window.location.origin,Referer:window.location.href}},xU="https://jgfcfdlfcnmaripgpepl.supabase.co",wU="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImpnZmNmZGxmY25tYXJpcGdwZXBsIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTI1NDM2MjgsImV4cCI6MjA2ODExOTYyOH0.OmkqPDJM8-BKLDo5WxsL8Nop03XxAaygNaToOMKkzGY",ue=lU(xU,wU,{auth:{storage:localStorage,persistSession:!0,autoRefreshToken:!0},global:{headers:yU()}}),bU=Object.freeze(Object.defineProperty({__proto__:null,supabase:ue},Symbol.toStringTag,{value:"Module"})),Yw=Pn("Device",{web:()=>Ae(()=>import("./web-DFwUJvO8.js"),[]).then(n=>new n.DeviceWeb)});var zS;(function(n){n.IndexedDbLocal="INDEXED_DB_LOCAL",n.InMemory="IN_MEMORY",n.BrowserLocal="BROWSER_LOCAL",n.BrowserSession="BROWSER_SESSION"})(zS||(zS={}));var WS;(function(n){n.APPLE="apple.com",n.FACEBOOK="facebook.com",n.GAME_CENTER="gc.apple.com",n.GITHUB="github.com",n.GOOGLE="google.com",n.MICROSOFT="microsoft.com",n.PLAY_GAMES="playgames.google.com",n.TWITTER="twitter.com",n.YAHOO="yahoo.com",n.PASSWORD="password",n.PHONE="phone"})(WS||(WS={}));const Ts=Pn("FirebaseAuthentication",{web:()=>Ae(()=>import("./web-GP_6rvbh.js"),[]).then(n=>new n.FirebaseAuthenticationWeb)}),mD=Pn("SignInWithApple",{web:()=>Ae(()=>import("./web-DWRzDeVw.js"),[]).then(n=>new n.SignInWithAppleWeb)}),_U=()=>{};var HS={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vD=function(n){const e=[];let t=0;for(let r=0;r<n.length;r++){let s=n.charCodeAt(r);s<128?e[t++]=s:s<2048?(e[t++]=s>>6|192,e[t++]=s&63|128):(s&64512)===55296&&r+1<n.length&&(n.charCodeAt(r+1)&64512)===56320?(s=65536+((s&1023)<<10)+(n.charCodeAt(++r)&1023),e[t++]=s>>18|240,e[t++]=s>>12&63|128,e[t++]=s>>6&63|128,e[t++]=s&63|128):(e[t++]=s>>12|224,e[t++]=s>>6&63|128,e[t++]=s&63|128)}return e},SU=function(n){const e=[];let t=0,r=0;for(;t<n.length;){const s=n[t++];if(s<128)e[r++]=String.fromCharCode(s);else if(s>191&&s<224){const i=n[t++];e[r++]=String.fromCharCode((s&31)<<6|i&63)}else if(s>239&&s<365){const i=n[t++],o=n[t++],a=n[t++],l=((s&7)<<18|(i&63)<<12|(o&63)<<6|a&63)-65536;e[r++]=String.fromCharCode(55296+(l>>10)),e[r++]=String.fromCharCode(56320+(l&1023))}else{const i=n[t++],o=n[t++];e[r++]=String.fromCharCode((s&15)<<12|(i&63)<<6|o&63)}}return e.join("")},yD={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,e){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();const t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let s=0;s<n.length;s+=3){const i=n[s],o=s+1<n.length,a=o?n[s+1]:0,l=s+2<n.length,c=l?n[s+2]:0,u=i>>2,h=(i&3)<<4|a>>4;let d=(a&15)<<2|c>>6,p=c&63;l||(p=64,o||(d=64)),r.push(t[u],t[h],t[d],t[p])}return r.join("")},encodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(n):this.encodeByteArray(vD(n),e)},decodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(n):SU(this.decodeStringToByteArray(n,e))},decodeStringToByteArray(n,e){this.init_();const t=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let s=0;s<n.length;){const i=t[n.charAt(s++)],a=s<n.length?t[n.charAt(s)]:0;++s;const c=s<n.length?t[n.charAt(s)]:64;++s;const h=s<n.length?t[n.charAt(s)]:64;if(++s,i==null||a==null||c==null||h==null)throw new CU;const d=i<<2|a>>4;if(r.push(d),c!==64){const p=a<<4&240|c>>2;if(r.push(p),h!==64){const m=c<<6&192|h;r.push(m)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}};class CU extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const EU=function(n){const e=vD(n);return yD.encodeByteArray(e,!0)},xD=function(n){return EU(n).replace(/\./g,"")},wD=function(n){try{return yD.decodeString(n,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function kU(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const PU=()=>kU().__FIREBASE_DEFAULTS__,TU=()=>{if(typeof process>"u"||typeof HS>"u")return;const n=HS.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},AU=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=n&&wD(n[1]);return e&&JSON.parse(e)},Xw=()=>{try{return _U()||PU()||TU()||AU()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}},DU=n=>{var e,t;return(t=(e=Xw())==null?void 0:e.emulatorHosts)==null?void 0:t[n]},bD=()=>{var n;return(n=Xw())==null?void 0:n.config},_D=n=>{var e;return(e=Xw())==null?void 0:e[`_${n}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class OU{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,r)=>{t?this.reject(t):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,r))}}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function d0(n){try{return(n.startsWith("http://")||n.startsWith("https://")?new URL(n).hostname:n).endsWith(".cloudworkstations.dev")}catch{return!1}}async function IU(n){return(await fetch(n,{credentials:"include"})).ok}const vu={};function RU(){const n={prod:[],emulator:[]};for(const e of Object.keys(vu))vu[e]?n.emulator.push(e):n.prod.push(e);return n}function NU(n){let e=document.getElementById(n),t=!1;return e||(e=document.createElement("div"),e.setAttribute("id",n),t=!0),{created:t,element:e}}let VS=!1;function jU(n,e){if(typeof window>"u"||typeof document>"u"||!d0(window.location.host)||vu[n]===e||vu[n]||VS)return;vu[n]=e;function t(d){return`__firebase__banner__${d}`}const r="__firebase__banner",i=RU().prod.length>0;function o(){const d=document.getElementById(r);d&&d.remove()}function a(d){d.style.display="flex",d.style.background="#7faaf0",d.style.position="fixed",d.style.bottom="5px",d.style.left="5px",d.style.padding=".5em",d.style.borderRadius="5px",d.style.alignItems="center"}function l(d,p){d.setAttribute("width","24"),d.setAttribute("id",p),d.setAttribute("height","24"),d.setAttribute("viewBox","0 0 24 24"),d.setAttribute("fill","none"),d.style.marginLeft="-6px"}function c(){const d=document.createElement("span");return d.style.cursor="pointer",d.style.marginLeft="16px",d.style.fontSize="24px",d.innerHTML=" &times;",d.onclick=()=>{VS=!0,o()},d}function u(d,p){d.setAttribute("id",p),d.innerText="Learn more",d.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",d.setAttribute("target","__blank"),d.style.paddingLeft="5px",d.style.textDecoration="underline"}function h(){const d=NU(r),p=t("text"),m=document.getElementById(p)||document.createElement("span"),g=t("learnmore"),y=document.getElementById(g)||document.createElement("a"),x=t("preprendIcon"),v=document.getElementById(x)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(d.created){const w=d.element;a(w),u(y,g);const _=c();l(v,x),w.append(v,m,y,_),document.body.appendChild(w)}i?(m.innerText="Preview backend disconnected.",v.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(v.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,m.innerText="Preview backend running in this workspace."),m.setAttribute("id",p)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",h):h()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Mn(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function LU(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Mn())}function MU(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function FU(){const n=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof n=="object"&&n.id!==void 0}function BU(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function UU(){const n=Mn();return n.indexOf("MSIE ")>=0||n.indexOf("Trident/")>=0}function $U(){try{return typeof indexedDB=="object"}catch{return!1}}function zU(){return new Promise((n,e)=>{try{let t=!0;const r="validate-browser-context-for-indexeddb-analytics-module",s=self.indexedDB.open(r);s.onsuccess=()=>{s.result.close(),t||self.indexedDB.deleteDatabase(r),n(!0)},s.onupgradeneeded=()=>{t=!1},s.onerror=()=>{var i;e(((i=s.error)==null?void 0:i.message)||"")}}catch(t){e(t)}})}function ree(){return!(typeof navigator>"u"||!navigator.cookieEnabled)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const WU="FirebaseError";class So extends Error{constructor(e,t,r){super(t),this.code=e,this.customData=r,this.name=WU,Object.setPrototypeOf(this,So.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Ed.prototype.create)}}class Ed{constructor(e,t,r){this.service=e,this.serviceName=t,this.errors=r}create(e,...t){const r=t[0]||{},s=`${this.service}/${e}`,i=this.errors[e],o=i?HU(i,r):"Error",a=`${this.serviceName}: ${o} (${s}).`;return new So(s,a,r)}}function HU(n,e){return n.replace(VU,(t,r)=>{const s=e[r];return s!=null?String(s):`<${r}?>`})}const VU=/\{\$([^}]+)}/g;function GU(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}function Ql(n,e){if(n===e)return!0;const t=Object.keys(n),r=Object.keys(e);for(const s of t){if(!r.includes(s))return!1;const i=n[s],o=e[s];if(GS(i)&&GS(o)){if(!Ql(i,o))return!1}else if(i!==o)return!1}for(const s of r)if(!t.includes(s))return!1;return!0}function GS(n){return n!==null&&typeof n=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hc(n){const e=[];for(const[t,r]of Object.entries(n))Array.isArray(r)?r.forEach(s=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(s))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}function eu(n){const e={};return n.replace(/^\?/,"").split("&").forEach(r=>{if(r){const[s,i]=r.split("=");e[decodeURIComponent(s)]=decodeURIComponent(i)}}),e}function tu(n){const e=n.indexOf("?");if(!e)return"";const t=n.indexOf("#",e);return n.substring(e,t>0?t:void 0)}function qU(n,e){const t=new YU(n,e);return t.subscribe.bind(t)}class YU{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,r){let s;if(e===void 0&&t===void 0&&r===void 0)throw new Error("Missing Observer.");XU(e,["next","error","complete"])?s=e:s={next:e,error:t,complete:r},s.next===void 0&&(s.next=Mg),s.error===void 0&&(s.error=Mg),s.complete===void 0&&(s.complete=Mg);const i=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?s.error(this.finalError):s.complete()}catch{}}),this.observers.push(s),i}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function XU(n,e){if(typeof n!="object"||n===null)return!1;for(const t of e)if(t in n&&typeof n[t]=="function")return!0;return!1}function Mg(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yt(n){return n&&n._delegate?n._delegate:n}class Zl{constructor(e,t,r){this.name=e,this.instanceFactory=t,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Bo="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class KU{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const r=new OU;if(this.instancesDeferred.set(t,r),this.isInitialized(t)||this.shouldAutoInitialize())try{const s=this.getOrInitializeService({instanceIdentifier:t});s&&r.resolve(s)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){const t=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),r=(e==null?void 0:e.optional)??!1;if(this.isInitialized(t)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:t})}catch(s){if(r)return null;throw s}else{if(r)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(QU(e))try{this.getOrInitializeService({instanceIdentifier:Bo})}catch{}for(const[t,r]of this.instancesDeferred.entries()){const s=this.normalizeInstanceIdentifier(t);try{const i=this.getOrInitializeService({instanceIdentifier:s});r.resolve(i)}catch{}}}}clearInstance(e=Bo){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Bo){return this.instances.has(e)}getOptions(e=Bo){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const s=this.getOrInitializeService({instanceIdentifier:r,options:t});for(const[i,o]of this.instancesDeferred.entries()){const a=this.normalizeInstanceIdentifier(i);r===a&&o.resolve(s)}return s}onInit(e,t){const r=this.normalizeInstanceIdentifier(t),s=this.onInitCallbacks.get(r)??new Set;s.add(e),this.onInitCallbacks.set(r,s);const i=this.instances.get(r);return i&&e(i,r),()=>{s.delete(e)}}invokeOnInitCallbacks(e,t){const r=this.onInitCallbacks.get(t);if(r)for(const s of r)try{s(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:JU(e),options:t}),this.instances.set(e,r),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=Bo){return this.component?this.component.multipleInstances?e:Bo:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function JU(n){return n===Bo?void 0:n}function QU(n){return n.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZU{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new KU(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var pt;(function(n){n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT"})(pt||(pt={}));const e$={debug:pt.DEBUG,verbose:pt.VERBOSE,info:pt.INFO,warn:pt.WARN,error:pt.ERROR,silent:pt.SILENT},t$=pt.INFO,n$={[pt.DEBUG]:"log",[pt.VERBOSE]:"log",[pt.INFO]:"info",[pt.WARN]:"warn",[pt.ERROR]:"error"},r$=(n,e,...t)=>{if(e<n.logLevel)return;const r=new Date().toISOString(),s=n$[e];if(s)console[s](`[${r}]  ${n.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class SD{constructor(e){this.name=e,this._logLevel=t$,this._logHandler=r$,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in pt))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?e$[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,pt.DEBUG,...e),this._logHandler(this,pt.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,pt.VERBOSE,...e),this._logHandler(this,pt.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,pt.INFO,...e),this._logHandler(this,pt.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,pt.WARN,...e),this._logHandler(this,pt.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,pt.ERROR,...e),this._logHandler(this,pt.ERROR,...e)}}const s$=(n,e)=>e.some(t=>n instanceof t);let qS,YS;function i$(){return qS||(qS=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function o$(){return YS||(YS=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const CD=new WeakMap,Ry=new WeakMap,ED=new WeakMap,Fg=new WeakMap,Kw=new WeakMap;function a$(n){const e=new Promise((t,r)=>{const s=()=>{n.removeEventListener("success",i),n.removeEventListener("error",o)},i=()=>{t(Vs(n.result)),s()},o=()=>{r(n.error),s()};n.addEventListener("success",i),n.addEventListener("error",o)});return e.then(t=>{t instanceof IDBCursor&&CD.set(t,n)}).catch(()=>{}),Kw.set(e,n),e}function l$(n){if(Ry.has(n))return;const e=new Promise((t,r)=>{const s=()=>{n.removeEventListener("complete",i),n.removeEventListener("error",o),n.removeEventListener("abort",o)},i=()=>{t(),s()},o=()=>{r(n.error||new DOMException("AbortError","AbortError")),s()};n.addEventListener("complete",i),n.addEventListener("error",o),n.addEventListener("abort",o)});Ry.set(n,e)}let Ny={get(n,e,t){if(n instanceof IDBTransaction){if(e==="done")return Ry.get(n);if(e==="objectStoreNames")return n.objectStoreNames||ED.get(n);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return Vs(n[e])},set(n,e,t){return n[e]=t,!0},has(n,e){return n instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in n}};function c$(n){Ny=n(Ny)}function u$(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){const r=n.call(Bg(this),e,...t);return ED.set(r,e.sort?e.sort():[e]),Vs(r)}:o$().includes(n)?function(...e){return n.apply(Bg(this),e),Vs(CD.get(this))}:function(...e){return Vs(n.apply(Bg(this),e))}}function d$(n){return typeof n=="function"?u$(n):(n instanceof IDBTransaction&&l$(n),s$(n,i$())?new Proxy(n,Ny):n)}function Vs(n){if(n instanceof IDBRequest)return a$(n);if(Fg.has(n))return Fg.get(n);const e=d$(n);return e!==n&&(Fg.set(n,e),Kw.set(e,n)),e}const Bg=n=>Kw.get(n);function h$(n,e,{blocked:t,upgrade:r,blocking:s,terminated:i}={}){const o=indexedDB.open(n,e),a=Vs(o);return r&&o.addEventListener("upgradeneeded",l=>{r(Vs(o.result),l.oldVersion,l.newVersion,Vs(o.transaction),l)}),t&&o.addEventListener("blocked",l=>t(l.oldVersion,l.newVersion,l)),a.then(l=>{i&&l.addEventListener("close",()=>i()),s&&l.addEventListener("versionchange",c=>s(c.oldVersion,c.newVersion,c))}).catch(()=>{}),a}function see(n,{blocked:e}={}){const t=indexedDB.deleteDatabase(n);return e&&t.addEventListener("blocked",r=>e(r.oldVersion,r)),Vs(t).then(()=>{})}const f$=["get","getKey","getAll","getAllKeys","count"],p$=["put","add","delete","clear"],Ug=new Map;function XS(n,e){if(!(n instanceof IDBDatabase&&!(e in n)&&typeof e=="string"))return;if(Ug.get(e))return Ug.get(e);const t=e.replace(/FromIndex$/,""),r=e!==t,s=p$.includes(t);if(!(t in(r?IDBIndex:IDBObjectStore).prototype)||!(s||f$.includes(t)))return;const i=async function(o,...a){const l=this.transaction(o,s?"readwrite":"readonly");let c=l.store;return r&&(c=c.index(a.shift())),(await Promise.all([c[t](...a),s&&l.done]))[0]};return Ug.set(e,i),i}c$(n=>({...n,get:(e,t,r)=>XS(e,t)||n.get(e,t,r),has:(e,t)=>!!XS(e,t)||n.has(e,t)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class g${constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(m$(t)){const r=t.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(t=>t).join(" ")}}function m$(n){const e=n.getComponent();return(e==null?void 0:e.type)==="VERSION"}const jy="@firebase/app",KS="0.14.1";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const si=new SD("@firebase/app"),v$="@firebase/app-compat",y$="@firebase/analytics-compat",x$="@firebase/analytics",w$="@firebase/app-check-compat",b$="@firebase/app-check",_$="@firebase/auth",S$="@firebase/auth-compat",C$="@firebase/database",E$="@firebase/data-connect",k$="@firebase/database-compat",P$="@firebase/functions",T$="@firebase/functions-compat",A$="@firebase/installations",D$="@firebase/installations-compat",O$="@firebase/messaging",I$="@firebase/messaging-compat",R$="@firebase/performance",N$="@firebase/performance-compat",j$="@firebase/remote-config",L$="@firebase/remote-config-compat",M$="@firebase/storage",F$="@firebase/storage-compat",B$="@firebase/firestore",U$="@firebase/ai",$$="@firebase/firestore-compat",z$="firebase",W$="12.1.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ly="[DEFAULT]",H$={[jy]:"fire-core",[v$]:"fire-core-compat",[x$]:"fire-analytics",[y$]:"fire-analytics-compat",[b$]:"fire-app-check",[w$]:"fire-app-check-compat",[_$]:"fire-auth",[S$]:"fire-auth-compat",[C$]:"fire-rtdb",[E$]:"fire-data-connect",[k$]:"fire-rtdb-compat",[P$]:"fire-fn",[T$]:"fire-fn-compat",[A$]:"fire-iid",[D$]:"fire-iid-compat",[O$]:"fire-fcm",[I$]:"fire-fcm-compat",[R$]:"fire-perf",[N$]:"fire-perf-compat",[j$]:"fire-rc",[L$]:"fire-rc-compat",[M$]:"fire-gcs",[F$]:"fire-gcs-compat",[B$]:"fire-fst",[$$]:"fire-fst-compat",[U$]:"fire-vertex","fire-js":"fire-js",[z$]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Qu=new Map,V$=new Map,My=new Map;function JS(n,e){try{n.container.addComponent(e)}catch(t){si.debug(`Component ${e.name} failed to register with FirebaseApp ${n.name}`,t)}}function Zu(n){const e=n.name;if(My.has(e))return si.debug(`There were multiple attempts to register component ${e}.`),!1;My.set(e,n);for(const t of Qu.values())JS(t,n);for(const t of V$.values())JS(t,n);return!0}function kD(n,e){const t=n.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),n.container.getProvider(e)}function ln(n){return n==null?!1:n.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const G$={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},so=new Ed("app","Firebase",G$);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class q${constructor(e,t,r){this._isDeleted=!1,this._options={...e},this._config={...t},this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new Zl("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw so.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kd=W$;function PD(n,e={}){let t=n;typeof e!="object"&&(e={name:e});const r={name:Ly,automaticDataCollectionEnabled:!0,...e},s=r.name;if(typeof s!="string"||!s)throw so.create("bad-app-name",{appName:String(s)});if(t||(t=bD()),!t)throw so.create("no-options");const i=Qu.get(s);if(i){if(Ql(t,i.options)&&Ql(r,i.config))return i;throw so.create("duplicate-app",{appName:s})}const o=new ZU(s);for(const l of My.values())o.addComponent(l);const a=new q$(t,r,o);return Qu.set(s,a),a}function TD(n=Ly){const e=Qu.get(n);if(!e&&n===Ly&&bD())return PD();if(!e)throw so.create("no-app",{appName:n});return e}function Y$(){return Array.from(Qu.values())}function yl(n,e,t){let r=H$[n]??n;t&&(r+=`-${t}`);const s=r.match(/\s|\//),i=e.match(/\s|\//);if(s||i){const o=[`Unable to register library "${r}" with version "${e}":`];s&&o.push(`library name "${r}" contains illegal characters (whitespace or "/")`),s&&i&&o.push("and"),i&&o.push(`version name "${e}" contains illegal characters (whitespace or "/")`),si.warn(o.join(" "));return}Zu(new Zl(`${r}-version`,()=>({library:r,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const X$="firebase-heartbeat-database",K$=1,ed="firebase-heartbeat-store";let $g=null;function AD(){return $g||($g=h$(X$,K$,{upgrade:(n,e)=>{switch(e){case 0:try{n.createObjectStore(ed)}catch(t){console.warn(t)}}}}).catch(n=>{throw so.create("idb-open",{originalErrorMessage:n.message})})),$g}async function J$(n){try{const t=(await AD()).transaction(ed),r=await t.objectStore(ed).get(DD(n));return await t.done,r}catch(e){if(e instanceof So)si.warn(e.message);else{const t=so.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});si.warn(t.message)}}}async function QS(n,e){try{const r=(await AD()).transaction(ed,"readwrite");await r.objectStore(ed).put(e,DD(n)),await r.done}catch(t){if(t instanceof So)si.warn(t.message);else{const r=so.create("idb-set",{originalErrorMessage:t==null?void 0:t.message});si.warn(r.message)}}}function DD(n){return`${n.name}!${n.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Q$=1024,Z$=30;class e9{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new n9(t),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){var e,t;try{const s=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),i=ZS();if(((e=this._heartbeatsCache)==null?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((t=this._heartbeatsCache)==null?void 0:t.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===i||this._heartbeatsCache.heartbeats.some(o=>o.date===i))return;if(this._heartbeatsCache.heartbeats.push({date:i,agent:s}),this._heartbeatsCache.heartbeats.length>Z$){const o=r9(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(o,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(r){si.warn(r)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)==null?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const t=ZS(),{heartbeatsToSend:r,unsentEntries:s}=t9(this._heartbeatsCache.heartbeats),i=xD(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=t,s.length>0?(this._heartbeatsCache.heartbeats=s,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),i}catch(t){return si.warn(t),""}}}function ZS(){return new Date().toISOString().substring(0,10)}function t9(n,e=Q$){const t=[];let r=n.slice();for(const s of n){const i=t.find(o=>o.agent===s.agent);if(i){if(i.dates.push(s.date),eC(t)>e){i.dates.pop();break}}else if(t.push({agent:s.agent,dates:[s.date]}),eC(t)>e){t.pop();break}r=r.slice(1)}return{heartbeatsToSend:t,unsentEntries:r}}class n9{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return $U()?zU().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const t=await J$(this.app);return t!=null&&t.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const r=await this.read();return QS(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const r=await this.read();return QS(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:[...r.heartbeats,...e.heartbeats]})}else return}}function eC(n){return xD(JSON.stringify({version:2,heartbeats:n})).length}function r9(n){if(n.length===0)return-1;let e=0,t=n[0].date;for(let r=1;r<n.length;r++)n[r].date<t&&(t=n[r].date,e=r);return e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function s9(n){Zu(new Zl("platform-logger",e=>new g$(e),"PRIVATE")),Zu(new Zl("heartbeat",e=>new e9(e),"PRIVATE")),yl(jy,KS,n),yl(jy,KS,"esm2020"),yl("fire-js","")}s9("");var i9="firebase",o9="12.1.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */yl(i9,o9,"app");function OD(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const a9=OD,ID=new Ed("auth","Firebase",OD());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ip=new SD("@firebase/auth");function l9(n,...e){ip.logLevel<=pt.WARN&&ip.warn(`Auth (${kd}): ${n}`,...e)}function df(n,...e){ip.logLevel<=pt.ERROR&&ip.error(`Auth (${kd}): ${n}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ar(n,...e){throw Qw(n,...e)}function Jn(n,...e){return Qw(n,...e)}function Jw(n,e,t){const r={...a9(),[e]:t};return new Ed("auth","Firebase",r).create(e,{appName:n.name})}function Ln(n){return Jw(n,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function h0(n,e,t){const r=t;if(!(e instanceof r))throw r.name!==e.constructor.name&&Ar(n,"argument-error"),Jw(n,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function Qw(n,...e){if(typeof n!="string"){const t=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=n.name),n._errorFactory.create(t,...r)}return ID.create(n,...e)}function pe(n,e,...t){if(!n)throw Qw(e,...t)}function Fs(n){const e="INTERNAL ASSERTION FAILED: "+n;throw df(e),new Error(e)}function ii(n,e){n||Fs(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function td(){var n;return typeof self<"u"&&((n=self.location)==null?void 0:n.href)||""}function Zw(){return tC()==="http:"||tC()==="https:"}function tC(){var n;return typeof self<"u"&&((n=self.location)==null?void 0:n.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function c9(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(Zw()||FU()||"connection"in navigator)?navigator.onLine:!0}function u9(){if(typeof navigator>"u")return null;const n=navigator;return n.languages&&n.languages[0]||n.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pd{constructor(e,t){this.shortDelay=e,this.longDelay=t,ii(t>e,"Short delay should be less than long delay!"),this.isMobile=LU()||BU()}get(){return c9()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function e1(n,e){ii(n.emulator,"Emulator should always be set here");const{url:t}=n.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class RD{static initialize(e,t,r){this.fetchImpl=e,t&&(this.headersImpl=t),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Fs("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Fs("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Fs("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const d9={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const h9=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],f9=new Pd(3e4,6e4);function tn(n,e){return n.tenantId&&!e.tenantId?{...e,tenantId:n.tenantId}:e}async function nn(n,e,t,r,s={}){return ND(n,s,async()=>{let i={},o={};r&&(e==="GET"?o=r:i={body:JSON.stringify(r)});const a=hc({key:n.config.apiKey,...o}).slice(1),l=await n._getAdditionalHeaders();l["Content-Type"]="application/json",n.languageCode&&(l["X-Firebase-Locale"]=n.languageCode);const c={method:e,headers:l,...i};return MU()||(c.referrerPolicy="no-referrer"),n.emulatorConfig&&d0(n.emulatorConfig.host)&&(c.credentials="include"),RD.fetch()(await jD(n,n.config.apiHost,t,a),c)})}async function ND(n,e,t){n._canInitEmulator=!1;const r={...d9,...e};try{const s=new g9(n),i=await Promise.race([t(),s.promise]);s.clearNetworkTimeout();const o=await i.json();if("needConfirmation"in o)throw nu(n,"account-exists-with-different-credential",o);if(i.ok&&!("errorMessage"in o))return o;{const a=i.ok?o.errorMessage:o.error.message,[l,c]=a.split(" : ");if(l==="FEDERATED_USER_ID_ALREADY_LINKED")throw nu(n,"credential-already-in-use",o);if(l==="EMAIL_EXISTS")throw nu(n,"email-already-in-use",o);if(l==="USER_DISABLED")throw nu(n,"user-disabled",o);const u=r[l]||l.toLowerCase().replace(/[_\s]+/g,"-");if(c)throw Jw(n,u,c);Ar(n,u)}}catch(s){if(s instanceof So)throw s;Ar(n,"network-request-failed",{message:String(s)})}}async function di(n,e,t,r,s={}){const i=await nn(n,e,t,r,s);return"mfaPendingCredential"in i&&Ar(n,"multi-factor-auth-required",{_serverResponse:i}),i}async function jD(n,e,t,r){const s=`${e}${t}?${r}`,i=n,o=i.config.emulator?e1(n.config,s):`${n.config.apiScheme}://${s}`;return h9.includes(t)&&(await i._persistenceManagerAvailable,i._getPersistenceType()==="COOKIE")?i._getPersistence()._getFinalTarget(o).toString():o}function p9(n){switch(n){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class g9{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,r)=>{this.timer=setTimeout(()=>r(Jn(this.auth,"network-request-failed")),f9.get())})}}function nu(n,e,t){const r={appName:n.name};t.email&&(r.email=t.email),t.phoneNumber&&(r.phoneNumber=t.phoneNumber);const s=Jn(n,e,r);return s.customData._tokenResponse=t,s}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function nC(n){return n!==void 0&&n.getResponse!==void 0}function rC(n){return n!==void 0&&n.enterprise!==void 0}class LD{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const t of this.recaptchaEnforcementState)if(t.provider&&t.provider===e)return p9(t.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function m9(n){return(await nn(n,"GET","/v1/recaptchaParams")).recaptchaSiteKey||""}async function MD(n,e){return nn(n,"GET","/v2/recaptchaConfig",tn(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function v9(n,e){return nn(n,"POST","/v1/accounts:delete",e)}async function y9(n,e){return nn(n,"POST","/v1/accounts:update",e)}async function op(n,e){return nn(n,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yu(n){if(n)try{const e=new Date(Number(n));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function x9(n,e=!1){const t=yt(n),r=await t.getIdToken(e),s=f0(r);pe(s&&s.exp&&s.auth_time&&s.iat,t.auth,"internal-error");const i=typeof s.firebase=="object"?s.firebase:void 0,o=i==null?void 0:i.sign_in_provider;return{claims:s,token:r,authTime:yu(zg(s.auth_time)),issuedAtTime:yu(zg(s.iat)),expirationTime:yu(zg(s.exp)),signInProvider:o||null,signInSecondFactor:(i==null?void 0:i.sign_in_second_factor)||null}}function zg(n){return Number(n)*1e3}function f0(n){const[e,t,r]=n.split(".");if(e===void 0||t===void 0||r===void 0)return df("JWT malformed, contained fewer than 3 sections"),null;try{const s=wD(t);return s?JSON.parse(s):(df("Failed to decode base64 JWT payload"),null)}catch(s){return df("Caught error parsing JWT payload as JSON",s==null?void 0:s.toString()),null}}function sC(n){const e=f0(n);return pe(e,"internal-error"),pe(typeof e.exp<"u","internal-error"),pe(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function pa(n,e,t=!1){if(t)return e;try{return await e}catch(r){throw r instanceof So&&w9(r)&&n.auth.currentUser===n&&await n.auth.signOut(),r}}function w9({code:n}){return n==="auth/user-disabled"||n==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class b9{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){const t=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),t}else{this.errorBackoff=3e4;const r=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,r)}}schedule(e=!1){if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fy{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=yu(this.lastLoginAt),this.creationTime=yu(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function nd(n){var h;const e=n.auth,t=await n.getIdToken(),r=await pa(n,op(e,{idToken:t}));pe(r==null?void 0:r.users.length,e,"internal-error");const s=r.users[0];n._notifyReloadListener(s);const i=(h=s.providerUserInfo)!=null&&h.length?FD(s.providerUserInfo):[],o=S9(n.providerData,i),a=n.isAnonymous,l=!(n.email&&s.passwordHash)&&!(o!=null&&o.length),c=a?l:!1,u={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:o,metadata:new Fy(s.createdAt,s.lastLoginAt),isAnonymous:c};Object.assign(n,u)}async function _9(n){const e=yt(n);await nd(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function S9(n,e){return[...n.filter(r=>!e.some(s=>s.providerId===r.providerId)),...e]}function FD(n){return n.map(({providerId:e,...t})=>({providerId:e,uid:t.rawId||"",displayName:t.displayName||null,email:t.email||null,phoneNumber:t.phoneNumber||null,photoURL:t.photoUrl||null}))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function C9(n,e){const t=await ND(n,{},async()=>{const r=hc({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:s,apiKey:i}=n.config,o=await jD(n,s,"/v1/token",`key=${i}`),a=await n._getAdditionalHeaders();a["Content-Type"]="application/x-www-form-urlencoded";const l={method:"POST",headers:a,body:r};return n.emulatorConfig&&d0(n.emulatorConfig.host)&&(l.credentials="include"),RD.fetch()(o,l)});return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}}async function E9(n,e){return nn(n,"POST","/v2/accounts:revokeToken",tn(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xl{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){pe(e.idToken,"internal-error"),pe(typeof e.idToken<"u","internal-error"),pe(typeof e.refreshToken<"u","internal-error");const t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):sC(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){pe(e.length!==0,"internal-error");const t=sC(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e,t=!1){return!t&&this.accessToken&&!this.isExpired?this.accessToken:(pe(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:r,refreshToken:s,expiresIn:i}=await C9(e,t);this.updateTokensAndExpiration(r,s,Number(i))}updateTokensAndExpiration(e,t,r){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,t){const{refreshToken:r,accessToken:s,expirationTime:i}=t,o=new xl;return r&&(pe(typeof r=="string","internal-error",{appName:e}),o.refreshToken=r),s&&(pe(typeof s=="string","internal-error",{appName:e}),o.accessToken=s),i&&(pe(typeof i=="number","internal-error",{appName:e}),o.expirationTime=i),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new xl,this.toJSON())}_performRefresh(){return Fs("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bi(n,e){pe(typeof n=="string"||typeof n>"u","internal-error",{appName:e})}class Yr{constructor({uid:e,auth:t,stsTokenManager:r,...s}){this.providerId="firebase",this.proactiveRefresh=new b9(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=t,this.stsTokenManager=r,this.accessToken=r.accessToken,this.displayName=s.displayName||null,this.email=s.email||null,this.emailVerified=s.emailVerified||!1,this.phoneNumber=s.phoneNumber||null,this.photoURL=s.photoURL||null,this.isAnonymous=s.isAnonymous||!1,this.tenantId=s.tenantId||null,this.providerData=s.providerData?[...s.providerData]:[],this.metadata=new Fy(s.createdAt||void 0,s.lastLoginAt||void 0)}async getIdToken(e){const t=await pa(this,this.stsTokenManager.getToken(this.auth,e));return pe(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return x9(this,e)}reload(){return _9(this)}_assign(e){this!==e&&(pe(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>({...t})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new Yr({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return t.metadata._copy(this.metadata),t}_onReload(e){pe(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),t&&await nd(this),await this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(ln(this.auth.app))return Promise.reject(Ln(this.auth));const e=await this.getIdToken();return await pa(this,v9(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){const r=t.displayName??void 0,s=t.email??void 0,i=t.phoneNumber??void 0,o=t.photoURL??void 0,a=t.tenantId??void 0,l=t._redirectEventId??void 0,c=t.createdAt??void 0,u=t.lastLoginAt??void 0,{uid:h,emailVerified:d,isAnonymous:p,providerData:m,stsTokenManager:g}=t;pe(h&&g,e,"internal-error");const y=xl.fromJSON(this.name,g);pe(typeof h=="string",e,"internal-error"),bi(r,e.name),bi(s,e.name),pe(typeof d=="boolean",e,"internal-error"),pe(typeof p=="boolean",e,"internal-error"),bi(i,e.name),bi(o,e.name),bi(a,e.name),bi(l,e.name),bi(c,e.name),bi(u,e.name);const x=new Yr({uid:h,auth:e,email:s,emailVerified:d,displayName:r,isAnonymous:p,photoURL:o,phoneNumber:i,tenantId:a,stsTokenManager:y,createdAt:c,lastLoginAt:u});return m&&Array.isArray(m)&&(x.providerData=m.map(v=>({...v}))),l&&(x._redirectEventId=l),x}static async _fromIdTokenResponse(e,t,r=!1){const s=new xl;s.updateFromServerResponse(t);const i=new Yr({uid:t.localId,auth:e,stsTokenManager:s,isAnonymous:r});return await nd(i),i}static async _fromGetAccountInfoResponse(e,t,r){const s=t.users[0];pe(s.localId!==void 0,"internal-error");const i=s.providerUserInfo!==void 0?FD(s.providerUserInfo):[],o=!(s.email&&s.passwordHash)&&!(i!=null&&i.length),a=new xl;a.updateFromIdToken(r);const l=new Yr({uid:s.localId,auth:e,stsTokenManager:a,isAnonymous:o}),c={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:i,metadata:new Fy(s.createdAt,s.lastLoginAt),isAnonymous:!(s.email&&s.passwordHash)&&!(i!=null&&i.length)};return Object.assign(l,c),l}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const iC=new Map;function Bs(n){ii(n instanceof Function,"Expected a class definition");let e=iC.get(n);return e?(ii(e instanceof n,"Instance stored in cache mismatched with class"),e):(e=new n,iC.set(n,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class BD{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return t===void 0?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}BD.type="NONE";const oC=BD;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hf(n,e,t){return`firebase:${n}:${e}:${t}`}class wl{constructor(e,t,r){this.persistence=e,this.auth=t,this.userKey=r;const{config:s,name:i}=this.auth;this.fullUserKey=hf(this.userKey,s.apiKey,i),this.fullPersistenceKey=hf("persistence",s.apiKey,i),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const t=await op(this.auth,{idToken:e}).catch(()=>{});return t?Yr._fromGetAccountInfoResponse(this.auth,t,e):null}return Yr._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,r="authUser"){if(!t.length)return new wl(Bs(oC),e,r);const s=(await Promise.all(t.map(async c=>{if(await c._isAvailable())return c}))).filter(c=>c);let i=s[0]||Bs(oC);const o=hf(r,e.config.apiKey,e.name);let a=null;for(const c of t)try{const u=await c._get(o);if(u){let h;if(typeof u=="string"){const d=await op(e,{idToken:u}).catch(()=>{});if(!d)break;h=await Yr._fromGetAccountInfoResponse(e,d,u)}else h=Yr._fromJSON(e,u);c!==i&&(a=h),i=c;break}}catch{}const l=s.filter(c=>c._shouldAllowMigration);return!i._shouldAllowMigration||!l.length?new wl(i,e,r):(i=l[0],a&&await i._set(o,a.toJSON()),await Promise.all(t.map(async c=>{if(c!==i)try{await c._remove(o)}catch{}})),new wl(i,e,r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function aC(n){const e=n.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(WD(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(UD(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(VD(e))return"Blackberry";if(GD(e))return"Webos";if($D(e))return"Safari";if((e.includes("chrome/")||zD(e))&&!e.includes("edge/"))return"Chrome";if(HD(e))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=n.match(t);if((r==null?void 0:r.length)===2)return r[1]}return"Other"}function UD(n=Mn()){return/firefox\//i.test(n)}function $D(n=Mn()){const e=n.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function zD(n=Mn()){return/crios\//i.test(n)}function WD(n=Mn()){return/iemobile/i.test(n)}function HD(n=Mn()){return/android/i.test(n)}function VD(n=Mn()){return/blackberry/i.test(n)}function GD(n=Mn()){return/webos/i.test(n)}function t1(n=Mn()){return/iphone|ipad|ipod/i.test(n)||/macintosh/i.test(n)&&/mobile/i.test(n)}function k9(n=Mn()){var e;return t1(n)&&!!((e=window.navigator)!=null&&e.standalone)}function P9(){return UU()&&document.documentMode===10}function qD(n=Mn()){return t1(n)||HD(n)||GD(n)||VD(n)||/windows phone/i.test(n)||WD(n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function YD(n,e=[]){let t;switch(n){case"Browser":t=aC(Mn());break;case"Worker":t=`${aC(Mn())}-${n}`;break;default:t=n}const r=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${kd}/${r}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class T9{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const r=i=>new Promise((o,a)=>{try{const l=e(i);o(l)}catch(l){a(l)}});r.onAbort=t,this.queue.push(r);const s=this.queue.length-1;return()=>{this.queue[s]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const r of this.queue)await r(e),r.onAbort&&t.push(r.onAbort)}catch(r){t.reverse();for(const s of t)try{s()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r==null?void 0:r.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function A9(n,e={}){return nn(n,"GET","/v2/passwordPolicy",tn(n,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const D9=6;class O9{constructor(e){var r;const t=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=t.minPasswordLength??D9,t.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=t.maxPasswordLength),t.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=t.containsLowercaseCharacter),t.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=t.containsUppercaseCharacter),t.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=t.containsNumericCharacter),t.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=t.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=((r=e.allowedNonAlphanumericCharacters)==null?void 0:r.join(""))??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){const t={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,t),this.validatePasswordCharacterOptions(e,t),t.isValid&&(t.isValid=t.meetsMinPasswordLength??!0),t.isValid&&(t.isValid=t.meetsMaxPasswordLength??!0),t.isValid&&(t.isValid=t.containsLowercaseLetter??!0),t.isValid&&(t.isValid=t.containsUppercaseLetter??!0),t.isValid&&(t.isValid=t.containsNumericCharacter??!0),t.isValid&&(t.isValid=t.containsNonAlphanumericCharacter??!0),t}validatePasswordLengthOptions(e,t){const r=this.customStrengthOptions.minPasswordLength,s=this.customStrengthOptions.maxPasswordLength;r&&(t.meetsMinPasswordLength=e.length>=r),s&&(t.meetsMaxPasswordLength=e.length<=s)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let r;for(let s=0;s<e.length;s++)r=e.charAt(s),this.updatePasswordCharacterOptionsStatuses(t,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,t,r,s,i){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=s)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class I9{constructor(e,t,r,s){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=r,this.config=s,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new lC(this),this.idTokenSubscription=new lC(this),this.beforeStateQueue=new T9(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=ID,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=s.sdkClientVersion,this._persistenceManagerAvailable=new Promise(i=>this._resolvePersistenceManagerAvailable=i)}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=Bs(t)),this._initializationPromise=this.queue(async()=>{var r,s,i;if(!this._deleted&&(this.persistenceManager=await wl.create(this,e),(r=this._resolvePersistenceManagerAvailable)==null||r.call(this),!this._deleted)){if((s=this._popupRedirectResolver)!=null&&s._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(t),this.lastNotifiedUid=((i=this.currentUser)==null?void 0:i.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const t=await op(this,{idToken:e}),r=await Yr._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(r)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var i;if(ln(this.app)){const o=this.app.settings.authIdToken;return o?new Promise(a=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(o).then(a,a))}):this.directlySetCurrentUser(null)}const t=await this.assertedPersistence.getCurrentUser();let r=t,s=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const o=(i=this.redirectUser)==null?void 0:i._redirectEventId,a=r==null?void 0:r._redirectEventId,l=await this.tryRedirectSignIn(e);(!o||o===a)&&(l!=null&&l.user)&&(r=l.user,s=!0)}if(!r)return this.directlySetCurrentUser(null);if(!r._redirectEventId){if(s)try{await this.beforeStateQueue.runMiddleware(r)}catch(o){r=t,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(o))}return r?this.reloadAndSetCurrentUserOrClear(r):this.directlySetCurrentUser(null)}return pe(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===r._redirectEventId?this.directlySetCurrentUser(r):this.reloadAndSetCurrentUserOrClear(r)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await nd(e)}catch(t){if((t==null?void 0:t.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=u9()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(ln(this.app))return Promise.reject(Ln(this));const t=e?yt(e):null;return t&&pe(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&pe(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return ln(this.app)?Promise.reject(Ln(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return ln(this.app)?Promise.reject(Ln(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(Bs(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await A9(this),t=new O9(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new Ed("auth","Firebase",e())}onAuthStateChanged(e,t,r){return this.registerStateListener(this.authStateSubscription,e,t,r)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,r){return this.registerStateListener(this.idTokenSubscription,e,t,r)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{const r=this.onAuthStateChanged(()=>{r(),e()},t)}})}async revokeAccessToken(e){if(this.currentUser){const t=await this.currentUser.getIdToken(),r={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(r.tenantId=this.tenantId),await E9(this,r)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)==null?void 0:e.toJSON()}}async _setRedirectUser(e,t){const r=await this.getOrInitRedirectPersistenceManager(t);return e===null?r.removeCurrentUser():r.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&Bs(e)||this._popupRedirectResolver;pe(t,this,"argument-error"),this.redirectPersistenceManager=await wl.create(this,[Bs(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var t,r;return this._isInitialized&&await this.queue(async()=>{}),((t=this._currentUser)==null?void 0:t._redirectEventId)===e?this._currentUser:((r=this.redirectUser)==null?void 0:r._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var t;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const e=((t=this.currentUser)==null?void 0:t.uid)??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,r,s){if(this._deleted)return()=>{};const i=typeof t=="function"?t:t.next.bind(t);let o=!1;const a=this._isInitialized?Promise.resolve():this._initializationPromise;if(pe(a,this,"internal-error"),a.then(()=>{o||i(this.currentUser)}),typeof t=="function"){const l=e.addObserver(t,r,s);return()=>{o=!0,l()}}else{const l=e.addObserver(t);return()=>{o=!0,l()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return pe(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=YD(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var s;const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const t=await((s=this.heartbeatServiceProvider.getImmediate({optional:!0}))==null?void 0:s.getHeartbeatsHeader());t&&(e["X-Firebase-Client"]=t);const r=await this._getAppCheckToken();return r&&(e["X-Firebase-AppCheck"]=r),e}async _getAppCheckToken(){var t;if(ln(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await((t=this.appCheckServiceProvider.getImmediate({optional:!0}))==null?void 0:t.getToken());return e!=null&&e.error&&l9(`Error while retrieving App Check token: ${e.error}`),e==null?void 0:e.token}}function un(n){return yt(n)}class lC{constructor(e){this.auth=e,this.observer=null,this.addObserver=qU(t=>this.observer=t)}get next(){return pe(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Td={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function R9(n){Td=n}function n1(n){return Td.loadJS(n)}function N9(){return Td.recaptchaV2Script}function j9(){return Td.recaptchaEnterpriseScript}function L9(){return Td.gapiScript}function XD(n){return`__${n}${Math.floor(Math.random()*1e6)}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const M9=500,F9=6e4,gh=1e12;class B9{constructor(e){this.auth=e,this.counter=gh,this._widgets=new Map}render(e,t){const r=this.counter;return this._widgets.set(r,new z9(e,this.auth.name,t||{})),this.counter++,r}reset(e){var r;const t=e||gh;(r=this._widgets.get(t))==null||r.delete(),this._widgets.delete(t)}getResponse(e){var r;const t=e||gh;return((r=this._widgets.get(t))==null?void 0:r.getResponse())||""}async execute(e){var r;const t=e||gh;return(r=this._widgets.get(t))==null||r.execute(),""}}class U9{constructor(){this.enterprise=new $9}ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}class $9{ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}class z9{constructor(e,t,r){this.params=r,this.timerId=null,this.deleted=!1,this.responseToken=null,this.clickHandler=()=>{this.execute()};const s=typeof e=="string"?document.getElementById(e):e;pe(s,"argument-error",{appName:t}),this.container=s,this.isVisible=this.params.size!=="invisible",this.isVisible?this.execute():this.container.addEventListener("click",this.clickHandler)}getResponse(){return this.checkIfDeleted(),this.responseToken}delete(){this.checkIfDeleted(),this.deleted=!0,this.timerId&&(clearTimeout(this.timerId),this.timerId=null),this.container.removeEventListener("click",this.clickHandler)}execute(){this.checkIfDeleted(),!this.timerId&&(this.timerId=window.setTimeout(()=>{this.responseToken=W9(50);const{callback:e,"expired-callback":t}=this.params;if(e)try{e(this.responseToken)}catch{}this.timerId=window.setTimeout(()=>{if(this.timerId=null,this.responseToken=null,t)try{t()}catch{}this.isVisible&&this.execute()},F9)},M9))}checkIfDeleted(){if(this.deleted)throw new Error("reCAPTCHA mock was already deleted!")}}function W9(n){const e=[],t="1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";for(let r=0;r<n;r++)e.push(t.charAt(Math.floor(Math.random()*t.length)));return e.join("")}const H9="recaptcha-enterprise",xu="NO_RECAPTCHA";class KD{constructor(e){this.type=H9,this.auth=un(e)}async verify(e="verify",t=!1){async function r(i){if(!t){if(i.tenantId==null&&i._agentRecaptchaConfig!=null)return i._agentRecaptchaConfig.siteKey;if(i.tenantId!=null&&i._tenantRecaptchaConfigs[i.tenantId]!==void 0)return i._tenantRecaptchaConfigs[i.tenantId].siteKey}return new Promise(async(o,a)=>{MD(i,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(l=>{if(l.recaptchaKey===void 0)a(new Error("recaptcha Enterprise site key undefined"));else{const c=new LD(l);return i.tenantId==null?i._agentRecaptchaConfig=c:i._tenantRecaptchaConfigs[i.tenantId]=c,o(c.siteKey)}}).catch(l=>{a(l)})})}function s(i,o,a){const l=window.grecaptcha;rC(l)?l.enterprise.ready(()=>{l.enterprise.execute(i,{action:e}).then(c=>{o(c)}).catch(()=>{o(xu)})}):a(Error("No reCAPTCHA enterprise script loaded."))}return this.auth.settings.appVerificationDisabledForTesting?new U9().execute("siteKey",{action:"verify"}):new Promise((i,o)=>{r(this.auth).then(a=>{if(!t&&rC(window.grecaptcha))s(a,i,o);else{if(typeof window>"u"){o(new Error("RecaptchaVerifier is only supported in browser"));return}let l=j9();l.length!==0&&(l+=a),n1(l).then(()=>{s(a,i,o)}).catch(c=>{o(c)})}}).catch(a=>{o(a)})})}}async function Wc(n,e,t,r=!1,s=!1){const i=new KD(n);let o;if(s)o=xu;else try{o=await i.verify(t)}catch{o=await i.verify(t,!0)}const a={...e};if(t==="mfaSmsEnrollment"||t==="mfaSmsSignIn"){if("phoneEnrollmentInfo"in a){const l=a.phoneEnrollmentInfo.phoneNumber,c=a.phoneEnrollmentInfo.recaptchaToken;Object.assign(a,{phoneEnrollmentInfo:{phoneNumber:l,recaptchaToken:c,captchaResponse:o,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in a){const l=a.phoneSignInInfo.recaptchaToken;Object.assign(a,{phoneSignInInfo:{recaptchaToken:l,captchaResponse:o,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return a}return r?Object.assign(a,{captchaResp:o}):Object.assign(a,{captchaResponse:o}),Object.assign(a,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(a,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),a}async function io(n,e,t,r,s){var i,o;if(s==="EMAIL_PASSWORD_PROVIDER")if((i=n._getRecaptchaConfig())!=null&&i.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const a=await Wc(n,e,t,t==="getOobCode");return r(n,a)}else return r(n,e).catch(async a=>{if(a.code==="auth/missing-recaptcha-token"){console.log(`${t} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const l=await Wc(n,e,t,t==="getOobCode");return r(n,l)}else return Promise.reject(a)});else if(s==="PHONE_PROVIDER")if((o=n._getRecaptchaConfig())!=null&&o.isProviderEnabled("PHONE_PROVIDER")){const a=await Wc(n,e,t);return r(n,a).catch(async l=>{var c;if(((c=n._getRecaptchaConfig())==null?void 0:c.getProviderEnforcementState("PHONE_PROVIDER"))==="AUDIT"&&(l.code==="auth/missing-recaptcha-token"||l.code==="auth/invalid-app-credential")){console.log(`Failed to verify with reCAPTCHA Enterprise. Automatically triggering the reCAPTCHA v2 flow to complete the ${t} flow.`);const u=await Wc(n,e,t,!1,!0);return r(n,u)}return Promise.reject(l)})}else{const a=await Wc(n,e,t,!1,!0);return r(n,a)}else return Promise.reject(s+" provider is not supported.")}async function V9(n){const e=un(n),t=await MD(e,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}),r=new LD(t);e.tenantId==null?e._agentRecaptchaConfig=r:e._tenantRecaptchaConfigs[e.tenantId]=r,r.isAnyProviderEnabled()&&new KD(e).verify()}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function G9(n,e){const t=kD(n,"auth");if(t.isInitialized()){const s=t.getImmediate(),i=t.getOptions();if(Ql(i,e??{}))return s;Ar(s,"already-initialized")}return t.initialize({options:e})}function q9(n,e){const t=(e==null?void 0:e.persistence)||[],r=(Array.isArray(t)?t:[t]).map(Bs);e!=null&&e.errorMap&&n._updateErrorMap(e.errorMap),n._initializeWithPersistence(r,e==null?void 0:e.popupRedirectResolver)}function Y9(n,e,t){const r=un(n);pe(/^https?:\/\//.test(e),r,"invalid-emulator-scheme");const s=!!(t!=null&&t.disableWarnings),i=JD(e),{host:o,port:a}=X9(e),l=a===null?"":`:${a}`,c={url:`${i}//${o}${l}/`},u=Object.freeze({host:o,port:a,protocol:i.replace(":",""),options:Object.freeze({disableWarnings:s})});if(!r._canInitEmulator){pe(r.config.emulator&&r.emulatorConfig,r,"emulator-config-failed"),pe(Ql(c,r.config.emulator)&&Ql(u,r.emulatorConfig),r,"emulator-config-failed");return}r.config.emulator=c,r.emulatorConfig=u,r.settings.appVerificationDisabledForTesting=!0,d0(o)?(IU(`${i}//${o}${l}`),jU("Auth",!0)):K9()}function JD(n){const e=n.indexOf(":");return e<0?"":n.substr(0,e+1)}function X9(n){const e=JD(n),t=/(\/\/)?([^?#/]+)/.exec(n.substr(e.length));if(!t)return{host:"",port:null};const r=t[2].split("@").pop()||"",s=/^(\[[^\]]+\])(:|$)/.exec(r);if(s){const i=s[1];return{host:i,port:cC(r.substr(i.length+1))}}else{const[i,o]=r.split(":");return{host:i,port:cC(o)}}}function cC(n){if(!n)return null;const e=Number(n);return isNaN(e)?null:e}function K9(){function n(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",n):n())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class p0{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return Fs("not implemented")}_getIdTokenResponse(e){return Fs("not implemented")}_linkToIdToken(e,t){return Fs("not implemented")}_getReauthenticationResolver(e){return Fs("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function J9(n,e){return nn(n,"POST","/v1/accounts:resetPassword",tn(n,e))}async function Q9(n,e){return nn(n,"POST","/v1/accounts:update",e)}async function Z9(n,e){return nn(n,"POST","/v1/accounts:signUp",e)}async function ez(n,e){return nn(n,"POST","/v1/accounts:update",tn(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function tz(n,e){return di(n,"POST","/v1/accounts:signInWithPassword",tn(n,e))}async function g0(n,e){return nn(n,"POST","/v1/accounts:sendOobCode",tn(n,e))}async function nz(n,e){return g0(n,e)}async function rz(n,e){return g0(n,e)}async function sz(n,e){return g0(n,e)}async function iz(n,e){return g0(n,e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function oz(n,e){return di(n,"POST","/v1/accounts:signInWithEmailLink",tn(n,e))}async function az(n,e){return di(n,"POST","/v1/accounts:signInWithEmailLink",tn(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rd extends p0{constructor(e,t,r,s=null){super("password",r),this._email=e,this._password=t,this._tenantId=s}static _fromEmailAndPassword(e,t){return new rd(e,t,"password")}static _fromEmailAndCode(e,t,r=null){return new rd(e,t,"emailLink",r)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e;if(t!=null&&t.email&&(t!=null&&t.password)){if(t.signInMethod==="password")return this._fromEmailAndPassword(t.email,t.password);if(t.signInMethod==="emailLink")return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const t={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return io(e,t,"signInWithPassword",tz,"EMAIL_PASSWORD_PROVIDER");case"emailLink":return oz(e,{email:this._email,oobCode:this._password});default:Ar(e,"internal-error")}}async _linkToIdToken(e,t){switch(this.signInMethod){case"password":const r={idToken:t,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return io(e,r,"signUpPassword",Z9,"EMAIL_PASSWORD_PROVIDER");case"emailLink":return az(e,{idToken:t,email:this._email,oobCode:this._password});default:Ar(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function bl(n,e){return di(n,"POST","/v1/accounts:signInWithIdp",tn(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lz="http://localhost";class oi extends p0{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new oi(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):Ar("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:s,...i}=t;if(!r||!s)return null;const o=new oi(r,s);return o.idToken=i.idToken||void 0,o.accessToken=i.accessToken||void 0,o.secret=i.secret,o.nonce=i.nonce,o.pendingToken=i.pendingToken||null,o}_getIdTokenResponse(e){const t=this.buildRequest();return bl(e,t)}_linkToIdToken(e,t){const r=this.buildRequest();return r.idToken=t,bl(e,r)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,bl(e,t)}buildRequest(){const e={requestUri:lz,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=hc(t)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function uC(n,e){return nn(n,"POST","/v1/accounts:sendVerificationCode",tn(n,e))}async function cz(n,e){return di(n,"POST","/v1/accounts:signInWithPhoneNumber",tn(n,e))}async function uz(n,e){const t=await di(n,"POST","/v1/accounts:signInWithPhoneNumber",tn(n,e));if(t.temporaryProof)throw nu(n,"account-exists-with-different-credential",t);return t}const dz={USER_NOT_FOUND:"user-not-found"};async function hz(n,e){const t={...e,operation:"REAUTH"};return di(n,"POST","/v1/accounts:signInWithPhoneNumber",tn(n,t),dz)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wu extends p0{constructor(e){super("phone","phone"),this.params=e}static _fromVerification(e,t){return new wu({verificationId:e,verificationCode:t})}static _fromTokenResponse(e,t){return new wu({phoneNumber:e,temporaryProof:t})}_getIdTokenResponse(e){return cz(e,this._makeVerificationRequest())}_linkToIdToken(e,t){return uz(e,{idToken:t,...this._makeVerificationRequest()})}_getReauthenticationResolver(e){return hz(e,this._makeVerificationRequest())}_makeVerificationRequest(){const{temporaryProof:e,phoneNumber:t,verificationId:r,verificationCode:s}=this.params;return e&&t?{temporaryProof:e,phoneNumber:t}:{sessionInfo:r,code:s}}toJSON(){const e={providerId:this.providerId};return this.params.phoneNumber&&(e.phoneNumber=this.params.phoneNumber),this.params.temporaryProof&&(e.temporaryProof=this.params.temporaryProof),this.params.verificationCode&&(e.verificationCode=this.params.verificationCode),this.params.verificationId&&(e.verificationId=this.params.verificationId),e}static fromJSON(e){typeof e=="string"&&(e=JSON.parse(e));const{verificationId:t,verificationCode:r,phoneNumber:s,temporaryProof:i}=e;return!r&&!t&&!s&&!i?null:new wu({verificationId:t,verificationCode:r,phoneNumber:s,temporaryProof:i})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fz(n){switch(n){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function pz(n){const e=eu(tu(n)).link,t=e?eu(tu(e)).deep_link_id:null,r=eu(tu(n)).deep_link_id;return(r?eu(tu(r)).link:null)||r||t||e||n}class m0{constructor(e){const t=eu(tu(e)),r=t.apiKey??null,s=t.oobCode??null,i=fz(t.mode??null);pe(r&&s&&i,"argument-error"),this.apiKey=r,this.operation=i,this.code=s,this.continueUrl=t.continueUrl??null,this.languageCode=t.lang??null,this.tenantId=t.tenantId??null}static parseLink(e){const t=pz(e);try{return new m0(t)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ea{constructor(){this.providerId=Ea.PROVIDER_ID}static credential(e,t){return rd._fromEmailAndPassword(e,t)}static credentialWithLink(e,t){const r=m0.parseLink(t);return pe(r,"argument-error"),rd._fromEmailAndCode(e,r.code,r.tenantId)}}Ea.PROVIDER_ID="password";Ea.EMAIL_PASSWORD_SIGN_IN_METHOD="password";Ea.EMAIL_LINK_SIGN_IN_METHOD="emailLink";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fc{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pc extends fc{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}class ff extends pc{static credentialFromJSON(e){const t=typeof e=="string"?JSON.parse(e):e;return pe("providerId"in t&&"signInMethod"in t,"argument-error"),oi._fromParams(t)}credential(e){return this._credential({...e,nonce:e.rawNonce})}_credential(e){return pe(e.idToken||e.accessToken,"argument-error"),oi._fromParams({...e,providerId:this.providerId,signInMethod:this.providerId})}static credentialFromResult(e){return ff.oauthCredentialFromTaggedObject(e)}static credentialFromError(e){return ff.oauthCredentialFromTaggedObject(e.customData||{})}static oauthCredentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:r,oauthTokenSecret:s,pendingToken:i,nonce:o,providerId:a}=e;if(!r&&!s&&!t&&!i||!a)return null;try{return new ff(a)._credential({idToken:t,accessToken:r,nonce:o,pendingToken:i})}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ji extends pc{constructor(){super("facebook.com")}static credential(e){return oi._fromParams({providerId:ji.PROVIDER_ID,signInMethod:ji.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return ji.credentialFromTaggedObject(e)}static credentialFromError(e){return ji.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return ji.credential(e.oauthAccessToken)}catch{return null}}}ji.FACEBOOK_SIGN_IN_METHOD="facebook.com";ji.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Li extends pc{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return oi._fromParams({providerId:Li.PROVIDER_ID,signInMethod:Li.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return Li.credentialFromTaggedObject(e)}static credentialFromError(e){return Li.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:r}=e;if(!t&&!r)return null;try{return Li.credential(t,r)}catch{return null}}}Li.GOOGLE_SIGN_IN_METHOD="google.com";Li.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mi extends pc{constructor(){super("github.com")}static credential(e){return oi._fromParams({providerId:Mi.PROVIDER_ID,signInMethod:Mi.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Mi.credentialFromTaggedObject(e)}static credentialFromError(e){return Mi.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Mi.credential(e.oauthAccessToken)}catch{return null}}}Mi.GITHUB_SIGN_IN_METHOD="github.com";Mi.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fi extends pc{constructor(){super("twitter.com")}static credential(e,t){return oi._fromParams({providerId:Fi.PROVIDER_ID,signInMethod:Fi.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return Fi.credentialFromTaggedObject(e)}static credentialFromError(e){return Fi.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:t,oauthTokenSecret:r}=e;if(!t||!r)return null;try{return Fi.credential(t,r)}catch{return null}}}Fi.TWITTER_SIGN_IN_METHOD="twitter.com";Fi.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function QD(n,e){return di(n,"POST","/v1/accounts:signUp",tn(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ys{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,r,s=!1){const i=await Yr._fromIdTokenResponse(e,r,s),o=dC(r);return new ys({user:i,providerId:o,_tokenResponse:r,operationType:t})}static async _forOperation(e,t,r){await e._updateTokensIfNecessary(r,!0);const s=dC(r);return new ys({user:e,providerId:s,_tokenResponse:r,operationType:t})}}function dC(n){return n.providerId?n.providerId:"phoneNumber"in n?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function iee(n){var s;if(ln(n.app))return Promise.reject(Ln(n));const e=un(n);if(await e._initializationPromise,(s=e.currentUser)!=null&&s.isAnonymous)return new ys({user:e.currentUser,providerId:null,operationType:"signIn"});const t=await QD(e,{returnSecureToken:!0}),r=await ys._fromIdTokenResponse(e,"signIn",t,!0);return await e._updateCurrentUser(r.user),r}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ap extends So{constructor(e,t,r,s){super(t.code,t.message),this.operationType=r,this.user=s,Object.setPrototypeOf(this,ap.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:t.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(e,t,r,s){return new ap(e,t,r,s)}}function ZD(n,e,t,r){return(e==="reauthenticate"?t._getReauthenticationResolver(n):t._getIdTokenResponse(n)).catch(i=>{throw i.code==="auth/multi-factor-auth-required"?ap._fromErrorAndOperation(n,i,e,r):i})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function e4(n){return new Set(n.map(({providerId:e})=>e).filter(e=>!!e))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function oee(n,e){const t=yt(n);await v0(!0,t,e);const{providerUserInfo:r}=await y9(t.auth,{idToken:await t.getIdToken(),deleteProvider:[e]}),s=e4(r||[]);return t.providerData=t.providerData.filter(i=>s.has(i.providerId)),s.has("phone")||(t.phoneNumber=null),await t.auth._persistUserIfCurrent(t),t}async function t4(n,e,t=!1){const r=await pa(n,e._linkToIdToken(n.auth,await n.getIdToken()),t);return ys._forOperation(n,"link",r)}async function v0(n,e,t){await nd(e);const r=e4(e.providerData),s=n===!1?"provider-already-linked":"no-such-provider";pe(r.has(t)===n,e.auth,s)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function gz(n,e,t=!1){const{auth:r}=n;if(ln(r.app))return Promise.reject(Ln(r));const s="reauthenticate";try{const i=await pa(n,ZD(r,s,e,n),t);pe(i.idToken,r,"internal-error");const o=f0(i.idToken);pe(o,r,"internal-error");const{sub:a}=o;return pe(n.uid===a,r,"user-mismatch"),ys._forOperation(n,s,i)}catch(i){throw(i==null?void 0:i.code)==="auth/user-not-found"&&Ar(r,"user-mismatch"),i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function n4(n,e,t=!1){if(ln(n.app))return Promise.reject(Ln(n));const r="signIn",s=await ZD(n,r,e),i=await ys._fromIdTokenResponse(n,r,s);return t||await n._updateCurrentUser(i.user),i}async function r1(n,e){return n4(un(n),e)}async function mz(n,e){const t=yt(n);return await v0(!1,t,e.providerId),t4(t,e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function vz(n,e){return di(n,"POST","/v1/accounts:signInWithCustomToken",tn(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function aee(n,e){if(ln(n.app))return Promise.reject(Ln(n));const t=un(n),r=await vz(t,{token:e,returnSecureToken:!0}),s=await ys._fromIdTokenResponse(t,"signIn",r);return await t._updateCurrentUser(s.user),s}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function y0(n,e,t){var r;pe(((r=t.url)==null?void 0:r.length)>0,n,"invalid-continue-uri"),pe(typeof t.dynamicLinkDomain>"u"||t.dynamicLinkDomain.length>0,n,"invalid-dynamic-link-domain"),pe(typeof t.linkDomain>"u"||t.linkDomain.length>0,n,"invalid-hosting-link-domain"),e.continueUrl=t.url,e.dynamicLinkDomain=t.dynamicLinkDomain,e.linkDomain=t.linkDomain,e.canHandleCodeInApp=t.handleCodeInApp,t.iOS&&(pe(t.iOS.bundleId.length>0,n,"missing-ios-bundle-id"),e.iOSBundleId=t.iOS.bundleId),t.android&&(pe(t.android.packageName.length>0,n,"missing-android-pkg-name"),e.androidInstallApp=t.android.installApp,e.androidMinimumVersionCode=t.android.minimumVersion,e.androidPackageName=t.android.packageName)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function s1(n){const e=un(n);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function lee(n,e,t){const r=un(n),s={requestType:"PASSWORD_RESET",email:e,clientType:"CLIENT_TYPE_WEB"};t&&y0(r,s,t),await io(r,s,"getOobCode",rz,"EMAIL_PASSWORD_PROVIDER")}async function cee(n,e,t){await J9(yt(n),{oobCode:e,newPassword:t}).catch(async r=>{throw r.code==="auth/password-does-not-meet-requirements"&&s1(n),r})}async function uee(n,e){await ez(yt(n),{oobCode:e})}async function dee(n,e,t){if(ln(n.app))return Promise.reject(Ln(n));const r=un(n),o=await io(r,{returnSecureToken:!0,email:e,password:t,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",QD,"EMAIL_PASSWORD_PROVIDER").catch(l=>{throw l.code==="auth/password-does-not-meet-requirements"&&s1(n),l}),a=await ys._fromIdTokenResponse(r,"signIn",o);return await r._updateCurrentUser(a.user),a}function hee(n,e,t){return ln(n.app)?Promise.reject(Ln(n)):r1(yt(n),Ea.credential(e,t)).catch(async r=>{throw r.code==="auth/password-does-not-meet-requirements"&&s1(n),r})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function fee(n,e,t){const r=un(n),s={requestType:"EMAIL_SIGNIN",email:e,clientType:"CLIENT_TYPE_WEB"};function i(o,a){pe(a.handleCodeInApp,r,"argument-error"),a&&y0(r,o,a)}i(s,t),await io(r,s,"getOobCode",sz,"EMAIL_PASSWORD_PROVIDER")}function pee(n,e){const t=m0.parseLink(e);return(t==null?void 0:t.operation)==="EMAIL_SIGNIN"}async function gee(n,e,t){if(ln(n.app))return Promise.reject(Ln(n));const r=yt(n),s=Ea.credentialWithLink(e,t||td());return pe(s._tenantId===(r.tenantId||null),r,"tenant-id-mismatch"),r1(r,s)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function yz(n,e){return nn(n,"POST","/v1/accounts:createAuthUri",tn(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function mee(n,e){const t=Zw()?td():"http://localhost",r={identifier:e,continueUri:t},{signinMethods:s}=await yz(yt(n),r);return s||[]}async function vee(n,e){const t=yt(n),s={requestType:"VERIFY_EMAIL",idToken:await n.getIdToken()};e&&y0(t.auth,s,e);const{email:i}=await nz(t.auth,s);i!==n.email&&await n.reload()}async function yee(n,e,t){const r=yt(n),i={requestType:"VERIFY_AND_CHANGE_EMAIL",idToken:await n.getIdToken(),newEmail:e};t&&y0(r.auth,i,t);const{email:o}=await iz(r.auth,i);o!==n.email&&await n.reload()}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function xz(n,e){return nn(n,"POST","/v1/accounts:update",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function xee(n,{displayName:e,photoURL:t}){if(e===void 0&&t===void 0)return;const r=yt(n),i={idToken:await r.getIdToken(),displayName:e,photoUrl:t,returnSecureToken:!0},o=await pa(r,xz(r.auth,i));r.displayName=o.displayName||null,r.photoURL=o.photoUrl||null;const a=r.providerData.find(({providerId:l})=>l==="password");a&&(a.displayName=r.displayName,a.photoURL=r.photoURL),await r._updateTokensIfNecessary(o)}function wee(n,e){const t=yt(n);return ln(t.auth.app)?Promise.reject(Ln(t.auth)):r4(t,e,null)}function bee(n,e){return r4(yt(n),null,e)}async function r4(n,e,t){const{auth:r}=n,i={idToken:await n.getIdToken(),returnSecureToken:!0};e&&(i.email=e),t&&(i.password=t);const o=await pa(n,Q9(r,i));await n._updateTokensIfNecessary(o,!0)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wz(n){var s,i;if(!n)return null;const{providerId:e}=n,t=n.rawUserInfo?JSON.parse(n.rawUserInfo):{},r=n.isNewUser||n.kind==="identitytoolkit#SignupNewUserResponse";if(!e&&(n!=null&&n.idToken)){const o=(i=(s=f0(n.idToken))==null?void 0:s.firebase)==null?void 0:i.sign_in_provider;if(o){const a=o!=="anonymous"&&o!=="custom"?o:null;return new _l(r,a)}}if(!e)return null;switch(e){case"facebook.com":return new bz(r,t);case"github.com":return new _z(r,t);case"google.com":return new Sz(r,t);case"twitter.com":return new Cz(r,t,n.screenName||null);case"custom":case"anonymous":return new _l(r,null);default:return new _l(r,e,t)}}class _l{constructor(e,t,r={}){this.isNewUser=e,this.providerId=t,this.profile=r}}class s4 extends _l{constructor(e,t,r,s){super(e,t,r),this.username=s}}class bz extends _l{constructor(e,t){super(e,"facebook.com",t)}}class _z extends s4{constructor(e,t){super(e,"github.com",t,typeof(t==null?void 0:t.login)=="string"?t==null?void 0:t.login:null)}}class Sz extends _l{constructor(e,t){super(e,"google.com",t)}}class Cz extends s4{constructor(e,t,r){super(e,"twitter.com",t,r)}}function _ee(n){const{user:e,_tokenResponse:t}=n;return e.isAnonymous&&!t?{providerId:null,isNewUser:!1,profile:null}:wz(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function See(n,e){return yt(n).setPersistence(e)}function Ez(n,e,t,r){return yt(n).onIdTokenChanged(e,t,r)}function kz(n,e,t){return yt(n).beforeAuthStateChanged(e,t)}function Pz(n){return yt(n).signOut()}function Cee(n,e){return un(n).revokeAccessToken(e)}async function Eee(n){return yt(n).delete()}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hC(n,e){return nn(n,"POST","/v2/accounts/mfaEnrollment:start",tn(n,e))}const lp="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class i4{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(lp,"1"),this.storage.removeItem(lp),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Tz=1e3,Az=10;class o4 extends i4{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=qD(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const r=this.storage.getItem(t),s=this.localCache[t];r!==s&&e(t,s,r)}}onStorageEvent(e,t=!1){if(!e.key){this.forAllChangedKeys((o,a,l)=>{this.notifyListeners(o,l)});return}const r=e.key;t?this.detachListener():this.stopPolling();const s=()=>{const o=this.storage.getItem(r);!t&&this.localCache[r]===o||this.notifyListeners(r,o)},i=this.storage.getItem(r);P9()&&i!==e.newValue&&e.newValue!==e.oldValue?setTimeout(s,Az):s()}notifyListeners(e,t){this.localCache[e]=t;const r=this.listeners[e];if(r)for(const s of Array.from(r))s(t&&JSON.parse(t))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,t,r)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:r}),!0)})},Tz)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}o4.type="LOCAL";const Dz=o4;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class a4 extends i4{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,t){}_removeListener(e,t){}}a4.type="SESSION";const l4=a4;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Oz(n){return Promise.all(n.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class x0{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find(s=>s.isListeningto(e));if(t)return t;const r=new x0(e);return this.receivers.push(r),r}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:r,eventType:s,data:i}=t.data,o=this.handlersMap[s];if(!(o!=null&&o.size))return;t.ports[0].postMessage({status:"ack",eventId:r,eventType:s});const a=Array.from(o).map(async c=>c(t.origin,i)),l=await Oz(a);t.ports[0].postMessage({status:"done",eventId:r,eventType:s,response:l})}_subscribe(e,t){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),(!t||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}x0.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function w0(n="",e=10){let t="";for(let r=0;r<e;r++)t+=Math.floor(Math.random()*10);return n+t}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Iz{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,r=50){const s=typeof MessageChannel<"u"?new MessageChannel:null;if(!s)throw new Error("connection_unavailable");let i,o;return new Promise((a,l)=>{const c=w0("",20);s.port1.start();const u=setTimeout(()=>{l(new Error("unsupported_event"))},r);o={messageChannel:s,onMessage(h){const d=h;if(d.data.eventId===c)switch(d.data.status){case"ack":clearTimeout(u),i=setTimeout(()=>{l(new Error("timeout"))},3e3);break;case"done":clearTimeout(i),a(d.data.response);break;default:clearTimeout(u),clearTimeout(i),l(new Error("invalid_response"));break}}},this.handlers.add(o),s.port1.addEventListener("message",o.onMessage),this.target.postMessage({eventType:e,eventId:c,data:t},[s.port2])}).finally(()=>{o&&this.removeMessageHandler(o)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $t(){return window}function Rz(n){$t().location.href=n}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function i1(){return typeof $t().WorkerGlobalScope<"u"&&typeof $t().importScripts=="function"}async function Nz(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function jz(){var n;return((n=navigator==null?void 0:navigator.serviceWorker)==null?void 0:n.controller)||null}function Lz(){return i1()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const c4="firebaseLocalStorageDb",Mz=1,cp="firebaseLocalStorage",u4="fbase_key";class Ad{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}}function b0(n,e){return n.transaction([cp],e?"readwrite":"readonly").objectStore(cp)}function Fz(){const n=indexedDB.deleteDatabase(c4);return new Ad(n).toPromise()}function By(){const n=indexedDB.open(c4,Mz);return new Promise((e,t)=>{n.addEventListener("error",()=>{t(n.error)}),n.addEventListener("upgradeneeded",()=>{const r=n.result;try{r.createObjectStore(cp,{keyPath:u4})}catch(s){t(s)}}),n.addEventListener("success",async()=>{const r=n.result;r.objectStoreNames.contains(cp)?e(r):(r.close(),await Fz(),e(await By()))})})}async function fC(n,e,t){const r=b0(n,!0).put({[u4]:e,value:t});return new Ad(r).toPromise()}async function Bz(n,e){const t=b0(n,!1).get(e),r=await new Ad(t).toPromise();return r===void 0?null:r.value}function pC(n,e){const t=b0(n,!0).delete(e);return new Ad(t).toPromise()}const Uz=800,$z=3;class d4{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await By(),this.db)}async _withRetries(e){let t=0;for(;;)try{const r=await this._openDb();return await e(r)}catch(r){if(t++>$z)throw r;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return i1()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=x0._getInstance(Lz()),this.receiver._subscribe("keyChanged",async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)})),this.receiver._subscribe("ping",async(e,t)=>["keyChanged"])}async initializeSender(){var t,r;if(this.activeServiceWorker=await Nz(),!this.activeServiceWorker)return;this.sender=new Iz(this.activeServiceWorker);const e=await this.sender._send("ping",{},800);e&&(t=e[0])!=null&&t.fulfilled&&(r=e[0])!=null&&r.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||jz()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await By();return await fC(e,lp,"1"),await pC(e,lp),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite(async()=>(await this._withRetries(r=>fC(r,e,t)),this.localCache[e]=t,this.notifyServiceWorker(e)))}async _get(e){const t=await this._withRetries(r=>Bz(r,e));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(t=>pC(t,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(s=>{const i=b0(s,!1).getAll();return new Ad(i).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const t=[],r=new Set;if(e.length!==0)for(const{fbase_key:s,value:i}of e)r.add(s),JSON.stringify(this.localCache[s])!==JSON.stringify(i)&&(this.notifyListeners(s,i),t.push(s));for(const s of Object.keys(this.localCache))this.localCache[s]&&!r.has(s)&&(this.notifyListeners(s,null),t.push(s));return t}notifyListeners(e,t){this.localCache[e]=t;const r=this.listeners[e];if(r)for(const s of Array.from(r))s(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),Uz)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}d4.type="LOCAL";const zz=d4;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gC(n,e){return nn(n,"POST","/v2/accounts/mfaSignIn:start",tn(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Wg=XD("rcb"),Wz=new Pd(3e4,6e4);class Hz{constructor(){var e;this.hostLanguage="",this.counter=0,this.librarySeparatelyLoaded=!!((e=$t().grecaptcha)!=null&&e.render)}load(e,t=""){return pe(Vz(t),e,"argument-error"),this.shouldResolveImmediately(t)&&nC($t().grecaptcha)?Promise.resolve($t().grecaptcha):new Promise((r,s)=>{const i=$t().setTimeout(()=>{s(Jn(e,"network-request-failed"))},Wz.get());$t()[Wg]=()=>{$t().clearTimeout(i),delete $t()[Wg];const a=$t().grecaptcha;if(!a||!nC(a)){s(Jn(e,"internal-error"));return}const l=a.render;a.render=(c,u)=>{const h=l(c,u);return this.counter++,h},this.hostLanguage=t,r(a)};const o=`${N9()}?${hc({onload:Wg,render:"explicit",hl:t})}`;n1(o).catch(()=>{clearTimeout(i),s(Jn(e,"internal-error"))})})}clearedOneInstance(){this.counter--}shouldResolveImmediately(e){var t;return!!((t=$t().grecaptcha)!=null&&t.render)&&(e===this.hostLanguage||this.counter>0||this.librarySeparatelyLoaded)}}function Vz(n){return n.length<=6&&/^\s*[a-zA-Z0-9\-]*\s*$/.test(n)}class Gz{async load(e){return new B9(e)}clearedOneInstance(){}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bu="recaptcha",qz={theme:"light",type:"image"};class kee{constructor(e,t,r={...qz}){this.parameters=r,this.type=bu,this.destroyed=!1,this.widgetId=null,this.tokenChangeListeners=new Set,this.renderPromise=null,this.recaptcha=null,this.auth=un(e),this.isInvisible=this.parameters.size==="invisible",pe(typeof document<"u",this.auth,"operation-not-supported-in-this-environment");const s=typeof t=="string"?document.getElementById(t):t;pe(s,this.auth,"argument-error"),this.container=s,this.parameters.callback=this.makeTokenCallback(this.parameters.callback),this._recaptchaLoader=this.auth.settings.appVerificationDisabledForTesting?new Gz:new Hz,this.validateStartingState()}async verify(){this.assertNotDestroyed();const e=await this.render(),t=this.getAssertedRecaptcha(),r=t.getResponse(e);return r||new Promise(s=>{const i=o=>{o&&(this.tokenChangeListeners.delete(i),s(o))};this.tokenChangeListeners.add(i),this.isInvisible&&t.execute(e)})}render(){try{this.assertNotDestroyed()}catch(e){return Promise.reject(e)}return this.renderPromise?this.renderPromise:(this.renderPromise=this.makeRenderPromise().catch(e=>{throw this.renderPromise=null,e}),this.renderPromise)}_reset(){this.assertNotDestroyed(),this.widgetId!==null&&this.getAssertedRecaptcha().reset(this.widgetId)}clear(){this.assertNotDestroyed(),this.destroyed=!0,this._recaptchaLoader.clearedOneInstance(),this.isInvisible||this.container.childNodes.forEach(e=>{this.container.removeChild(e)})}validateStartingState(){pe(!this.parameters.sitekey,this.auth,"argument-error"),pe(this.isInvisible||!this.container.hasChildNodes(),this.auth,"argument-error"),pe(typeof document<"u",this.auth,"operation-not-supported-in-this-environment")}makeTokenCallback(e){return t=>{if(this.tokenChangeListeners.forEach(r=>r(t)),typeof e=="function")e(t);else if(typeof e=="string"){const r=$t()[e];typeof r=="function"&&r(t)}}}assertNotDestroyed(){pe(!this.destroyed,this.auth,"internal-error")}async makeRenderPromise(){if(await this.init(),!this.widgetId){let e=this.container;if(!this.isInvisible){const t=document.createElement("div");e.appendChild(t),e=t}this.widgetId=this.getAssertedRecaptcha().render(e,this.parameters)}return this.widgetId}async init(){pe(Zw()&&!i1(),this.auth,"internal-error"),await Yz(),this.recaptcha=await this._recaptchaLoader.load(this.auth,this.auth.languageCode||void 0);const e=await m9(this.auth);pe(e,this.auth,"internal-error"),this.parameters.sitekey=e}getAssertedRecaptcha(){return pe(this.recaptcha,this.auth,"internal-error"),this.recaptcha}}function Yz(){let n=null;return new Promise(e=>{if(document.readyState==="complete"){e();return}n=()=>e(),window.addEventListener("load",n)}).catch(e=>{throw n&&window.removeEventListener("load",n),e})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class h4{constructor(e,t){this.verificationId=e,this.onConfirmation=t}confirm(e){const t=wu._fromVerification(this.verificationId,e);return this.onConfirmation(t)}}async function Pee(n,e,t){if(ln(n.app))return Promise.reject(Ln(n));const r=un(n),s=await f4(r,e,yt(t));return new h4(s,i=>r1(r,i))}async function Tee(n,e,t){const r=yt(n);await v0(!1,r,"phone");const s=await f4(r.auth,e,yt(t));return new h4(s,i=>mz(r,i))}async function f4(n,e,t){var r;if(!n._getRecaptchaConfig())try{await V9(n)}catch{console.log("Failed to initialize reCAPTCHA Enterprise config. Triggering the reCAPTCHA v2 verification.")}try{let s;if(typeof e=="string"?s={phoneNumber:e}:s=e,"session"in s){const i=s.session;if("phoneNumber"in s){pe(i.type==="enroll",n,"internal-error");const o={idToken:i.credential,phoneEnrollmentInfo:{phoneNumber:s.phoneNumber,clientType:"CLIENT_TYPE_WEB"}};return(await io(n,o,"mfaSmsEnrollment",async(u,h)=>{if(h.phoneEnrollmentInfo.captchaResponse===xu){pe((t==null?void 0:t.type)===bu,u,"argument-error");const d=await Hg(u,h,t);return hC(u,d)}return hC(u,h)},"PHONE_PROVIDER").catch(u=>Promise.reject(u))).phoneSessionInfo.sessionInfo}else{pe(i.type==="signin",n,"internal-error");const o=((r=s.multiFactorHint)==null?void 0:r.uid)||s.multiFactorUid;pe(o,n,"missing-multi-factor-info");const a={mfaPendingCredential:i.credential,mfaEnrollmentId:o,phoneSignInInfo:{clientType:"CLIENT_TYPE_WEB"}};return(await io(n,a,"mfaSmsSignIn",async(h,d)=>{if(d.phoneSignInInfo.captchaResponse===xu){pe((t==null?void 0:t.type)===bu,h,"argument-error");const p=await Hg(h,d,t);return gC(h,p)}return gC(h,d)},"PHONE_PROVIDER").catch(h=>Promise.reject(h))).phoneResponseInfo.sessionInfo}}else{const i={phoneNumber:s.phoneNumber,clientType:"CLIENT_TYPE_WEB"};return(await io(n,i,"sendVerificationCode",async(c,u)=>{if(u.captchaResponse===xu){pe((t==null?void 0:t.type)===bu,c,"argument-error");const h=await Hg(c,u,t);return uC(c,h)}return uC(c,u)},"PHONE_PROVIDER").catch(c=>Promise.reject(c))).sessionInfo}}finally{t==null||t._reset()}}async function Hg(n,e,t){pe(t.type===bu,n,"argument-error");const r=await t.verify();pe(typeof r=="string",n,"argument-error");const s={...e};if("phoneEnrollmentInfo"in s){const i=s.phoneEnrollmentInfo.phoneNumber,o=s.phoneEnrollmentInfo.captchaResponse,a=s.phoneEnrollmentInfo.clientType,l=s.phoneEnrollmentInfo.recaptchaVersion;return Object.assign(s,{phoneEnrollmentInfo:{phoneNumber:i,recaptchaToken:r,captchaResponse:o,clientType:a,recaptchaVersion:l}}),s}else if("phoneSignInInfo"in s){const i=s.phoneSignInInfo.captchaResponse,o=s.phoneSignInInfo.clientType,a=s.phoneSignInInfo.recaptchaVersion;return Object.assign(s,{phoneSignInInfo:{recaptchaToken:r,captchaResponse:i,clientType:o,recaptchaVersion:a}}),s}else return Object.assign(s,{recaptchaToken:r}),s}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Dd(n,e){return e?Bs(e):(pe(n._popupRedirectResolver,n,"argument-error"),n._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class o1 extends p0{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return bl(e,this._buildIdpRequest())}_linkToIdToken(e,t){return bl(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return bl(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function Xz(n){return n4(n.auth,new o1(n),n.bypassAuthState)}function Kz(n){const{auth:e,user:t}=n;return pe(t,e,"internal-error"),gz(t,new o1(n),n.bypassAuthState)}async function Jz(n){const{auth:e,user:t}=n;return pe(t,e,"internal-error"),t4(t,new o1(n),n.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class p4{constructor(e,t,r,s,i=!1){this.auth=e,this.resolver=r,this.user=s,this.bypassAuthState=i,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(r){this.reject(r)}})}async onAuthEvent(e){const{urlResponse:t,sessionId:r,postBody:s,tenantId:i,error:o,type:a}=e;if(o){this.reject(o);return}const l={auth:this.auth,requestUri:t,sessionId:r,tenantId:i||void 0,postBody:s||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(a)(l))}catch(c){this.reject(c)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return Xz;case"linkViaPopup":case"linkViaRedirect":return Jz;case"reauthViaPopup":case"reauthViaRedirect":return Kz;default:Ar(this.auth,"internal-error")}}resolve(e){ii(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){ii(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Qz=new Pd(2e3,1e4);async function Aee(n,e,t){if(ln(n.app))return Promise.reject(Jn(n,"operation-not-supported-in-this-environment"));const r=un(n);h0(n,e,fc);const s=Dd(r,t);return new qi(r,"signInViaPopup",e,s).executeNotNull()}async function Dee(n,e,t){const r=yt(n);h0(r.auth,e,fc);const s=Dd(r.auth,t);return new qi(r.auth,"linkViaPopup",e,s,r).executeNotNull()}class qi extends p4{constructor(e,t,r,s,i){super(e,t,s,i),this.provider=r,this.authWindow=null,this.pollId=null,qi.currentPopupAction&&qi.currentPopupAction.cancel(),qi.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return pe(e,this.auth,"internal-error"),e}async onExecution(){ii(this.filter.length===1,"Popup operations only handle one event");const e=w0();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(t=>{this.reject(t)}),this.resolver._isIframeWebStorageSupported(this.auth,t=>{t||this.reject(Jn(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)==null?void 0:e.associatedEvent)||null}cancel(){this.reject(Jn(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,qi.currentPopupAction=null}pollUserCancellation(){const e=()=>{var t,r;if((r=(t=this.authWindow)==null?void 0:t.window)!=null&&r.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(Jn(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,Qz.get())};e()}}qi.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Zz="pendingRedirect",pf=new Map;class eW extends p4{constructor(e,t,r=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,r),this.eventId=null}async execute(){let e=pf.get(this.auth._key());if(!e){try{const r=await tW(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(r)}catch(t){e=()=>Promise.reject(t)}pf.set(this.auth._key(),e)}return this.bypassAuthState||pf.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function tW(n,e){const t=v4(e),r=m4(n);if(!await r._isAvailable())return!1;const s=await r._get(t)==="true";return await r._remove(t),s}async function g4(n,e){return m4(n)._set(v4(e),"true")}function nW(n,e){pf.set(n._key(),e)}function m4(n){return Bs(n._redirectPersistence)}function v4(n){return hf(Zz,n.config.apiKey,n.name)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Oee(n,e,t){return rW(n,e,t)}async function rW(n,e,t){if(ln(n.app))return Promise.reject(Ln(n));const r=un(n);h0(n,e,fc),await r._initializationPromise;const s=Dd(r,t);return await g4(s,r),s._openRedirect(r,e,"signInViaRedirect")}function Iee(n,e,t){return sW(n,e,t)}async function sW(n,e,t){const r=yt(n);h0(r.auth,e,fc),await r.auth._initializationPromise;const s=Dd(r.auth,t);await v0(!1,r,e.providerId),await g4(s,r.auth);const i=await iW(r);return s._openRedirect(r.auth,e,"linkViaRedirect",i)}async function Ree(n,e){return await un(n)._initializationPromise,y4(n,e,!1)}async function y4(n,e,t=!1){if(ln(n.app))return Promise.reject(Ln(n));const r=un(n),s=Dd(r,e),o=await new eW(r,s,t).execute();return o&&!t&&(delete o.user._redirectEventId,await r._persistUserIfCurrent(o.user),await r._setRedirectUser(null,e)),o}async function iW(n){const e=w0(`${n.uid}:::`);return n._redirectEventId=e,await n.auth._setRedirectUser(n),await n.auth._persistUserIfCurrent(n),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const oW=10*60*1e3;class aW{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(e,r)&&(t=!0,this.sendToConsumer(e,r),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!lW(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){var r;if(e.error&&!x4(e)){const s=((r=e.error.code)==null?void 0:r.split("auth/")[1])||"internal-error";t.onError(Jn(this.auth,s))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const r=t.eventId===null||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&r}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=oW&&this.cachedEventUids.clear(),this.cachedEventUids.has(mC(e))}saveEventToCache(e){this.cachedEventUids.add(mC(e)),this.lastProcessedEventTime=Date.now()}}function mC(n){return[n.type,n.eventId,n.sessionId,n.tenantId].filter(e=>e).join("-")}function x4({type:n,error:e}){return n==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function lW(n){switch(n.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return x4(n);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function cW(n,e={}){return nn(n,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uW=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,dW=/^https?/;async function hW(n){if(n.config.emulator)return;const{authorizedDomains:e}=await cW(n);for(const t of e)try{if(fW(t))return}catch{}Ar(n,"unauthorized-domain")}function fW(n){const e=td(),{protocol:t,hostname:r}=new URL(e);if(n.startsWith("chrome-extension://")){const o=new URL(n);return o.hostname===""&&r===""?t==="chrome-extension:"&&n.replace("chrome-extension://","")===e.replace("chrome-extension://",""):t==="chrome-extension:"&&o.hostname===r}if(!dW.test(t))return!1;if(uW.test(n))return r===n;const s=n.replace(/\./g,"\\.");return new RegExp("^(.+\\."+s+"|"+s+")$","i").test(r)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pW=new Pd(3e4,6e4);function vC(){const n=$t().___jsl;if(n!=null&&n.H){for(const e of Object.keys(n.H))if(n.H[e].r=n.H[e].r||[],n.H[e].L=n.H[e].L||[],n.H[e].r=[...n.H[e].L],n.CP)for(let t=0;t<n.CP.length;t++)n.CP[t]=null}}function gW(n){return new Promise((e,t)=>{var s,i,o;function r(){vC(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{vC(),t(Jn(n,"network-request-failed"))},timeout:pW.get()})}if((i=(s=$t().gapi)==null?void 0:s.iframes)!=null&&i.Iframe)e(gapi.iframes.getContext());else if((o=$t().gapi)!=null&&o.load)r();else{const a=XD("iframefcb");return $t()[a]=()=>{gapi.load?r():t(Jn(n,"network-request-failed"))},n1(`${L9()}?onload=${a}`).catch(l=>t(l))}}).catch(e=>{throw gf=null,e})}let gf=null;function mW(n){return gf=gf||gW(n),gf}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vW=new Pd(5e3,15e3),yW="__/auth/iframe",xW="emulator/auth/iframe",wW={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},bW=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function _W(n){const e=n.config;pe(e.authDomain,n,"auth-domain-config-required");const t=e.emulator?e1(e,xW):`https://${n.config.authDomain}/${yW}`,r={apiKey:e.apiKey,appName:n.name,v:kd},s=bW.get(n.config.apiHost);s&&(r.eid=s);const i=n._getFrameworks();return i.length&&(r.fw=i.join(",")),`${t}?${hc(r).slice(1)}`}async function SW(n){const e=await mW(n),t=$t().gapi;return pe(t,n,"internal-error"),e.open({where:document.body,url:_W(n),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:wW,dontclear:!0},r=>new Promise(async(s,i)=>{await r.restyle({setHideOnLeave:!1});const o=Jn(n,"network-request-failed"),a=$t().setTimeout(()=>{i(o)},vW.get());function l(){$t().clearTimeout(a),s(r)}r.ping(l).then(l,()=>{i(o)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const CW={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},EW=500,kW=600,PW="_blank",TW="http://localhost";class yC{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function AW(n,e,t,r=EW,s=kW){const i=Math.max((window.screen.availHeight-s)/2,0).toString(),o=Math.max((window.screen.availWidth-r)/2,0).toString();let a="";const l={...CW,width:r.toString(),height:s.toString(),top:i,left:o},c=Mn().toLowerCase();t&&(a=zD(c)?PW:t),UD(c)&&(e=e||TW,l.scrollbars="yes");const u=Object.entries(l).reduce((d,[p,m])=>`${d}${p}=${m},`,"");if(k9(c)&&a!=="_self")return DW(e||"",a),new yC(null);const h=window.open(e||"",a,u);pe(h,n,"popup-blocked");try{h.focus()}catch{}return new yC(h)}function DW(n,e){const t=document.createElement("a");t.href=n,t.target=e;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(r)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const OW="__/auth/handler",IW="emulator/auth/handler",RW=encodeURIComponent("fac");async function xC(n,e,t,r,s,i){pe(n.config.authDomain,n,"auth-domain-config-required"),pe(n.config.apiKey,n,"invalid-api-key");const o={apiKey:n.config.apiKey,appName:n.name,authType:t,redirectUrl:r,v:kd,eventId:s};if(e instanceof fc){e.setDefaultLanguage(n.languageCode),o.providerId=e.providerId||"",GU(e.getCustomParameters())||(o.customParameters=JSON.stringify(e.getCustomParameters()));for(const[u,h]of Object.entries({}))o[u]=h}if(e instanceof pc){const u=e.getScopes().filter(h=>h!=="");u.length>0&&(o.scopes=u.join(","))}n.tenantId&&(o.tid=n.tenantId);const a=o;for(const u of Object.keys(a))a[u]===void 0&&delete a[u];const l=await n._getAppCheckToken(),c=l?`#${RW}=${encodeURIComponent(l)}`:"";return`${NW(n)}?${hc(a).slice(1)}${c}`}function NW({config:n}){return n.emulator?e1(n,IW):`https://${n.authDomain}/${OW}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Vg="webStorageSupport";class jW{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=l4,this._completeRedirectFn=y4,this._overrideRedirectResult=nW}async _openPopup(e,t,r,s){var o;ii((o=this.eventManagers[e._key()])==null?void 0:o.manager,"_initialize() not called before _openPopup()");const i=await xC(e,t,r,td(),s);return AW(e,i,w0())}async _openRedirect(e,t,r,s){await this._originValidation(e);const i=await xC(e,t,r,td(),s);return Rz(i),new Promise(()=>{})}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:s,promise:i}=this.eventManagers[t];return s?Promise.resolve(s):(ii(i,"If manager is not set, promise should be"),i)}const r=this.initAndGetManager(e);return this.eventManagers[t]={promise:r},r.catch(()=>{delete this.eventManagers[t]}),r}async initAndGetManager(e){const t=await SW(e),r=new aW(e);return t.register("authEvent",s=>(pe(s==null?void 0:s.authEvent,e,"invalid-auth-event"),{status:r.onEvent(s.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:r},this.iframes[e._key()]=t,r}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(Vg,{type:Vg},s=>{var o;const i=(o=s==null?void 0:s[0])==null?void 0:o[Vg];i!==void 0&&t(!!i),Ar(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=hW(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return qD()||$D()||t1()}}const LW=jW;var wC="@firebase/auth",bC="1.11.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class MW{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)==null?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged(r=>{e((r==null?void 0:r.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){pe(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function FW(n){switch(n){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function BW(n){Zu(new Zl("auth",(e,{options:t})=>{const r=e.getProvider("app").getImmediate(),s=e.getProvider("heartbeat"),i=e.getProvider("app-check-internal"),{apiKey:o,authDomain:a}=r.options;pe(o&&!o.includes(":"),"invalid-api-key",{appName:r.name});const l={apiKey:o,authDomain:a,clientPlatform:n,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:YD(n)},c=new I9(r,s,i,l);return q9(c,t),c},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,r)=>{e.getProvider("auth-internal").initialize()})),Zu(new Zl("auth-internal",e=>{const t=un(e.getProvider("auth").getImmediate());return(r=>new MW(r))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),yl(wC,bC,FW(n)),yl(wC,bC,"esm2020")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const UW=5*60,$W=_D("authIdTokenMaxAge")||UW;let _C=null;const zW=n=>async e=>{const t=e&&await e.getIdTokenResult(),r=t&&(new Date().getTime()-Date.parse(t.issuedAtTime))/1e3;if(r&&r>$W)return;const s=t==null?void 0:t.token;_C!==s&&(_C=s,await fetch(n,{method:s?"POST":"DELETE",headers:s?{Authorization:`Bearer ${s}`}:{}}))};function WW(n=TD()){const e=kD(n,"auth");if(e.isInitialized())return e.getImmediate();const t=G9(n,{popupRedirectResolver:LW,persistence:[zz,Dz,l4]}),r=_D("authTokenSyncURL");if(r&&typeof isSecureContext=="boolean"&&isSecureContext){const i=new URL(r,location.origin);if(location.origin===i.origin){const o=zW(i.toString());kz(t,o,()=>o(t.currentUser)),Ez(t,a=>o(a))}}const s=DU("auth");return s&&Y9(t,`http://${s}`),t}function HW(){var n;return((n=document.getElementsByTagName("head"))==null?void 0:n[0])??document}R9({loadJS(n){return new Promise((e,t)=>{const r=document.createElement("script");r.setAttribute("src",n),r.onload=e,r.onerror=s=>{const i=Jn("internal-error");i.customData=s,t(i)},r.type="text/javascript",r.charset="UTF-8",HW().appendChild(r)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});BW("Browser");const VW=(n=32)=>{const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";let t="";for(let r=0;r<n;r++)t+=e.charAt(Math.floor(Math.random()*e.length));return t},GW=async n=>{const t=new TextEncoder().encode(n),r=await crypto.subtle.digest("SHA-256",t);return Array.from(new Uint8Array(r)).map(i=>i.toString(16).padStart(2,"0")).join("")},qW={apiKey:"AIzaSyD3s00zRVVv00R5cprrGCXLuHIQwpL_uuw",authDomain:"photoshare-a70ea.firebaseapp.com",projectId:"photoshare-a70ea",storageBucket:"photoshare-a70ea.firebasestorage.app",messagingSenderId:"1064591086523",appId:"1:1064591086523:web:8e96ca0af1939935f2aa9e",measurementId:"G-5RPTCKYBMF"};let Uy;Y$().length===0?Uy=PD(qW):Uy=TD();const YW=WW(Uy),w4=b.createContext(void 0),Or=()=>{const n=b.useContext(w4);if(n===void 0)throw new Error("useAuth must be used within an AuthProvider");return n},XW=({children:n})=>{const[e,t]=b.useState(null),[r,s]=b.useState(null),[i,o]=b.useState(!0),a=()=>{localStorage.removeItem("eventphoto_device_id"),localStorage.removeItem("eventphoto_current_event")};b.useEffect(()=>{let m=!0,g=!1;const y=()=>{if(!g){const v=window.notifyAndroidWebAppReady;typeof v=="function"&&(console.log(" [WEB] Auth initialized - notifying Android web app is ready"),v(),g=!0)}},{data:{subscription:x}}=ue.auth.onAuthStateChange((v,w)=>{var _,S,E;if(m){if(v!=="TOKEN_REFRESHED"&&console.log(" AUTH STATE CHANGE:",{event:v,hasSession:!!w,userId:(_=w==null?void 0:w.user)==null?void 0:_.id}),s(w),w!=null&&w.user){const C={id:w.user.id,email:w.user.email||"",name:((S=w.user.user_metadata)==null?void 0:S.name)||((E=w.user.email)==null?void 0:E.split("@")[0]),isOwner:!0};t(C),a()}else t(null);o(!1),y(),window._pendingDeepLink&&typeof window.handlePhotoShareDeepLink=="function"&&(console.log(" [WEB] Processing pending deep link:",window._pendingDeepLink),setTimeout(()=>{const C=window._pendingDeepLink;window._pendingDeepLink=null,window.handlePhotoShareDeepLink(C)},500))}});return ue.auth.getSession().then(({data:{session:v},error:w})=>{var _,S;if(m){if(w){console.error(" Auth session error:",w),o(!1),y();return}if(s(v),v!=null&&v.user){const E={id:v.user.id,email:v.user.email||"",name:((_=v.user.user_metadata)==null?void 0:_.name)||((S=v.user.email)==null?void 0:S.split("@")[0]),isOwner:!0};t(E)}else t(null);o(!1),y(),window._pendingDeepLink&&typeof window.handlePhotoShareDeepLink=="function"&&(console.log(" [WEB] Processing pending deep link:",window._pendingDeepLink),setTimeout(()=>{const E=window._pendingDeepLink;window._pendingDeepLink=null,window.handlePhotoShareDeepLink(E)},500))}}).catch(v=>{console.error(" Auth check error:",v),m&&(o(!1),y())}),()=>{m=!1,x.unsubscribe()}},[]);const p={user:e,isLoading:i,login:async(m,g)=>{try{const{error:y}=await ue.auth.signInWithPassword({email:m,password:g});return y?{error:y.message}:{}}catch(y){return console.error("Login failed:",y),{error:"Login failed. Please try again."}}},register:async(m,g,y)=>{try{const x="https://photo-share.app/",{error:v}=await ue.auth.signUp({email:m,password:g,options:{emailRedirectTo:x,data:{name:y||m.split("@")[0]}}});return v?{error:v.message}:{}}catch(x){return console.error("Registration failed:",x),{error:"Registration failed. Please try again."}}},loginWithGoogle:async()=>{var m,g,y,x,v,w,_,S;console.log(" GOOGLE LOGIN: Function called - starting authentication...");try{const E=de.isNativePlatform();if(console.log(" GOOGLE LOGIN: Platform detected:",{isNative:E}),E)try{console.log(" FIREBASE GOOGLE: Starting Firebase Google sign-in..."),console.log(" FIREBASE GOOGLE: Plugin availability check:",{hasFirebaseAuth:!!Ts,hasSignInMethod:!!(Ts!=null&&Ts.signInWithGoogle),pluginMethods:Ts?Object.keys(Ts):"undefined"});const C=await Ts.signInWithGoogle();if(console.log(" FIREBASE GOOGLE: Raw result type:",typeof C),console.log(" FIREBASE GOOGLE: Raw result keys:",C?Object.keys(C):"null/undefined"),console.log(" FIREBASE GOOGLE: Sign-in successful, result:",{uid:(m=C.user)==null?void 0:m.uid,email:(g=C.user)==null?void 0:g.email}),!((y=C.credential)!=null&&y.idToken))return console.error(" FIREBASE GOOGLE: No idToken received"),{error:"Authentication failed - no token received"};console.log(" FIREBASE GOOGLE: Authenticating with Supabase using idToken...");const{data:P,error:O}=await ue.auth.signInWithIdToken({provider:"google",token:C.credential.idToken});return O?(console.error(" FIREBASE GOOGLE: Supabase authentication failed:",O),{error:O.message}):(console.log(" FIREBASE GOOGLE: Supabase authentication successful:",{userId:(x=P.user)==null?void 0:x.id}),{})}catch(C){if(console.error(" FIREBASE GOOGLE: Firebase authentication failed:",C),console.error(" FIREBASE GOOGLE: Error type:",typeof C),console.error(" FIREBASE GOOGLE: Error message:",C==null?void 0:C.message),console.error(" FIREBASE GOOGLE: Error code:",C==null?void 0:C.code),console.error(" FIREBASE GOOGLE: Error name:",C==null?void 0:C.name),console.error(" FIREBASE GOOGLE: Error stack:",C==null?void 0:C.stack),console.error(" FIREBASE GOOGLE: Error toString:",C==null?void 0:C.toString()),console.error(" FIREBASE GOOGLE: Full error object:",C),console.error(" FIREBASE GOOGLE: Full error JSON:",JSON.stringify(C,null,2)),(v=C==null?void 0:C.message)!=null&&v.includes("28404")||(w=C==null?void 0:C.message)!=null&&w.includes("Failed to retrieve an ID token"))return console.error(" FIREBASE GOOGLE: Error 28404 detected - ID token retrieval failed"),console.error(" FIREBASE GOOGLE: This error typically indicates:"),console.error("  1. Missing SHA-1 or SHA-256 fingerprint in Firebase Console"),console.error("  2. Incorrect package name/bundle ID in Firebase project"),console.error("  3. google-services.json file missing or outdated"),console.error("  4. Google Sign-In API not enabled in Google Cloud Console"),console.error("  5. Debug vs Release certificate mismatch"),console.error(" FIREBASE GOOGLE: Required steps to fix:"),console.error("  - Add debug SHA-1 fingerprint to Firebase Console"),console.error("  - Download latest google-services.json"),console.error("  - Ensure Google Sign-In API is enabled in Google Cloud Console"),console.error('  - Run "npx cap sync" after updating google-services.json'),{error:"Google authentication setup error: Missing SHA fingerprint or invalid Firebase configuration. Please check Firebase Console settings."};if((_=C==null?void 0:C.message)!=null&&_.includes("no credentials available")||(S=C==null?void 0:C.message)!=null&&S.includes("No credentials"))return console.error(" FIREBASE GOOGLE: No credentials available error detected"),console.error(" FIREBASE GOOGLE: This error typically indicates:"),console.error("  1. Missing google-services.json file in Android project"),console.error("  2. Missing SHA-1 or SHA-256 fingerprint in Firebase Console"),console.error("  3. Google Sign-In API not enabled in Google Cloud Console"),console.error("  4. Incorrect package name in Firebase project settings"),console.error("  5. Firebase Authentication not properly initialized"),console.error(" FIREBASE GOOGLE: Required steps to fix:"),console.error("  - Add debug SHA-1 fingerprint: keytool -list -v -keystore ~/.android/debug.keystore -alias androiddebugkey -storepass android -keypass android"),console.error("  - Download latest google-services.json and place in android/app/"),console.error("  - Enable Google Sign-In API in Google Cloud Console"),console.error('  - Run "npx cap sync" after updating google-services.json'),{error:"Google authentication setup error: Missing credentials configuration. Please check Firebase Console and google-services.json file."};if(C!=null&&C.code)switch(console.error(" FIREBASE GOOGLE: Specific error code detected:",C.code),C.code){case"auth/user-cancelled":return{error:"Google sign-in was cancelled"};case"auth/operation-not-allowed":return{error:"Google Sign-In is not enabled in Firebase"};case"auth/invalid-credential":return{error:"Invalid Google credentials"};case"auth/network-request-failed":return{error:"Network error during Google sign-in"};case"auth/no-such-provider":return{error:"Google Sign-In provider not configured"};default:return{error:`Google login failed: ${C.code}`}}return{error:`Google login failed: ${(C==null?void 0:C.message)||"Unknown error"}`}}else{console.log(" WEB SUPABASE GOOGLE: Starting Supabase OAuth flow...");const{error:C}=await ue.auth.signInWithOAuth({provider:"google"});return C?(console.error(" WEB SUPABASE GOOGLE: OAuth failed:",C),{error:C.message}):(console.log(" WEB SUPABASE GOOGLE: OAuth initiated successfully"),{})}}catch(E){return console.error(" GOOGLE LOGIN: Unexpected error:",E),{error:"Google login failed. Please try again."}}},loginWithApple:async()=>{console.log(" APPLE LOGIN: Function called - starting authentication...");try{const m=de.isNativePlatform(),g=de.getPlatform()==="ios";if(console.log(" APPLE LOGIN: Platform detected:",{platform:de.getPlatform(),isNative:m,isIOS:g}),m&&g){console.log(" IOS APPLE: Using @capacitor-community/apple-sign-in plugin...");try{console.log(" IOS APPLE: Calling SignInWithApple.authorize...");const y=VW(),x=await GW(y),v=await mD.authorize({clientId:"app.lovable.6915f975bb6c42d0a28ad854c5271c90",redirectURI:"https://jgfcfdlfcnmaripgpepl.supabase.co/auth/v1/callback",scopes:"email name",state:"state",nonce:x});console.log(" IOS APPLE: Apple Sign-In successful:",v);const{data:w,error:_}=await ue.auth.signInWithIdToken({provider:"apple",token:v.response.identityToken,nonce:y});return _?(console.error(" IOS APPLE: Supabase exchange failed:",_),{error:_.message}):(console.log(" IOS APPLE: Successfully authenticated with Supabase"),{})}catch(y){return console.error(" IOS APPLE: Native authentication failed:",y),{error:`Apple login failed: ${(y==null?void 0:y.message)||"Unknown error"}`}}}else{if(m&&!g)return console.log(" ANDROID: Apple Sign In not supported on Android"),{error:"Apple Sign In is only available on iOS devices. Please use Google Sign In or email authentication."};console.log(" WEB APPLE: Starting web Apple OAuth...");try{const{error:y}=await ue.auth.signInWithOAuth({provider:"apple",options:{redirectTo:`${window.location.origin}/`}});return y?(console.error(" WEB APPLE: OAuth failed:",y),{error:y.message}):(console.log(" WEB APPLE: OAuth initiated successfully"),{})}catch(y){return console.error(" WEB APPLE: Web authentication failed:",y),{error:`Apple web login failed: ${(y==null?void 0:y.message)||"Unknown error"}`}}}}catch(m){return console.error(" APPLE LOGIN: Unexpected error:",m),{error:"Apple login failed. Please try again."}}},logout:async()=>{await ue.auth.signOut();try{(await Yw.getInfo()).platform!=="web"?await Ts.signOut():await Pz(YW)}catch(m){console.log("Firebase Auth logout not available or failed:",m)}t(null),s(null)},isAuthenticated:!!e};return f.jsx(w4.Provider,{value:p,children:n})},SC=Pn("Network",{web:()=>Ae(()=>import("./web-Csuuo4VE.js"),[]).then(n=>new n.NetworkWeb)}),a1=()=>{const[n,e]=b.useState(null);return b.useEffect(()=>{(async()=>{try{const a=await SC.getStatus();e(a)}catch{e({connected:navigator.onLine,connectionType:"unknown"})}})();let r=null;(async()=>{try{r=await SC.addListener("networkStatusChange",a=>{e(a)})}catch{console.log("Network listener not available")}})();const i=()=>{e({connected:!0,connectionType:"unknown"})},o=()=>{e({connected:!1,connectionType:"none"})};return window.addEventListener("online",i),window.addEventListener("offline",o),()=>{var a;(a=r==null?void 0:r.remove)==null||a.call(r),window.removeEventListener("online",i),window.removeEventListener("offline",o)}},[]),{isConnected:(n==null?void 0:n.connected)??!0,connectionType:((n==null?void 0:n.connectionType)??"unknown").toLowerCase(),status:n}},$y=Pn("App",{web:()=>Ae(()=>import("./web-Db9xk1OL.js"),[]).then(n=>new n.AppWeb)}),KW=()=>{const[n,e]=b.useState(null);return b.useEffect(()=>{(async()=>{try{const o=await $y.getState();e(o)}catch{e({isActive:!0})}})();let r=null;(async()=>{try{r=await $y.addListener("appStateChange",o=>{e(o)})}catch{console.log("App state listener not available")}})();const i=()=>{e({isActive:!document.hidden})};return document.addEventListener("visibilitychange",i),()=>{var o;(o=r==null?void 0:r.remove)==null||o.call(r),document.removeEventListener("visibilitychange",i)}},[]),{isActive:(n==null?void 0:n.isActive)??!0,state:n}},b4=b.createContext(void 0),JW=()=>{const n=b.useContext(b4);if(n===void 0)throw new Error("useAutoUpload must be used within an AutoUploadProvider");return n},QW=async()=>{var t,r,s,i;const n=[100,300,600],e=3;for(let o=0;o<e;o++){try{const a=[(r=(t=window.Capacitor)==null?void 0:t.Plugins)==null?void 0:r.AutoUpload,(i=(s=window.Capacitor)==null?void 0:s.Plugins)==null?void 0:i.PhotoLibraryMonitor,window.PhotoLibraryMonitor,window.PhotoShareAutoUpload,window.AutoUpload];for(const l of a)if(l!=null&&l.getAutoUploadSettings){const c=await l.getAutoUploadSettings();if(c)return console.log(" Auto-upload: Found native settings via plugin"),c}}catch{}o<e-1&&await new Promise(a=>setTimeout(a,n[o]))}return null},ZW=({children:n})=>{const{user:e}=Or(),{isConnected:t,connectionType:r}=a1(),{isActive:s}=KW(),[i,o]=b.useState(()=>{if(e)try{const _=localStorage.getItem(`auto_upload_settings_${e.id}`);if(_){const S=JSON.parse(_);return console.log(" Auto-upload: Initial state from localStorage:",S),S}}catch(_){console.error(" Auto-upload: Error reading initial localStorage:",_)}return console.log(" Auto-upload: Using default initial state (user not logged in or no stored settings)"),{autoUploadEnabled:!1,wifiOnlyUpload:!1,backgroundUploadEnabled:!1}}),[a,l]=b.useState(!1),[c,u]=b.useState(null),h=b.useCallback(async(_=!1)=>{if(console.log(" Auto-upload loadSettings called, user:",e==null?void 0:e.id),!e){console.log(" Auto-upload: No user, skipping load"),l(!1);return}try{const S=localStorage.getItem(`auto_upload_settings_${e.id}`);console.log(" Auto-upload: localStorage raw value:",S);let E={autoUploadEnabled:!1,wifiOnlyUpload:!1,backgroundUploadEnabled:!1};S?(E={...E,...JSON.parse(S)},o(E),console.log(" Auto-upload: Settings loaded from localStorage (instant):",E)):console.log(" Auto-upload: No stored settings found for user"),!_&&de.isNativePlatform()&&QW().then(C=>{if(C){const P={autoUploadEnabled:C.userAutoUploadEnabled??E.autoUploadEnabled,wifiOnlyUpload:C.wifiOnlyUpload??E.wifiOnlyUpload,backgroundUploadEnabled:C.backgroundUploadEnabled??E.backgroundUploadEnabled};localStorage.setItem(`auto_upload_settings_${e.id}`,JSON.stringify(P)),o(P),console.log(" Auto-upload: Synced with native settings in background")}}).catch(C=>{console.log(" Auto-upload: Native sync failed, using localStorage values")})}catch(S){console.error(" Auto-upload: Error loading settings:",S)}finally{l(!1)}},[e]);b.useEffect(()=>{var _;if(console.log(" Auto-upload: User effect triggered, user:",e==null?void 0:e.id),e){console.log(" Auto-upload: Initializing for user:",e.id);const S=localStorage.getItem(`auto_upload_settings_${e.id}`);if(S)try{const E=JSON.parse(S);console.log(" Auto-upload: Loaded from localStorage in useEffect:",E),o(E)}catch(E){console.error(" Auto-upload: Error parsing localStorage:",E)}de.isNativePlatform()?(console.log(" Auto-upload: Waiting for permission gate..."),(_=window.waitForPermissionGate)==null||_.call(window,5e3).then(E=>{E.blocked?(console.log(" Auto-upload: Permission gate blocked, skipping native sync"),l(!1)):(console.log(" Auto-upload: Permission gate cleared, loading settings"),h())}).catch(E=>{console.warn(" Auto-upload: Permission gate wait failed, proceeding:",E),h()})):h()}else console.log(" Auto-upload: User logged out, resetting settings"),o({autoUploadEnabled:!1,wifiOnlyUpload:!1,backgroundUploadEnabled:!1}),l(!1)},[e,h]),b.useEffect(()=>{s&&e&&(console.log(" Auto-upload: App became active, reloading settings..."),h())},[s,h,e]),b.useEffect(()=>{const _=S=>{console.log(" Auto-upload: Received native settings change event:",S.detail),h()};return window.addEventListener("native:autoUploadSettingsChanged",_),()=>{window.removeEventListener("native:autoUploadSettingsChanged",_)}},[h]);const d=b.useCallback(async _=>{var S,E,C,P;if(!e)return!1;try{const O={...i,..._};if(localStorage.setItem(`auto_upload_settings_${e.id}`,JSON.stringify(O)),o(O),console.log(" Auto-upload: Settings updated locally:",O),de.isNativePlatform()){const A=[(E=(S=window.Capacitor)==null?void 0:S.Plugins)==null?void 0:E.AutoUpload,(P=(C=window.Capacitor)==null?void 0:C.Plugins)==null?void 0:P.PhotoLibraryMonitor,window.PhotoLibraryMonitor];for(const R of A)if(R!=null&&R.updateAutoUploadSettings)try{await R.updateAutoUploadSettings({userAutoUploadEnabled:O.autoUploadEnabled,wifiOnlyUpload:O.wifiOnlyUpload,backgroundUploadEnabled:O.backgroundUploadEnabled}),console.log(" Auto-upload: Updated native settings");break}catch(B){console.log(" Auto-upload: Failed to update native settings:",B)}}return!0}catch(O){return console.error(" Auto-upload: Error updating settings:",O),!1}},[e,i]),p=async()=>{var _,S,E;if((E=(S=(_=window.Capacitor)==null?void 0:_.Plugins)==null?void 0:S.AppPermissions)!=null&&E.checkPhotoPermission)try{return(await window.Capacitor.Plugins.AppPermissions.checkPhotoPermission()).status}catch(C){console.warn(" Auto-upload: Could not check photo permission:",C)}return"prompt"},m=b.useCallback(async(_,S,E,C)=>{var P,O;if(de.isNativePlatform()&&await p()!=="granted"){console.log(" Auto-upload: Photo permission not granted, skipping context setup");return}if(u(_),de.isNativePlatform()&&i.autoUploadEnabled){const A=[(O=(P=window.Capacitor)==null?void 0:P.Plugins)==null?void 0:O.PhotoLibraryMonitor,window.PhotoLibraryMonitor];for(const R of A)if(R!=null&&R.enableAutoUpload)try{await R.enableAutoUpload({eventId:_}),console.log(" Auto-upload: Enabled for event:",_);break}catch(B){console.log(" Auto-upload: Failed to enable for event:",B)}}},[i.autoUploadEnabled]),g=b.useCallback(async()=>{var _,S;if(u(null),de.isNativePlatform()){const E=[(S=(_=window.Capacitor)==null?void 0:_.Plugins)==null?void 0:S.PhotoLibraryMonitor,window.PhotoLibraryMonitor];for(const C of E)if(C!=null&&C.disableAutoUpload)try{await C.disableAutoUpload(),console.log(" Auto-upload: Disabled");break}catch(P){console.log(" Auto-upload: Failed to disable:",P)}}},[]),y=b.useCallback(()=>{const _=r==="wifi"||r==="unknown"&&t,S={isConnected:t,connectionType:r,isWifi:_};return console.log(" WiFi Detection:",{connectionType:r,isConnected:t,isWifi:_,wifiOnlyUpload:i.wifiOnlyUpload,platform:de.getPlatform()}),i.autoUploadEnabled?t?i.wifiOnlyUpload&&!_?{canUpload:!1,reason:"wifi_required",networkInfo:S,settings:i}:{canUpload:!0,reason:"ready",networkInfo:S,settings:i}:{canUpload:!1,reason:"no_network",networkInfo:S,settings:i}:{canUpload:!1,reason:"auto_upload_disabled",networkInfo:S,settings:i}},[i,t,r]),x=b.useCallback(_=>d({autoUploadEnabled:_}),[d]),v=b.useCallback(_=>d({wifiOnlyUpload:_}),[d]),w=b.useCallback(_=>d({backgroundUploadEnabled:_}),[d]);return f.jsx(b4.Provider,{value:{settings:i,loading:a,currentEventId:c,updateSettings:d,toggleAutoUpload:x,toggleWifiOnly:v,toggleBackgroundUpload:w,setEventContext:m,clearEventContext:g,checkCanUploadNow:y,networkStatus:{isConnected:t,connectionType:r,isWifi:r==="wifi"}},children:n})};var zy;(function(n){n.Dark="DARK",n.Light="LIGHT",n.Default="DEFAULT"})(zy||(zy={}));var CC;(function(n){n.None="NONE",n.Slide="SLIDE",n.Fade="FADE"})(CC||(CC={}));const Ro=Pn("StatusBar"),Od=()=>{const[n,e]=b.useState(null),[t,r]=b.useState(navigator.onLine);b.useEffect(()=>{console.log("Is native:",de.isNativePlatform()),(async()=>{try{const h=await Yw.getInfo();e(h),console.log("Device info:",h)}catch{console.log("Device info not available in browser")}})();const c=()=>r(!0),u=()=>r(!1);return window.addEventListener("online",c),window.addEventListener("offline",u),()=>{window.removeEventListener("online",c),window.removeEventListener("offline",u)}},[]);const s=l=>{if(!l)return"web";const c=l.toLowerCase();return c==="android"?"android":c==="ios"?"ios":"web"},i=(n==null?void 0:n.platform)||"web",o=s(n==null?void 0:n.platform),a=(n==null?void 0:n.platform)!=="web";return{deviceInfo:n,isNative:a,platform:i,dbPlatform:o,isOnline:t}},eH=(n={})=>{const{isNative:e}=Od();return b.useEffect(()=>{if(!e)return;(async()=>{try{n.style&&await Ro.setStyle({style:n.style}),n.backgroundColor&&await Ro.setBackgroundColor({color:n.backgroundColor}),n.overlay!==void 0&&await Ro.setOverlaysWebView({overlay:n.overlay})}catch{console.log("Status bar configuration not available")}})()},[e,n.style,n.backgroundColor,n.overlay]),{setStyle:async o=>{if(e)try{await Ro.setStyle({style:o})}catch{console.log("Status bar style not available")}},setBackgroundColor:async o=>{if(e)try{await Ro.setBackgroundColor({color:o})}catch{console.log("Status bar background color not available")}},hide:async()=>{if(e)try{await Ro.hide()}catch{console.log("Status bar hide not available")}},show:async()=>{if(e)try{await Ro.show()}catch{console.log("Status bar show not available")}}}};var EC;(function(n){n.Dark="DARK",n.Light="LIGHT",n.Default="DEFAULT"})(EC||(EC={}));var kC;(function(n){n.Body="body",n.Ionic="ionic",n.Native="native",n.None="none"})(kC||(kC={}));const Ut=Pn("Keyboard");function _4(n=!0){b.useEffect(()=>{var c,u,h,d,p;if(!n)return;let e;const t=m=>{clearTimeout(e),e=setTimeout(()=>{const g=Math.max(0,Math.round(m));document.documentElement.style.setProperty("--kb",`${g}px`),g>0?document.documentElement.classList.add("keyboard-open"):document.documentElement.classList.remove("keyboard-open")},50)};let r,s,i,o;document.documentElement.style.setProperty("--kb","0px"),document.documentElement.classList.remove("keyboard-open");try{(c=Ut.setResizeMode)==null||c.call(Ut,{mode:"ionic"})}catch{}try{r=(u=Ut.addListener)==null?void 0:u.call(Ut,"keyboardWillShow",m=>{t((m==null?void 0:m.keyboardHeight)||0)}),s=(h=Ut.addListener)==null?void 0:h.call(Ut,"keyboardDidShow",m=>{t((m==null?void 0:m.keyboardHeight)||0)}),i=(d=Ut.addListener)==null?void 0:d.call(Ut,"keyboardWillHide",()=>t(0)),o=(p=Ut.addListener)==null?void 0:p.call(Ut,"keyboardDidHide",()=>t(0))}catch{}const a=window.visualViewport,l=()=>{if(!n||!a)return;const m=Math.max(0,window.innerHeight-a.height-a.offsetTop);t(m)};return a==null||a.addEventListener("resize",l),a==null||a.addEventListener("scroll",l),l(),()=>{var m;clearTimeout(e),r==null||r.then(g=>g.remove()).catch(()=>{}),s==null||s.then(g=>g.remove()).catch(()=>{}),i==null||i.then(g=>g.remove()).catch(()=>{}),o==null||o.then(g=>g.remove()).catch(()=>{}),a==null||a.removeEventListener("resize",l),a==null||a.removeEventListener("scroll",l),t(0);try{(m=Ut.setResizeMode)==null||m.call(Ut,{mode:"ionic"})}catch{}}},[n])}function tH(){const[n,e]=Y.useState("0px"),[t,r]=Y.useState(!1),[s,i]=Y.useState("unknown");return Y.useEffect(()=>{i(de.getPlatform());const l=setInterval(()=>{const c=getComputedStyle(document.documentElement).getPropertyValue("--kb");e(c||"0px"),r(document.documentElement.classList.contains("keyboard-open"))},100);return()=>clearInterval(l)},[]),new URLSearchParams(window.location.search).get("kbdebug")!=="1"?null:f.jsxs("div",{className:"fixed bottom-4 left-4 bg-black/90 text-white text-xs p-3 rounded-lg z-[9999] font-mono max-w-[200px]",children:[f.jsx("div",{className:"font-bold mb-2 text-yellow-400",children:" KB Debug"}),f.jsxs("div",{children:["Platform: ",s]}),f.jsxs("div",{children:["Native: ",de.isNativePlatform()?"YES":"NO"]}),f.jsxs("div",{children:["--kb: ",n]}),f.jsxs("div",{children:["State: ",t?" OPEN":" CLOSED"]})]})}const La=({children:n})=>{const{user:e,isLoading:t}=Or(),r=vs(),s=Sa();return b.useEffect(()=>{if(!t&&!e){const i=s.pathname+s.search;r(`/?redirect=${encodeURIComponent(i)}`,{replace:!0})}},[e,t,r,s]),t?f.jsx("div",{className:"min-h-screen bg-background flex items-center justify-center",children:f.jsxs("div",{className:"text-center space-y-4",children:[f.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary mx-auto"}),f.jsx("p",{className:"text-muted-foreground",children:"Loading..."})]})}):e?f.jsx(f.Fragment,{children:n}):null},nH=({children:n})=>{const{user:e,isLoading:t}=Or(),r=vs(),[s,i]=b.useState(!1),[o,a]=b.useState(!0);return b.useEffect(()=>{t||(async()=>{if(console.log(" AdminRoute: Checking admin access",{user:!!e,isLoading:t,userEmail:e==null?void 0:e.email}),!e){console.log(" AdminRoute: No user, redirecting to /"),r("/");return}try{console.log(" AdminRoute: Fetching user data for",e.id);const{data:c,error:u}=await ue.from("users").select("email").eq("user_id",e.id).single();if(console.log(" AdminRoute: User data result",{userData:c,error:u}),u){console.error(" AdminRoute: Database error:",u),r("/");return}if((c==null?void 0:c.email)!=="mattspecker@gmail.com"){console.log(" AdminRoute: Access denied - email mismatch",{actual:c==null?void 0:c.email,required:"mattspecker@gmail.com"}),r("/");return}console.log(" AdminRoute: Admin access granted"),i(!0)}catch(c){console.error(" AdminRoute: Exception during admin check:",c),r("/")}finally{a(!1)}})()},[e,t,r]),t||o?(console.log(" AdminRoute: Showing loading state",{isLoading:t,isChecking:o}),f.jsx("div",{className:"min-h-screen bg-background flex items-center justify-center",children:f.jsxs("div",{className:"text-center space-y-4",children:[f.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary mx-auto"}),f.jsx("p",{className:"text-muted-foreground",children:"Checking admin access..."})]})})):s?f.jsx(f.Fragment,{children:n}):null},l1=wd("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-12 px-4 py-2",sm:"h-12 rounded-md px-3",lg:"h-12 rounded-md px-8",icon:"h-12 w-12"}},defaultVariants:{variant:"default",size:"default"}}),_e=b.forwardRef(({className:n,variant:e,size:t,asChild:r=!1,...s},i)=>{const o=r?ua:"button";return f.jsx(o,{className:Oe(l1({variant:e,size:t,className:n})),ref:i,...s})});_e.displayName="Button";const zo=b.forwardRef(({className:n,type:e,...t},r)=>f.jsx("input",{type:e,className:Oe("flex h-12 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",n),ref:r,...t}));zo.displayName="Input";var rH="Label",S4=b.forwardRef((n,e)=>f.jsx(Le.label,{...n,ref:e,onMouseDown:t=>{var s;t.target.closest("button, input, select, textarea")||((s=n.onMouseDown)==null||s.call(n,t),!t.defaultPrevented&&t.detail>1&&t.preventDefault())}}));S4.displayName=rH;var C4=S4;const sH=wd("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),js=b.forwardRef(({className:n,...e},t)=>f.jsx(C4,{ref:t,className:Oe(sH(),n),...e}));js.displayName=C4.displayName;const Ht=b.forwardRef(({className:n,...e},t)=>f.jsx("div",{ref:t,className:Oe("rounded-lg border bg-card text-card-foreground shadow-sm",n),...e}));Ht.displayName="Card";const Gs=b.forwardRef(({className:n,...e},t)=>f.jsx("div",{ref:t,className:Oe("flex flex-col space-y-1.5 p-6",n),...e}));Gs.displayName="CardHeader";const qs=b.forwardRef(({className:n,...e},t)=>f.jsx("h2",{ref:t,className:Oe("text-xl font-semibold leading-none tracking-tight",n),...e}));qs.displayName="CardTitle";const Ys=b.forwardRef(({className:n,...e},t)=>f.jsx("p",{ref:t,className:Oe("text-sm text-muted-foreground",n),...e}));Ys.displayName="CardDescription";const Qt=b.forwardRef(({className:n,...e},t)=>f.jsx("div",{ref:t,className:Oe("p-6 pt-0",n),...e}));Qt.displayName="CardContent";const iH=b.forwardRef(({className:n,...e},t)=>f.jsx("div",{ref:t,className:Oe("flex items-center p-6 pt-0",n),...e}));iH.displayName="CardFooter";function oH(n,e=[]){let t=[];function r(i,o){const a=b.createContext(o),l=t.length;t=[...t,o];function c(h){const{scope:d,children:p,...m}=h,g=(d==null?void 0:d[n][l])||a,y=b.useMemo(()=>m,Object.values(m));return f.jsx(g.Provider,{value:y,children:p})}function u(h,d){const p=(d==null?void 0:d[n][l])||a,m=b.useContext(p);if(m)return m;if(o!==void 0)return o;throw new Error(`\`${h}\` must be used within \`${i}\``)}return c.displayName=i+"Provider",[c,u]}const s=()=>{const i=t.map(o=>b.createContext(o));return function(a){const l=(a==null?void 0:a[n])||i;return b.useMemo(()=>({[`__scope${n}`]:{...a,[n]:l}}),[a,l])}};return s.scopeName=n,[r,aH(s,...e)]}function aH(...n){const e=n[0];if(n.length===1)return e;const t=()=>{const r=n.map(s=>({useScope:s(),scopeName:s.scopeName}));return function(i){const o=r.reduce((a,{useScope:l,scopeName:c})=>{const h=l(i)[`__scope${c}`];return{...a,...h}},{});return b.useMemo(()=>({[`__scope${e.scopeName}`]:o}),[o])}};return t.scopeName=e.scopeName,t}var lH=b.createContext(void 0);function c1(n){const e=b.useContext(lH);return n||e||"ltr"}var Gg="rovingFocusGroup.onEntryFocus",cH={bubbles:!1,cancelable:!0},_0="RovingFocusGroup",[Wy,E4,uH]=yw(_0),[dH,k4]=oH(_0,[uH]),[hH,fH]=dH(_0),P4=b.forwardRef((n,e)=>f.jsx(Wy.Provider,{scope:n.__scopeRovingFocusGroup,children:f.jsx(Wy.Slot,{scope:n.__scopeRovingFocusGroup,children:f.jsx(pH,{...n,ref:e})})}));P4.displayName=_0;var pH=b.forwardRef((n,e)=>{const{__scopeRovingFocusGroup:t,orientation:r,loop:s=!1,dir:i,currentTabStopId:o,defaultCurrentTabStopId:a,onCurrentTabStopIdChange:l,onEntryFocus:c,preventScrollOnEntryFocus:u=!1,...h}=n,d=b.useRef(null),p=ct(e,d),m=c1(i),[g=null,y]=ti({prop:o,defaultProp:a,onChange:l}),[x,v]=b.useState(!1),w=tr(c),_=E4(t),S=b.useRef(!1),[E,C]=b.useState(0);return b.useEffect(()=>{const P=d.current;if(P)return P.addEventListener(Gg,w),()=>P.removeEventListener(Gg,w)},[w]),f.jsx(hH,{scope:t,orientation:r,dir:m,loop:s,currentTabStopId:g,onItemFocus:b.useCallback(P=>y(P),[y]),onItemShiftTab:b.useCallback(()=>v(!0),[]),onFocusableItemAdd:b.useCallback(()=>C(P=>P+1),[]),onFocusableItemRemove:b.useCallback(()=>C(P=>P-1),[]),children:f.jsx(Le.div,{tabIndex:x||E===0?-1:0,"data-orientation":r,...h,ref:p,style:{outline:"none",...n.style},onMouseDown:De(n.onMouseDown,()=>{S.current=!0}),onFocus:De(n.onFocus,P=>{const O=!S.current;if(P.target===P.currentTarget&&O&&!x){const A=new CustomEvent(Gg,cH);if(P.currentTarget.dispatchEvent(A),!A.defaultPrevented){const R=_().filter(F=>F.focusable),B=R.find(F=>F.active),I=R.find(F=>F.id===g),U=[B,I,...R].filter(Boolean).map(F=>F.ref.current);D4(U,u)}}S.current=!1}),onBlur:De(n.onBlur,()=>v(!1))})})}),T4="RovingFocusGroupItem",A4=b.forwardRef((n,e)=>{const{__scopeRovingFocusGroup:t,focusable:r=!0,active:s=!1,tabStopId:i,...o}=n,a=Hs(),l=i||a,c=fH(T4,t),u=c.currentTabStopId===l,h=E4(t),{onFocusableItemAdd:d,onFocusableItemRemove:p}=c;return b.useEffect(()=>{if(r)return d(),()=>p()},[r,d,p]),f.jsx(Wy.ItemSlot,{scope:t,id:l,focusable:r,active:s,children:f.jsx(Le.span,{tabIndex:u?0:-1,"data-orientation":c.orientation,...o,ref:e,onMouseDown:De(n.onMouseDown,m=>{r?c.onItemFocus(l):m.preventDefault()}),onFocus:De(n.onFocus,()=>c.onItemFocus(l)),onKeyDown:De(n.onKeyDown,m=>{if(m.key==="Tab"&&m.shiftKey){c.onItemShiftTab();return}if(m.target!==m.currentTarget)return;const g=vH(m,c.orientation,c.dir);if(g!==void 0){if(m.metaKey||m.ctrlKey||m.altKey||m.shiftKey)return;m.preventDefault();let x=h().filter(v=>v.focusable).map(v=>v.ref.current);if(g==="last")x.reverse();else if(g==="prev"||g==="next"){g==="prev"&&x.reverse();const v=x.indexOf(m.currentTarget);x=c.loop?yH(x,v+1):x.slice(v+1)}setTimeout(()=>D4(x))}})})})});A4.displayName=T4;var gH={ArrowLeft:"prev",ArrowUp:"prev",ArrowRight:"next",ArrowDown:"next",PageUp:"first",Home:"first",PageDown:"last",End:"last"};function mH(n,e){return e!=="rtl"?n:n==="ArrowLeft"?"ArrowRight":n==="ArrowRight"?"ArrowLeft":n}function vH(n,e,t){const r=mH(n.key,t);if(!(e==="vertical"&&["ArrowLeft","ArrowRight"].includes(r))&&!(e==="horizontal"&&["ArrowUp","ArrowDown"].includes(r)))return gH[r]}function D4(n,e=!1){const t=document.activeElement;for(const r of n)if(r===t||(r.focus({preventScroll:e}),document.activeElement!==t))return}function yH(n,e){return n.map((t,r)=>n[(e+r)%n.length])}var xH=P4,wH=A4,u1="Tabs",[bH,Nee]=xo(u1,[k4]),O4=k4(),[_H,d1]=bH(u1),I4=b.forwardRef((n,e)=>{const{__scopeTabs:t,value:r,onValueChange:s,defaultValue:i,orientation:o="horizontal",dir:a,activationMode:l="automatic",...c}=n,u=c1(a),[h,d]=ti({prop:r,onChange:s,defaultProp:i});return f.jsx(_H,{scope:t,baseId:Hs(),value:h,onValueChange:d,orientation:o,dir:u,activationMode:l,children:f.jsx(Le.div,{dir:u,"data-orientation":o,...c,ref:e})})});I4.displayName=u1;var R4="TabsList",N4=b.forwardRef((n,e)=>{const{__scopeTabs:t,loop:r=!0,...s}=n,i=d1(R4,t),o=O4(t);return f.jsx(xH,{asChild:!0,...o,orientation:i.orientation,dir:i.dir,loop:r,children:f.jsx(Le.div,{role:"tablist","aria-orientation":i.orientation,...s,ref:e})})});N4.displayName=R4;var j4="TabsTrigger",L4=b.forwardRef((n,e)=>{const{__scopeTabs:t,value:r,disabled:s=!1,...i}=n,o=d1(j4,t),a=O4(t),l=B4(o.baseId,r),c=U4(o.baseId,r),u=r===o.value;return f.jsx(wH,{asChild:!0,...a,focusable:!s,active:u,children:f.jsx(Le.button,{type:"button",role:"tab","aria-selected":u,"aria-controls":c,"data-state":u?"active":"inactive","data-disabled":s?"":void 0,disabled:s,id:l,...i,ref:e,onMouseDown:De(n.onMouseDown,h=>{!s&&h.button===0&&h.ctrlKey===!1?o.onValueChange(r):h.preventDefault()}),onKeyDown:De(n.onKeyDown,h=>{[" ","Enter"].includes(h.key)&&o.onValueChange(r)}),onFocus:De(n.onFocus,()=>{const h=o.activationMode!=="manual";!u&&!s&&h&&o.onValueChange(r)})})})});L4.displayName=j4;var M4="TabsContent",F4=b.forwardRef((n,e)=>{const{__scopeTabs:t,value:r,forceMount:s,children:i,...o}=n,a=d1(M4,t),l=B4(a.baseId,r),c=U4(a.baseId,r),u=r===a.value,h=b.useRef(u);return b.useEffect(()=>{const d=requestAnimationFrame(()=>h.current=!1);return()=>cancelAnimationFrame(d)},[]),f.jsx(wo,{present:s||u,children:({present:d})=>f.jsx(Le.div,{"data-state":u?"active":"inactive","data-orientation":a.orientation,role:"tabpanel","aria-labelledby":l,hidden:!d,id:c,tabIndex:0,...o,ref:e,style:{...n.style,animationDuration:h.current?"0s":void 0},children:d&&i})})});F4.displayName=M4;function B4(n,e){return`${n}-trigger-${e}`}function U4(n,e){return`${n}-content-${e}`}var SH=I4,$4=N4,z4=L4,W4=F4;const CH=SH,H4=b.forwardRef(({className:n,...e},t)=>f.jsx($4,{ref:t,className:Oe("inline-flex h-12 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground",n),...e}));H4.displayName=$4.displayName;const Hy=b.forwardRef(({className:n,...e},t)=>f.jsx(z4,{ref:t,className:Oe("inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-3 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm min-h-12",n),...e}));Hy.displayName=z4.displayName;const Vy=b.forwardRef(({className:n,...e},t)=>f.jsx(W4,{ref:t,className:Oe("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",n),...e}));Vy.displayName=W4.displayName;function h1({children:n,className:e}){return f.jsx("div",{className:Oe("min-h-screen bg-gradient-to-br from-background via-background to-muted/20 font-outfit",e),children:n})}function EH({onAppleClick:n,onGoogleClick:e,disabled:t=!1}){const[r,s]=b.useState(!1);b.useEffect(()=>{const a=navigator.userAgent.toLowerCase(),l=/iphone|ipad|ipod|macintosh|mac os x/.test(a);s(l)},[]);const i=f.jsxs(_e,{variant:"outline",size:"default",className:"h-12 w-full",onClick:n,disabled:t,children:[f.jsx("svg",{className:"w-5 h-5 mr-2",viewBox:"0 0 24 24",fill:"currentColor",children:f.jsx("path",{d:"M17.05 20.28c-.98.95-2.05.8-3.08.35-1.09-.46-2.09-.48-3.24 0-1.44.62-2.2.44-3.06-.35C2.79 15.25 3.51 7.59 9.05 7.31c1.35.07 2.29.74 3.08.8 1.18-.24 2.31-.93 3.57-.84 1.51.12 2.65.72 3.4 1.8-3.12 1.87-2.38 5.98.48 7.13-.57 1.5-1.31 2.99-2.54 4.09l.01-.01zM12.03 7.25c-.15-2.23 1.66-4.07 3.74-4.25.29 2.58-2.34 4.5-3.74 4.25z"})}),"Continue with Apple"]}),o=f.jsxs(_e,{variant:"outline",size:"default",className:"h-12 w-full",onClick:e,disabled:t,children:[f.jsxs("svg",{className:"w-5 h-5 mr-2",viewBox:"0 0 24 24",children:[f.jsx("path",{fill:"#4285F4",d:"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"}),f.jsx("path",{fill:"#34A853",d:"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"}),f.jsx("path",{fill:"#FBBC05",d:"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"}),f.jsx("path",{fill:"#EA4335",d:"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"})]}),"Continue with Google"]});return f.jsx("div",{className:"space-y-3",children:r?f.jsxs(f.Fragment,{children:[i,o]}):f.jsxs(f.Fragment,{children:[o,i]})})}const Gy=()=>{const[n,e]=b.useState(!1),[t,r]=b.useState(!1),[s,i]=b.useState(!1),o=vs(),[a]=J6(),{isAuthenticated:l,isLoading:c,user:u,login:h,register:d,loginWithGoogle:p,loginWithApple:m}=Or();Od();const{toast:g}=Bt();_4(s);const y=a.get("eventCode"),x=!!y,[v,w]=b.useState(""),[_,S]=b.useState(""),[E,C]=b.useState(""),[P,O]=b.useState(""),[A,R]=b.useState("");b.useEffect(()=>{if(!s)return;const D=()=>{if(window.visualViewport){const k=window.visualViewport.height,N=window.visualViewport.offsetTop;document.documentElement.style.setProperty("--vvh",`${k}px`),document.documentElement.style.setProperty("--vvtop",`${N}px`)}};return D(),window.visualViewport&&(window.visualViewport.addEventListener("resize",D),window.visualViewport.addEventListener("scroll",D)),()=>{window.visualViewport&&(window.visualViewport.removeEventListener("resize",D),window.visualViewport.removeEventListener("scroll",D))}},[s]);const B=D=>{setTimeout(()=>{D.target.scrollIntoView({behavior:"smooth",block:"center"})},100)};b.useEffect(()=>{(async()=>{if(!u)return;const k=a.get("eventCode"),N=a.get("passcode"),M=a.get("redirect");if(k){console.log(" POST-AUTH: Redirecting to join page with event code:",k);const T=`/join/${k}${N?`?passcode=${N}`:""}`;o(T,{replace:!0})}else M?(console.log(" POST-AUTH: Redirecting to specified path:",M),o(M,{replace:!0})):l&&(console.log(" POST-AUTH: Redirecting to dashboard"),o("/dashboard",{replace:!0}))})()},[u,a,o,l]);const I=async()=>{e(!0);try{const{error:D}=await p();D&&g({title:"Google login failed",description:D,variant:"destructive"})}catch{g({title:"Google login failed",description:"An unexpected error occurred. Please try again.",variant:"destructive"})}finally{e(!1)}},L=async()=>{try{const{error:D}=await m();D&&g({title:"Apple login failed",description:D,variant:"destructive"})}catch{g({title:"Apple login failed",description:"An unexpected error occurred. Please try again.",variant:"destructive"})}},U=async D=>{D.preventDefault(),r(!0);try{const{error:k}=await h(v,_);if(k){g({title:"Login failed",description:k,variant:"destructive"});return}if(!a.get("eventCode")){const M=a.get("redirect")||"/dashboard";o(M,{replace:!0})}}catch{g({title:"Login failed",description:"An unexpected error occurred. Please try again.",variant:"destructive"})}finally{r(!1)}},F=async D=>{D.preventDefault(),r(!0);try{const{error:k}=await d(E,P,A);if(k){g({title:"Registration failed",description:k,variant:"destructive"});return}g({title:"Registration successful!",description:"Please check your email to verify your account. You can then log in."}),C(""),O(""),R("")}catch{g({title:"Registration failed",description:"An unexpected error occurred. Please try again.",variant:"destructive"})}finally{r(!1)}};return f.jsx(h1,{children:f.jsxs("div",{className:"safe-area-full container mx-auto px-4 py-16",children:[f.jsxs("div",{className:"text-center space-y-4 mb-8",children:[f.jsxs("div",{className:"flex items-center justify-center space-x-3",children:[f.jsx("div",{className:"p-3 md:p-4 rounded-2xl",style:{background:"var(--gradient-primary)",boxShadow:"var(--shadow-camera)"},children:f.jsx(kr,{className:"h-8 w-8 md:h-12 md:w-12 text-primary-foreground"})}),f.jsx("h1",{className:"text-3xl md:text-5xl font-bold bg-gradient-to-r from-primary to-accent bg-clip-text text-transparent",children:"PhotoShare"})]}),f.jsx("p",{className:"text-base md:text-lg text-muted-foreground max-w-2xl mx-auto px-4",children:"Everyone's moments, Everyone's memories"})]}),f.jsxs("div",{className:"max-w-md mx-auto space-y-6 mb-12",children:[f.jsx(EH,{onAppleClick:L,onGoogleClick:I,disabled:n}),f.jsxs("div",{className:"relative my-6",children:[f.jsx("div",{className:"absolute inset-0 flex items-center",children:f.jsx("div",{className:"w-full border-t border-border"})}),f.jsx("div",{className:"relative flex justify-center text-sm",children:f.jsx("span",{className:"px-2 bg-background text-muted-foreground",children:"or"})})]}),f.jsx(_e,{variant:"outline",size:"default",className:"w-full h-12",onClick:()=>i(!0),children:"Continue with Email"})]}),s&&f.jsx("div",{className:"fixed inset-0 bg-black/50 flex justify-center z-50",style:{height:"calc(var(--vvh, 100vh))",paddingTop:"var(--vvtop, 0px)",paddingBottom:"calc(var(--kb, 0px) + env(safe-area-inset-bottom))"},children:f.jsx("div",{className:"w-full sm:p-4 flex items-end sm:items-center justify-center",style:{height:"calc(var(--vvh, 100vh))"},children:f.jsxs(Ht,{className:"w-full max-w-md mb-0 sm:mb-auto rounded-t-2xl sm:rounded-2xl flex flex-col",style:{maxHeight:"calc(var(--vvh, 100vh) - var(--kb, 0px) - 2rem)"},children:[f.jsxs(Gs,{className:"text-center pb-4",children:[f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsxs(_e,{variant:"ghost",size:"sm",onClick:()=>i(!1),children:[f.jsx(_w,{className:"h-4 w-4 mr-2"}),"Back"]}),f.jsxs("div",{className:"flex items-center space-x-2",children:[f.jsx("div",{className:"p-2 rounded-full",style:{background:"var(--gradient-primary)",boxShadow:"var(--shadow-camera)"},children:f.jsx(kr,{className:"h-6 w-6 text-primary-foreground"})}),f.jsx("h2",{className:"text-xl font-bold bg-gradient-to-r from-primary to-accent bg-clip-text text-transparent",children:"PhotoShare"})]}),f.jsx("div",{className:"w-16"})]}),f.jsx(qs,{children:"Welcome"}),f.jsx(Ys,{children:x?`Sign in to join event ${y}`:"Sign in to your account or create a new one"})]}),f.jsx(Qt,{className:"overflow-y-auto flex-1",style:{maxHeight:"calc(var(--vvh, 100vh) - var(--kb, 0px) - 12rem)"},children:f.jsxs(CH,{defaultValue:"login",className:"w-full",children:[f.jsxs(H4,{className:"grid w-full grid-cols-2",children:[f.jsx(Hy,{value:"login",children:"Sign In"}),f.jsx(Hy,{value:"register",children:"Sign Up"})]}),f.jsx(Vy,{value:"login",className:"space-y-4 mt-6",children:f.jsxs("form",{onSubmit:U,className:"space-y-4",children:[f.jsxs("div",{className:"space-y-2",children:[f.jsx(js,{htmlFor:"login-email",children:"Email"}),f.jsxs("div",{className:"relative",children:[f.jsx(H_,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-muted-foreground"}),f.jsx(zo,{id:"login-email",type:"email",value:v,onChange:D=>w(D.target.value),onFocus:B,placeholder:"Enter your email",className:"pl-10",style:{scrollMarginBottom:"120px"},autoComplete:"email",inputMode:"email",required:!0})]})]}),f.jsxs("div",{className:"space-y-2",children:[f.jsx(js,{htmlFor:"login-password",children:"Password"}),f.jsxs("div",{className:"relative",children:[f.jsx(W_,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-muted-foreground"}),f.jsx(zo,{id:"login-password",type:"password",value:_,onChange:D=>S(D.target.value),onFocus:B,placeholder:"Enter your password",className:"pl-10",style:{scrollMarginBottom:"120px"},autoComplete:"current-password",required:!0})]})]}),f.jsx(_e,{type:"submit",className:"w-full camera-button",disabled:t,children:t?"Signing In...":"Sign In"})]})}),f.jsx(Vy,{value:"register",className:"space-y-4 mt-6",children:f.jsxs("form",{onSubmit:F,className:"space-y-4",children:[f.jsxs("div",{className:"space-y-2",children:[f.jsx(js,{htmlFor:"register-name",children:"Name"}),f.jsxs("div",{className:"relative",children:[f.jsx(Ew,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-muted-foreground"}),f.jsx(zo,{id:"register-name",type:"text",value:A,onChange:D=>R(D.target.value),onFocus:B,placeholder:"Enter your name",className:"pl-10",style:{scrollMarginBottom:"120px"},autoComplete:"name",autoCapitalize:"words"})]})]}),f.jsxs("div",{className:"space-y-2",children:[f.jsx(js,{htmlFor:"register-email",children:"Email"}),f.jsxs("div",{className:"relative",children:[f.jsx(H_,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-muted-foreground"}),f.jsx(zo,{id:"register-email",type:"email",value:E,onChange:D=>C(D.target.value),onFocus:B,placeholder:"Enter your email",className:"pl-10",style:{scrollMarginBottom:"120px"},autoComplete:"email",inputMode:"email",required:!0})]})]}),f.jsxs("div",{className:"space-y-2",children:[f.jsx(js,{htmlFor:"register-password",children:"Password"}),f.jsxs("div",{className:"relative",children:[f.jsx(W_,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-muted-foreground"}),f.jsx(zo,{id:"register-password",type:"password",value:P,onChange:D=>O(D.target.value),onFocus:B,placeholder:"Create a password",className:"pl-10",style:{scrollMarginBottom:"120px"},autoComplete:"new-password",required:!0})]})]}),f.jsx(_e,{type:"submit",className:"w-full camera-button",disabled:t,children:t?"Creating Account...":"Create Account"})]})})]})})]})})}),f.jsxs("div",{className:"grid md:grid-cols-3 gap-6 max-w-5xl mx-auto",children:[f.jsx(Ht,{children:f.jsxs(Qt,{className:"pt-6 text-center",children:[f.jsx(kr,{className:"w-10 h-10 text-primary mb-4 mx-auto"}),f.jsx("h3",{className:"font-bold text-lg mb-2",children:"Create & Join Events"}),f.jsx("p",{className:"text-muted-foreground text-sm",children:"Start your own event or join with a simple code"})]})}),f.jsx(Ht,{children:f.jsxs(Qt,{className:"pt-6 text-center",children:[f.jsx(da,{className:"w-10 h-10 text-accent mb-4 mx-auto"}),f.jsx("h3",{className:"font-bold text-lg mb-2",children:"Everyone's Moments"}),f.jsx("p",{className:"text-muted-foreground text-sm",children:"All photos automatically upload to your shared event"})]})}),f.jsx(Ht,{children:f.jsxs(Qt,{className:"pt-6 text-center",children:[f.jsx(Gl,{className:"w-10 h-10 text-primary mb-4 mx-auto"}),f.jsx("h3",{className:"font-bold text-lg mb-2",children:"Keep What Matters"}),f.jsx("p",{className:"text-muted-foreground text-sm",children:"Browse everyone's photos and download your favorites"})]})})]})]})})},kH=()=>{const n=Sa(),e=vs();return b.useEffect(()=>{console.error("404 Error: User attempted to access non-existent route:",n.pathname)},[n.pathname]),f.jsx(h1,{className:"flex flex-col items-center justify-center p-8",children:f.jsxs("div",{className:"text-center max-w-md space-y-6",children:[f.jsx("div",{className:"flex justify-center mb-4",children:f.jsx("div",{className:"p-4 rounded-full bg-muted",children:f.jsx(jT,{className:"w-12 h-12 text-muted-foreground"})})}),f.jsxs("div",{children:[f.jsx("div",{className:"text-7xl sm:text-9xl font-bold bg-gradient-to-r from-primary to-accent bg-clip-text text-transparent mb-4",children:"404"}),f.jsx("h1",{className:"text-3xl sm:text-4xl font-bold mb-3",children:"Page Not Found"}),f.jsx("p",{className:"text-lg sm:text-xl text-muted-foreground",children:"The page you're looking for doesn't exist or has been moved."})]}),f.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 justify-center pt-2",children:[f.jsxs(_e,{onClick:()=>e("/"),className:"gap-2",children:[f.jsx(TL,{className:"h-4 w-4"}),"Go Home"]}),f.jsxs(_e,{variant:"outline",onClick:()=>e(-1),className:"gap-2",children:[f.jsx(_w,{className:"h-4 w-4"}),"Go Back"]})]})]})})},qg=768;function PH(){const[n,e]=b.useState(void 0);return b.useEffect(()=>{const t=window.matchMedia(`(max-width: ${qg-1}px)`),r=()=>{e(window.innerWidth<qg)};return t.addEventListener("change",r),e(window.innerWidth<qg),()=>t.removeEventListener("change",r)},[]),!!n}var Us;(function(n){n.Prompt="PROMPT",n.Camera="CAMERA",n.Photos="PHOTOS"})(Us||(Us={}));var Sl;(function(n){n.Rear="REAR",n.Front="FRONT"})(Sl||(Sl={}));var sd;(function(n){n.Uri="uri",n.Base64="base64",n.DataUrl="dataUrl"})(sd||(sd={}));class TH extends qw{async getPhoto(e){return new Promise(async(t,r)=>{if(e.webUseInput||e.source===Us.Photos)this.fileInputExperience(e,t,r);else if(e.source===Us.Prompt){let s=document.querySelector("pwa-action-sheet");s||(s=document.createElement("pwa-action-sheet"),document.body.appendChild(s)),s.header=e.promptLabelHeader||"Photo",s.cancelable=!1,s.options=[{title:e.promptLabelPhoto||"From Photos"},{title:e.promptLabelPicture||"Take Picture"}],s.addEventListener("onSelection",async i=>{i.detail===0?this.fileInputExperience(e,t,r):this.cameraExperience(e,t,r)})}else this.cameraExperience(e,t,r)})}async pickImages(e){return new Promise(async(t,r)=>{this.multipleFileInputExperience(t,r)})}async cameraExperience(e,t,r){if(customElements.get("pwa-camera-modal")){const s=document.createElement("pwa-camera-modal");s.facingMode=e.direction===Sl.Front?"user":"environment",document.body.appendChild(s);try{await s.componentOnReady(),s.addEventListener("onPhoto",async i=>{const o=i.detail;o===null?r(new vl("User cancelled photos app")):o instanceof Error?r(o):t(await this._getCameraPhoto(o,e)),s.dismiss(),document.body.removeChild(s)}),s.present()}catch{this.fileInputExperience(e,t,r)}}else console.error("Unable to load PWA Element 'pwa-camera-modal'. See the docs: https://capacitorjs.com/docs/web/pwa-elements."),this.fileInputExperience(e,t,r)}fileInputExperience(e,t,r){let s=document.querySelector("#_capacitor-camera-input");const i=()=>{var o;(o=s.parentNode)===null||o===void 0||o.removeChild(s)};s||(s=document.createElement("input"),s.id="_capacitor-camera-input",s.type="file",s.hidden=!0,document.body.appendChild(s),s.addEventListener("change",o=>{const a=s.files[0];let l="jpeg";if(a.type==="image/png"?l="png":a.type==="image/gif"&&(l="gif"),e.resultType==="dataUrl"||e.resultType==="base64"){const c=new FileReader;c.addEventListener("load",()=>{if(e.resultType==="dataUrl")t({dataUrl:c.result,format:l});else if(e.resultType==="base64"){const u=c.result.split(",")[1];t({base64String:u,format:l})}i()}),c.readAsDataURL(a)}else t({webPath:URL.createObjectURL(a),format:l}),i()}),s.addEventListener("cancel",o=>{r(new vl("User cancelled photos app")),i()})),s.accept="image/*",s.capture=!0,e.source===Us.Photos||e.source===Us.Prompt?s.removeAttribute("capture"):e.direction===Sl.Front?s.capture="user":e.direction===Sl.Rear&&(s.capture="environment"),s.click()}multipleFileInputExperience(e,t){let r=document.querySelector("#_capacitor-camera-input-multiple");const s=()=>{var i;(i=r.parentNode)===null||i===void 0||i.removeChild(r)};r||(r=document.createElement("input"),r.id="_capacitor-camera-input-multiple",r.type="file",r.hidden=!0,r.multiple=!0,document.body.appendChild(r),r.addEventListener("change",i=>{const o=[];for(let a=0;a<r.files.length;a++){const l=r.files[a];let c="jpeg";l.type==="image/png"?c="png":l.type==="image/gif"&&(c="gif"),o.push({webPath:URL.createObjectURL(l),format:c})}e({photos:o}),s()}),r.addEventListener("cancel",i=>{t(new vl("User cancelled photos app")),s()})),r.accept="image/*",r.click()}_getCameraPhoto(e,t){return new Promise((r,s)=>{const i=new FileReader,o=e.type.split("/")[1];t.resultType==="uri"?r({webPath:URL.createObjectURL(e),format:o,saved:!1}):(i.readAsDataURL(e),i.onloadend=()=>{const a=i.result;t.resultType==="dataUrl"?r({dataUrl:a,format:o,saved:!1}):r({base64String:a.split(",")[1],format:o,saved:!1})},i.onerror=a=>{s(a)})})}async checkPermissions(){if(typeof navigator>"u"||!navigator.permissions)throw this.unavailable("Permissions API not available in this browser");try{return{camera:(await window.navigator.permissions.query({name:"camera"})).state,photos:"granted"}}catch{throw this.unavailable("Camera permissions are not available in this browser")}}async requestPermissions(){throw this.unimplemented("Not implemented on web.")}async pickLimitedLibraryPhotos(){throw this.unavailable("Not implemented on web.")}async getLimitedLibraryPhotos(){throw this.unavailable("Not implemented on web.")}}const Id=Pn("Camera",{web:()=>new TH}),f1=Object.freeze(Object.defineProperty({__proto__:null,Camera:Id,get CameraDirection(){return Sl},get CameraResultType(){return sd},get CameraSource(){return Us}},Symbol.toStringTag,{value:"Module"}));function p1(n){var o;const e=n.split(","),t=((o=e[0].match(/:(.*?);/))==null?void 0:o[1])||"image/jpeg",r=atob(e[1]);let s=r.length;const i=new Uint8Array(s);for(;s--;)i[s]=r.charCodeAt(s);return new Blob([i],{type:t})}function ec(n,e,t){const r=p1(n),s=t||r.type;return new File([r],e,{type:s,lastModified:Date.now()})}function fo(n){return n.startsWith("data:")}const AH=()=>{const[n,e]=b.useState(!1),{toast:t}=Bt(),r=b.useRef(null),s=b.useRef(null),i=b.useRef(null);Y.useEffect(()=>{e(!1),r.current=null,s.current=null;const u=()=>{console.log(" Manual reset of photo picker state"),e(!1),r.current=null,s.current=null},h=()=>{console.log(" Page show - resetting photo picker state"),e(!1),r.current=null,s.current=null};window.addEventListener("resetPhotoPicker",u),window.addEventListener("pageshow",h);const d=()=>{document.visibilityState==="visible"&&(console.log(" Visibility change - resetting photo picker state"),e(!1),r.current=null,s.current=null)};return document.addEventListener("visibilitychange",d),()=>{window.removeEventListener("resetPhotoPicker",u),window.removeEventListener("pageshow",h),document.removeEventListener("visibilitychange",d),i.current&&(clearTimeout(i.current),i.current=null)}},[]),Y.useEffect(()=>()=>{console.log(" Component unmounting - resetting photo picker state"),e(!1),r.current=null,s.current=null},[]);const o=u=>{const h=[];if((!u.eventId||u.eventId.trim()==="")&&h.push("eventId is missing or empty"),(!u.eventName||u.eventName.trim()===""||u.eventName==="MISSING")&&h.push("eventName is missing, empty, or set to MISSING"),!u.startTime||u.startTime.trim()==="")h.push("startTime is missing or empty");else{const d=new Date(u.startTime);isNaN(d.getTime())&&h.push("startTime is not a valid date")}if(!u.endTime||u.endTime.trim()==="")h.push("endTime is missing or empty");else{const d=new Date(u.endTime);isNaN(d.getTime())&&h.push("endTime is not a valid date")}return h},a=u=>{const h=Date.now(),d=100;if(r.current)return console.log(" Blocking duplicate call - active call in progress:",r.current.callId),!0;if(s.current){const p=h-s.current.timestamp,m=s.current.eventData.eventId===u.eventId;if(p<d&&m)return console.log(` Blocking rapid duplicate call (${p}ms since last call):`,{lastCall:s.current,currentCall:{eventData:u,timestamp:h}}),!0}return!1},l=async u=>{var p,m;const h=`call-${Date.now()}-${Math.random().toString(36).substr(2,9)}`,d=Date.now();if(console.log(` === pickEventPhotos CALLED === [${d}]`),console.log(` Call ID: ${h}`),console.log(" Event Data:",u),console.log(" Current state - isPickingPhotos:",n),console.log(" Active call:",((p=r.current)==null?void 0:p.callId)||"none"),n)return console.log(" Already picking photos, ignoring call"),[];if(u){const g=o(u);if(g.length>0)return console.error(" Event data validation failed:",g),t({title:"Invalid event data",description:`Cannot proceed: ${g.join(", ")}`,variant:"destructive"}),[];if(a(u))return console.log(" Duplicate call detected, ignoring"),[];const y={callId:h,timestamp:d,eventData:u};r.current=y,s.current=y}e(!0),i.current&&clearTimeout(i.current),i.current=window.setTimeout(()=>{r.current&&(console.warn(" Photo picker watchdog triggered - auto-resetting state"),e(!1),r.current=null,window.dispatchEvent(new Event("resetPhotoPicker")))},2e4);try{if(!de.isNativePlatform())return console.log(" Using web file picker"),await c();if(u&&((m=window.EventPhotoPickerIntegration)!=null&&m.isReady))try{console.log(" Using EventPhotoPicker for time-based selection"),console.log(" Calling window.EventPhotoPickerIntegration.openPhotoPicker with:",{eventId:u.eventId,eventName:u.eventName,startTime:u.startTime,endTime:u.endTime,allowMultipleSelection:!0,showTimeFilter:!0});const v=await window.EventPhotoPickerIntegration.openPhotoPicker({eventId:u.eventId,eventName:u.eventName,startTime:u.startTime,endTime:u.endTime,allowMultipleSelection:!0,showTimeFilter:!0});if(console.log(" EventPhotoPicker result:",v),!v||!v.selectedPhotos||v.selectedPhotos.length===0)return console.log(" EventPhotoPicker: No photos selected or cancelled"),[];const _=(await Promise.all(v.selectedPhotos.map(async(S,E)=>{try{const C=S.dataUrl||S.webPath;if(fo(C))return ec(C,`event-photo-${Date.now()}-${E}.jpg`,"image/jpeg");{const O=await(await fetch(C)).blob();return new File([O],`event-photo-${Date.now()}-${E}.jpg`,{type:"image/jpeg"})}}catch(C){return console.error("Failed to convert photo to File:",C),null}}))).filter(Boolean);return console.log(` EventPhotoPicker success: ${_.length} files converted`),_}catch(v){const w=v instanceof Error?v.message:String(v);return w.includes("cancelled")||w.includes("canceled")||w.includes("User cancelled")||w.includes("CropEditor cancelled")?(console.log(" EventPhotoPicker: User cancelled operation"),[]):(console.error(" EventPhotoPicker error:",v),[])}console.log(" Using regular Capacitor Camera for photo selection");const g=await Id.pickImages({quality:90,limit:10,presentationStyle:"popover"});if(!g.photos||g.photos.length===0)return console.log(" Regular picker: User cancelled or no photos selected"),[];const x=(await Promise.all(g.photos.map(async(v,w)=>{try{let _=v.webPath;if(v.path&&!(_!=null&&_.startsWith("data:"))&&(de.getPlatform()==="ios"&&v.path.startsWith("file://")||de.getPlatform()==="android"&&v.path.startsWith("content://"))&&(_=v.path),!_)return console.error("No valid path found for photo"),null;if(fo(_))return ec(_,`photo-${Date.now()}-${w}.jpg`,"image/jpeg");{const E=await(await fetch(_)).blob();return new File([E],`photo-${Date.now()}-${w}.jpg`,{type:"image/jpeg"})}}catch(_){return console.error("Failed to convert photo to File:",_),null}}))).filter(Boolean);return console.log(` Regular picker success: ${x.length} files converted`),x}catch(g){const y=g instanceof Error?g.message:String(g);return y.includes("cancelled")||y.includes("canceled")||y.includes("User cancelled")||y.includes("CropEditor cancelled")?(console.log(" Event photo picker: User cancelled operation"),[]):(console.error(" Event photo picker failed:",g),t({title:"Photo selection failed",description:y,variant:"destructive"}),[])}finally{console.log(` Finally block - resetting state for call ${h}`),setTimeout(()=>{e(!1),r.current=null,i.current&&(clearTimeout(i.current),i.current=null),window.dispatchEvent(new Event("resetPhotoPicker")),console.log(` State reset complete for call ${h}`)},100)}},c=()=>new Promise(u=>{const h=document.createElement("input");h.type="file",h.accept="image/*",h.multiple=!0;const d=()=>{try{h.parentNode&&h.parentNode.removeChild(h)}catch{}};h.onchange=p=>{const m=Array.from(p.target.files||[]);console.log("Web picker selected files:",m.length),d(),u(m)},h.oncancel=()=>{console.log("Web file picker cancelled"),d(),u([])},setTimeout(d,6e4),h.click()});return{pickEventPhotos:l,isPickingPhotos:n}};let Pi=null;const qy=n=>{Pi=n},V4=()=>{const[n,e]=b.useState(!1),{toast:t}=Bt();b.useEffect(()=>{var i;console.log(" Camera hook initialized - checking available features"),console.log(" Available Capacitor plugins:",Object.keys(((i=window.Capacitor)==null?void 0:i.Plugins)||{})),console.log(" Photo editor launcher available:",!!Pi)},[]);const r=b.useCallback(async i=>{var o,a;if(n)return null;e(!0),console.log(" Starting camera capture process...",{isNative:de.isNativePlatform(),platform:de.getPlatform(),timestamp:new Date().toISOString()});try{if(!de.isNativePlatform())return await s();const l=await Id.getPhoto({quality:90,allowEditing:!1,resultType:sd.Uri,source:Us.Camera,presentationStyle:"popover"});if(console.log(" Standard camera response received:",{platform:de.getPlatform(),hasWebPath:!!l.webPath,hasPath:!!l.path,webPath:l.webPath,path:l.path,format:l.format,timestamp:new Date().toISOString()}),!l.webPath&&!l.path)return console.log(" No image path received"),null;let c=l.webPath||l.path,u=!1;if(de.getPlatform()==="ios"){console.log(" iOS detected: Will launch PhotoEditorPlugin next"),console.log(" Next hook: PhotoEditorPlugin.editPhoto() for photo editing");try{const d=(a=(o=window.Capacitor)==null?void 0:o.Plugins)==null?void 0:a.PhotoEditorPlugin;if(d){console.log(" Launching iOS photo editor with path:",c);const p=document.createElement("div");p.style.cssText=`
              position: fixed;
              top: 0;
              left: 0;
              width: 100%;
              height: 100%;
              background: black;
              z-index: 99999;
              display: flex;
              align-items: center;
              justify-content: center;
            `,p.innerHTML='<div style="color: white; font-size: 18px;">Opening Photo Editor...</div>',document.body.appendChild(p),await new Promise(g=>setTimeout(g,50));const m=await d.editPhoto({imagePath:c});document.body.removeChild(p),m.success&&(console.log(" iOS photo editing completed:",{changes:m.changes,editedPath:m.editedPath}),c=m.editedPath,u=!0)}else if(console.log(" PhotoEditorPlugin not available, trying web editor fallback"),Pi||window.launchPhotoEditor)try{console.log(" Trying web photo editor fallback on iOS");const m=await(Pi||window.launchPhotoEditor)(c);m!=null&&m.edited&&(m!=null&&m.webPath)&&(console.log(" Web photo editor succeeded on iOS"),c=m.webPath,u=!0)}catch(p){console.log(" Web photo editor also failed on iOS:",p)}}catch(d){console.error(" iOS photo editing failed:",d);const p=document.querySelector('div[style*="z-index: 99999"]');p&&p.remove()}}else if(de.getPlatform()==="android"&&(console.log(" Android: Trying web photo editor"),Pi||window.launchPhotoEditor))try{console.log(" Launching web photo editor on Android");const p=await(Pi||window.launchPhotoEditor)(c);p!=null&&p.edited&&(p!=null&&p.webPath)&&(console.log(" Web photo editor succeeded on Android"),c=p.webPath,u=!0)}catch(d){console.log(" Web photo editor failed on Android:",d)}let h;if(l.dataUrl&&fo(l.dataUrl))console.log(" Using dataUrl for file conversion (avoiding CSP restrictions)"),h=ec(l.dataUrl,`camera-${Date.now()}.jpg`,"image/jpeg");else{const p=await(await fetch(c)).blob();h=new File([p],`camera-${Date.now()}.jpg`,{type:"image/jpeg"})}return console.log(" Final camera file created:",{name:h.name,size:h.size,type:h.type,edited:u,platform:de.getPlatform()}),h}catch(l){const c=l instanceof Error?l.message:"Failed to open camera";return c.toLowerCase().includes("cancelled")||c.toLowerCase().includes("canceled")?(console.log(" Camera cancelled by user"),null):(console.error(" Camera capture failed:",l),t({title:"Camera Failed",description:c,variant:"destructive"}),null)}finally{e(!1)}},[n,t]),s=async()=>new Promise(async i=>{const o=document.createElement("input");o.type="file",o.accept="image/*",o.capture="environment",o.onchange=async a=>{var c;const l=(c=a.target.files)==null?void 0:c[0];if(!l){i(null);return}try{if(Pi||window.launchPhotoEditor){const u=await new Promise(p=>{const m=new FileReader;m.onload=()=>p(m.result),m.readAsDataURL(l)});console.log(" Launching web photo editor for file picker photo");const d=await(Pi||window.launchPhotoEditor)(u);if(d!=null&&d.edited&&(d!=null&&d.webPath)){console.log(" Photo edited successfully");const m=await(await fetch(d.webPath)).blob();i(new File([m],l.name,{type:l.type}));return}}}catch(u){console.log(" Photo editor skipped or failed, using original photo:",u)}i(l)},o.oncancel=()=>i(null),o.click()});return{takePicture:r,isTakingPicture:n}},DH=Object.freeze(Object.defineProperty({__proto__:null,setPhotoEditorLauncher:qy,useCameraPicture:V4},Symbol.toStringTag,{value:"Module"}));function V(n,e,t){return(e=function(r){var s=function(i,o){if(typeof i!="object"||!i)return i;var a=i[Symbol.toPrimitive];if(a!==void 0){var l=a.call(i,o||"default");if(typeof l!="object")return l;throw new TypeError("@@toPrimitive must return a primitive value.")}return(o==="string"?String:Number)(i)}(r,"string");return typeof s=="symbol"?s:s+""}(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function PC(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);e&&(r=r.filter(function(s){return Object.getOwnPropertyDescriptor(n,s).enumerable})),t.push.apply(t,r)}return t}function q(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?PC(Object(t),!0).forEach(function(r){V(n,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):PC(Object(t)).forEach(function(r){Object.defineProperty(n,r,Object.getOwnPropertyDescriptor(t,r))})}return n}function Ct(n,e){if(n==null)return{};var t,r,s=function(o,a){if(o==null)return{};var l={};for(var c in o)if({}.hasOwnProperty.call(o,c)){if(a.indexOf(c)>=0)continue;l[c]=o[c]}return l}(n,e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(n);for(r=0;r<i.length;r++)t=i[r],e.indexOf(t)>=0||{}.propertyIsEnumerable.call(n,t)&&(s[t]=n[t])}return s}function Co(n,e){return e||(e=n.slice(0)),Object.freeze(Object.defineProperties(n,{raw:{value:Object.freeze(e)}}))}class TC{constructor(){V(this,"browserShadowBlurConstant",1),V(this,"DPI",96),V(this,"devicePixelRatio",typeof window<"u"?window.devicePixelRatio:1),V(this,"perfLimitSizeTotal",2097152),V(this,"maxCacheSideLimit",4096),V(this,"minCacheSideLimit",256),V(this,"disableStyleCopyPaste",!1),V(this,"enableGLFiltering",!0),V(this,"textureSize",4096),V(this,"forceGLPutImageData",!1),V(this,"cachesBoundsOfCurve",!1),V(this,"fontPaths",{}),V(this,"NUM_FRACTION_DIGITS",4)}}const nt=new class extends TC{constructor(n){super(),this.configure(n)}configure(){let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Object.assign(this,n)}addFonts(){let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.fontPaths=q(q({},this.fontPaths),n)}removeFonts(){(arguments.length>0&&arguments[0]!==void 0?arguments[0]:[]).forEach(n=>{delete this.fontPaths[n]})}clearFonts(){this.fontPaths={}}restoreDefaults(n){const e=new TC,t=(n==null?void 0:n.reduce((r,s)=>(r[s]=e[s],r),{}))||e;this.configure(t)}},po=function(n){for(var e=arguments.length,t=new Array(e>1?e-1:0),r=1;r<e;r++)t[r-1]=arguments[r];return console[n]("fabric",...t)};class fs extends Error{constructor(e,t){super("fabric: ".concat(e),t)}}class OH extends fs{constructor(e){super("".concat(e," 'options.signal' is in 'aborted' state"))}}class IH{}let RH=class extends IH{testPrecision(e,t){const r="precision ".concat(t,` float;
void main(){}`),s=e.createShader(e.FRAGMENT_SHADER);return!!s&&(e.shaderSource(s,r),e.compileShader(s),!!e.getShaderParameter(s,e.COMPILE_STATUS))}queryWebGL(e){const t=e.getContext("webgl");t&&(this.maxTextureSize=t.getParameter(t.MAX_TEXTURE_SIZE),this.GLPrecision=["highp","mediump","lowp"].find(r=>this.testPrecision(t,r)),t.getExtension("WEBGL_lose_context").loseContext(),po("log","WebGL: max texture size ".concat(this.maxTextureSize)))}isSupported(e){return!!this.maxTextureSize&&this.maxTextureSize>=e}};const NH={};let AC;const xs=()=>AC||(AC={document,window,isTouchSupported:"ontouchstart"in window||"ontouchstart"in document||window&&window.navigator&&window.navigator.maxTouchPoints>0,WebGLProbe:new RH,dispose(){},copyPasteData:NH}),gc=()=>xs().document,g1=()=>xs().window,G4=()=>{var n;return Math.max((n=nt.devicePixelRatio)!==null&&n!==void 0?n:g1().devicePixelRatio,1)},_u=new class{constructor(){V(this,"charWidthsCache",{}),V(this,"boundsOfCurveCache",{})}getFontCache(n){let{fontFamily:e,fontStyle:t,fontWeight:r}=n;e=e.toLowerCase(),this.charWidthsCache[e]||(this.charWidthsCache[e]={});const s=this.charWidthsCache[e],i="".concat(t.toLowerCase(),"_").concat((r+"").toLowerCase());return s[i]||(s[i]={}),s[i]}clearFontCache(n){(n=(n||"").toLowerCase())?this.charWidthsCache[n]&&delete this.charWidthsCache[n]:this.charWidthsCache={}}limitDimsByArea(n){const{perfLimitSizeTotal:e}=nt,t=Math.sqrt(e*n);return[Math.floor(t),Math.floor(e/t)]}},Yy="6.4.3";function mf(){}const Rd=Math.PI/2,up=2*Math.PI,m1=Math.PI/180,Fn=Object.freeze([1,0,0,1,0,0]),v1=16,_i=.4477152502,qe="center",lt="left",Qn="top",Xy="bottom",Lt="right",Zn="none",y1=/\r?\n/,q4="moving",S0="scaling",Y4="rotating",x1="rotate",X4="skewing",id="resizing",jH="modifyPoly",LH="modifyPath",dp="changed",C0="scale",nr="scaleX",Dr="scaleY",mc="skewX",vc="skewY",Gt="fill",er="stroke",hp="modified",Ma="json",Yg="svg",me=new class{constructor(){this[Ma]=new Map,this[Yg]=new Map}has(n){return this[Ma].has(n)}getClass(n){const e=this[Ma].get(n);if(!e)throw new fs("No class registered for ".concat(n));return e}setClass(n,e){e?this[Ma].set(e,n):(this[Ma].set(n.type,n),this[Ma].set(n.type.toLowerCase(),n))}getSVGClass(n){return this[Yg].get(n)}setSVGClass(n,e){this[Yg].set(e??n.type.toLowerCase(),n)}},fp=new class extends Array{remove(n){const e=this.indexOf(n);e>-1&&this.splice(e,1)}cancelAll(){const n=this.splice(0);return n.forEach(e=>e.abort()),n}cancelByCanvas(n){if(!n)return[];const e=this.filter(t=>{var r;return t.target===n||typeof t.target=="object"&&((r=t.target)===null||r===void 0?void 0:r.canvas)===n});return e.forEach(t=>t.abort()),e}cancelByTarget(n){if(!n)return[];const e=this.filter(t=>t.target===n);return e.forEach(t=>t.abort()),e}};class MH{constructor(){V(this,"__eventListeners",{})}on(e,t){if(this.__eventListeners||(this.__eventListeners={}),typeof e=="object")return Object.entries(e).forEach(r=>{let[s,i]=r;this.on(s,i)}),()=>this.off(e);if(t){const r=e;return this.__eventListeners[r]||(this.__eventListeners[r]=[]),this.__eventListeners[r].push(t),()=>this.off(r,t)}return()=>!1}once(e,t){if(typeof e=="object"){const r=[];return Object.entries(e).forEach(s=>{let[i,o]=s;r.push(this.once(i,o))}),()=>r.forEach(s=>s())}if(t){const r=this.on(e,function(){for(var s=arguments.length,i=new Array(s),o=0;o<s;o++)i[o]=arguments[o];t.call(this,...i),r()});return r}return()=>!1}_removeEventListener(e,t){if(this.__eventListeners[e])if(t){const r=this.__eventListeners[e],s=r.indexOf(t);s>-1&&r.splice(s,1)}else this.__eventListeners[e]=[]}off(e,t){if(this.__eventListeners)if(e===void 0)for(const r in this.__eventListeners)this._removeEventListener(r);else typeof e=="object"?Object.entries(e).forEach(r=>{let[s,i]=r;this._removeEventListener(s,i)}):this._removeEventListener(e,t)}fire(e,t){var r;if(!this.__eventListeners)return;const s=(r=this.__eventListeners[e])===null||r===void 0?void 0:r.concat();if(s)for(let i=0;i<s.length;i++)s[i].call(this,t||{})}}const Va=(n,e)=>{const t=n.indexOf(e);return t!==-1&&n.splice(t,1),n},ai=n=>{if(n===0)return 1;switch(Math.abs(n)/Rd){case 1:case 3:return 0;case 2:return-1}return Math.cos(n)},li=n=>{if(n===0)return 0;const e=n/Rd,t=Math.sign(n);switch(e){case 1:return t;case 2:return 0;case 3:return-t}return Math.sin(n)};class Z{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;typeof e=="object"?(this.x=e.x,this.y=e.y):(this.x=e,this.y=t)}add(e){return new Z(this.x+e.x,this.y+e.y)}addEquals(e){return this.x+=e.x,this.y+=e.y,this}scalarAdd(e){return new Z(this.x+e,this.y+e)}scalarAddEquals(e){return this.x+=e,this.y+=e,this}subtract(e){return new Z(this.x-e.x,this.y-e.y)}subtractEquals(e){return this.x-=e.x,this.y-=e.y,this}scalarSubtract(e){return new Z(this.x-e,this.y-e)}scalarSubtractEquals(e){return this.x-=e,this.y-=e,this}multiply(e){return new Z(this.x*e.x,this.y*e.y)}scalarMultiply(e){return new Z(this.x*e,this.y*e)}scalarMultiplyEquals(e){return this.x*=e,this.y*=e,this}divide(e){return new Z(this.x/e.x,this.y/e.y)}scalarDivide(e){return new Z(this.x/e,this.y/e)}scalarDivideEquals(e){return this.x/=e,this.y/=e,this}eq(e){return this.x===e.x&&this.y===e.y}lt(e){return this.x<e.x&&this.y<e.y}lte(e){return this.x<=e.x&&this.y<=e.y}gt(e){return this.x>e.x&&this.y>e.y}gte(e){return this.x>=e.x&&this.y>=e.y}lerp(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:.5;return t=Math.max(Math.min(1,t),0),new Z(this.x+(e.x-this.x)*t,this.y+(e.y-this.y)*t)}distanceFrom(e){const t=this.x-e.x,r=this.y-e.y;return Math.sqrt(t*t+r*r)}midPointFrom(e){return this.lerp(e)}min(e){return new Z(Math.min(this.x,e.x),Math.min(this.y,e.y))}max(e){return new Z(Math.max(this.x,e.x),Math.max(this.y,e.y))}toString(){return"".concat(this.x,",").concat(this.y)}setXY(e,t){return this.x=e,this.y=t,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setFromPoint(e){return this.x=e.x,this.y=e.y,this}swap(e){const t=this.x,r=this.y;this.x=e.x,this.y=e.y,e.x=t,e.y=r}clone(){return new Z(this.x,this.y)}rotate(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:w1;const r=li(e),s=ai(e),i=this.subtract(t);return new Z(i.x*s-i.y*r,i.x*r+i.y*s).add(t)}transform(e){let t=arguments.length>1&&arguments[1]!==void 0&&arguments[1];return new Z(e[0]*this.x+e[2]*this.y+(t?0:e[4]),e[1]*this.x+e[3]*this.y+(t?0:e[5]))}}const w1=new Z(0,0),vf=n=>!!n&&Array.isArray(n._objects);function K4(n){class e extends n{constructor(){super(...arguments),V(this,"_objects",[])}_onObjectAdded(r){}_onObjectRemoved(r){}_onStackOrderChanged(r){}add(){for(var r=arguments.length,s=new Array(r),i=0;i<r;i++)s[i]=arguments[i];const o=this._objects.push(...s);return s.forEach(a=>this._onObjectAdded(a)),o}insertAt(r){for(var s=arguments.length,i=new Array(s>1?s-1:0),o=1;o<s;o++)i[o-1]=arguments[o];return this._objects.splice(r,0,...i),i.forEach(a=>this._onObjectAdded(a)),this._objects.length}remove(){const r=this._objects,s=[];for(var i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];return o.forEach(l=>{const c=r.indexOf(l);c!==-1&&(r.splice(c,1),s.push(l),this._onObjectRemoved(l))}),s}forEachObject(r){this.getObjects().forEach((s,i,o)=>r(s,i,o))}getObjects(){for(var r=arguments.length,s=new Array(r),i=0;i<r;i++)s[i]=arguments[i];return s.length===0?[...this._objects]:this._objects.filter(o=>o.isType(...s))}item(r){return this._objects[r]}isEmpty(){return this._objects.length===0}size(){return this._objects.length}contains(r,s){return!!this._objects.includes(r)||!!s&&this._objects.some(i=>i instanceof e&&i.contains(r,!0))}complexity(){return this._objects.reduce((r,s)=>r+=s.complexity?s.complexity():0,0)}sendObjectToBack(r){return!(!r||r===this._objects[0])&&(Va(this._objects,r),this._objects.unshift(r),this._onStackOrderChanged(r),!0)}bringObjectToFront(r){return!(!r||r===this._objects[this._objects.length-1])&&(Va(this._objects,r),this._objects.push(r),this._onStackOrderChanged(r),!0)}sendObjectBackwards(r,s){if(!r)return!1;const i=this._objects.indexOf(r);if(i!==0){const o=this.findNewLowerIndex(r,i,s);return Va(this._objects,r),this._objects.splice(o,0,r),this._onStackOrderChanged(r),!0}return!1}bringObjectForward(r,s){if(!r)return!1;const i=this._objects.indexOf(r);if(i!==this._objects.length-1){const o=this.findNewUpperIndex(r,i,s);return Va(this._objects,r),this._objects.splice(o,0,r),this._onStackOrderChanged(r),!0}return!1}moveObjectTo(r,s){return r!==this._objects[s]&&(Va(this._objects,r),this._objects.splice(s,0,r),this._onStackOrderChanged(r),!0)}findNewLowerIndex(r,s,i){let o;if(i){o=s;for(let a=s-1;a>=0;--a)if(r.isOverlapping(this._objects[a])){o=a;break}}else o=s-1;return o}findNewUpperIndex(r,s,i){let o;if(i){o=s;for(let a=s+1;a<this._objects.length;++a)if(r.isOverlapping(this._objects[a])){o=a;break}}else o=s+1;return o}collectObjects(r){let{left:s,top:i,width:o,height:a}=r,{includeIntersecting:l=!0}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const c=[],u=new Z(s,i),h=u.add(new Z(o,a));for(let d=this._objects.length-1;d>=0;d--){const p=this._objects[d];p.selectable&&p.visible&&(l&&p.intersectsWithRect(u,h)||p.isContainedWithinRect(u,h)||l&&p.containsPoint(u)||l&&p.containsPoint(h))&&c.push(p)}return c}}return e}class J4 extends MH{_setOptions(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};for(const t in e)this.set(t,e[t])}_setObject(e){for(const t in e)this._set(t,e[t])}set(e,t){return typeof e=="object"?this._setObject(e):this._set(e,t),this}_set(e,t){this[e]=t}toggle(e){const t=this.get(e);return typeof t=="boolean"&&this.set(e,!t),this}get(e){return this[e]}}function yf(n){return g1().requestAnimationFrame(n)}function FH(n){return g1().cancelAnimationFrame(n)}let BH=0;const go=()=>BH++,Zt=()=>{const n=gc().createElement("canvas");if(!n||n.getContext===void 0)throw new fs("Failed to create `canvas` element");return n},UH=()=>gc().createElement("img"),Q4=(n,e,t)=>n.toDataURL("image/".concat(e),t),Ft=n=>n*m1,ga=n=>n/m1,$H=n=>n.every((e,t)=>e===Fn[t]),Wn=(n,e,t)=>new Z(n).transform(e,t),Xr=n=>{const e=1/(n[0]*n[3]-n[1]*n[2]),t=[e*n[3],-e*n[1],-e*n[2],e*n[0],0,0],{x:r,y:s}=new Z(n[4],n[5]).transform(t,!0);return t[4]=-r,t[5]=-s,t},pn=(n,e,t)=>[n[0]*e[0]+n[2]*e[1],n[1]*e[0]+n[3]*e[1],n[0]*e[2]+n[2]*e[3],n[1]*e[2]+n[3]*e[3],t?0:n[0]*e[4]+n[2]*e[5]+n[4],t?0:n[1]*e[4]+n[3]*e[5]+n[5]],b1=(n,e)=>n.reduceRight((t,r)=>r&&t?pn(r,t,e):r||t,void 0)||Fn.concat(),Z4=n=>{let[e,t]=n;return Math.atan2(t,e)},pp=n=>{const e=Z4(n),t=Math.pow(n[0],2)+Math.pow(n[1],2),r=Math.sqrt(t),s=(n[0]*n[3]-n[2]*n[1])/r,i=Math.atan2(n[0]*n[2]+n[1]*n[3],t);return{angle:ga(e),scaleX:r,scaleY:s,skewX:ga(i),skewY:0,translateX:n[4]||0,translateY:n[5]||0}},Nd=function(n){return[1,0,0,1,n,arguments.length>1&&arguments[1]!==void 0?arguments[1]:0]};function jd(){let{angle:n=0}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},{x:e=0,y:t=0}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const r=Ft(n),s=ai(r),i=li(r);return[s,i,-i,s,e?e-(s*e-i*t):0,t?t-(i*e+s*t):0]}const _1=function(n){return[n,0,0,arguments.length>1&&arguments[1]!==void 0?arguments[1]:n,0,0]},eO=n=>Math.tan(Ft(n)),tO=n=>[1,0,eO(n),1,0,0],nO=n=>[1,eO(n),0,1,0,0],E0=n=>{let{scaleX:e=1,scaleY:t=1,flipX:r=!1,flipY:s=!1,skewX:i=0,skewY:o=0}=n,a=_1(r?-e:e,s?-t:t);return i&&(a=pn(a,tO(i),!0)),o&&(a=pn(a,nO(o),!0)),a},zH=n=>{const{translateX:e=0,translateY:t=0,angle:r=0}=n;let s=Nd(e,t);r&&(s=pn(s,jd({angle:r})));const i=E0(n);return $H(i)||(s=pn(s,i)),s},xf=function(n){let{signal:e,crossOrigin:t=null}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return new Promise(function(r,s){if(e&&e.aborted)return s(new OH("loadImage"));const i=UH();let o;e&&(o=function(l){i.src="",s(l)},e.addEventListener("abort",o,{once:!0}));const a=function(){i.onload=i.onerror=null,o&&(e==null||e.removeEventListener("abort",o)),r(i)};n?(i.onload=a,i.onerror=function(){o&&(e==null||e.removeEventListener("abort",o)),s(new fs("Error loading ".concat(i.src)))},t&&(i.crossOrigin=t),i.src=n):a()})},od=function(n){let{signal:e,reviver:t=mf}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return new Promise((r,s)=>{const i=[];e&&e.addEventListener("abort",s,{once:!0}),Promise.all(n.map(o=>me.getClass(o.type).fromObject(o,{signal:e}).then(a=>(t(o,a),i.push(a),a)))).then(r).catch(o=>{i.forEach(a=>{a.dispose&&a.dispose()}),s(o)}).finally(()=>{e&&e.removeEventListener("abort",s)})})},k0=function(n){let{signal:e}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return new Promise((t,r)=>{const s=[];e&&e.addEventListener("abort",r,{once:!0});const i=Object.values(n).map(a=>a&&a.type&&me.has(a.type)?od([a],{signal:e}).then(l=>{let[c]=l;return s.push(c),c}):a),o=Object.keys(n);Promise.all(i).then(a=>a.reduce((l,c,u)=>(l[o[u]]=c,l),{})).then(t).catch(a=>{s.forEach(l=>{l.dispose&&l.dispose()}),r(a)}).finally(()=>{e&&e.removeEventListener("abort",r)})})},yc=function(n){return(arguments.length>1&&arguments[1]!==void 0?arguments[1]:[]).reduce((e,t)=>(t in n&&(e[t]=n[t]),e),{})},S1=(n,e)=>Object.keys(n).reduce((t,r)=>(e(n[r],r,n)&&(t[r]=n[r]),t),{}),DC={aliceblue:"#F0F8FF",antiquewhite:"#FAEBD7",aqua:"#0FF",aquamarine:"#7FFFD4",azure:"#F0FFFF",beige:"#F5F5DC",bisque:"#FFE4C4",black:"#000",blanchedalmond:"#FFEBCD",blue:"#00F",blueviolet:"#8A2BE2",brown:"#A52A2A",burlywood:"#DEB887",cadetblue:"#5F9EA0",chartreuse:"#7FFF00",chocolate:"#D2691E",coral:"#FF7F50",cornflowerblue:"#6495ED",cornsilk:"#FFF8DC",crimson:"#DC143C",cyan:"#0FF",darkblue:"#00008B",darkcyan:"#008B8B",darkgoldenrod:"#B8860B",darkgray:"#A9A9A9",darkgrey:"#A9A9A9",darkgreen:"#006400",darkkhaki:"#BDB76B",darkmagenta:"#8B008B",darkolivegreen:"#556B2F",darkorange:"#FF8C00",darkorchid:"#9932CC",darkred:"#8B0000",darksalmon:"#E9967A",darkseagreen:"#8FBC8F",darkslateblue:"#483D8B",darkslategray:"#2F4F4F",darkslategrey:"#2F4F4F",darkturquoise:"#00CED1",darkviolet:"#9400D3",deeppink:"#FF1493",deepskyblue:"#00BFFF",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1E90FF",firebrick:"#B22222",floralwhite:"#FFFAF0",forestgreen:"#228B22",fuchsia:"#F0F",gainsboro:"#DCDCDC",ghostwhite:"#F8F8FF",gold:"#FFD700",goldenrod:"#DAA520",gray:"#808080",grey:"#808080",green:"#008000",greenyellow:"#ADFF2F",honeydew:"#F0FFF0",hotpink:"#FF69B4",indianred:"#CD5C5C",indigo:"#4B0082",ivory:"#FFFFF0",khaki:"#F0E68C",lavender:"#E6E6FA",lavenderblush:"#FFF0F5",lawngreen:"#7CFC00",lemonchiffon:"#FFFACD",lightblue:"#ADD8E6",lightcoral:"#F08080",lightcyan:"#E0FFFF",lightgoldenrodyellow:"#FAFAD2",lightgray:"#D3D3D3",lightgrey:"#D3D3D3",lightgreen:"#90EE90",lightpink:"#FFB6C1",lightsalmon:"#FFA07A",lightseagreen:"#20B2AA",lightskyblue:"#87CEFA",lightslategray:"#789",lightslategrey:"#789",lightsteelblue:"#B0C4DE",lightyellow:"#FFFFE0",lime:"#0F0",limegreen:"#32CD32",linen:"#FAF0E6",magenta:"#F0F",maroon:"#800000",mediumaquamarine:"#66CDAA",mediumblue:"#0000CD",mediumorchid:"#BA55D3",mediumpurple:"#9370DB",mediumseagreen:"#3CB371",mediumslateblue:"#7B68EE",mediumspringgreen:"#00FA9A",mediumturquoise:"#48D1CC",mediumvioletred:"#C71585",midnightblue:"#191970",mintcream:"#F5FFFA",mistyrose:"#FFE4E1",moccasin:"#FFE4B5",navajowhite:"#FFDEAD",navy:"#000080",oldlace:"#FDF5E6",olive:"#808000",olivedrab:"#6B8E23",orange:"#FFA500",orangered:"#FF4500",orchid:"#DA70D6",palegoldenrod:"#EEE8AA",palegreen:"#98FB98",paleturquoise:"#AFEEEE",palevioletred:"#DB7093",papayawhip:"#FFEFD5",peachpuff:"#FFDAB9",peru:"#CD853F",pink:"#FFC0CB",plum:"#DDA0DD",powderblue:"#B0E0E6",purple:"#800080",rebeccapurple:"#639",red:"#F00",rosybrown:"#BC8F8F",royalblue:"#4169E1",saddlebrown:"#8B4513",salmon:"#FA8072",sandybrown:"#F4A460",seagreen:"#2E8B57",seashell:"#FFF5EE",sienna:"#A0522D",silver:"#C0C0C0",skyblue:"#87CEEB",slateblue:"#6A5ACD",slategray:"#708090",slategrey:"#708090",snow:"#FFFAFA",springgreen:"#00FF7F",steelblue:"#4682B4",tan:"#D2B48C",teal:"#008080",thistle:"#D8BFD8",tomato:"#FF6347",turquoise:"#40E0D0",violet:"#EE82EE",wheat:"#F5DEB3",white:"#FFF",whitesmoke:"#F5F5F5",yellow:"#FF0",yellowgreen:"#9ACD32"},Xg=(n,e,t)=>(t<0&&(t+=1),t>1&&(t-=1),t<1/6?n+6*(e-n)*t:t<.5?e:t<2/3?n+(e-n)*(2/3-t)*6:n),OC=(n,e,t,r)=>{n/=255,e/=255,t/=255;const s=Math.max(n,e,t),i=Math.min(n,e,t);let o,a;const l=(s+i)/2;if(s===i)o=a=0;else{const c=s-i;switch(a=l>.5?c/(2-s-i):c/(s+i),s){case n:o=(e-t)/c+(e<t?6:0);break;case e:o=(t-n)/c+2;break;case t:o=(n-e)/c+4}o/=6}return[Math.round(360*o),Math.round(100*a),Math.round(100*l),r]},IC=function(){let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"1";return parseFloat(n)/(n.endsWith("%")?100:1)},mh=n=>Math.min(Math.round(n),255).toString(16).toUpperCase().padStart(2,"0"),RC=n=>{let[e,t,r,s=1]=n;const i=Math.round(.3*e+.59*t+.11*r);return[i,i,i,s]};class dt{constructor(e){if(V(this,"isUnrecognised",!1),e)if(e instanceof dt)this.setSource([...e._source]);else if(Array.isArray(e)){const[t,r,s,i=1]=e;this.setSource([t,r,s,i])}else this.setSource(this._tryParsingColor(e));else this.setSource([0,0,0,1])}_tryParsingColor(e){return e in DC&&(e=DC[e]),e==="transparent"?[255,255,255,0]:dt.sourceFromHex(e)||dt.sourceFromRgb(e)||dt.sourceFromHsl(e)||(this.isUnrecognised=!0)&&[0,0,0,1]}getSource(){return this._source}setSource(e){this._source=e}toRgb(){const[e,t,r]=this.getSource();return"rgb(".concat(e,",").concat(t,",").concat(r,")")}toRgba(){return"rgba(".concat(this.getSource().join(","),")")}toHsl(){const[e,t,r]=OC(...this.getSource());return"hsl(".concat(e,",").concat(t,"%,").concat(r,"%)")}toHsla(){const[e,t,r,s]=OC(...this.getSource());return"hsla(".concat(e,",").concat(t,"%,").concat(r,"%,").concat(s,")")}toHex(){return this.toHexa().slice(0,6)}toHexa(){const[e,t,r,s]=this.getSource();return"".concat(mh(e)).concat(mh(t)).concat(mh(r)).concat(mh(Math.round(255*s)))}getAlpha(){return this.getSource()[3]}setAlpha(e){return this._source[3]=e,this}toGrayscale(){return this.setSource(RC(this.getSource())),this}toBlackWhite(e){const[t,,,r]=RC(this.getSource()),s=t<(e||127)?0:255;return this.setSource([s,s,s,r]),this}overlayWith(e){e instanceof dt||(e=new dt(e));const t=this.getSource(),r=e.getSource(),[s,i,o]=t.map((a,l)=>Math.round(.5*a+.5*r[l]));return this.setSource([s,i,o,t[3]]),this}static fromRgb(e){return dt.fromRgba(e)}static fromRgba(e){return new dt(dt.sourceFromRgb(e))}static sourceFromRgb(e){const t=e.match(/^rgba?\(\s*(\d{0,3}(?:\.\d+)?%?)\s*[\s|,]\s*(\d{0,3}(?:\.\d+)?%?)\s*[\s|,]\s*(\d{0,3}(?:\.\d+)?%?)\s*(?:\s*[,/]\s*(\d{0,3}(?:\.\d+)?%?)\s*)?\)$/i);if(t){const[r,s,i]=t.slice(1,4).map(o=>{const a=parseFloat(o);return o.endsWith("%")?Math.round(2.55*a):a});return[r,s,i,IC(t[4])]}}static fromHsl(e){return dt.fromHsla(e)}static fromHsla(e){return new dt(dt.sourceFromHsl(e))}static sourceFromHsl(e){const t=e.match(/^hsla?\(\s*([+-]?\d{0,3}(?:\.\d+)?(?:deg|turn|rad)?)\s*[\s|,]\s*(\d{0,3}(?:\.\d+)?%?)\s*[\s|,]\s*(\d{0,3}(?:\.\d+)?%?)\s*(?:\s*[,/]\s*(\d*(?:\.\d+)?%?)\s*)?\)$/i);if(!t)return;const r=(dt.parseAngletoDegrees(t[1])%360+360)%360/360,s=parseFloat(t[2])/100,i=parseFloat(t[3])/100;let o,a,l;if(s===0)o=a=l=i;else{const c=i<=.5?i*(s+1):i+s-i*s,u=2*i-c;o=Xg(u,c,r+1/3),a=Xg(u,c,r),l=Xg(u,c,r-1/3)}return[Math.round(255*o),Math.round(255*a),Math.round(255*l),IC(t[4])]}static fromHex(e){return new dt(dt.sourceFromHex(e))}static sourceFromHex(e){if(e.match(/^#?(([0-9a-f]){3,4}|([0-9a-f]{2}){3,4})$/i)){const t=e.slice(e.indexOf("#")+1);let r;r=t.length<=4?t.split("").map(l=>l+l):t.match(/.{2}/g);const[s,i,o,a=255]=r.map(l=>parseInt(l,16));return[s,i,o,a/255]}}static parseAngletoDegrees(e){const t=e.toLowerCase(),r=parseFloat(t);return t.includes("rad")?ga(r):t.includes("turn")?360*r:r}}const Tt=(n,e)=>parseFloat(Number(n).toFixed(e)),Cl=function(n){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:v1;const t=/\D{0,2}$/.exec(n),r=parseFloat(n),s=nt.DPI;switch(t==null?void 0:t[0]){case"mm":return r*s/25.4;case"cm":return r*s/2.54;case"in":return r*s;case"pt":return r*s/72;case"pc":return r*s/72*12;case"em":return r*e;default:return r}},WH=n=>{const[e,t]=n.trim().split(" "),[r,s]=(i=e)&&i!==Zn?[i.slice(1,4),i.slice(5,8)]:i===Zn?[i,i]:["Mid","Mid"];var i;return{meetOrSlice:t||"meet",alignX:r,alignY:s}},gp=n=>"matrix("+n.map(e=>Tt(e,nt.NUM_FRACTION_DIGITS)).join(" ")+")",ad=function(n,e){let t,r,s=!(arguments.length>2&&arguments[2]!==void 0)||arguments[2];if(e)if(e.toLive)t="url(#SVGID_".concat(e.id,")");else{const i=new dt(e),o=i.getAlpha();t=i.toRgb(),o!==1&&(r=o.toString())}else t="none";return s?"".concat(n,": ").concat(t,"; ").concat(r?"".concat(n,"-opacity: ").concat(r,"; "):""):"".concat(n,'="').concat(t,'" ').concat(r?"".concat(n,'-opacity="').concat(r,'" '):"")},Sr=n=>!!n&&n.toLive!==void 0,NC=n=>!!n&&typeof n.toObject=="function",jC=n=>!!n&&n.offsetX!==void 0&&"source"in n,rO=n=>!!n&&typeof n._renderText=="function",Wo=n=>!!n&&"multiSelectionStacking"in n;function sO(n){const e=n&&qr(n);let t=0,r=0;if(!n||!e)return{left:t,top:r};let s=n;const i=e.documentElement,o=e.body||{scrollLeft:0,scrollTop:0};for(;s&&(s.parentNode||s.host)&&(s=s.parentNode||s.host,s===e?(t=o.scrollLeft||i.scrollLeft||0,r=o.scrollTop||i.scrollTop||0):(t+=s.scrollLeft||0,r+=s.scrollTop||0),s.nodeType!==1||s.style.position!=="fixed"););return{left:t,top:r}}const qr=n=>n.ownerDocument||null,iO=n=>{var e;return((e=n.ownerDocument)===null||e===void 0?void 0:e.defaultView)||null},oO=function(n,e,t){let{width:r,height:s}=t,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:1;n.width=r,n.height=s,i>1&&(n.setAttribute("width",(r*i).toString()),n.setAttribute("height",(s*i).toString()),e.scale(i,i))},Ky=(n,e)=>{let{width:t,height:r}=e;t&&(n.style.width=typeof t=="number"?"".concat(t,"px"):t),r&&(n.style.height=typeof r=="number"?"".concat(r,"px"):r)};function LC(n){return n.onselectstart!==void 0&&(n.onselectstart=()=>!1),n.style.userSelect=Zn,n}class aO{constructor(e){V(this,"_originalCanvasStyle",void 0),V(this,"lower",void 0);const t=this.createLowerCanvas(e);this.lower={el:t,ctx:t.getContext("2d")}}createLowerCanvas(e){const t=(r=e)&&r.getContext!==void 0?e:e&&gc().getElementById(e)||Zt();var r;if(t.hasAttribute("data-fabric"))throw new fs("Trying to initialize a canvas that has already been initialized. Did you forget to dispose the canvas?");return this._originalCanvasStyle=t.style.cssText,t.setAttribute("data-fabric","main"),t.classList.add("lower-canvas"),t}cleanupDOM(e){let{width:t,height:r}=e;const{el:s}=this.lower;s.classList.remove("lower-canvas"),s.removeAttribute("data-fabric"),s.setAttribute("width","".concat(t)),s.setAttribute("height","".concat(r)),s.style.cssText=this._originalCanvasStyle||"",this._originalCanvasStyle=void 0}setDimensions(e,t){const{el:r,ctx:s}=this.lower;oO(r,s,e,t)}setCSSDimensions(e){Ky(this.lower.el,e)}calcOffset(){return function(e){var t;const r=e&&qr(e),s={left:0,top:0};if(!r)return s;const i=((t=iO(e))===null||t===void 0?void 0:t.getComputedStyle(e,null))||{};s.left+=parseInt(i.borderLeftWidth,10)||0,s.top+=parseInt(i.borderTopWidth,10)||0,s.left+=parseInt(i.paddingLeft,10)||0,s.top+=parseInt(i.paddingTop,10)||0;let o={left:0,top:0};const a=r.documentElement;e.getBoundingClientRect!==void 0&&(o=e.getBoundingClientRect());const l=sO(e);return{left:o.left+l.left-(a.clientLeft||0)+s.left,top:o.top+l.top-(a.clientTop||0)+s.top}}(this.lower.el)}dispose(){xs().dispose(this.lower.el),delete this.lower}}const HH={backgroundVpt:!0,backgroundColor:"",overlayVpt:!0,overlayColor:"",includeDefaultValues:!0,svgViewportTransformation:!0,renderOnAddRemove:!0,skipOffscreen:!0,enableRetinaScaling:!0,imageSmoothingEnabled:!0,controlsAboveOverlay:!1,allowTouchScrolling:!1,viewportTransform:[...Fn]};class Ld extends K4(J4){get lowerCanvasEl(){var e;return(e=this.elements.lower)===null||e===void 0?void 0:e.el}get contextContainer(){var e;return(e=this.elements.lower)===null||e===void 0?void 0:e.ctx}static getDefaults(){return Ld.ownDefaults}constructor(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(),Object.assign(this,this.constructor.getDefaults()),this.set(t),this.initElements(e),this._setDimensionsImpl({width:this.width||this.elements.lower.el.width||0,height:this.height||this.elements.lower.el.height||0}),this.skipControlsDrawing=!1,this.viewportTransform=[...this.viewportTransform],this.calcViewportBoundaries()}initElements(e){this.elements=new aO(e)}add(){const e=super.add(...arguments);return arguments.length>0&&this.renderOnAddRemove&&this.requestRenderAll(),e}insertAt(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),s=1;s<t;s++)r[s-1]=arguments[s];const i=super.insertAt(e,...r);return r.length>0&&this.renderOnAddRemove&&this.requestRenderAll(),i}remove(){const e=super.remove(...arguments);return e.length>0&&this.renderOnAddRemove&&this.requestRenderAll(),e}_onObjectAdded(e){e.canvas&&e.canvas!==this&&(po("warn",`Canvas is trying to add an object that belongs to a different canvas.
Resulting to default behavior: removing object from previous canvas and adding to new canvas`),e.canvas.remove(e)),e._set("canvas",this),e.setCoords(),this.fire("object:added",{target:e}),e.fire("added",{target:this})}_onObjectRemoved(e){e._set("canvas",void 0),this.fire("object:removed",{target:e}),e.fire("removed",{target:this})}_onStackOrderChanged(){this.renderOnAddRemove&&this.requestRenderAll()}getRetinaScaling(){return this.enableRetinaScaling?G4():1}calcOffset(){return this._offset=this.elements.calcOffset()}getWidth(){return this.width}getHeight(){return this.height}setWidth(e,t){return this.setDimensions({width:e},t)}setHeight(e,t){return this.setDimensions({height:e},t)}_setDimensionsImpl(e){let{cssOnly:t=!1,backstoreOnly:r=!1}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!t){const s=q({width:this.width,height:this.height},e);this.elements.setDimensions(s,this.getRetinaScaling()),this.hasLostContext=!0,this.width=s.width,this.height=s.height}r||this.elements.setCSSDimensions(e),this.calcOffset()}setDimensions(e,t){this._setDimensionsImpl(e,t),t&&t.cssOnly||this.requestRenderAll()}getZoom(){return this.viewportTransform[0]}setViewportTransform(e){this.viewportTransform=e,this.calcViewportBoundaries(),this.renderOnAddRemove&&this.requestRenderAll()}zoomToPoint(e,t){const r=e,s=[...this.viewportTransform],i=Wn(e,Xr(s));s[0]=t,s[3]=t;const o=Wn(i,s);s[4]+=r.x-o.x,s[5]+=r.y-o.y,this.setViewportTransform(s)}setZoom(e){this.zoomToPoint(new Z(0,0),e)}absolutePan(e){const t=[...this.viewportTransform];return t[4]=-e.x,t[5]=-e.y,this.setViewportTransform(t)}relativePan(e){return this.absolutePan(new Z(-e.x-this.viewportTransform[4],-e.y-this.viewportTransform[5]))}getElement(){return this.elements.lower.el}clearContext(e){e.clearRect(0,0,this.width,this.height)}getContext(){return this.elements.lower.ctx}clear(){this.remove(...this.getObjects()),this.backgroundImage=void 0,this.overlayImage=void 0,this.backgroundColor="",this.overlayColor="",this.clearContext(this.getContext()),this.fire("canvas:cleared"),this.renderOnAddRemove&&this.requestRenderAll()}renderAll(){this.cancelRequestedRender(),this.destroyed||this.renderCanvas(this.getContext(),this._objects)}renderAndReset(){this.nextRenderHandle=0,this.renderAll()}requestRenderAll(){this.nextRenderHandle||this.disposed||this.destroyed||(this.nextRenderHandle=yf(()=>this.renderAndReset()))}calcViewportBoundaries(){const e=this.width,t=this.height,r=Xr(this.viewportTransform),s=Wn({x:0,y:0},r),i=Wn({x:e,y:t},r),o=s.min(i),a=s.max(i);return this.vptCoords={tl:o,tr:new Z(a.x,o.y),bl:new Z(o.x,a.y),br:a}}cancelRequestedRender(){this.nextRenderHandle&&(FH(this.nextRenderHandle),this.nextRenderHandle=0)}drawControls(e){}renderCanvas(e,t){if(this.destroyed)return;const r=this.viewportTransform,s=this.clipPath;this.calcViewportBoundaries(),this.clearContext(e),e.imageSmoothingEnabled=this.imageSmoothingEnabled,e.patternQuality="best",this.fire("before:render",{ctx:e}),this._renderBackground(e),e.save(),e.transform(r[0],r[1],r[2],r[3],r[4],r[5]),this._renderObjects(e,t),e.restore(),this.controlsAboveOverlay||this.skipControlsDrawing||this.drawControls(e),s&&(s._set("canvas",this),s.shouldCache(),s._transformDone=!0,s.renderCache({forClipping:!0}),this.drawClipPathOnCanvas(e,s)),this._renderOverlay(e),this.controlsAboveOverlay&&!this.skipControlsDrawing&&this.drawControls(e),this.fire("after:render",{ctx:e}),this.__cleanupTask&&(this.__cleanupTask(),this.__cleanupTask=void 0)}drawClipPathOnCanvas(e,t){const r=this.viewportTransform;e.save(),e.transform(...r),e.globalCompositeOperation="destination-in",t.transform(e),e.scale(1/t.zoomX,1/t.zoomY),e.drawImage(t._cacheCanvas,-t.cacheTranslationX,-t.cacheTranslationY),e.restore()}_renderObjects(e,t){for(let r=0,s=t.length;r<s;++r)t[r]&&t[r].render(e)}_renderBackgroundOrOverlay(e,t){const r=this["".concat(t,"Color")],s=this["".concat(t,"Image")],i=this.viewportTransform,o=this["".concat(t,"Vpt")];if(!r&&!s)return;const a=Sr(r);if(r){if(e.save(),e.beginPath(),e.moveTo(0,0),e.lineTo(this.width,0),e.lineTo(this.width,this.height),e.lineTo(0,this.height),e.closePath(),e.fillStyle=a?r.toLive(e):r,o&&e.transform(...i),a){e.transform(1,0,0,1,r.offsetX||0,r.offsetY||0);const l=r.gradientTransform||r.patternTransform;l&&e.transform(...l)}e.fill(),e.restore()}if(s){e.save();const{skipOffscreen:l}=this;this.skipOffscreen=o,o&&e.transform(...i),s.render(e),this.skipOffscreen=l,e.restore()}}_renderBackground(e){this._renderBackgroundOrOverlay(e,"background")}_renderOverlay(e){this._renderBackgroundOrOverlay(e,"overlay")}getCenter(){return{top:this.height/2,left:this.width/2}}getCenterPoint(){return new Z(this.width/2,this.height/2)}centerObjectH(e){return this._centerObject(e,new Z(this.getCenterPoint().x,e.getCenterPoint().y))}centerObjectV(e){return this._centerObject(e,new Z(e.getCenterPoint().x,this.getCenterPoint().y))}centerObject(e){return this._centerObject(e,this.getCenterPoint())}viewportCenterObject(e){return this._centerObject(e,this.getVpCenter())}viewportCenterObjectH(e){return this._centerObject(e,new Z(this.getVpCenter().x,e.getCenterPoint().y))}viewportCenterObjectV(e){return this._centerObject(e,new Z(e.getCenterPoint().x,this.getVpCenter().y))}getVpCenter(){return Wn(this.getCenterPoint(),Xr(this.viewportTransform))}_centerObject(e,t){e.setXY(t,qe,qe),e.setCoords(),this.renderOnAddRemove&&this.requestRenderAll()}toDatalessJSON(e){return this.toDatalessObject(e)}toObject(e){return this._toObjectMethod("toObject",e)}toJSON(){return this.toObject()}toDatalessObject(e){return this._toObjectMethod("toDatalessObject",e)}_toObjectMethod(e,t){const r=this.clipPath,s=r&&!r.excludeFromExport?this._toObject(r,e,t):null;return q(q(q({version:Yy},yc(this,t)),{},{objects:this._objects.filter(i=>!i.excludeFromExport).map(i=>this._toObject(i,e,t))},this.__serializeBgOverlay(e,t)),s?{clipPath:s}:null)}_toObject(e,t,r){let s;this.includeDefaultValues||(s=e.includeDefaultValues,e.includeDefaultValues=!1);const i=e[t](r);return this.includeDefaultValues||(e.includeDefaultValues=!!s),i}__serializeBgOverlay(e,t){const r={},s=this.backgroundImage,i=this.overlayImage,o=this.backgroundColor,a=this.overlayColor;return Sr(o)?o.excludeFromExport||(r.background=o.toObject(t)):o&&(r.background=o),Sr(a)?a.excludeFromExport||(r.overlay=a.toObject(t)):a&&(r.overlay=a),s&&!s.excludeFromExport&&(r.backgroundImage=this._toObject(s,e,t)),i&&!i.excludeFromExport&&(r.overlayImage=this._toObject(i,e,t)),r}toSVG(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;e.reviver=t;const r=[];return this._setSVGPreamble(r,e),this._setSVGHeader(r,e),this.clipPath&&r.push('<g clip-path="url(#'.concat(this.clipPath.clipPathId,`)" >
`)),this._setSVGBgOverlayColor(r,"background"),this._setSVGBgOverlayImage(r,"backgroundImage",t),this._setSVGObjects(r,t),this.clipPath&&r.push(`</g>
`),this._setSVGBgOverlayColor(r,"overlay"),this._setSVGBgOverlayImage(r,"overlayImage",t),r.push("</svg>"),r.join("")}_setSVGPreamble(e,t){t.suppressPreamble||e.push('<?xml version="1.0" encoding="',t.encoding||"UTF-8",`" standalone="no" ?>
`,'<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" ',`"http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
`)}_setSVGHeader(e,t){const r=t.width||"".concat(this.width),s=t.height||"".concat(this.height),i=nt.NUM_FRACTION_DIGITS,o=t.viewBox;let a;if(o)a='viewBox="'.concat(o.x," ").concat(o.y," ").concat(o.width," ").concat(o.height,'" ');else if(this.svgViewportTransformation){const l=this.viewportTransform;a='viewBox="'.concat(Tt(-l[4]/l[0],i)," ").concat(Tt(-l[5]/l[3],i)," ").concat(Tt(this.width/l[0],i)," ").concat(Tt(this.height/l[3],i),'" ')}else a='viewBox="0 0 '.concat(this.width," ").concat(this.height,'" ');e.push("<svg ",'xmlns="http://www.w3.org/2000/svg" ','xmlns:xlink="http://www.w3.org/1999/xlink" ','version="1.1" ','width="',r,'" ','height="',s,'" ',a,`xml:space="preserve">
`,"<desc>Created with Fabric.js ",Yy,`</desc>
`,`<defs>
`,this.createSVGFontFacesMarkup(),this.createSVGRefElementsMarkup(),this.createSVGClipPathMarkup(t),`</defs>
`)}createSVGClipPathMarkup(e){const t=this.clipPath;return t?(t.clipPathId="CLIPPATH_".concat(go()),'<clipPath id="'.concat(t.clipPathId,`" >
`).concat(t.toClipPathSVG(e.reviver),`</clipPath>
`)):""}createSVGRefElementsMarkup(){return["background","overlay"].map(e=>{const t=this["".concat(e,"Color")];if(Sr(t)){const r=this["".concat(e,"Vpt")],s=this.viewportTransform,i={isType:()=>!1,width:this.width/(r?s[0]:1),height:this.height/(r?s[3]:1)};return t.toSVG(i,{additionalTransform:r?gp(s):""})}}).join("")}createSVGFontFacesMarkup(){const e=[],t={},r=nt.fontPaths;this._objects.forEach(function i(o){e.push(o),vf(o)&&o._objects.forEach(i)}),e.forEach(i=>{if(!rO(i))return;const{styles:o,fontFamily:a}=i;!t[a]&&r[a]&&(t[a]=!0,o&&Object.values(o).forEach(l=>{Object.values(l).forEach(c=>{let{fontFamily:u=""}=c;!t[u]&&r[u]&&(t[u]=!0)})}))});const s=Object.keys(t).map(i=>`		@font-face {
			font-family: '`.concat(i,`';
			src: url('`).concat(r[i],`');
		}
`)).join("");return s?`	<style type="text/css"><![CDATA[
`.concat(s,`]]></style>
`):""}_setSVGObjects(e,t){this.forEachObject(r=>{r.excludeFromExport||this._setSVGObject(e,r,t)})}_setSVGObject(e,t,r){e.push(t.toSVG(r))}_setSVGBgOverlayImage(e,t,r){const s=this[t];s&&!s.excludeFromExport&&s.toSVG&&e.push(s.toSVG(r))}_setSVGBgOverlayColor(e,t){const r=this["".concat(t,"Color")];if(r)if(Sr(r)){const s=r.repeat||"",i=this.width,o=this.height,a=this["".concat(t,"Vpt")]?gp(Xr(this.viewportTransform)):"";e.push('<rect transform="'.concat(a," translate(").concat(i/2,",").concat(o/2,')" x="').concat(r.offsetX-i/2,'" y="').concat(r.offsetY-o/2,'" width="').concat(s!=="repeat-y"&&s!=="no-repeat"||!jC(r)?i:r.source.width,'" height="').concat(s!=="repeat-x"&&s!=="no-repeat"||!jC(r)?o:r.source.height,'" fill="url(#SVGID_').concat(r.id,`)"></rect>
`))}else e.push('<rect x="0" y="0" width="100%" height="100%" ','fill="',r,'"',`></rect>
`)}loadFromJSON(e,t){let{signal:r}=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(!e)return Promise.reject(new fs("`json` is undefined"));const s=typeof e=="string"?JSON.parse(e):e,{objects:i=[],backgroundImage:o,background:a,overlayImage:l,overlay:c,clipPath:u}=s,h=this.renderOnAddRemove;return this.renderOnAddRemove=!1,Promise.all([od(i,{reviver:t,signal:r}),k0({backgroundImage:o,backgroundColor:a,overlayImage:l,overlayColor:c,clipPath:u},{signal:r})]).then(d=>{let[p,m]=d;return this.clear(),this.add(...p),this.set(s),this.set(m),this.renderOnAddRemove=h,this})}clone(e){const t=this.toObject(e);return this.cloneWithoutData().loadFromJSON(t)}cloneWithoutData(){const e=Zt();return e.width=this.width,e.height=this.height,new this.constructor(e)}toDataURL(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{format:t="png",quality:r=1,multiplier:s=1,enableRetinaScaling:i=!1}=e,o=s*(i?this.getRetinaScaling():1);return Q4(this.toCanvasElement(o,e),t,r)}toCanvasElement(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:1,{width:t,height:r,left:s,top:i,filter:o}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const a=(t||this.width)*e,l=(r||this.height)*e,c=this.getZoom(),u=this.width,h=this.height,d=this.skipControlsDrawing,p=c*e,m=this.viewportTransform,g=[p,0,0,p,(m[4]-(s||0))*e,(m[5]-(i||0))*e],y=this.enableRetinaScaling,x=Zt(),v=o?this._objects.filter(w=>o(w)):this._objects;return x.width=a,x.height=l,this.enableRetinaScaling=!1,this.viewportTransform=g,this.width=a,this.height=l,this.skipControlsDrawing=!0,this.calcViewportBoundaries(),this.renderCanvas(x.getContext("2d"),v),this.viewportTransform=m,this.width=u,this.height=h,this.calcViewportBoundaries(),this.enableRetinaScaling=y,this.skipControlsDrawing=d,x}dispose(){return!this.disposed&&this.elements.cleanupDOM({width:this.width,height:this.height}),fp.cancelByCanvas(this),this.disposed=!0,new Promise((e,t)=>{const r=()=>{this.destroy(),e(!0)};r.kill=t,this.__cleanupTask&&this.__cleanupTask.kill("aborted"),this.destroyed?e(!1):this.nextRenderHandle?this.__cleanupTask=r:r()})}destroy(){this.destroyed=!0,this.cancelRequestedRender(),this.forEachObject(e=>e.dispose()),this._objects=[],this.backgroundImage&&this.backgroundImage.dispose(),this.backgroundImage=void 0,this.overlayImage&&this.overlayImage.dispose(),this.overlayImage=void 0,this.elements.dispose()}toString(){return"#<Canvas (".concat(this.complexity(),"): { objects: ").concat(this._objects.length," }>")}}V(Ld,"ownDefaults",HH);const VH=["touchstart","touchmove","touchend"],GH=n=>{const e=sO(n.target),t=function(r){const s=r.changedTouches;return s&&s[0]?s[0]:r}(n);return new Z(t.clientX+e.left,t.clientY+e.top)},Jy=n=>VH.includes(n.type)||n.pointerType==="touch",Qy=n=>{n.preventDefault(),n.stopPropagation()},Xs=n=>{let e=0,t=0,r=0,s=0;for(let i=0,o=n.length;i<o;i++){const{x:a,y:l}=n[i];(a>r||!i)&&(r=a),(a<e||!i)&&(e=a),(l>s||!i)&&(s=l),(l<t||!i)&&(t=l)}return{left:e,top:t,width:r-e,height:s-t}},qH=["translateX","translateY","scaleX","scaleY"],YH=(n,e)=>mp(n,pn(e,n.calcOwnMatrix())),mp=(n,e)=>{const t=pp(e),{translateX:r,translateY:s,scaleX:i,scaleY:o}=t,a=Ct(t,qH),l=new Z(r,s);n.flipX=!1,n.flipY=!1,Object.assign(n,a),n.set({scaleX:i,scaleY:o}),n.setPositionByOrigin(l,qe,qe)},XH=n=>{n.scaleX=1,n.scaleY=1,n.skewX=0,n.skewY=0,n.flipX=!1,n.flipY=!1,n.rotate(0)},lO=n=>({scaleX:n.scaleX,scaleY:n.scaleY,skewX:n.skewX,skewY:n.skewY,angle:n.angle,left:n.left,flipX:n.flipX,flipY:n.flipY,top:n.top}),C1=(n,e,t)=>{const r=n/2,s=e/2,i=[new Z(-r,-s),new Z(r,-s),new Z(-r,s),new Z(r,s)].map(a=>a.transform(t)),o=Xs(i);return new Z(o.width,o.height)},P0=function(){let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Fn;return pn(Xr(arguments.length>1&&arguments[1]!==void 0?arguments[1]:Fn),n)},El=function(n){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Fn,t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:Fn;return n.transform(P0(e,t))},KH=function(n){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Fn,t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:Fn;return n.transform(P0(e,t),!0)},JH=(n,e,t)=>{const r=P0(e,t);return mp(n,pn(r,n.calcOwnMatrix())),r},cO=(n,e)=>{var t;const{transform:{target:r}}=e;(t=r.canvas)===null||t===void 0||t.fire("object:".concat(n),q(q({},e),{},{target:r})),r.fire(n,e)},QH={left:-.5,top:-.5,center:0,bottom:.5,right:.5},zt=n=>typeof n=="string"?QH[n]:n-.5,vp="not-allowed";function uO(n){return zt(n.originX)===zt(qe)&&zt(n.originY)===zt(qe)}function MC(n){return .5-zt(n)}const Zr=(n,e)=>n[e],dO=(n,e,t,r)=>({e:n,transform:e,pointer:new Z(t,r)});function hO(n,e){const t=n.getTotalAngle()+ga(Math.atan2(e.y,e.x))+360;return Math.round(t%360/45)}function E1(n,e,t,r,s){var i;let{target:o,corner:a}=n;const l=o.controls[a],c=((i=o.canvas)===null||i===void 0?void 0:i.getZoom())||1,u=o.padding/c,h=function(d,p,m,g){const y=d.getRelativeCenterPoint(),x=m!==void 0&&g!==void 0?d.translateToGivenOrigin(y,qe,qe,m,g):new Z(d.left,d.top);return(d.angle?p.rotate(-Ft(d.angle),y):p).subtract(x)}(o,new Z(r,s),e,t);return h.x>=u&&(h.x-=u),h.x<=-u&&(h.x+=u),h.y>=u&&(h.y-=u),h.y<=u&&(h.y+=u),h.x-=l.offsetX,h.y-=l.offsetY,h}const ZH=(n,e,t,r)=>{const{target:s,offsetX:i,offsetY:o}=e,a=t-i,l=r-o,c=!Zr(s,"lockMovementX")&&s.left!==a,u=!Zr(s,"lockMovementY")&&s.top!==l;return c&&s.set(lt,a),u&&s.set(Qn,l),(c||u)&&cO(q4,dO(n,e,t,r)),c||u};class fO{getSvgStyles(e){const t=this.fillRule?this.fillRule:"nonzero",r=this.strokeWidth?this.strokeWidth:"0",s=this.strokeDashArray?this.strokeDashArray.join(" "):Zn,i=this.strokeDashOffset?this.strokeDashOffset:"0",o=this.strokeLineCap?this.strokeLineCap:"butt",a=this.strokeLineJoin?this.strokeLineJoin:"miter",l=this.strokeMiterLimit?this.strokeMiterLimit:"4",c=this.opacity!==void 0?this.opacity:"1",u=this.visible?"":" visibility: hidden;",h=e?"":this.getSvgFilter(),d=ad(Gt,this.fill);return[ad(er,this.stroke),"stroke-width: ",r,"; ","stroke-dasharray: ",s,"; ","stroke-linecap: ",o,"; ","stroke-dashoffset: ",i,"; ","stroke-linejoin: ",a,"; ","stroke-miterlimit: ",l,"; ",d,"fill-rule: ",t,"; ","opacity: ",c,";",h,u].join("")}getSvgFilter(){return this.shadow?"filter: url(#SVGID_".concat(this.shadow.id,");"):""}getSvgCommons(){return[this.id?'id="'.concat(this.id,'" '):"",this.clipPath?'clip-path="url(#'.concat(this.clipPath.clipPathId,')" '):""].join("")}getSvgTransform(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"";const r=e?this.calcTransformMatrix():this.calcOwnMatrix(),s='transform="'.concat(gp(r));return"".concat(s).concat(t,'" ')}_toSVG(e){return[""]}toSVG(e){return this._createBaseSVGMarkup(this._toSVG(e),{reviver:e})}toClipPathSVG(e){return"	"+this._createBaseClipPathSVGMarkup(this._toSVG(e),{reviver:e})}_createBaseClipPathSVGMarkup(e){let{reviver:t,additionalTransform:r=""}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const s=[this.getSvgTransform(!0,r),this.getSvgCommons()].join(""),i=e.indexOf("COMMON_PARTS");return e[i]=s,t?t(e.join("")):e.join("")}_createBaseSVGMarkup(e){let{noStyle:t,reviver:r,withShadow:s,additionalTransform:i}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const o=t?"":'style="'.concat(this.getSvgStyles(),'" '),a=s?'style="'.concat(this.getSvgFilter(),'" '):"",l=this.clipPath,c=this.strokeUniform?'vector-effect="non-scaling-stroke" ':"",u=l&&l.absolutePositioned,h=this.stroke,d=this.fill,p=this.shadow,m=[],g=e.indexOf("COMMON_PARTS");let y;l&&(l.clipPathId="CLIPPATH_".concat(go()),y='<clipPath id="'.concat(l.clipPathId,`" >
`).concat(l.toClipPathSVG(r),`</clipPath>
`)),u&&m.push("<g ",a,this.getSvgCommons(),` >
`),m.push("<g ",this.getSvgTransform(!1),u?"":a+this.getSvgCommons(),` >
`);const x=[o,c,t?"":this.addPaintOrder()," ",i?'transform="'.concat(i,'" '):""].join("");return e[g]=x,Sr(d)&&m.push(d.toSVG(this)),Sr(h)&&m.push(h.toSVG(this)),p&&m.push(p.toSVG(this)),l&&m.push(y),m.push(e.join("")),m.push(`</g>
`),u&&m.push(`</g>
`),r?r(m.join("")):m.join("")}addPaintOrder(){return this.paintFirst!==Gt?' paint-order="'.concat(this.paintFirst,'" '):""}}function T0(n){return new RegExp("^("+n.join("|")+")\\b","i")}var FC;const ma=String.raw(FC||(FC=Co(["(?:[-+]?(?:d*.d+|d+.?)(?:[eE][-+]?d+)?)"],["(?:[-+]?(?:\\d*\\.\\d+|\\d+\\.?)(?:[eE][-+]?\\d+)?)"]))),eV=new RegExp("(normal|italic)?\\s*(normal|small-caps)?\\s*(normal|bold|bolder|lighter|100|200|300|400|500|600|700|800|900)?\\s*("+ma+"(?:px|cm|mm|em|pt|pc|in)*)(?:\\/(normal|"+ma+"))?\\s+(.*)"),tV={cx:lt,x:lt,r:"radius",cy:Qn,y:Qn,display:"visible",visibility:"visible",transform:"transformMatrix","fill-opacity":"fillOpacity","fill-rule":"fillRule","font-family":"fontFamily","font-size":"fontSize","font-style":"fontStyle","font-weight":"fontWeight","letter-spacing":"charSpacing","paint-order":"paintFirst","stroke-dasharray":"strokeDashArray","stroke-dashoffset":"strokeDashOffset","stroke-linecap":"strokeLineCap","stroke-linejoin":"strokeLineJoin","stroke-miterlimit":"strokeMiterLimit","stroke-opacity":"strokeOpacity","stroke-width":"strokeWidth","text-decoration":"textDecoration","text-anchor":"textAnchor",opacity:"opacity","clip-path":"clipPath","clip-rule":"clipRule","vector-effect":"strokeUniform","image-rendering":"imageSmoothing"},Kg="font-size",Jg="clip-path";T0(["path","circle","polygon","polyline","ellipse","rect","line","image","text"]);T0(["symbol","image","marker","pattern","view","svg"]);const BC=T0(["symbol","g","a","svg","clipPath","defs"]),nV=new Z(1,0),pO=new Z,gO=(n,e)=>n.rotate(e),Zy=(n,e)=>new Z(e).subtract(n),ex=n=>n.distanceFrom(pO),tx=(n,e)=>Math.atan2(Su(n,e),sV(n,e)),rV=n=>tx(nV,n),k1=n=>n.eq(pO)?n:n.scalarDivide(ex(n)),mO=function(n){let e=!(arguments.length>1&&arguments[1]!==void 0)||arguments[1];return k1(new Z(-n.y,n.x).scalarMultiply(e?1:-1))},Su=(n,e)=>n.x*e.y-n.y*e.x,sV=(n,e)=>n.x*e.x+n.y*e.y,UC=(n,e,t)=>{if(n.eq(e)||n.eq(t))return!0;const r=Su(e,t),s=Su(e,n),i=Su(t,n);return r>=0?s>=0&&i<=0:!(s<=0&&i>=0)},$C="(-?\\d+(?:\\.\\d*)?(?:px)?(?:\\s?|$))?",zC=new RegExp("(?:\\s|^)"+$C+$C+"("+ma+"?(?:px)?)?(?:\\s?|$)(?:$|\\s)");class Ks{constructor(e){const t=typeof e=="string"?Ks.parseShadow(e):e;Object.assign(this,Ks.ownDefaults,t),this.id=go()}static parseShadow(e){const t=e.trim(),[,r=0,s=0,i=0]=(zC.exec(t)||[]).map(o=>parseFloat(o)||0);return{color:(t.replace(zC,"")||"rgb(0,0,0)").trim(),offsetX:r,offsetY:s,blur:i}}toString(){return[this.offsetX,this.offsetY,this.blur,this.color].join("px ")}toSVG(e){const t=gO(new Z(this.offsetX,this.offsetY),Ft(-e.angle)),r=new dt(this.color);let s=40,i=40;return e.width&&e.height&&(s=100*Tt((Math.abs(t.x)+this.blur)/e.width,nt.NUM_FRACTION_DIGITS)+20,i=100*Tt((Math.abs(t.y)+this.blur)/e.height,nt.NUM_FRACTION_DIGITS)+20),e.flipX&&(t.x*=-1),e.flipY&&(t.y*=-1),'<filter id="SVGID_'.concat(this.id,'" y="-').concat(i,'%" height="').concat(100+2*i,'%" x="-').concat(s,'%" width="').concat(100+2*s,`%" >
	<feGaussianBlur in="SourceAlpha" stdDeviation="`).concat(Tt(this.blur?this.blur/2:0,nt.NUM_FRACTION_DIGITS),`"></feGaussianBlur>
	<feOffset dx="`).concat(Tt(t.x,nt.NUM_FRACTION_DIGITS),'" dy="').concat(Tt(t.y,nt.NUM_FRACTION_DIGITS),`" result="oBlur" ></feOffset>
	<feFlood flood-color="`).concat(r.toRgb(),'" flood-opacity="').concat(r.getAlpha(),`"/>
	<feComposite in2="oBlur" operator="in" />
	<feMerge>
		<feMergeNode></feMergeNode>
		<feMergeNode in="SourceGraphic"></feMergeNode>
	</feMerge>
</filter>
`)}toObject(){const e={color:this.color,blur:this.blur,offsetX:this.offsetX,offsetY:this.offsetY,affectStroke:this.affectStroke,nonScaling:this.nonScaling,type:this.constructor.type},t=Ks.ownDefaults;return this.includeDefaultValues?e:S1(e,(r,s)=>r!==t[s])}static async fromObject(e){return new this(e)}}V(Ks,"ownDefaults",{color:"rgb(0,0,0)",blur:0,offsetX:0,offsetY:0,affectStroke:!1,includeDefaultValues:!0,nonScaling:!1}),V(Ks,"type","shadow"),me.setClass(Ks,"shadow");const tc=(n,e,t)=>Math.max(n,Math.min(e,t)),iV=[Qn,lt,nr,Dr,"flipX","flipY","originX","originY","angle","opacity","globalCompositeOperation","shadow","visible",mc,vc],hi=[Gt,er,"strokeWidth","strokeDashArray","width","height","paintFirst","strokeUniform","strokeLineCap","strokeDashOffset","strokeLineJoin","strokeMiterLimit","backgroundColor","clipPath"],oV={top:0,left:0,width:0,height:0,angle:0,flipX:!1,flipY:!1,scaleX:1,scaleY:1,minScaleLimit:0,skewX:0,skewY:0,originX:lt,originY:Qn,strokeWidth:1,strokeUniform:!1,padding:0,opacity:1,paintFirst:Gt,fill:"rgb(0,0,0)",fillRule:"nonzero",stroke:null,strokeDashArray:null,strokeDashOffset:0,strokeLineCap:"butt",strokeLineJoin:"miter",strokeMiterLimit:4,globalCompositeOperation:"source-over",backgroundColor:"",shadow:null,visible:!0,includeDefaultValues:!0,excludeFromExport:!1,objectCaching:!0,clipPath:void 0,inverted:!1,absolutePositioned:!1,centeredRotation:!0,centeredScaling:!1,dirty:!0},aV=(n,e,t,r)=>-t*Math.cos(n/r*Rd)+t+e,lV=()=>!1;class P1{constructor(e){let{startValue:t,byValue:r,duration:s=500,delay:i=0,easing:o=aV,onStart:a=mf,onChange:l=mf,onComplete:c=mf,abort:u=lV,target:h}=e;V(this,"_state","pending"),V(this,"durationProgress",0),V(this,"valueProgress",0),this.tick=this.tick.bind(this),this.duration=s,this.delay=i,this.easing=o,this._onStart=a,this._onChange=l,this._onComplete=c,this._abort=u,this.target=h,this.startValue=t,this.byValue=r,this.value=this.startValue,this.endValue=Object.freeze(this.calculate(this.duration).value)}get state(){return this._state}isDone(){return this._state==="aborted"||this._state==="completed"}start(){const e=t=>{this._state==="pending"&&(this.startTime=t||+new Date,this._state="running",this._onStart(),this.tick(this.startTime))};this.register(),this.delay>0?setTimeout(()=>yf(e),this.delay):yf(e)}tick(e){const t=(e||+new Date)-this.startTime,r=Math.min(t,this.duration);this.durationProgress=r/this.duration;const{value:s,valueProgress:i}=this.calculate(r);this.value=Object.freeze(s),this.valueProgress=i,this._state!=="aborted"&&(this._abort(this.value,this.valueProgress,this.durationProgress)?(this._state="aborted",this.unregister()):t>=this.duration?(this.durationProgress=this.valueProgress=1,this._onChange(this.endValue,this.valueProgress,this.durationProgress),this._state="completed",this._onComplete(this.endValue,this.valueProgress,this.durationProgress),this.unregister()):(this._onChange(this.value,this.valueProgress,this.durationProgress),yf(this.tick)))}register(){fp.push(this)}unregister(){fp.remove(this)}abort(){this._state="aborted",this.unregister()}}const cV=["startValue","endValue"];class uV extends P1{constructor(e){let{startValue:t=0,endValue:r=100}=e;super(q(q({},Ct(e,cV)),{},{startValue:t,byValue:r-t}))}calculate(e){const t=this.easing(e,this.startValue,this.byValue,this.duration);return{value:t,valueProgress:Math.abs((t-this.startValue)/this.byValue)}}}const dV=["startValue","endValue"];class hV extends P1{constructor(e){let{startValue:t=[0],endValue:r=[100]}=e;super(q(q({},Ct(e,dV)),{},{startValue:t,byValue:r.map((s,i)=>s-t[i])}))}calculate(e){const t=this.startValue.map((r,s)=>this.easing(e,r,this.byValue[s],this.duration,s));return{value:t,valueProgress:Math.abs((t[0]-this.startValue[0])/this.byValue[0])}}}const fV=["startValue","endValue","easing","onChange","onComplete","abort"],pV=(n,e,t,r)=>e+t*(1-Math.cos(n/r*Rd)),Qg=n=>n&&((e,t,r)=>n(new dt(e).toRgba(),t,r));class gV extends P1{constructor(e){let{startValue:t,endValue:r,easing:s=pV,onChange:i,onComplete:o,abort:a}=e,l=Ct(e,fV);const c=new dt(t).getSource(),u=new dt(r).getSource();super(q(q({},l),{},{startValue:c,byValue:u.map((h,d)=>h-c[d]),easing:s,onChange:Qg(i),onComplete:Qg(o),abort:Qg(a)}))}calculate(e){const[t,r,s,i]=this.startValue.map((a,l)=>this.easing(e,a,this.byValue[l],this.duration,l)),o=[...[t,r,s].map(Math.round),tc(0,i,1)];return{value:o,valueProgress:o.map((a,l)=>this.byValue[l]!==0?Math.abs((a-this.startValue[l])/this.byValue[l]):0).find(a=>a!==0)||0}}}function vO(n){const e=(t=>Array.isArray(t.startValue)||Array.isArray(t.endValue))(n)?new hV(n):new uV(n);return e.start(),e}function mV(n){const e=new gV(n);return e.start(),e}class Et{constructor(e){this.status=e,this.points=[]}includes(e){return this.points.some(t=>t.eq(e))}append(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return this.points=this.points.concat(t.filter(s=>!this.includes(s))),this}static isPointContained(e,t,r){let s=arguments.length>3&&arguments[3]!==void 0&&arguments[3];if(t.eq(r))return e.eq(t);if(t.x===r.x)return e.x===t.x&&(s||e.y>=Math.min(t.y,r.y)&&e.y<=Math.max(t.y,r.y));if(t.y===r.y)return e.y===t.y&&(s||e.x>=Math.min(t.x,r.x)&&e.x<=Math.max(t.x,r.x));{const i=Zy(t,r),o=Zy(t,e).divide(i);return s?Math.abs(o.x)===Math.abs(o.y):o.x===o.y&&o.x>=0&&o.x<=1}}static isPointInPolygon(e,t){const r=new Z(e).setX(Math.min(e.x-1,...t.map(i=>i.x)));let s=0;for(let i=0;i<t.length;i++){const o=this.intersectSegmentSegment(t[i],t[(i+1)%t.length],e,r);if(o.includes(e))return!0;s+=+(o.status==="Intersection")}return s%2==1}static intersectLineLine(e,t,r,s){let i=!(arguments.length>4&&arguments[4]!==void 0)||arguments[4],o=!(arguments.length>5&&arguments[5]!==void 0)||arguments[5];const a=t.x-e.x,l=t.y-e.y,c=s.x-r.x,u=s.y-r.y,h=e.x-r.x,d=e.y-r.y,p=c*d-u*h,m=a*d-l*h,g=u*a-c*l;if(g!==0){const y=p/g,x=m/g;return(i||0<=y&&y<=1)&&(o||0<=x&&x<=1)?new Et("Intersection").append(new Z(e.x+y*a,e.y+y*l)):new Et}if(p===0||m===0){const y=i||o||Et.isPointContained(e,r,s)||Et.isPointContained(t,r,s)||Et.isPointContained(r,e,t)||Et.isPointContained(s,e,t);return new Et(y?"Coincident":void 0)}return new Et("Parallel")}static intersectSegmentLine(e,t,r,s){return Et.intersectLineLine(e,t,r,s,!1,!0)}static intersectSegmentSegment(e,t,r,s){return Et.intersectLineLine(e,t,r,s,!1,!1)}static intersectLinePolygon(e,t,r){let s=!(arguments.length>3&&arguments[3]!==void 0)||arguments[3];const i=new Et,o=r.length;for(let a,l,c,u=0;u<o;u++){if(a=r[u],l=r[(u+1)%o],c=Et.intersectLineLine(e,t,a,l,s,!1),c.status==="Coincident")return c;i.append(...c.points)}return i.points.length>0&&(i.status="Intersection"),i}static intersectSegmentPolygon(e,t,r){return Et.intersectLinePolygon(e,t,r,!1)}static intersectPolygonPolygon(e,t){const r=new Et,s=e.length,i=[];for(let o=0;o<s;o++){const a=e[o],l=e[(o+1)%s],c=Et.intersectSegmentPolygon(a,l,t);c.status==="Coincident"?(i.push(c),r.append(a,l)):r.append(...c.points)}return i.length>0&&i.length===e.length?new Et("Coincident"):(r.points.length>0&&(r.status="Intersection"),r)}static intersectPolygonRectangle(e,t,r){const s=t.min(r),i=t.max(r),o=new Z(i.x,s.y),a=new Z(s.x,i.y);return Et.intersectPolygonPolygon(e,[s,o,i,a])}}class vV extends J4{getX(){return this.getXY().x}setX(e){this.setXY(this.getXY().setX(e))}getY(){return this.getXY().y}setY(e){this.setXY(this.getXY().setY(e))}getRelativeX(){return this.left}setRelativeX(e){this.left=e}getRelativeY(){return this.top}setRelativeY(e){this.top=e}getXY(){const e=this.getRelativeXY();return this.group?Wn(e,this.group.calcTransformMatrix()):e}setXY(e,t,r){this.group&&(e=Wn(e,Xr(this.group.calcTransformMatrix()))),this.setRelativeXY(e,t,r)}getRelativeXY(){return new Z(this.left,this.top)}setRelativeXY(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.originX,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.originY;this.setPositionByOrigin(e,t,r)}isStrokeAccountedForInDimensions(){return!1}getCoords(){const{tl:e,tr:t,br:r,bl:s}=this.aCoords||(this.aCoords=this.calcACoords()),i=[e,t,r,s];if(this.group){const o=this.group.calcTransformMatrix();return i.map(a=>Wn(a,o))}return i}intersectsWithRect(e,t){return Et.intersectPolygonRectangle(this.getCoords(),e,t).status==="Intersection"}intersectsWithObject(e){const t=Et.intersectPolygonPolygon(this.getCoords(),e.getCoords());return t.status==="Intersection"||t.status==="Coincident"||e.isContainedWithinObject(this)||this.isContainedWithinObject(e)}isContainedWithinObject(e){return this.getCoords().every(t=>e.containsPoint(t))}isContainedWithinRect(e,t){const{left:r,top:s,width:i,height:o}=this.getBoundingRect();return r>=e.x&&r+i<=t.x&&s>=e.y&&s+o<=t.y}isOverlapping(e){return this.intersectsWithObject(e)||this.isContainedWithinObject(e)||e.isContainedWithinObject(this)}containsPoint(e){return Et.isPointInPolygon(e,this.getCoords())}isOnScreen(){if(!this.canvas)return!1;const{tl:e,br:t}=this.canvas.vptCoords;return!!this.getCoords().some(r=>r.x<=t.x&&r.x>=e.x&&r.y<=t.y&&r.y>=e.y)||!!this.intersectsWithRect(e,t)||this.containsPoint(e.midPointFrom(t))}isPartiallyOnScreen(){if(!this.canvas)return!1;const{tl:e,br:t}=this.canvas.vptCoords;return this.intersectsWithRect(e,t)?!0:this.getCoords().every(r=>(r.x>=t.x||r.x<=e.x)&&(r.y>=t.y||r.y<=e.y))&&this.containsPoint(e.midPointFrom(t))}getBoundingRect(){return Xs(this.getCoords())}getScaledWidth(){return this._getTransformedDimensions().x}getScaledHeight(){return this._getTransformedDimensions().y}scale(e){this._set(nr,e),this._set(Dr,e),this.setCoords()}scaleToWidth(e){const t=this.getBoundingRect().width/this.getScaledWidth();return this.scale(e/this.width/t)}scaleToHeight(e){const t=this.getBoundingRect().height/this.getScaledHeight();return this.scale(e/this.height/t)}getCanvasRetinaScaling(){var e;return((e=this.canvas)===null||e===void 0?void 0:e.getRetinaScaling())||1}getTotalAngle(){return this.group?ga(Z4(this.calcTransformMatrix())):this.angle}getViewportTransform(){var e;return((e=this.canvas)===null||e===void 0?void 0:e.viewportTransform)||Fn.concat()}calcACoords(){const e=jd({angle:this.angle}),{x:t,y:r}=this.getRelativeCenterPoint(),s=Nd(t,r),i=pn(s,e),o=this._getTransformedDimensions(),a=o.x/2,l=o.y/2;return{tl:Wn({x:-a,y:-l},i),tr:Wn({x:a,y:-l},i),bl:Wn({x:-a,y:l},i),br:Wn({x:a,y:l},i)}}setCoords(){this.aCoords=this.calcACoords()}transformMatrixKey(){let e=arguments.length>0&&arguments[0]!==void 0&&arguments[0],t=[];return!e&&this.group&&(t=this.group.transformMatrixKey(e)),t.push(this.top,this.left,this.width,this.height,this.scaleX,this.scaleY,this.angle,this.strokeWidth,this.skewX,this.skewY,+this.flipX,+this.flipY,zt(this.originX),zt(this.originY)),t}calcTransformMatrix(){let e=arguments.length>0&&arguments[0]!==void 0&&arguments[0],t=this.calcOwnMatrix();if(e||!this.group)return t;const r=this.transformMatrixKey(e),s=this.matrixCache;return s&&s.key.every((i,o)=>i===r[o])?s.value:(this.group&&(t=pn(this.group.calcTransformMatrix(!1),t)),this.matrixCache={key:r,value:t},t)}calcOwnMatrix(){const e=this.transformMatrixKey(!0),t=this.ownMatrixCache;if(t&&t.key===e)return t.value;const r=this.getRelativeCenterPoint(),s={angle:this.angle,translateX:r.x,translateY:r.y,scaleX:this.scaleX,scaleY:this.scaleY,skewX:this.skewX,skewY:this.skewY,flipX:this.flipX,flipY:this.flipY},i=zH(s);return this.ownMatrixCache={key:e,value:i},i}_getNonTransformedDimensions(){return new Z(this.width,this.height).scalarAdd(this.strokeWidth)}_calculateCurrentDimensions(e){return this._getTransformedDimensions(e).transform(this.getViewportTransform(),!0).scalarAdd(2*this.padding)}_getTransformedDimensions(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const t=q({scaleX:this.scaleX,scaleY:this.scaleY,skewX:this.skewX,skewY:this.skewY,width:this.width,height:this.height,strokeWidth:this.strokeWidth},e),r=t.strokeWidth;let s=r,i=0;this.strokeUniform&&(s=0,i=r);const o=t.width+s,a=t.height+s;let l;return l=t.skewX===0&&t.skewY===0?new Z(o*t.scaleX,a*t.scaleY):C1(o,a,E0(t)),l.scalarAdd(i)}translateToGivenOrigin(e,t,r,s,i){let o=e.x,a=e.y;const l=zt(s)-zt(t),c=zt(i)-zt(r);if(l||c){const u=this._getTransformedDimensions();o+=l*u.x,a+=c*u.y}return new Z(o,a)}translateToCenterPoint(e,t,r){if(t===qe&&r===qe)return e;const s=this.translateToGivenOrigin(e,t,r,qe,qe);return this.angle?s.rotate(Ft(this.angle),e):s}translateToOriginPoint(e,t,r){const s=this.translateToGivenOrigin(e,qe,qe,t,r);return this.angle?s.rotate(Ft(this.angle),e):s}getCenterPoint(){const e=this.getRelativeCenterPoint();return this.group?Wn(e,this.group.calcTransformMatrix()):e}getRelativeCenterPoint(){return this.translateToCenterPoint(new Z(this.left,this.top),this.originX,this.originY)}getPointByOrigin(e,t){return this.translateToOriginPoint(this.getRelativeCenterPoint(),e,t)}setPositionByOrigin(e,t,r){const s=this.translateToCenterPoint(e,t,r),i=this.translateToOriginPoint(s,this.originX,this.originY);this.set({left:i.x,top:i.y})}_getLeftTopCoords(){return this.translateToOriginPoint(this.getRelativeCenterPoint(),lt,Qn)}}const yV=["type"],xV=["extraParam"];let As=class wf extends vV{static getDefaults(){return wf.ownDefaults}get type(){const e=this.constructor.type;return e==="FabricObject"?"object":e.toLowerCase()}set type(e){po("warn","Setting type has no effect",e)}constructor(e){super(),V(this,"_cacheContext",null),Object.assign(this,wf.ownDefaults),this.setOptions(e)}_createCacheCanvas(){this._cacheCanvas=Zt(),this._cacheContext=this._cacheCanvas.getContext("2d"),this._updateCacheCanvas(),this.dirty=!0}_limitCacheSize(e){const t=e.width,r=e.height,s=nt.maxCacheSideLimit,i=nt.minCacheSideLimit;if(t<=s&&r<=s&&t*r<=nt.perfLimitSizeTotal)return t<i&&(e.width=i),r<i&&(e.height=i),e;const o=t/r,[a,l]=_u.limitDimsByArea(o),c=tc(i,a,s),u=tc(i,l,s);return t>c&&(e.zoomX/=t/c,e.width=c,e.capped=!0),r>u&&(e.zoomY/=r/u,e.height=u,e.capped=!0),e}_getCacheCanvasDimensions(){const e=this.getTotalObjectScaling(),t=this._getTransformedDimensions({skewX:0,skewY:0}),r=t.x*e.x/this.scaleX,s=t.y*e.y/this.scaleY;return{width:r+2,height:s+2,zoomX:e.x,zoomY:e.y,x:r,y:s}}_updateCacheCanvas(){const e=this._cacheCanvas,t=this._cacheContext,r=this._limitCacheSize(this._getCacheCanvasDimensions()),s=nt.minCacheSideLimit,i=r.width,o=r.height,a=r.zoomX,l=r.zoomY,c=i!==e.width||o!==e.height,u=this.zoomX!==a||this.zoomY!==l;if(!e||!t)return!1;let h,d,p=c||u,m=0,g=0,y=!1;if(c){const x=this._cacheCanvas.width,v=this._cacheCanvas.height,w=i>x||o>v;y=w||(i<.9*x||o<.9*v)&&x>s&&v>s,w&&!r.capped&&(i>s||o>s)&&(m=.1*i,g=.1*o)}return rO(this)&&this.path&&(p=!0,y=!0,m+=this.getHeightOfLine(0)*this.zoomX,g+=this.getHeightOfLine(0)*this.zoomY),!!p&&(y?(e.width=Math.ceil(i+m),e.height=Math.ceil(o+g)):(t.setTransform(1,0,0,1,0,0),t.clearRect(0,0,e.width,e.height)),h=r.x/2,d=r.y/2,this.cacheTranslationX=Math.round(e.width/2-h)+h,this.cacheTranslationY=Math.round(e.height/2-d)+d,t.translate(this.cacheTranslationX,this.cacheTranslationY),t.scale(a,l),this.zoomX=a,this.zoomY=l,!0)}setOptions(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this._setOptions(e)}transform(e){const t=this.group&&!this.group._transformDone||this.group&&this.canvas&&e===this.canvas.contextTop,r=this.calcTransformMatrix(!t);e.transform(r[0],r[1],r[2],r[3],r[4],r[5])}getObjectScaling(){if(!this.group)return new Z(Math.abs(this.scaleX),Math.abs(this.scaleY));const e=pp(this.calcTransformMatrix());return new Z(Math.abs(e.scaleX),Math.abs(e.scaleY))}getTotalObjectScaling(){const e=this.getObjectScaling();if(this.canvas){const t=this.canvas.getZoom(),r=this.getCanvasRetinaScaling();return e.scalarMultiply(t*r)}return e}getObjectOpacity(){let e=this.opacity;return this.group&&(e*=this.group.getObjectOpacity()),e}_constrainScale(e){return Math.abs(e)<this.minScaleLimit?e<0?-this.minScaleLimit:this.minScaleLimit:e===0?1e-4:e}_set(e,t){e!==nr&&e!==Dr||(t=this._constrainScale(t)),e===nr&&t<0?(this.flipX=!this.flipX,t*=-1):e==="scaleY"&&t<0?(this.flipY=!this.flipY,t*=-1):e!=="shadow"||!t||t instanceof Ks||(t=new Ks(t));const r=this[e]!==t;return this[e]=t,r&&this.constructor.cacheProperties.includes(e)&&(this.dirty=!0),this.parent&&(this.dirty||r&&this.constructor.stateProperties.includes(e))&&this.parent._set("dirty",!0),this}isNotVisible(){return this.opacity===0||!this.width&&!this.height&&this.strokeWidth===0||!this.visible}render(e){this.isNotVisible()||this.canvas&&this.canvas.skipOffscreen&&!this.group&&!this.isOnScreen()||(e.save(),this._setupCompositeOperation(e),this.drawSelectionBackground(e),this.transform(e),this._setOpacity(e),this._setShadow(e),this.shouldCache()?(this.renderCache(),this.drawCacheOnCanvas(e)):(this._removeCacheCanvas(),this.drawObject(e),this.dirty=!1),e.restore())}drawSelectionBackground(e){}renderCache(e){e=e||{},this._cacheCanvas&&this._cacheContext||this._createCacheCanvas(),this.isCacheDirty()&&this._cacheContext&&(this.drawObject(this._cacheContext,e.forClipping),this.dirty=!1)}_removeCacheCanvas(){this._cacheCanvas=void 0,this._cacheContext=null}hasStroke(){return this.stroke&&this.stroke!=="transparent"&&this.strokeWidth!==0}hasFill(){return this.fill&&this.fill!=="transparent"}needsItsOwnCache(){return!!(this.paintFirst===er&&this.hasFill()&&this.hasStroke()&&this.shadow)||!!this.clipPath}shouldCache(){return this.ownCaching=this.needsItsOwnCache()||this.objectCaching&&(!this.parent||!this.parent.isOnACache()),this.ownCaching}willDrawShadow(){return!!this.shadow&&(this.shadow.offsetX!==0||this.shadow.offsetY!==0)}drawClipPathOnCache(e,t){if(e.save(),t.inverted?e.globalCompositeOperation="destination-out":e.globalCompositeOperation="destination-in",t.absolutePositioned){const r=Xr(this.calcTransformMatrix());e.transform(r[0],r[1],r[2],r[3],r[4],r[5])}t.transform(e),e.scale(1/t.zoomX,1/t.zoomY),e.drawImage(t._cacheCanvas,-t.cacheTranslationX,-t.cacheTranslationY),e.restore()}drawObject(e,t){const r=this.fill,s=this.stroke;t?(this.fill="black",this.stroke="",this._setClippingProperties(e)):this._renderBackground(e),this._render(e),this._drawClipPath(e,this.clipPath),this.fill=r,this.stroke=s}_drawClipPath(e,t){t&&(t._set("canvas",this.canvas),t.shouldCache(),t._transformDone=!0,t.renderCache({forClipping:!0}),this.drawClipPathOnCache(e,t))}drawCacheOnCanvas(e){e.scale(1/this.zoomX,1/this.zoomY),e.drawImage(this._cacheCanvas,-this.cacheTranslationX,-this.cacheTranslationY)}isCacheDirty(){let e=arguments.length>0&&arguments[0]!==void 0&&arguments[0];if(this.isNotVisible())return!1;const t=this._cacheCanvas,r=this._cacheContext;return!(!t||!r||e||!this._updateCacheCanvas())||!!(this.dirty||this.clipPath&&this.clipPath.absolutePositioned)&&(t&&r&&!e&&(r.save(),r.setTransform(1,0,0,1,0,0),r.clearRect(0,0,t.width,t.height),r.restore()),!0)}_renderBackground(e){if(!this.backgroundColor)return;const t=this._getNonTransformedDimensions();e.fillStyle=this.backgroundColor,e.fillRect(-t.x/2,-t.y/2,t.x,t.y),this._removeShadow(e)}_setOpacity(e){this.group&&!this.group._transformDone?e.globalAlpha=this.getObjectOpacity():e.globalAlpha*=this.opacity}_setStrokeStyles(e,t){const r=t.stroke;r&&(e.lineWidth=t.strokeWidth,e.lineCap=t.strokeLineCap,e.lineDashOffset=t.strokeDashOffset,e.lineJoin=t.strokeLineJoin,e.miterLimit=t.strokeMiterLimit,Sr(r)?r.gradientUnits==="percentage"||r.gradientTransform||r.patternTransform?this._applyPatternForTransformedGradient(e,r):(e.strokeStyle=r.toLive(e),this._applyPatternGradientTransform(e,r)):e.strokeStyle=t.stroke)}_setFillStyles(e,t){let{fill:r}=t;r&&(Sr(r)?(e.fillStyle=r.toLive(e),this._applyPatternGradientTransform(e,r)):e.fillStyle=r)}_setClippingProperties(e){e.globalAlpha=1,e.strokeStyle="transparent",e.fillStyle="#000000"}_setLineDash(e,t){t&&t.length!==0&&(1&t.length&&t.push(...t),e.setLineDash(t))}_setShadow(e){if(!this.shadow)return;const t=this.shadow,r=this.canvas,s=this.getCanvasRetinaScaling(),[i,,,o]=(r==null?void 0:r.viewportTransform)||Fn,a=i*s,l=o*s,c=t.nonScaling?new Z(1,1):this.getObjectScaling();e.shadowColor=t.color,e.shadowBlur=t.blur*nt.browserShadowBlurConstant*(a+l)*(c.x+c.y)/4,e.shadowOffsetX=t.offsetX*a*c.x,e.shadowOffsetY=t.offsetY*l*c.y}_removeShadow(e){this.shadow&&(e.shadowColor="",e.shadowBlur=e.shadowOffsetX=e.shadowOffsetY=0)}_applyPatternGradientTransform(e,t){if(!Sr(t))return{offsetX:0,offsetY:0};const r=t.gradientTransform||t.patternTransform,s=-this.width/2+t.offsetX||0,i=-this.height/2+t.offsetY||0;return t.gradientUnits==="percentage"?e.transform(this.width,0,0,this.height,s,i):e.transform(1,0,0,1,s,i),r&&e.transform(r[0],r[1],r[2],r[3],r[4],r[5]),{offsetX:s,offsetY:i}}_renderPaintInOrder(e){this.paintFirst===er?(this._renderStroke(e),this._renderFill(e)):(this._renderFill(e),this._renderStroke(e))}_render(e){}_renderFill(e){this.fill&&(e.save(),this._setFillStyles(e,this),this.fillRule==="evenodd"?e.fill("evenodd"):e.fill(),e.restore())}_renderStroke(e){if(this.stroke&&this.strokeWidth!==0){if(this.shadow&&!this.shadow.affectStroke&&this._removeShadow(e),e.save(),this.strokeUniform){const t=this.getObjectScaling();e.scale(1/t.x,1/t.y)}this._setLineDash(e,this.strokeDashArray),this._setStrokeStyles(e,this),e.stroke(),e.restore()}}_applyPatternForTransformedGradient(e,t){var r;const s=this._limitCacheSize(this._getCacheCanvasDimensions()),i=Zt(),o=this.getCanvasRetinaScaling(),a=s.x/this.scaleX/o,l=s.y/this.scaleY/o;i.width=Math.ceil(a),i.height=Math.ceil(l);const c=i.getContext("2d");c&&(c.beginPath(),c.moveTo(0,0),c.lineTo(a,0),c.lineTo(a,l),c.lineTo(0,l),c.closePath(),c.translate(a/2,l/2),c.scale(s.zoomX/this.scaleX/o,s.zoomY/this.scaleY/o),this._applyPatternGradientTransform(c,t),c.fillStyle=t.toLive(e),c.fill(),e.translate(-this.width/2-this.strokeWidth/2,-this.height/2-this.strokeWidth/2),e.scale(o*this.scaleX/s.zoomX,o*this.scaleY/s.zoomY),e.strokeStyle=(r=c.createPattern(i,"no-repeat"))!==null&&r!==void 0?r:"")}_findCenterFromElement(){return new Z(this.left+this.width/2,this.top+this.height/2)}clone(e){const t=this.toObject(e);return this.constructor.fromObject(t)}cloneAsImage(e){const t=this.toCanvasElement(e);return new(me.getClass("image"))(t)}toCanvasElement(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const t=lO(this),r=this.group,s=this.shadow,i=Math.abs,o=e.enableRetinaScaling?G4():1,a=(e.multiplier||1)*o,l=e.canvasProvider||(v=>new Ld(v,{enableRetinaScaling:!1,renderOnAddRemove:!1,skipOffscreen:!1}));delete this.group,e.withoutTransform&&XH(this),e.withoutShadow&&(this.shadow=null),e.viewportTransform&&JH(this,this.getViewportTransform()),this.setCoords();const c=Zt(),u=this.getBoundingRect(),h=this.shadow,d=new Z;if(h){const v=h.blur,w=h.nonScaling?new Z(1,1):this.getObjectScaling();d.x=2*Math.round(i(h.offsetX)+v)*i(w.x),d.y=2*Math.round(i(h.offsetY)+v)*i(w.y)}const p=u.width+d.x,m=u.height+d.y;c.width=Math.ceil(p),c.height=Math.ceil(m);const g=l(c);e.format==="jpeg"&&(g.backgroundColor="#fff"),this.setPositionByOrigin(new Z(g.width/2,g.height/2),qe,qe);const y=this.canvas;g._objects=[this],this.set("canvas",g),this.setCoords();const x=g.toCanvasElement(a||1,e);return this.set("canvas",y),this.shadow=s,r&&(this.group=r),this.set(t),this.setCoords(),g._objects=[],g.destroy(),x}toDataURL(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return Q4(this.toCanvasElement(e),e.format||"png",e.quality||1)}isType(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return t.includes(this.constructor.type)||t.includes(this.type)}complexity(){return 1}toJSON(){return this.toObject()}rotate(e){const{centeredRotation:t,originX:r,originY:s}=this;if(t){const{x:i,y:o}=this.getRelativeCenterPoint();this.originX=qe,this.originY=qe,this.left=i,this.top=o}if(this.set("angle",e),t){const{x:i,y:o}=this.translateToOriginPoint(this.getRelativeCenterPoint(),r,s);this.left=i,this.top=o,this.originX=r,this.originY=s}}setOnGroup(){}_setupCompositeOperation(e){this.globalCompositeOperation&&(e.globalCompositeOperation=this.globalCompositeOperation)}dispose(){fp.cancelByTarget(this),this.off(),this._set("canvas",void 0),this._cacheCanvas&&xs().dispose(this._cacheCanvas),this._cacheCanvas=void 0,this._cacheContext=null}animate(e,t){return Object.entries(e).reduce((r,s)=>{let[i,o]=s;return r[i]=this._animate(i,o,t),r},{})}_animate(e,t){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const s=e.split("."),i=this.constructor.colorProperties.includes(s[s.length-1]),{abort:o,startValue:a,onChange:l,onComplete:c}=r,u=q(q({},r),{},{target:this,startValue:a??s.reduce((h,d)=>h[d],this),endValue:t,abort:o==null?void 0:o.bind(this),onChange:(h,d,p)=>{s.reduce((m,g,y)=>(y===s.length-1&&(m[g]=h),m[g]),this),l&&l(h,d,p)},onComplete:(h,d,p)=>{this.setCoords(),c&&c(h,d,p)}});return i?mV(u):vO(u)}isDescendantOf(e){const{parent:t,group:r}=this;return t===e||r===e||!!t&&t.isDescendantOf(e)||!!r&&r!==t&&r.isDescendantOf(e)}getAncestors(){const e=[];let t=this;do t=t.parent,t&&e.push(t);while(t);return e}findCommonAncestors(e){if(this===e)return{fork:[],otherFork:[],common:[this,...this.getAncestors()]};const t=this.getAncestors(),r=e.getAncestors();if(t.length===0&&r.length>0&&this===r[r.length-1])return{fork:[],otherFork:[e,...r.slice(0,r.length-1)],common:[this]};for(let s,i=0;i<t.length;i++){if(s=t[i],s===e)return{fork:[this,...t.slice(0,i)],otherFork:[],common:t.slice(i)};for(let o=0;o<r.length;o++){if(this===r[o])return{fork:[],otherFork:[e,...r.slice(0,o)],common:[this,...t]};if(s===r[o])return{fork:[this,...t.slice(0,i)],otherFork:[e,...r.slice(0,o)],common:t.slice(i)}}}return{fork:[this,...t],otherFork:[e,...r],common:[]}}hasCommonAncestors(e){const t=this.findCommonAncestors(e);return t&&!!t.common.length}isInFrontOf(e){if(this===e)return;const t=this.findCommonAncestors(e);if(t.fork.includes(e))return!0;if(t.otherFork.includes(this))return!1;const r=t.common[0]||this.canvas;if(!r)return;const s=t.fork.pop(),i=t.otherFork.pop(),o=r._objects.indexOf(s),a=r._objects.indexOf(i);return o>-1&&o>a}toObject(){const e=(arguments.length>0&&arguments[0]!==void 0?arguments[0]:[]).concat(wf.customProperties,this.constructor.customProperties||[]);let t;const r=nt.NUM_FRACTION_DIGITS,{clipPath:s,fill:i,stroke:o,shadow:a,strokeDashArray:l,left:c,top:u,originX:h,originY:d,width:p,height:m,strokeWidth:g,strokeLineCap:y,strokeDashOffset:x,strokeLineJoin:v,strokeUniform:w,strokeMiterLimit:_,scaleX:S,scaleY:E,angle:C,flipX:P,flipY:O,opacity:A,visible:R,backgroundColor:B,fillRule:I,paintFirst:L,globalCompositeOperation:U,skewX:F,skewY:D}=this;s&&!s.excludeFromExport&&(t=s.toObject(e.concat("inverted","absolutePositioned")));const k=M=>Tt(M,r),N=q(q({},yc(this,e)),{},{type:this.constructor.type,version:Yy,originX:h,originY:d,left:k(c),top:k(u),width:k(p),height:k(m),fill:NC(i)?i.toObject():i,stroke:NC(o)?o.toObject():o,strokeWidth:k(g),strokeDashArray:l&&l.concat(),strokeLineCap:y,strokeDashOffset:x,strokeLineJoin:v,strokeUniform:w,strokeMiterLimit:k(_),scaleX:k(S),scaleY:k(E),angle:k(C),flipX:P,flipY:O,opacity:k(A),shadow:a&&a.toObject(),visible:R,backgroundColor:B,fillRule:I,paintFirst:L,globalCompositeOperation:U,skewX:k(F),skewY:k(D)},t?{clipPath:t}:null);return this.includeDefaultValues?N:this._removeDefaultValues(N)}toDatalessObject(e){return this.toObject(e)}_removeDefaultValues(e){const t=this.constructor.getDefaults(),r=Object.keys(t).length>0?t:Object.getPrototypeOf(this);return S1(e,(s,i)=>{if(i===lt||i===Qn||i==="type")return!0;const o=r[i];return s!==o&&!(Array.isArray(s)&&Array.isArray(o)&&s.length===0&&o.length===0)})}toString(){return"#<".concat(this.constructor.type,">")}static _fromObject(e){let t=Ct(e,yV),r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},{extraParam:s}=r,i=Ct(r,xV);return k0(t,i).then(o=>s?(delete o[s],new this(t[s],o)):new this(o))}static fromObject(e,t){return this._fromObject(e,t)}};V(As,"stateProperties",iV),V(As,"cacheProperties",hi),V(As,"ownDefaults",oV),V(As,"type","FabricObject"),V(As,"colorProperties",[Gt,er,"backgroundColor"]),V(As,"customProperties",[]),me.setClass(As),me.setClass(As,"object");const xc=(n,e,t)=>(r,s,i,o)=>{const a=e(r,s,i,o);return a&&cO(n,q(q({},dO(r,s,i,o)),t)),a};function wc(n){return(e,t,r,s)=>{const{target:i,originX:o,originY:a}=t,l=i.getRelativeCenterPoint(),c=i.translateToOriginPoint(l,o,a),u=n(e,t,r,s);return i.setPositionByOrigin(c,t.originX,t.originY),u}}const WC=xc(id,wc((n,e,t,r)=>{const s=E1(e,e.originX,e.originY,t,r);if(zt(e.originX)===zt(qe)||zt(e.originX)===zt(Lt)&&s.x<0||zt(e.originX)===zt(lt)&&s.x>0){const{target:i}=e,o=i.strokeWidth/(i.strokeUniform?i.scaleX:1),a=uO(e)?2:1,l=i.width,c=Math.abs(s.x*a/i.scaleX)-o;return i.set("width",Math.max(c,1)),l!==i.width}return!1}));function wV(n,e,t,r,s){r=r||{};const i=this.sizeX||r.cornerSize||s.cornerSize,o=this.sizeY||r.cornerSize||s.cornerSize,a=r.transparentCorners!==void 0?r.transparentCorners:s.transparentCorners,l=a?er:Gt,c=!a&&(r.cornerStrokeColor||s.cornerStrokeColor);let u,h=e,d=t;n.save(),n.fillStyle=r.cornerColor||s.cornerColor||"",n.strokeStyle=r.cornerStrokeColor||s.cornerStrokeColor||"",i>o?(u=i,n.scale(1,o/i),d=t*i/o):o>i?(u=o,n.scale(i/o,1),h=e*o/i):u=i,n.lineWidth=1,n.beginPath(),n.arc(h,d,u/2,0,up,!1),n[l](),c&&n.stroke(),n.restore()}function bV(n,e,t,r,s){r=r||{};const i=this.sizeX||r.cornerSize||s.cornerSize,o=this.sizeY||r.cornerSize||s.cornerSize,a=r.transparentCorners!==void 0?r.transparentCorners:s.transparentCorners,l=a?er:Gt,c=!a&&(r.cornerStrokeColor||s.cornerStrokeColor),u=i/2,h=o/2;n.save(),n.fillStyle=r.cornerColor||s.cornerColor||"",n.strokeStyle=r.cornerStrokeColor||s.cornerStrokeColor||"",n.lineWidth=1,n.translate(e,t);const d=s.getTotalAngle();n.rotate(Ft(d)),n["".concat(l,"Rect")](-u,-h,i,o),c&&n.strokeRect(-u,-h,i,o),n.restore()}class jr{constructor(e){V(this,"visible",!0),V(this,"actionName",C0),V(this,"angle",0),V(this,"x",0),V(this,"y",0),V(this,"offsetX",0),V(this,"offsetY",0),V(this,"sizeX",0),V(this,"sizeY",0),V(this,"touchSizeX",0),V(this,"touchSizeY",0),V(this,"cursorStyle","crosshair"),V(this,"withConnection",!1),Object.assign(this,e)}shouldActivate(e,t,r,s){var i;let{tl:o,tr:a,br:l,bl:c}=s;return((i=t.canvas)===null||i===void 0?void 0:i.getActiveObject())===t&&t.isControlVisible(e)&&Et.isPointInPolygon(r,[o,a,l,c])}getActionHandler(e,t,r){return this.actionHandler}getMouseDownHandler(e,t,r){return this.mouseDownHandler}getMouseUpHandler(e,t,r){return this.mouseUpHandler}cursorStyleHandler(e,t,r){return t.cursorStyle}getActionName(e,t,r){return t.actionName}getVisibility(e,t){var r,s;return(r=(s=e._controlsVisibility)===null||s===void 0?void 0:s[t])!==null&&r!==void 0?r:this.visible}setVisibility(e,t,r){this.visible=e}positionHandler(e,t,r,s){return new Z(this.x*e.x+this.offsetX,this.y*e.y+this.offsetY).transform(t)}calcCornerCoords(e,t,r,s,i,o){const a=b1([Nd(r,s),jd({angle:e}),_1((i?this.touchSizeX:this.sizeX)||t,(i?this.touchSizeY:this.sizeY)||t)]);return{tl:new Z(-.5,-.5).transform(a),tr:new Z(.5,-.5).transform(a),br:new Z(.5,.5).transform(a),bl:new Z(-.5,.5).transform(a)}}render(e,t,r,s,i){((s=s||{}).cornerStyle||i.cornerStyle)==="circle"?wV.call(this,e,t,r,s,i):bV.call(this,e,t,r,s,i)}}const _V=(n,e,t)=>t.lockRotation?vp:e.cursorStyle,SV=xc(Y4,wc((n,e,t,r)=>{let{target:s,ex:i,ey:o,theta:a,originX:l,originY:c}=e;const u=s.translateToOriginPoint(s.getRelativeCenterPoint(),l,c);if(Zr(s,"lockRotation"))return!1;const h=Math.atan2(o-u.y,i-u.x),d=Math.atan2(r-u.y,t-u.x);let p=ga(d-h+a);if(s.snapAngle&&s.snapAngle>0){const g=s.snapAngle,y=s.snapThreshold||g,x=Math.ceil(p/g)*g,v=Math.floor(p/g)*g;Math.abs(p-v)<y?p=v:Math.abs(p-x)<y&&(p=x)}p<0&&(p=360+p),p%=360;const m=s.angle!==p;return s.angle=p,m}));function yO(n,e){const t=e.canvas,r=n[t.uniScaleKey];return t.uniformScaling&&!r||!t.uniformScaling&&r}function xO(n,e,t){const r=Zr(n,"lockScalingX"),s=Zr(n,"lockScalingY");if(r&&s||!e&&(r||s)&&t||r&&e==="x"||s&&e==="y")return!0;const{width:i,height:o,strokeWidth:a}=n;return i===0&&a===0&&e!=="y"||o===0&&a===0&&e!=="x"}const CV=["e","se","s","sw","w","nw","n","ne","e"],ru=(n,e,t)=>{const r=yO(n,t);if(xO(t,e.x!==0&&e.y===0?"x":e.x===0&&e.y!==0?"y":"",r))return vp;const s=hO(t,e);return"".concat(CV[s],"-resize")};function T1(n,e,t,r){let s=arguments.length>4&&arguments[4]!==void 0?arguments[4]:{};const i=e.target,o=s.by,a=yO(n,i);let l,c,u,h,d,p;if(xO(i,o,a))return!1;if(e.gestureScale)c=e.scaleX*e.gestureScale,u=e.scaleY*e.gestureScale;else{if(l=E1(e,e.originX,e.originY,t,r),d=o!=="y"?Math.sign(l.x||e.signX||1):1,p=o!=="x"?Math.sign(l.y||e.signY||1):1,e.signX||(e.signX=d),e.signY||(e.signY=p),Zr(i,"lockScalingFlip")&&(e.signX!==d||e.signY!==p))return!1;if(h=i._getTransformedDimensions(),a&&!o){const y=Math.abs(l.x)+Math.abs(l.y),{original:x}=e,v=y/(Math.abs(h.x*x.scaleX/i.scaleX)+Math.abs(h.y*x.scaleY/i.scaleY));c=x.scaleX*v,u=x.scaleY*v}else c=Math.abs(l.x*i.scaleX/h.x),u=Math.abs(l.y*i.scaleY/h.y);uO(e)&&(c*=2,u*=2),e.signX!==d&&o!=="y"&&(e.originX=MC(e.originX),c*=-1,e.signX=d),e.signY!==p&&o!=="x"&&(e.originY=MC(e.originY),u*=-1,e.signY=p)}const m=i.scaleX,g=i.scaleY;return o?(o==="x"&&i.set(nr,c),o==="y"&&i.set(Dr,u)):(!Zr(i,"lockScalingX")&&i.set(nr,c),!Zr(i,"lockScalingY")&&i.set(Dr,u)),m!==i.scaleX||g!==i.scaleY}const vh=xc(S0,wc((n,e,t,r)=>T1(n,e,t,r))),EV=xc(S0,wc((n,e,t,r)=>T1(n,e,t,r,{by:"x"}))),kV=xc(S0,wc((n,e,t,r)=>T1(n,e,t,r,{by:"y"}))),PV=["target","ex","ey","skewingSide"],Zg={x:{counterAxis:"y",scale:nr,skew:mc,lockSkewing:"lockSkewingX",origin:"originX",flip:"flipX"},y:{counterAxis:"x",scale:Dr,skew:vc,lockSkewing:"lockSkewingY",origin:"originY",flip:"flipY"}},TV=["ns","nesw","ew","nwse"],AV=(n,e,t)=>{if(e.x!==0&&Zr(t,"lockSkewingY")||e.y!==0&&Zr(t,"lockSkewingX"))return vp;const r=hO(t,e)%4;return"".concat(TV[r],"-resize")};function wO(n,e,t,r,s){const{target:i}=t,{counterAxis:o,origin:a,lockSkewing:l,skew:c,flip:u}=Zg[n];if(Zr(i,l))return!1;const{origin:h,flip:d}=Zg[o],p=zt(t[h])*(i[d]?-1:1),m=-Math.sign(p)*(i[u]?-1:1),g=.5*-((i[c]===0&&E1(t,qe,qe,r,s)[n]>0||i[c]>0?1:-1)*m)+.5;return xc(X4,wc((x,v,w,_)=>function(S,E,C){let{target:P,ex:O,ey:A,skewingSide:R}=E,B=Ct(E,PV);const{skew:I}=Zg[S],L=C.subtract(new Z(O,A)).divide(new Z(P.scaleX,P.scaleY))[S],U=P[I],F=B[I],D=Math.tan(Ft(F)),k=S==="y"?P._getTransformedDimensions({scaleX:1,scaleY:1,skewX:0}).x:P._getTransformedDimensions({scaleX:1,scaleY:1}).y,N=2*L*R/Math.max(k,1)+D,M=ga(Math.atan(N));P.set(I,M);const T=U!==P[I];if(T&&S==="y"){const{skewX:j,scaleX:$}=P,z=P._getTransformedDimensions({skewY:U}),ee=P._getTransformedDimensions(),X=j!==0?z.x/ee.x:1;X!==1&&P.set(nr,X*$)}return T}(n,v,new Z(w,_))))(e,q(q({},t),{},{[a]:g,skewingSide:m}),r,s)}const DV=(n,e,t,r)=>wO("x",n,e,t,r),OV=(n,e,t,r)=>wO("y",n,e,t,r);function A0(n,e){return n[e.canvas.altActionKey]}const yh=(n,e,t)=>{const r=A0(n,t);return e.x===0?r?mc:Dr:e.y===0?r?vc:nr:""},il=(n,e,t)=>A0(n,t)?AV(0,e,t):ru(n,e,t),HC=(n,e,t,r)=>A0(n,e.target)?OV(n,e,t,r):EV(n,e,t,r),VC=(n,e,t,r)=>A0(n,e.target)?DV(n,e,t,r):kV(n,e,t,r),bO=()=>({ml:new jr({x:-.5,y:0,cursorStyleHandler:il,actionHandler:HC,getActionName:yh}),mr:new jr({x:.5,y:0,cursorStyleHandler:il,actionHandler:HC,getActionName:yh}),mb:new jr({x:0,y:.5,cursorStyleHandler:il,actionHandler:VC,getActionName:yh}),mt:new jr({x:0,y:-.5,cursorStyleHandler:il,actionHandler:VC,getActionName:yh}),tl:new jr({x:-.5,y:-.5,cursorStyleHandler:ru,actionHandler:vh}),tr:new jr({x:.5,y:-.5,cursorStyleHandler:ru,actionHandler:vh}),bl:new jr({x:-.5,y:.5,cursorStyleHandler:ru,actionHandler:vh}),br:new jr({x:.5,y:.5,cursorStyleHandler:ru,actionHandler:vh}),mtr:new jr({x:0,y:-.5,actionHandler:SV,cursorStyleHandler:_V,offsetY:-40,withConnection:!0,actionName:x1})}),IV=()=>({mr:new jr({x:.5,y:0,actionHandler:WC,cursorStyleHandler:il,actionName:id}),ml:new jr({x:-.5,y:0,actionHandler:WC,cursorStyleHandler:il,actionName:id})}),RV=()=>q(q({},bO()),IV());class ld extends As{static getDefaults(){return q(q({},super.getDefaults()),ld.ownDefaults)}constructor(e){super(),Object.assign(this,this.constructor.createControls(),ld.ownDefaults),this.setOptions(e)}static createControls(){return{controls:bO()}}_updateCacheCanvas(){const e=this.canvas;if(this.noScaleCache&&e&&e._currentTransform){const t=e._currentTransform,r=t.target,s=t.action;if(this===r&&s&&s.startsWith(C0))return!1}return super._updateCacheCanvas()}getActiveControl(){const e=this.__corner;return e?{key:e,control:this.controls[e],coord:this.oCoords[e]}:void 0}findControl(e){let t=arguments.length>1&&arguments[1]!==void 0&&arguments[1];if(!this.hasControls||!this.canvas)return;this.__corner=void 0;const r=Object.entries(this.oCoords);for(let s=r.length-1;s>=0;s--){const[i,o]=r[s],a=this.controls[i];if(a.shouldActivate(i,this,e,t?o.touchCorner:o.corner))return this.__corner=i,{key:i,control:a,coord:this.oCoords[i]}}}calcOCoords(){const e=this.getViewportTransform(),t=this.getCenterPoint(),r=Nd(t.x,t.y),s=jd({angle:this.getTotalAngle()-(this.group&&this.flipX?180:0)}),i=pn(r,s),o=pn(e,i),a=pn(o,[1/e[0],0,0,1/e[3],0,0]),l=this.group?pp(this.calcTransformMatrix()):void 0;l&&(l.scaleX=Math.abs(l.scaleX),l.scaleY=Math.abs(l.scaleY));const c=this._calculateCurrentDimensions(l),u={};return this.forEachControl((h,d)=>{const p=h.positionHandler(c,a,this,h);u[d]=Object.assign(p,this._calcCornerCoords(h,p))}),u}_calcCornerCoords(e,t){const r=this.getTotalAngle();return{corner:e.calcCornerCoords(r,this.cornerSize,t.x,t.y,!1,this),touchCorner:e.calcCornerCoords(r,this.touchCornerSize,t.x,t.y,!0,this)}}setCoords(){super.setCoords(),this.canvas&&(this.oCoords=this.calcOCoords())}forEachControl(e){for(const t in this.controls)e(this.controls[t],t,this)}drawSelectionBackground(e){if(!this.selectionBackgroundColor||this.canvas&&this.canvas._activeObject!==this)return;e.save();const t=this.getRelativeCenterPoint(),r=this._calculateCurrentDimensions(),s=this.getViewportTransform();e.translate(t.x,t.y),e.scale(1/s[0],1/s[3]),e.rotate(Ft(this.angle)),e.fillStyle=this.selectionBackgroundColor,e.fillRect(-r.x/2,-r.y/2,r.x,r.y),e.restore()}strokeBorders(e,t){e.strokeRect(-t.x/2,-t.y/2,t.x,t.y)}_drawBorders(e,t){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const s=q({hasControls:this.hasControls,borderColor:this.borderColor,borderDashArray:this.borderDashArray},r);e.save(),e.strokeStyle=s.borderColor,this._setLineDash(e,s.borderDashArray),this.strokeBorders(e,t),s.hasControls&&this.drawControlsConnectingLines(e,t),e.restore()}_renderControls(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{hasBorders:r,hasControls:s}=this,i=q({hasBorders:r,hasControls:s},t),o=this.getViewportTransform(),a=i.hasBorders,l=i.hasControls,c=pn(o,this.calcTransformMatrix()),u=pp(c);e.save(),e.translate(u.translateX,u.translateY),e.lineWidth=1*this.borderScaleFactor,this.group===this.parent&&(e.globalAlpha=this.isMoving?this.borderOpacityWhenMoving:1),this.flipX&&(u.angle-=180),e.rotate(Ft(this.group?u.angle:this.angle)),a&&this.drawBorders(e,u,t),l&&this.drawControls(e,t),e.restore()}drawBorders(e,t,r){let s;if(r&&r.forActiveSelection||this.group){const i=C1(this.width,this.height,E0(t)),o=this.isStrokeAccountedForInDimensions()?w1:(this.strokeUniform?new Z().scalarAdd(this.canvas?this.canvas.getZoom():1):new Z(t.scaleX,t.scaleY)).scalarMultiply(this.strokeWidth);s=i.add(o).scalarAdd(this.borderScaleFactor).scalarAdd(2*this.padding)}else s=this._calculateCurrentDimensions().scalarAdd(this.borderScaleFactor);this._drawBorders(e,s,r)}drawControlsConnectingLines(e,t){let r=!1;e.beginPath(),this.forEachControl((s,i)=>{s.withConnection&&s.getVisibility(this,i)&&(r=!0,e.moveTo(s.x*t.x,s.y*t.y),e.lineTo(s.x*t.x+s.offsetX,s.y*t.y+s.offsetY))}),r&&e.stroke()}drawControls(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};e.save();const r=this.getCanvasRetinaScaling(),{cornerStrokeColor:s,cornerDashArray:i,cornerColor:o}=this,a=q({cornerStrokeColor:s,cornerDashArray:i,cornerColor:o},t);e.setTransform(r,0,0,r,0,0),e.strokeStyle=e.fillStyle=a.cornerColor,this.transparentCorners||(e.strokeStyle=a.cornerStrokeColor),this._setLineDash(e,a.cornerDashArray),this.forEachControl((l,c)=>{if(l.getVisibility(this,c)){const u=this.oCoords[c];l.render(e,u.x,u.y,a,this)}}),e.restore()}isControlVisible(e){return this.controls[e]&&this.controls[e].getVisibility(this,e)}setControlVisible(e,t){this._controlsVisibility||(this._controlsVisibility={}),this._controlsVisibility[e]=t}setControlsVisibility(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Object.entries(e).forEach(t=>{let[r,s]=t;return this.setControlVisible(r,s)})}clearContextTop(e){if(!this.canvas)return;const t=this.canvas.contextTop;if(!t)return;const r=this.canvas.viewportTransform;t.save(),t.transform(r[0],r[1],r[2],r[3],r[4],r[5]),this.transform(t);const s=this.width+4,i=this.height+4;return t.clearRect(-s/2,-i/2,s,i),e||t.restore(),t}onDeselect(e){return!1}onSelect(e){return!1}shouldStartDragging(e){return!1}onDragStart(e){return!1}canDrop(e){return!1}renderDragSourceEffect(e){}renderDropTargetEffect(e){}}function _O(n,e){return e.forEach(t=>{Object.getOwnPropertyNames(t.prototype).forEach(r=>{r!=="constructor"&&Object.defineProperty(n.prototype,r,Object.getOwnPropertyDescriptor(t.prototype,r)||Object.create(null))})}),n}V(ld,"ownDefaults",{noScaleCache:!0,lockMovementX:!1,lockMovementY:!1,lockRotation:!1,lockScalingX:!1,lockScalingY:!1,lockSkewingX:!1,lockSkewingY:!1,lockScalingFlip:!1,cornerSize:13,touchCornerSize:24,transparentCorners:!0,cornerColor:"rgb(178,204,255)",cornerStrokeColor:"",cornerStyle:"rect",cornerDashArray:null,hasControls:!0,borderColor:"rgb(178,204,255)",borderDashArray:null,borderOpacityWhenMoving:.4,borderScaleFactor:1,hasBorders:!0,selectionBackgroundColor:"",selectable:!0,evented:!0,perPixelTargetFind:!1,activeOn:"down",hoverCursor:null,moveCursor:null});class En extends ld{}_O(En,[fO]),me.setClass(En),me.setClass(En,"object");const NV=(n,e,t,r)=>{const s=2*(r=Math.round(r))+1,{data:i}=n.getImageData(e-r,t-r,s,s);for(let o=3;o<i.length;o+=4)if(i[o]>0)return!1;return!0};class SO{constructor(e){this.options=e,this.strokeProjectionMagnitude=this.options.strokeWidth/2,this.scale=new Z(this.options.scaleX,this.options.scaleY),this.strokeUniformScalar=this.options.strokeUniform?new Z(1/this.options.scaleX,1/this.options.scaleY):new Z(1,1)}createSideVector(e,t){const r=Zy(e,t);return this.options.strokeUniform?r.multiply(this.scale):r}projectOrthogonally(e,t,r){return this.applySkew(e.add(this.calcOrthogonalProjection(e,t,r)))}isSkewed(){return this.options.skewX!==0||this.options.skewY!==0}applySkew(e){const t=new Z(e);return t.y+=t.x*Math.tan(Ft(this.options.skewY)),t.x+=t.y*Math.tan(Ft(this.options.skewX)),t}scaleUnitVector(e,t){return e.multiply(this.strokeUniformScalar).scalarMultiply(t)}}const jV=new Z;class kl extends SO{static getOrthogonalRotationFactor(e,t){const r=t?tx(e,t):rV(e);return Math.abs(r)<Rd?-1:1}constructor(e,t,r,s){super(s),V(this,"AB",void 0),V(this,"AC",void 0),V(this,"alpha",void 0),V(this,"bisector",void 0),this.A=new Z(e),this.B=new Z(t),this.C=new Z(r),this.AB=this.createSideVector(this.A,this.B),this.AC=this.createSideVector(this.A,this.C),this.alpha=tx(this.AB,this.AC),this.bisector=k1(gO(this.AB.eq(jV)?this.AC:this.AB,this.alpha/2))}calcOrthogonalProjection(e,t){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.strokeProjectionMagnitude;const s=this.createSideVector(e,t),i=mO(s),o=kl.getOrthogonalRotationFactor(i,this.bisector);return this.scaleUnitVector(i,r*o)}projectBevel(){const e=[];return(this.alpha%up==0?[this.B]:[this.B,this.C]).forEach(t=>{e.push(this.projectOrthogonally(this.A,t)),e.push(this.projectOrthogonally(this.A,t,-this.strokeProjectionMagnitude))}),e}projectMiter(){const e=[],t=Math.abs(this.alpha),r=1/Math.sin(t/2),s=this.scaleUnitVector(this.bisector,-this.strokeProjectionMagnitude*r),i=this.options.strokeUniform?ex(this.scaleUnitVector(this.bisector,this.options.strokeMiterLimit)):this.options.strokeMiterLimit;return ex(s)/this.strokeProjectionMagnitude<=i&&e.push(this.applySkew(this.A.add(s))),e.push(...this.projectBevel()),e}projectRoundNoSkew(e,t){const r=[],s=new Z(kl.getOrthogonalRotationFactor(this.bisector),kl.getOrthogonalRotationFactor(new Z(this.bisector.y,this.bisector.x)));return[new Z(1,0).scalarMultiply(this.strokeProjectionMagnitude).multiply(this.strokeUniformScalar).multiply(s),new Z(0,1).scalarMultiply(this.strokeProjectionMagnitude).multiply(this.strokeUniformScalar).multiply(s)].forEach(i=>{UC(i,e,t)&&r.push(this.A.add(i))}),r}projectRoundWithSkew(e,t){const r=[],{skewX:s,skewY:i,scaleX:o,scaleY:a,strokeUniform:l}=this.options,c=new Z(Math.tan(Ft(s)),Math.tan(Ft(i))),u=this.strokeProjectionMagnitude,h=l?u/a/Math.sqrt(1/a**2+1/o**2*c.y**2):u/Math.sqrt(1+c.y**2),d=new Z(Math.sqrt(Math.max(u**2-h**2,0)),h),p=l?u/Math.sqrt(1+c.x**2*(1/a)**2/(1/o+1/o*c.x*c.y)**2):u/Math.sqrt(1+c.x**2/(1+c.x*c.y)**2),m=new Z(p,Math.sqrt(Math.max(u**2-p**2,0)));return[m,m.scalarMultiply(-1),d,d.scalarMultiply(-1)].map(g=>this.applySkew(l?g.multiply(this.strokeUniformScalar):g)).forEach(g=>{UC(g,e,t)&&r.push(this.applySkew(this.A).add(g))}),r}projectRound(){const e=[];e.push(...this.projectBevel());const t=this.alpha%up==0,r=this.applySkew(this.A),s=e[t?0:2].subtract(r),i=e[t?1:0].subtract(r),o=t?this.applySkew(this.AB.scalarMultiply(-1)):this.applySkew(this.bisector.multiply(this.strokeUniformScalar).scalarMultiply(-1)),a=Su(s,o)>0,l=a?s:i,c=a?i:s;return this.isSkewed()?e.push(...this.projectRoundWithSkew(l,c)):e.push(...this.projectRoundNoSkew(l,c)),e}projectPoints(){switch(this.options.strokeLineJoin){case"miter":return this.projectMiter();case"round":return this.projectRound();default:return this.projectBevel()}}project(){return this.projectPoints().map(e=>({originPoint:this.A,projectedPoint:e,angle:this.alpha,bisector:this.bisector}))}}class GC extends SO{constructor(e,t,r){super(r),this.A=new Z(e),this.T=new Z(t)}calcOrthogonalProjection(e,t){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.strokeProjectionMagnitude;const s=this.createSideVector(e,t);return this.scaleUnitVector(mO(s),r)}projectButt(){return[this.projectOrthogonally(this.A,this.T,this.strokeProjectionMagnitude),this.projectOrthogonally(this.A,this.T,-this.strokeProjectionMagnitude)]}projectRound(){const e=[];if(!this.isSkewed()&&this.A.eq(this.T)){const t=new Z(1,1).scalarMultiply(this.strokeProjectionMagnitude).multiply(this.strokeUniformScalar);e.push(this.applySkew(this.A.add(t)),this.applySkew(this.A.subtract(t)))}else e.push(...new kl(this.A,this.T,this.T,this.options).projectRound());return e}projectSquare(){const e=[];if(this.A.eq(this.T)){const t=new Z(1,1).scalarMultiply(this.strokeProjectionMagnitude).multiply(this.strokeUniformScalar);e.push(this.A.add(t),this.A.subtract(t))}else{const t=this.calcOrthogonalProjection(this.A,this.T,this.strokeProjectionMagnitude),r=this.scaleUnitVector(k1(this.createSideVector(this.A,this.T)),-this.strokeProjectionMagnitude),s=this.A.add(r);e.push(s.add(t),s.subtract(t))}return e.map(t=>this.applySkew(t))}projectPoints(){switch(this.options.strokeLineCap){case"round":return this.projectRound();case"square":return this.projectSquare();default:return this.projectButt()}}project(){return this.projectPoints().map(e=>({originPoint:this.A,projectedPoint:e}))}}const LV=function(n,e){let t=arguments.length>2&&arguments[2]!==void 0&&arguments[2];const r=[];if(n.length===0)return r;const s=n.reduce((i,o)=>(i[i.length-1].eq(o)||i.push(new Z(o)),i),[new Z(n[0])]);if(s.length===1)t=!0;else if(!t){const i=s[0],o=((a,l)=>{for(let c=a.length-1;c>=0;c--)if(l(a[c],c,a))return c;return-1})(s,a=>!a.eq(i));s.splice(o+1)}return s.forEach((i,o,a)=>{let l,c;o===0?(c=a[1],l=t?i:a[a.length-1]):o===a.length-1?(l=a[o-1],c=t?i:a[0]):(l=a[o-1],c=a[o+1]),t&&a.length===1?r.push(...new GC(i,i,e).project()):!t||o!==0&&o!==a.length-1?r.push(...new kl(i,l,c,e).project()):r.push(...new GC(i,o===0?c:l,e).project())}),r},A1=n=>{const e={};return Object.keys(n).forEach(t=>{e[t]={},Object.keys(n[t]).forEach(r=>{e[t][r]=q({},n[t][r])})}),e},MV=n=>n.replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&apos;").replace(/</g,"&lt;").replace(/>/g,"&gt;"),D1=n=>{const e=[];for(let t,r=0;r<n.length;r++)(t=FV(n,r))!==!1&&e.push(t);return e},FV=(n,e)=>{const t=n.charCodeAt(e);if(isNaN(t))return"";if(t<55296||t>57343)return n.charAt(e);if(55296<=t&&t<=56319){if(n.length<=e+1)throw"High surrogate without following low surrogate";const s=n.charCodeAt(e+1);if(56320>s||s>57343)throw"High surrogate without following low surrogate";return n.charAt(e)+n.charAt(e+1)}if(e===0)throw"Low surrogate without preceding high surrogate";const r=n.charCodeAt(e-1);if(55296>r||r>56319)throw"Low surrogate without preceding high surrogate";return!1},O1=function(n,e){let t=arguments.length>2&&arguments[2]!==void 0&&arguments[2];return n.fill!==e.fill||n.stroke!==e.stroke||n.strokeWidth!==e.strokeWidth||n.fontSize!==e.fontSize||n.fontFamily!==e.fontFamily||n.fontWeight!==e.fontWeight||n.fontStyle!==e.fontStyle||n.textBackgroundColor!==e.textBackgroundColor||n.deltaY!==e.deltaY||t&&(n.overline!==e.overline||n.underline!==e.underline||n.linethrough!==e.linethrough)},BV=(n,e)=>{const t=e.split(`
`),r=[];let s=-1,i={};n=A1(n);for(let o=0;o<t.length;o++){const a=D1(t[o]);if(n[o])for(let l=0;l<a.length;l++){s++;const c=n[o][l];c&&Object.keys(c).length>0&&(O1(i,c,!0)?r.push({start:s,end:s+1,style:c}):r[r.length-1].end++),i=c||{}}else s+=a.length,i={}}return r},UV=(n,e)=>{if(!Array.isArray(n))return A1(n);const t=e.split(y1),r={};let s=-1,i=0;for(let o=0;o<t.length;o++){const a=D1(t[o]);for(let l=0;l<a.length;l++)s++,n[i]&&n[i].start<=s&&s<n[i].end&&(r[o]=r[o]||{},r[o][l]=q({},n[i].style),s===n[i].end-1&&i++)}return r},Eo=["display","transform",Gt,"fill-opacity","fill-rule","opacity",er,"stroke-dasharray","stroke-linecap","stroke-dashoffset","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke-width","id","paint-order","vector-effect","instantiated_by_use","clip-path"];function qC(n,e){const t=n.nodeName,r=n.getAttribute("class"),s=n.getAttribute("id"),i="(?![a-zA-Z\\-]+)";let o;if(o=new RegExp("^"+t,"i"),e=e.replace(o,""),s&&e.length&&(o=new RegExp("#"+s+i,"i"),e=e.replace(o,"")),r&&e.length){const a=r.split(" ");for(let l=a.length;l--;)o=new RegExp("\\."+a[l]+i,"i"),e=e.replace(o,"")}return e.length===0}function $V(n,e){let t=!0;const r=qC(n,e.pop());return r&&e.length&&(t=function(s,i){let o,a=!0;for(;s.parentElement&&s.parentElement.nodeType===1&&i.length;)a&&(o=i.pop()),a=qC(s=s.parentElement,o);return i.length===0}(n,e)),r&&t&&e.length===0}const zV=n=>{var e;return(e=tV[n])!==null&&e!==void 0?e:n},WV=new RegExp("(".concat(ma,")"),"gi"),HV=n=>n.replace(WV," $1 ").replace(/,/gi," ").replace(/\s+/gi," ");var YC,XC,KC,JC,QC,ZC,eE;const Rn="(".concat(ma,")"),VV=String.raw(YC||(YC=Co(["(skewX)(",")"],["(skewX)\\(","\\)"])),Rn),GV=String.raw(XC||(XC=Co(["(skewY)(",")"],["(skewY)\\(","\\)"])),Rn),qV=String.raw(KC||(KC=Co(["(rotate)(","(?: "," ",")?)"],["(rotate)\\(","(?: "," ",")?\\)"])),Rn,Rn,Rn),YV=String.raw(JC||(JC=Co(["(scale)(","(?: ",")?)"],["(scale)\\(","(?: ",")?\\)"])),Rn,Rn),XV=String.raw(QC||(QC=Co(["(translate)(","(?: ",")?)"],["(translate)\\(","(?: ",")?\\)"])),Rn,Rn),KV=String.raw(ZC||(ZC=Co(["(matrix)("," "," "," "," "," ",")"],["(matrix)\\("," "," "," "," "," ","\\)"])),Rn,Rn,Rn,Rn,Rn,Rn),I1="(?:".concat(KV,"|").concat(XV,"|").concat(qV,"|").concat(YV,"|").concat(VV,"|").concat(GV,")"),JV="(?:".concat(I1,"*)"),QV=String.raw(eE||(eE=Co(["^s*(?:","?)s*$"],["^\\s*(?:","?)\\s*$"])),JV),ZV=new RegExp(QV),eG=new RegExp(I1),tG=new RegExp(I1,"g");function nx(n){const e=[];if(!(n=HV(n).replace(/\s*([()])\s*/gi,"$1"))||n&&!ZV.test(n))return[...Fn];for(const t of n.matchAll(tG)){const r=eG.exec(t[0]);if(!r)continue;let s=Fn;const i=r.filter(m=>!!m),[,o,...a]=i,[l,c,u,h,d,p]=a.map(m=>parseFloat(m));switch(o){case"translate":s=Nd(l,c);break;case x1:s=jd({angle:l},{x:c,y:u});break;case C0:s=_1(l,c);break;case mc:s=tO(l);break;case vc:s=nO(l);break;case"matrix":s=[l,c,u,h,d,p]}e.push(s)}return b1(e)}function nG(n,e,t,r){const s=Array.isArray(e);let i,o=e;if(n!==Gt&&n!==er||e!==Zn){if(n==="strokeUniform")return e==="non-scaling-stroke";if(n==="strokeDashArray")o=e===Zn?null:e.replace(/,/g," ").split(/\s+/).map(parseFloat);else if(n==="transformMatrix")o=t&&t.transformMatrix?pn(t.transformMatrix,nx(e)):nx(e);else if(n==="visible")o=e!==Zn&&e!=="hidden",t&&t.visible===!1&&(o=!1);else if(n==="opacity")o=parseFloat(e),t&&t.opacity!==void 0&&(o*=t.opacity);else if(n==="textAnchor")o=e==="start"?lt:e==="end"?Lt:qe;else if(n==="charSpacing")i=Cl(e,r)/r*1e3;else if(n==="paintFirst"){const a=e.indexOf(Gt),l=e.indexOf(er);o=Gt,(a>-1&&l>-1&&l<a||a===-1&&l>-1)&&(o=er)}else{if(n==="href"||n==="xlink:href"||n==="font"||n==="id")return e;if(n==="imageSmoothing")return e==="optimizeQuality";i=s?e.map(Cl):Cl(e,r)}}else o="";return!s&&isNaN(i)?o:i}function rG(n,e){const t=n.match(eV);if(!t)return;const r=t[1],s=t[3],i=t[4],o=t[5],a=t[6];r&&(e.fontStyle=r),s&&(e.fontWeight=isNaN(parseFloat(s))?s:parseFloat(s)),i&&(e.fontSize=Cl(i)),a&&(e.fontFamily=a),o&&(e.lineHeight=o==="normal"?1:o)}function sG(n,e){n.replace(/;\s*$/,"").split(";").forEach(t=>{if(!t)return;const[r,s]=t.split(":");e[r.trim().toLowerCase()]=s.trim()})}function iG(n){const e={},t=n.getAttribute("style");return t&&(typeof t=="string"?sG(t,e):function(r,s){Object.entries(r).forEach(i=>{let[o,a]=i;a!==void 0&&(s[o.toLowerCase()]=a)})}(t,e)),e}const oG={stroke:"strokeOpacity",fill:"fillOpacity"};function fi(n,e,t){if(!n)return{};let r,s={},i=v1;n.parentNode&&BC.test(n.parentNode.nodeName)&&(s=fi(n.parentElement,e,t),s.fontSize&&(r=i=Cl(s.fontSize)));const o=q(q(q({},e.reduce((c,u)=>{const h=n.getAttribute(u);return h&&(c[u]=h),c},{})),function(c){let u=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},h={};for(const d in u)$V(c,d.split(" "))&&(h=q(q({},h),u[d]));return h}(n,t)),iG(n));o[Jg]&&n.setAttribute(Jg,o[Jg]),o[Kg]&&(r=Cl(o[Kg],i),o[Kg]="".concat(r));const a={};for(const c in o){const u=zV(c),h=nG(u,o[c],s,r);a[u]=h}a&&a.font&&rG(a.font,a);const l=q(q({},s),a);return BC.test(n.nodeName)?l:function(c){const u=En.getDefaults();return Object.entries(oG).forEach(h=>{let[d,p]=h;if(c[p]===void 0||c[d]==="")return;if(c[d]===void 0){if(!u[d])return;c[d]=u[d]}if(c[d].indexOf("url(")===0)return;const m=new dt(c[d]);c[d]=m.setAlpha(Tt(m.getAlpha()*c[p],2)).toRgba()}),c}(l)}const aG=["left","top","width","height","visible"],CO=["rx","ry"];class Vr extends En{static getDefaults(){return q(q({},super.getDefaults()),Vr.ownDefaults)}constructor(e){super(),Object.assign(this,Vr.ownDefaults),this.setOptions(e),this._initRxRy()}_initRxRy(){const{rx:e,ry:t}=this;e&&!t?this.ry=e:t&&!e&&(this.rx=t)}_render(e){const{width:t,height:r}=this,s=-t/2,i=-r/2,o=this.rx?Math.min(this.rx,t/2):0,a=this.ry?Math.min(this.ry,r/2):0,l=o!==0||a!==0;e.beginPath(),e.moveTo(s+o,i),e.lineTo(s+t-o,i),l&&e.bezierCurveTo(s+t-_i*o,i,s+t,i+_i*a,s+t,i+a),e.lineTo(s+t,i+r-a),l&&e.bezierCurveTo(s+t,i+r-_i*a,s+t-_i*o,i+r,s+t-o,i+r),e.lineTo(s+o,i+r),l&&e.bezierCurveTo(s+_i*o,i+r,s,i+r-_i*a,s,i+r-a),e.lineTo(s,i+a),l&&e.bezierCurveTo(s,i+_i*a,s+_i*o,i,s+o,i),e.closePath(),this._renderPaintInOrder(e)}toObject(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return super.toObject([...CO,...e])}_toSVG(){const{width:e,height:t,rx:r,ry:s}=this;return["<rect ","COMMON_PARTS",'x="'.concat(-e/2,'" y="').concat(-t/2,'" rx="').concat(r,'" ry="').concat(s,'" width="').concat(e,'" height="').concat(t,`" />
`)]}static async fromElement(e,t,r){const s=fi(e,this.ATTRIBUTE_NAMES,r),{left:i=0,top:o=0,width:a=0,height:l=0,visible:c=!0}=s,u=Ct(s,aG);return new this(q(q(q({},t),u),{},{left:i,top:o,width:a,height:l,visible:!!(c&&a&&l)}))}}V(Vr,"type","Rect"),V(Vr,"cacheProperties",[...hi,...CO]),V(Vr,"ownDefaults",{rx:0,ry:0}),V(Vr,"ATTRIBUTE_NAMES",[...Eo,"x","y","rx","ry","width","height"]),me.setClass(Vr),me.setSVGClass(Vr);const $s="initialization",yp="added",R1="removed",xp="imperative",EO=(n,e)=>{const{strokeUniform:t,strokeWidth:r,width:s,height:i,group:o}=e,a=o&&o!==n?P0(o.calcTransformMatrix(),n.calcTransformMatrix()):null,l=a?e.getRelativeCenterPoint().transform(a):e.getRelativeCenterPoint(),c=!e.isStrokeAccountedForInDimensions(),u=t&&c?KH(new Z(r,r),void 0,n.calcTransformMatrix()):w1,h=!t&&c?r:0,d=C1(s+h,i+h,b1([a,e.calcOwnMatrix()],!0)).add(u).scalarDivide(2);return[l.subtract(d),l.add(d)]};class D0{calcLayoutResult(e,t){if(this.shouldPerformLayout(e))return this.calcBoundingBox(t,e)}shouldPerformLayout(e){let{type:t,prevStrategy:r,strategy:s}=e;return t===$s||t===xp||!!r&&s!==r}shouldLayoutClipPath(e){let{type:t,target:{clipPath:r}}=e;return t!==$s&&r&&!r.absolutePositioned}getInitialSize(e,t){return t.size}calcBoundingBox(e,t){const{type:r,target:s}=t;if(r===xp&&t.overrides)return t.overrides;if(e.length===0)return;const{left:i,top:o,width:a,height:l}=Xs(e.map(h=>EO(s,h)).reduce((h,d)=>h.concat(d),[])),c=new Z(a,l),u=new Z(i,o).add(c.scalarDivide(2));if(r===$s){const h=this.getInitialSize(t,{size:c,center:u});return{center:u,relativeCorrection:new Z(0,0),size:h}}return{center:u.transform(s.calcOwnMatrix()),size:c}}}V(D0,"type","strategy");class rx extends D0{shouldPerformLayout(e){return!0}}V(rx,"type","fit-content"),me.setClass(rx);const lG=["strategy"],cG=["target","strategy","bubbles","prevStrategy"],kO="layoutManager";class cd{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:new rx;V(this,"strategy",void 0),this.strategy=e,this._subscriptions=new Map}performLayout(e){const t=q(q({bubbles:!0,strategy:this.strategy},e),{},{prevStrategy:this._prevLayoutStrategy,stopPropagation(){this.bubbles=!1}});this.onBeforeLayout(t);const r=this.getLayoutResult(t);r&&this.commitLayout(t,r),this.onAfterLayout(t,r),this._prevLayoutStrategy=t.strategy}attachHandlers(e,t){const{target:r}=t;return[hp,q4,id,Y4,S0,X4,dp,jH,LH].map(s=>e.on(s,i=>this.performLayout(s===hp?{type:"object_modified",trigger:s,e:i,target:r}:{type:"object_modifying",trigger:s,e:i,target:r})))}subscribe(e,t){this.unsubscribe(e,t);const r=this.attachHandlers(e,t);this._subscriptions.set(e,r)}unsubscribe(e,t){(this._subscriptions.get(e)||[]).forEach(r=>r()),this._subscriptions.delete(e)}unsubscribeTargets(e){e.targets.forEach(t=>this.unsubscribe(t,e))}subscribeTargets(e){e.targets.forEach(t=>this.subscribe(t,e))}onBeforeLayout(e){const{target:t,type:r}=e,{canvas:s}=t;if(r===$s||r===yp?this.subscribeTargets(e):r===R1&&this.unsubscribeTargets(e),t.fire("layout:before",{context:e}),s&&s.fire("object:layout:before",{target:t,context:e}),r===xp&&e.deep){const i=Ct(e,lG);t.forEachObject(o=>o.layoutManager&&o.layoutManager.performLayout(q(q({},i),{},{bubbles:!1,target:o})))}}getLayoutResult(e){const{target:t,strategy:r,type:s}=e,i=r.calcLayoutResult(e,t.getObjects());if(!i)return;const o=s===$s?new Z:t.getRelativeCenterPoint(),{center:a,correction:l=new Z,relativeCorrection:c=new Z}=i,u=o.subtract(a).add(l).transform(s===$s?Fn:Xr(t.calcOwnMatrix()),!0).add(c);return{result:i,prevCenter:o,nextCenter:a,offset:u}}commitLayout(e,t){const{target:r}=e,{result:{size:s},nextCenter:i}=t;var o,a;r.set({width:s.x,height:s.y}),this.layoutObjects(e,t),e.type===$s?r.set({left:(o=e.x)!==null&&o!==void 0?o:i.x+s.x*zt(r.originX),top:(a=e.y)!==null&&a!==void 0?a:i.y+s.y*zt(r.originY)}):(r.setPositionByOrigin(i,qe,qe),r.setCoords(),r.set("dirty",!0))}layoutObjects(e,t){const{target:r}=e;r.forEachObject(s=>{s.group===r&&this.layoutObject(e,t,s)}),e.strategy.shouldLayoutClipPath(e)&&this.layoutObject(e,t,r.clipPath)}layoutObject(e,t,r){let{offset:s}=t;r.set({left:r.left+s.x,top:r.top+s.y})}onAfterLayout(e,t){const{target:r,strategy:s,bubbles:i,prevStrategy:o}=e,a=Ct(e,cG),{canvas:l}=r;r.fire("layout:after",{context:e,result:t}),l&&l.fire("object:layout:after",{context:e,result:t,target:r});const c=r.parent;i&&c!=null&&c.layoutManager&&((a.path||(a.path=[])).push(r),c.layoutManager.performLayout(q(q({},a),{},{target:c}))),r.set("dirty",!0)}dispose(){const{_subscriptions:e}=this;e.forEach(t=>t.forEach(r=>r())),e.clear()}toObject(){return{type:kO,strategy:this.strategy.constructor.type}}toJSON(){return this.toObject()}}me.setClass(cd,kO);const uG=["type","objects","layoutManager"];class dG extends cd{performLayout(){}}class sa extends K4(En){static getDefaults(){return q(q({},super.getDefaults()),sa.ownDefaults)}constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(),V(this,"_activeObjects",[]),V(this,"__objectSelectionTracker",void 0),V(this,"__objectSelectionDisposer",void 0),Object.assign(this,sa.ownDefaults),this.setOptions(t),this.groupInit(e,t)}groupInit(e,t){var r;this._objects=[...e],this.__objectSelectionTracker=this.__objectSelectionMonitor.bind(this,!0),this.__objectSelectionDisposer=this.__objectSelectionMonitor.bind(this,!1),this.forEachObject(s=>{this.enterGroup(s,!1)}),this.layoutManager=(r=t.layoutManager)!==null&&r!==void 0?r:new cd,this.layoutManager.performLayout({type:$s,target:this,targets:[...e],x:t.left,y:t.top})}canEnterGroup(e){return e===this||this.isDescendantOf(e)?(po("error","Group: circular object trees are not supported, this call has no effect"),!1):this._objects.indexOf(e)===-1||(po("error","Group: duplicate objects are not supported inside group, this call has no effect"),!1)}_filterObjectsBeforeEnteringGroup(e){return e.filter((t,r,s)=>this.canEnterGroup(t)&&s.indexOf(t)===r)}add(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];const s=this._filterObjectsBeforeEnteringGroup(t),i=super.add(...s);return this._onAfterObjectsChange(yp,s),i}insertAt(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),s=1;s<t;s++)r[s-1]=arguments[s];const i=this._filterObjectsBeforeEnteringGroup(r),o=super.insertAt(e,...i);return this._onAfterObjectsChange(yp,i),o}remove(){const e=super.remove(...arguments);return this._onAfterObjectsChange(R1,e),e}_onObjectAdded(e){this.enterGroup(e,!0),this.fire("object:added",{target:e}),e.fire("added",{target:this})}_onObjectRemoved(e,t){this.exitGroup(e,t),this.fire("object:removed",{target:e}),e.fire("removed",{target:this})}_onAfterObjectsChange(e,t){this.layoutManager.performLayout({type:e,targets:t,target:this})}_onStackOrderChanged(){this._set("dirty",!0)}_set(e,t){const r=this[e];return super._set(e,t),e==="canvas"&&r!==t&&(this._objects||[]).forEach(s=>{s._set(e,t)}),this}_shouldSetNestedCoords(){return this.subTargetCheck}removeAll(){return this._activeObjects=[],this.remove(...this._objects)}__objectSelectionMonitor(e,t){let{target:r}=t;const s=this._activeObjects;if(e)s.push(r),this._set("dirty",!0);else if(s.length>0){const i=s.indexOf(r);i>-1&&(s.splice(i,1),this._set("dirty",!0))}}_watchObject(e,t){e&&this._watchObject(!1,t),e?(t.on("selected",this.__objectSelectionTracker),t.on("deselected",this.__objectSelectionDisposer)):(t.off("selected",this.__objectSelectionTracker),t.off("deselected",this.__objectSelectionDisposer))}enterGroup(e,t){e.group&&e.group.remove(e),e._set("parent",this),this._enterGroup(e,t)}_enterGroup(e,t){t&&mp(e,pn(Xr(this.calcTransformMatrix()),e.calcTransformMatrix())),this._shouldSetNestedCoords()&&e.setCoords(),e._set("group",this),e._set("canvas",this.canvas),this._watchObject(!0,e);const r=this.canvas&&this.canvas.getActiveObject&&this.canvas.getActiveObject();r&&(r===e||e.isDescendantOf(r))&&this._activeObjects.push(e)}exitGroup(e,t){this._exitGroup(e,t),e._set("parent",void 0),e._set("canvas",void 0)}_exitGroup(e,t){e._set("group",void 0),t||(mp(e,pn(this.calcTransformMatrix(),e.calcTransformMatrix())),e.setCoords()),this._watchObject(!1,e);const r=this._activeObjects.length>0?this._activeObjects.indexOf(e):-1;r>-1&&this._activeObjects.splice(r,1)}shouldCache(){const e=En.prototype.shouldCache.call(this);if(e){for(let t=0;t<this._objects.length;t++)if(this._objects[t].willDrawShadow())return this.ownCaching=!1,!1}return e}willDrawShadow(){if(super.willDrawShadow())return!0;for(let e=0;e<this._objects.length;e++)if(this._objects[e].willDrawShadow())return!0;return!1}isOnACache(){return this.ownCaching||!!this.parent&&this.parent.isOnACache()}drawObject(e){this._renderBackground(e);for(let r=0;r<this._objects.length;r++){var t;(t=this.canvas)!==null&&t!==void 0&&t.preserveObjectStacking&&this._objects[r].group!==this?(e.save(),e.transform(...Xr(this.calcTransformMatrix())),this._objects[r].render(e),e.restore()):this._objects[r].group===this&&this._objects[r].render(e)}this._drawClipPath(e,this.clipPath)}setCoords(){super.setCoords(),this._shouldSetNestedCoords()&&this.forEachObject(e=>e.setCoords())}triggerLayout(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.layoutManager.performLayout(q({target:this,type:xp},e))}render(e){this._transformDone=!0,super.render(e),this._transformDone=!1}__serializeObjects(e,t){const r=this.includeDefaultValues;return this._objects.filter(function(s){return!s.excludeFromExport}).map(function(s){const i=s.includeDefaultValues;s.includeDefaultValues=r;const o=s[e||"toObject"](t);return s.includeDefaultValues=i,o})}toObject(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];const t=this.layoutManager.toObject();return q(q(q({},super.toObject(["subTargetCheck","interactive",...e])),t.strategy!=="fit-content"||this.includeDefaultValues?{layoutManager:t}:{}),{},{objects:this.__serializeObjects("toObject",e)})}toString(){return"#<Group: (".concat(this.complexity(),")>")}dispose(){this.layoutManager.unsubscribeTargets({targets:this.getObjects(),target:this}),this._activeObjects=[],this.forEachObject(e=>{this._watchObject(!1,e),e.dispose()}),super.dispose()}_createSVGBgRect(e){if(!this.backgroundColor)return"";const t=Vr.prototype._toSVG.call(this),r=t.indexOf("COMMON_PARTS");t[r]='for="group" ';const s=t.join("");return e?e(s):s}_toSVG(e){const t=["<g ","COMMON_PARTS",` >
`],r=this._createSVGBgRect(e);r&&t.push("		",r);for(let s=0;s<this._objects.length;s++)t.push("		",this._objects[s].toSVG(e));return t.push(`</g>
`),t}getSvgStyles(){const e=this.opacity!==void 0&&this.opacity!==1?"opacity: ".concat(this.opacity,";"):"",t=this.visible?"":" visibility: hidden;";return[e,this.getSvgFilter(),t].join("")}toClipPathSVG(e){const t=[],r=this._createSVGBgRect(e);r&&t.push("	",r);for(let s=0;s<this._objects.length;s++)t.push("	",this._objects[s].toClipPathSVG(e));return this._createBaseClipPathSVGMarkup(t,{reviver:e})}static fromObject(e,t){let{type:r,objects:s=[],layoutManager:i}=e,o=Ct(e,uG);return Promise.all([od(s,t),k0(o,t)]).then(a=>{let[l,c]=a;const u=new this(l,q(q(q({},o),c),{},{layoutManager:new dG}));if(i){const h=me.getClass(i.type),d=me.getClass(i.strategy);u.layoutManager=new h(new d)}else u.layoutManager=new cd;return u.layoutManager.subscribeTargets({type:$s,target:u,targets:u.getObjects()}),u.setCoords(),u})}}V(sa,"type","Group"),V(sa,"ownDefaults",{strokeWidth:0,subTargetCheck:!1,interactive:!1}),me.setClass(sa);const hG=(n,e)=>Math.min(e.width/n.width,e.height/n.height),fG=(n,e)=>Math.max(e.width/n.width,e.height/n.height),sx="\\s*,?\\s*",Hc="".concat(sx,"(").concat(ma,")"),pG="".concat(Hc).concat(Hc).concat(Hc).concat(sx,"([01])").concat(sx,"([01])").concat(Hc).concat(Hc),gG={m:"l",M:"L"},mG=(n,e,t,r,s,i,o,a,l,c,u)=>{const h=ai(n),d=li(n),p=ai(e),m=li(e),g=t*s*p-r*i*m+o,y=r*s*p+t*i*m+a;return["C",c+l*(-t*s*d-r*i*h),u+l*(-r*s*d+t*i*h),g+l*(t*s*m+r*i*p),y+l*(r*s*m-t*i*p),g,y]},tE=(n,e,t,r)=>{const s=Math.atan2(e,n),i=Math.atan2(r,t);return i>=s?i-s:2*Math.PI-(s-i)};function nE(n,e,t,r,s,i,o,a){let l;if(nt.cachesBoundsOfCurve&&(l=[...arguments].join(),_u.boundsOfCurveCache[l]))return _u.boundsOfCurveCache[l];const c=Math.sqrt,u=Math.abs,h=[],d=[[0,0],[0,0]];let p=6*n-12*t+6*s,m=-3*n+9*t-9*s+3*o,g=3*t-3*n;for(let _=0;_<2;++_){if(_>0&&(p=6*e-12*r+6*i,m=-3*e+9*r-9*i+3*a,g=3*r-3*e),u(m)<1e-12){if(u(p)<1e-12)continue;const O=-g/p;0<O&&O<1&&h.push(O);continue}const S=p*p-4*g*m;if(S<0)continue;const E=c(S),C=(-p+E)/(2*m);0<C&&C<1&&h.push(C);const P=(-p-E)/(2*m);0<P&&P<1&&h.push(P)}let y=h.length;const x=y,v=PO(n,e,t,r,s,i,o,a);for(;y--;){const{x:_,y:S}=v(h[y]);d[0][y]=_,d[1][y]=S}d[0][x]=n,d[1][x]=e,d[0][x+1]=o,d[1][x+1]=a;const w=[new Z(Math.min(...d[0]),Math.min(...d[1])),new Z(Math.max(...d[0]),Math.max(...d[1]))];return nt.cachesBoundsOfCurve&&(_u.boundsOfCurveCache[l]=w),w}const vG=(n,e,t)=>{let[r,s,i,o,a,l,c,u]=t;const h=((d,p,m,g,y,x,v)=>{if(m===0||g===0)return[];let w=0,_=0,S=0;const E=Math.PI,C=v*m1,P=li(C),O=ai(C),A=.5*(-O*d-P*p),R=.5*(-O*p+P*d),B=m**2,I=g**2,L=R**2,U=A**2,F=B*I-B*L-I*U;let D=Math.abs(m),k=Math.abs(g);if(F<0){const ie=Math.sqrt(1-F/(B*I));D*=ie,k*=ie}else S=(y===x?-1:1)*Math.sqrt(F/(B*L+I*U));const N=S*D*R/k,M=-S*k*A/D,T=O*N-P*M+.5*d,j=P*N+O*M+.5*p;let $=tE(1,0,(A-N)/D,(R-M)/k),z=tE((A-N)/D,(R-M)/k,(-A-N)/D,(-R-M)/k);x===0&&z>0?z-=2*E:x===1&&z<0&&(z+=2*E);const ee=Math.ceil(Math.abs(z/E*2)),X=[],J=z/ee,K=8/3*Math.sin(J/4)*Math.sin(J/4)/Math.sin(J/2);let ne=$+J;for(let ie=0;ie<ee;ie++)X[ie]=mG($,ne,O,P,D,k,T,j,K,w,_),w=X[ie][5],_=X[ie][6],$=ne,ne+=J;return X})(c-n,u-e,s,i,a,l,o);for(let d=0,p=h.length;d<p;d++)h[d][1]+=n,h[d][2]+=e,h[d][3]+=n,h[d][4]+=e,h[d][5]+=n,h[d][6]+=e;return h},yG=n=>{let e=0,t=0,r=0,s=0;const i=[];let o,a=0,l=0;for(const c of n){const u=[...c];let h;switch(u[0]){case"l":u[1]+=e,u[2]+=t;case"L":e=u[1],t=u[2],h=["L",e,t];break;case"h":u[1]+=e;case"H":e=u[1],h=["L",e,t];break;case"v":u[1]+=t;case"V":t=u[1],h=["L",e,t];break;case"m":u[1]+=e,u[2]+=t;case"M":e=u[1],t=u[2],r=u[1],s=u[2],h=["M",e,t];break;case"c":u[1]+=e,u[2]+=t,u[3]+=e,u[4]+=t,u[5]+=e,u[6]+=t;case"C":a=u[3],l=u[4],e=u[5],t=u[6],h=["C",u[1],u[2],a,l,e,t];break;case"s":u[1]+=e,u[2]+=t,u[3]+=e,u[4]+=t;case"S":o==="C"?(a=2*e-a,l=2*t-l):(a=e,l=t),e=u[3],t=u[4],h=["C",a,l,u[1],u[2],e,t],a=h[3],l=h[4];break;case"q":u[1]+=e,u[2]+=t,u[3]+=e,u[4]+=t;case"Q":a=u[1],l=u[2],e=u[3],t=u[4],h=["Q",a,l,e,t];break;case"t":u[1]+=e,u[2]+=t;case"T":o==="Q"?(a=2*e-a,l=2*t-l):(a=e,l=t),e=u[1],t=u[2],h=["Q",a,l,e,t];break;case"a":u[6]+=e,u[7]+=t;case"A":vG(e,t,u).forEach(d=>i.push(d)),e=u[6],t=u[7];break;case"z":case"Z":e=r,t=s,h=["Z"]}h?(i.push(h),o=h[0]):o=""}return i},wp=(n,e,t,r)=>Math.sqrt((t-n)**2+(r-e)**2),PO=(n,e,t,r,s,i,o,a)=>l=>{const c=l**3,u=(p=>3*p**2*(1-p))(l),h=(p=>3*p*(1-p)**2)(l),d=(p=>(1-p)**3)(l);return new Z(o*c+s*u+t*h+n*d,a*c+i*u+r*h+e*d)},TO=n=>n**2,AO=n=>2*n*(1-n),DO=n=>(1-n)**2,xG=(n,e,t,r,s,i,o,a)=>l=>{const c=TO(l),u=AO(l),h=DO(l),d=3*(h*(t-n)+u*(s-t)+c*(o-s)),p=3*(h*(r-e)+u*(i-r)+c*(a-i));return Math.atan2(p,d)},wG=(n,e,t,r,s,i)=>o=>{const a=TO(o),l=AO(o),c=DO(o);return new Z(s*a+t*l+n*c,i*a+r*l+e*c)},bG=(n,e,t,r,s,i)=>o=>{const a=1-o,l=2*(a*(t-n)+o*(s-t)),c=2*(a*(r-e)+o*(i-r));return Math.atan2(c,l)},rE=(n,e,t)=>{let r=new Z(e,t),s=0;for(let i=1;i<=100;i+=1){const o=n(i/100);s+=wp(r.x,r.y,o.x,o.y),r=o}return s},_G=(n,e)=>{let t,r=0,s=0,i={x:n.x,y:n.y},o=q({},i),a=.01,l=0;const c=n.iterator,u=n.angleFinder;for(;s<e&&a>1e-4;)o=c(r),l=r,t=wp(i.x,i.y,o.x,o.y),t+s>e?(r-=a,a/=2):(i=o,r+=a,s+=t);return q(q({},o),{},{angle:u(l)})},OO=n=>{let e,t,r=0,s=0,i=0,o=0,a=0;const l=[];for(const c of n){const u={x:s,y:i,command:c[0],length:0};switch(c[0]){case"M":t=u,t.x=o=s=c[1],t.y=a=i=c[2];break;case"L":t=u,t.length=wp(s,i,c[1],c[2]),s=c[1],i=c[2];break;case"C":e=PO(s,i,c[1],c[2],c[3],c[4],c[5],c[6]),t=u,t.iterator=e,t.angleFinder=xG(s,i,c[1],c[2],c[3],c[4],c[5],c[6]),t.length=rE(e,s,i),s=c[5],i=c[6];break;case"Q":e=wG(s,i,c[1],c[2],c[3],c[4]),t=u,t.iterator=e,t.angleFinder=bG(s,i,c[1],c[2],c[3],c[4]),t.length=rE(e,s,i),s=c[3],i=c[4];break;case"Z":t=u,t.destX=o,t.destY=a,t.length=wp(s,i,o,a),s=o,i=a}r+=t.length,l.push(t)}return l.push({length:r,x:s,y:i}),l},SG=function(n,e){let t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:OO(n),r=0;for(;e-t[r].length>0&&r<t.length-2;)e-=t[r].length,r++;const s=t[r],i=e/s.length,o=n[r];switch(s.command){case"M":return{x:s.x,y:s.y,angle:0};case"Z":return q(q({},new Z(s.x,s.y).lerp(new Z(s.destX,s.destY),i)),{},{angle:Math.atan2(s.destY-s.y,s.destX-s.x)});case"L":return q(q({},new Z(s.x,s.y).lerp(new Z(o[1],o[2]),i)),{},{angle:Math.atan2(o[2]-s.y,o[1]-s.x)});case"C":case"Q":return _G(s,e)}},CG=new RegExp("[mzlhvcsqta][^mzlhvcsqta]*","gi"),sE=new RegExp(pG,"g"),EG=new RegExp(ma,"gi"),kG={m:2,l:2,h:1,v:1,c:6,s:4,q:4,t:2,a:7},PG=n=>{var e;const t=[],r=(e=n.match(CG))!==null&&e!==void 0?e:[];for(const s of r){const i=s[0];if(i==="z"||i==="Z"){t.push([i]);continue}const o=kG[i.toLowerCase()];let a=[];if(i==="a"||i==="A"){sE.lastIndex=0;for(let l=null;l=sE.exec(s);)a.push(...l.slice(1))}else a=s.match(EG)||[];for(let l=0;l<a.length;l+=o){const c=new Array(o),u=gG[i];c[0]=l>0&&u?u:i;for(let h=0;h<o;h++)c[h+1]=parseFloat(a[l+h]);t.push(c)}}return t},TG=(n,e)=>n.map(t=>t.map((r,s)=>s===0||e===void 0?r:Tt(r,e)).join(" ")).join(" ");function ix(n,e){const t=n.style;t&&e&&(typeof e=="string"?t.cssText+=";"+e:Object.entries(e).forEach(r=>{let[s,i]=r;return t.setProperty(s,i)}))}class AG extends aO{constructor(e){let{allowTouchScrolling:t=!1,containerClass:r=""}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(e),V(this,"upper",void 0),V(this,"container",void 0);const{el:s}=this.lower,i=this.createUpperCanvas();this.upper={el:i,ctx:i.getContext("2d")},this.applyCanvasStyle(s,{allowTouchScrolling:t}),this.applyCanvasStyle(i,{allowTouchScrolling:t,styles:{position:"absolute",left:"0",top:"0"}});const o=this.createContainerElement();o.classList.add(r),s.parentNode&&s.parentNode.replaceChild(o,s),o.append(s,i),this.container=o}createUpperCanvas(){const{el:e}=this.lower,t=Zt();return t.className=e.className,t.classList.remove("lower-canvas"),t.classList.add("upper-canvas"),t.setAttribute("data-fabric","top"),t.style.cssText=e.style.cssText,t.setAttribute("draggable","true"),t}createContainerElement(){const e=gc().createElement("div");return e.setAttribute("data-fabric","wrapper"),ix(e,{position:"relative"}),LC(e),e}applyCanvasStyle(e,t){const{styles:r,allowTouchScrolling:s}=t;ix(e,q(q({},r),{},{"touch-action":s?"manipulation":Zn})),LC(e)}setDimensions(e,t){super.setDimensions(e,t);const{el:r,ctx:s}=this.upper;oO(r,s,e,t)}setCSSDimensions(e){super.setCSSDimensions(e),Ky(this.upper.el,e),Ky(this.container,e)}cleanupDOM(e){const t=this.container,{el:r}=this.lower,{el:s}=this.upper;super.cleanupDOM(e),t.removeChild(s),t.removeChild(r),t.parentNode&&t.parentNode.replaceChild(r,t)}dispose(){super.dispose(),xs().dispose(this.upper.el),delete this.upper,delete this.container}}class O0 extends Ld{constructor(){super(...arguments),V(this,"targets",[]),V(this,"_hoveredTargets",[]),V(this,"_objectsToRender",void 0),V(this,"_currentTransform",null),V(this,"_groupSelector",null),V(this,"contextTopDirty",!1)}static getDefaults(){return q(q({},super.getDefaults()),O0.ownDefaults)}get upperCanvasEl(){var e;return(e=this.elements.upper)===null||e===void 0?void 0:e.el}get contextTop(){var e;return(e=this.elements.upper)===null||e===void 0?void 0:e.ctx}get wrapperEl(){return this.elements.container}initElements(e){this.elements=new AG(e,{allowTouchScrolling:this.allowTouchScrolling,containerClass:this.containerClass}),this._createCacheCanvas()}_onObjectAdded(e){this._objectsToRender=void 0,super._onObjectAdded(e)}_onObjectRemoved(e){this._objectsToRender=void 0,e===this._activeObject&&(this.fire("before:selection:cleared",{deselected:[e]}),this._discardActiveObject(),this.fire("selection:cleared",{deselected:[e]}),e.fire("deselected",{target:e})),e===this._hoveredTarget&&(this._hoveredTarget=void 0,this._hoveredTargets=[]),super._onObjectRemoved(e)}_onStackOrderChanged(){this._objectsToRender=void 0,super._onStackOrderChanged()}_chooseObjectsToRender(){const e=this._activeObject;return!this.preserveObjectStacking&&e?this._objects.filter(t=>!t.group&&t!==e).concat(e):this._objects}renderAll(){this.cancelRequestedRender(),this.destroyed||(!this.contextTopDirty||this._groupSelector||this.isDrawingMode||(this.clearContext(this.contextTop),this.contextTopDirty=!1),this.hasLostContext&&(this.renderTopLayer(this.contextTop),this.hasLostContext=!1),!this._objectsToRender&&(this._objectsToRender=this._chooseObjectsToRender()),this.renderCanvas(this.getContext(),this._objectsToRender))}renderTopLayer(e){e.save(),this.isDrawingMode&&this._isCurrentlyDrawing&&(this.freeDrawingBrush&&this.freeDrawingBrush._render(),this.contextTopDirty=!0),this.selection&&this._groupSelector&&(this._drawSelection(e),this.contextTopDirty=!0),e.restore()}renderTop(){const e=this.contextTop;this.clearContext(e),this.renderTopLayer(e),this.fire("after:render",{ctx:e})}setTargetFindTolerance(e){e=Math.round(e),this.targetFindTolerance=e;const t=this.getRetinaScaling(),r=Math.ceil((2*e+1)*t);this.pixelFindCanvasEl.width=this.pixelFindCanvasEl.height=r,this.pixelFindContext.scale(t,t)}isTargetTransparent(e,t,r){const s=this.targetFindTolerance,i=this.pixelFindContext;this.clearContext(i),i.save(),i.translate(-t+s,-r+s),i.transform(...this.viewportTransform);const o=e.selectionBackgroundColor;e.selectionBackgroundColor="",e.render(i),e.selectionBackgroundColor=o,i.restore();const a=Math.round(s*this.getRetinaScaling());return NV(i,a,a,a)}_isSelectionKeyPressed(e){const t=this.selectionKey;return!!t&&(Array.isArray(t)?!!t.find(r=>!!r&&e[r]===!0):e[t])}_shouldClearSelection(e,t){const r=this.getActiveObjects(),s=this._activeObject;return!!(!t||t&&s&&r.length>1&&r.indexOf(t)===-1&&s!==t&&!this._isSelectionKeyPressed(e)||t&&!t.evented||t&&!t.selectable&&s&&s!==t)}_shouldCenterTransform(e,t,r){if(!e)return;let s;return t===C0||t===nr||t===Dr||t===id?s=this.centeredScaling||e.centeredScaling:t===x1&&(s=this.centeredRotation||e.centeredRotation),s?!r:r}_getOriginFromCorner(e,t){const r={x:e.originX,y:e.originY};return t&&(["ml","tl","bl"].includes(t)?r.x=Lt:["mr","tr","br"].includes(t)&&(r.x=lt),["tl","mt","tr"].includes(t)?r.y=Xy:["bl","mb","br"].includes(t)&&(r.y=Qn)),r}_setupCurrentTransform(e,t,r){var s;const i=t.group?El(this.getScenePoint(e),void 0,t.group.calcTransformMatrix()):this.getScenePoint(e),{key:o="",control:a}=t.getActiveControl()||{},l=r&&a?(s=a.getActionHandler(e,t,a))===null||s===void 0?void 0:s.bind(a):ZH,c=((p,m,g,y)=>{if(!m||!p)return"drag";const x=y.controls[m];return x.getActionName(g,x,y)})(r,o,e,t),u=e[this.centeredKey],h=this._shouldCenterTransform(t,c,u)?{x:qe,y:qe}:this._getOriginFromCorner(t,o),d={target:t,action:c,actionHandler:l,actionPerformed:!1,corner:o,scaleX:t.scaleX,scaleY:t.scaleY,skewX:t.skewX,skewY:t.skewY,offsetX:i.x-t.left,offsetY:i.y-t.top,originX:h.x,originY:h.y,ex:i.x,ey:i.y,lastX:i.x,lastY:i.y,theta:Ft(t.angle),width:t.width,height:t.height,shiftKey:e.shiftKey,altKey:u,original:q(q({},lO(t)),{},{originX:h.x,originY:h.y})};this._currentTransform=d,this.fire("before:transform",{e,transform:d})}setCursor(e){this.upperCanvasEl.style.cursor=e}_drawSelection(e){const{x:t,y:r,deltaX:s,deltaY:i}=this._groupSelector,o=new Z(t,r).transform(this.viewportTransform),a=new Z(t+s,r+i).transform(this.viewportTransform),l=this.selectionLineWidth/2;let c=Math.min(o.x,a.x),u=Math.min(o.y,a.y),h=Math.max(o.x,a.x),d=Math.max(o.y,a.y);this.selectionColor&&(e.fillStyle=this.selectionColor,e.fillRect(c,u,h-c,d-u)),this.selectionLineWidth&&this.selectionBorderColor&&(e.lineWidth=this.selectionLineWidth,e.strokeStyle=this.selectionBorderColor,c+=l,u+=l,h-=l,d-=l,En.prototype._setLineDash.call(this,e,this.selectionDashArray),e.strokeRect(c,u,h-c,d-u))}findTarget(e){if(this.skipTargetFind)return;const t=this.getViewportPoint(e),r=this._activeObject,s=this.getActiveObjects();if(this.targets=[],r&&s.length>=1){if(r.findControl(t,Jy(e))||s.length>1&&this.searchPossibleTargets([r],t))return r;if(r===this.searchPossibleTargets([r],t)){if(this.preserveObjectStacking){const i=this.targets;this.targets=[];const o=this.searchPossibleTargets(this._objects,t);return e[this.altSelectionKey]&&o&&o!==r?(this.targets=i,r):o}return r}}return this.searchPossibleTargets(this._objects,t)}_pointIsInObjectSelectionArea(e,t){let r=e.getCoords();const s=this.getZoom(),i=e.padding/s;if(i){const[o,a,l,c]=r,u=Math.atan2(a.y-o.y,a.x-o.x),h=ai(u)*i,d=li(u)*i,p=h+d,m=h-d;r=[new Z(o.x-m,o.y-p),new Z(a.x+p,a.y-m),new Z(l.x+m,l.y+p),new Z(c.x-p,c.y+m)]}return Et.isPointInPolygon(t,r)}_checkTarget(e,t){return!!(e&&e.visible&&e.evented&&this._pointIsInObjectSelectionArea(e,El(t,void 0,this.viewportTransform))&&(!this.perPixelTargetFind&&!e.perPixelTargetFind||e.isEditing||!this.isTargetTransparent(e,t.x,t.y)))}_searchPossibleTargets(e,t){let r=e.length;for(;r--;){const s=e[r];if(this._checkTarget(s,t)){if(vf(s)&&s.subTargetCheck){const i=this._searchPossibleTargets(s._objects,t);i&&this.targets.push(i)}return s}}}searchPossibleTargets(e,t){const r=this._searchPossibleTargets(e,t);if(r&&vf(r)&&r.interactive&&this.targets[0]){const s=this.targets;for(let i=s.length-1;i>0;i--){const o=s[i];if(!vf(o)||!o.interactive)return o}return s[0]}return r}getViewportPoint(e){return this._pointer?this._pointer:this.getPointer(e,!0)}getScenePoint(e){return this._absolutePointer?this._absolutePointer:this.getPointer(e)}getPointer(e){let t=arguments.length>1&&arguments[1]!==void 0&&arguments[1];const r=this.upperCanvasEl,s=r.getBoundingClientRect();let i=GH(e),o=s.width||0,a=s.height||0;o&&a||(Qn in s&&Xy in s&&(a=Math.abs(s.top-s.bottom)),Lt in s&&lt in s&&(o=Math.abs(s.right-s.left))),this.calcOffset(),i.x=i.x-this._offset.left,i.y=i.y-this._offset.top,t||(i=El(i,void 0,this.viewportTransform));const l=this.getRetinaScaling();l!==1&&(i.x/=l,i.y/=l);const c=o===0||a===0?new Z(1,1):new Z(r.width/o,r.height/a);return i.multiply(c)}_setDimensionsImpl(e,t){this._resetTransformEventData(),super._setDimensionsImpl(e,t),this._isCurrentlyDrawing&&this.freeDrawingBrush&&this.freeDrawingBrush._setBrushStyles(this.contextTop)}_createCacheCanvas(){this.pixelFindCanvasEl=Zt(),this.pixelFindContext=this.pixelFindCanvasEl.getContext("2d",{willReadFrequently:!0}),this.setTargetFindTolerance(this.targetFindTolerance)}getTopContext(){return this.elements.upper.ctx}getSelectionContext(){return this.elements.upper.ctx}getSelectionElement(){return this.elements.upper.el}getActiveObject(){return this._activeObject}getActiveObjects(){const e=this._activeObject;return Wo(e)?e.getObjects():e?[e]:[]}_fireSelectionEvents(e,t){let r=!1,s=!1;const i=this.getActiveObjects(),o=[],a=[];e.forEach(l=>{i.includes(l)||(r=!0,l.fire("deselected",{e:t,target:l}),a.push(l))}),i.forEach(l=>{e.includes(l)||(r=!0,l.fire("selected",{e:t,target:l}),o.push(l))}),e.length>0&&i.length>0?(s=!0,r&&this.fire("selection:updated",{e:t,selected:o,deselected:a})):i.length>0?(s=!0,this.fire("selection:created",{e:t,selected:o})):e.length>0&&(s=!0,this.fire("selection:cleared",{e:t,deselected:a})),s&&(this._objectsToRender=void 0)}setActiveObject(e,t){const r=this.getActiveObjects(),s=this._setActiveObject(e,t);return this._fireSelectionEvents(r,t),s}_setActiveObject(e,t){const r=this._activeObject;return r!==e&&!(!this._discardActiveObject(t,e)&&this._activeObject)&&!e.onSelect({e:t})&&(this._activeObject=e,Wo(e)&&r!==e&&e.set("canvas",this),e.setCoords(),!0)}_discardActiveObject(e,t){const r=this._activeObject;return!!r&&!r.onDeselect({e,object:t})&&(this._currentTransform&&this._currentTransform.target===r&&this.endCurrentTransform(e),Wo(r)&&r===this._hoveredTarget&&(this._hoveredTarget=void 0),this._activeObject=void 0,!0)}discardActiveObject(e){const t=this.getActiveObjects(),r=this.getActiveObject();t.length&&this.fire("before:selection:cleared",{e,deselected:[r]});const s=this._discardActiveObject(e);return this._fireSelectionEvents(t,e),s}endCurrentTransform(e){const t=this._currentTransform;this._finalizeCurrentTransform(e),t&&t.target&&(t.target.isMoving=!1),this._currentTransform=null}_finalizeCurrentTransform(e){const t=this._currentTransform,r=t.target,s={e,target:r,transform:t,action:t.action};r._scaling&&(r._scaling=!1),r.setCoords(),t.actionPerformed&&(this.fire("object:modified",s),r.fire(hp,s))}setViewportTransform(e){super.setViewportTransform(e);const t=this._activeObject;t&&t.setCoords()}destroy(){const e=this._activeObject;Wo(e)&&(e.removeAll(),e.dispose()),delete this._activeObject,super.destroy(),this.pixelFindContext=null,this.pixelFindCanvasEl=void 0}clear(){this.discardActiveObject(),this._activeObject=void 0,this.clearContext(this.contextTop),super.clear()}drawControls(e){const t=this._activeObject;t&&t._renderControls(e)}_toObject(e,t,r){const s=this._realizeGroupTransformOnObject(e),i=super._toObject(e,t,r);return e.set(s),i}_realizeGroupTransformOnObject(e){const{group:t}=e;if(t&&Wo(t)&&this._activeObject===t){const r=yc(e,["angle","flipX","flipY",lt,nr,Dr,mc,vc,Qn]);return YH(e,t.calcOwnMatrix()),r}return{}}_setSVGObject(e,t,r){const s=this._realizeGroupTransformOnObject(t);super._setSVGObject(e,t,r),t.set(s)}}V(O0,"ownDefaults",{uniformScaling:!0,uniScaleKey:"shiftKey",centeredScaling:!1,centeredRotation:!1,centeredKey:"altKey",altActionKey:"shiftKey",selection:!0,selectionKey:"shiftKey",selectionColor:"rgba(100, 100, 255, 0.3)",selectionDashArray:[],selectionBorderColor:"rgba(255, 255, 255, 0.3)",selectionLineWidth:1,selectionFullyContained:!1,hoverCursor:"move",moveCursor:"move",defaultCursor:"default",freeDrawingCursor:"crosshair",notAllowedCursor:"not-allowed",perPixelTargetFind:!1,targetFindTolerance:0,skipTargetFind:!1,stopContextMenu:!1,fireRightClick:!1,fireMiddleClick:!1,enablePointerEvents:!1,containerClass:"canvas-container",preserveObjectStacking:!1});class DG{constructor(e){V(this,"targets",[]),V(this,"__disposer",void 0);const t=()=>{const{hiddenTextarea:s}=e.getActiveObject()||{};s&&s.focus()},r=e.upperCanvasEl;r.addEventListener("click",t),this.__disposer=()=>r.removeEventListener("click",t)}exitTextEditing(){this.target=void 0,this.targets.forEach(e=>{e.isEditing&&e.exitEditing()})}add(e){this.targets.push(e)}remove(e){this.unregister(e),Va(this.targets,e)}register(e){this.target=e}unregister(e){e===this.target&&(this.target=void 0)}onMouseMove(e){var t;!((t=this.target)===null||t===void 0)&&t.isEditing&&this.target.updateSelectionOnMouseMove(e)}clear(){this.targets=[],this.target=void 0}dispose(){this.clear(),this.__disposer(),delete this.__disposer}}const OG=["target","oldTarget","fireCanvas","e"],ir={passive:!1},Fa=(n,e)=>{const t=n.getViewportPoint(e),r=n.getScenePoint(e);return{viewportPoint:t,scenePoint:r,pointer:t,absolutePointer:r}},Si=function(n){for(var e=arguments.length,t=new Array(e>1?e-1:0),r=1;r<e;r++)t[r-1]=arguments[r];return n.addEventListener(...t)},xr=function(n){for(var e=arguments.length,t=new Array(e>1?e-1:0),r=1;r<e;r++)t[r-1]=arguments[r];return n.removeEventListener(...t)},IG={mouse:{in:"over",out:"out",targetIn:"mouseover",targetOut:"mouseout",canvasIn:"mouse:over",canvasOut:"mouse:out"},drag:{in:"enter",out:"leave",targetIn:"dragenter",targetOut:"dragleave",canvasIn:"drag:enter",canvasOut:"drag:leave"}};class ol extends O0{constructor(e){super(e,arguments.length>1&&arguments[1]!==void 0?arguments[1]:{}),V(this,"_isClick",void 0),V(this,"textEditingManager",new DG(this)),["_onMouseDown","_onTouchStart","_onMouseMove","_onMouseUp","_onTouchEnd","_onResize","_onMouseWheel","_onMouseOut","_onMouseEnter","_onContextMenu","_onDoubleClick","_onDragStart","_onDragEnd","_onDragProgress","_onDragOver","_onDragEnter","_onDragLeave","_onDrop"].forEach(t=>{this[t]=this[t].bind(this)}),this.addOrRemove(Si,"add")}_getEventPrefix(){return this.enablePointerEvents?"pointer":"mouse"}addOrRemove(e,t){const r=this.upperCanvasEl,s=this._getEventPrefix();e(iO(r),"resize",this._onResize),e(r,s+"down",this._onMouseDown),e(r,"".concat(s,"move"),this._onMouseMove,ir),e(r,"".concat(s,"out"),this._onMouseOut),e(r,"".concat(s,"enter"),this._onMouseEnter),e(r,"wheel",this._onMouseWheel),e(r,"contextmenu",this._onContextMenu),e(r,"dblclick",this._onDoubleClick),e(r,"dragstart",this._onDragStart),e(r,"dragend",this._onDragEnd),e(r,"dragover",this._onDragOver),e(r,"dragenter",this._onDragEnter),e(r,"dragleave",this._onDragLeave),e(r,"drop",this._onDrop),this.enablePointerEvents||e(r,"touchstart",this._onTouchStart,ir)}removeListeners(){this.addOrRemove(xr,"remove");const e=this._getEventPrefix(),t=qr(this.upperCanvasEl);xr(t,"".concat(e,"up"),this._onMouseUp),xr(t,"touchend",this._onTouchEnd,ir),xr(t,"".concat(e,"move"),this._onMouseMove,ir),xr(t,"touchmove",this._onMouseMove,ir)}_onMouseWheel(e){this.__onMouseWheel(e)}_onMouseOut(e){const t=this._hoveredTarget,r=q({e},Fa(this,e));this.fire("mouse:out",q(q({},r),{},{target:t})),this._hoveredTarget=void 0,t&&t.fire("mouseout",q({},r)),this._hoveredTargets.forEach(s=>{this.fire("mouse:out",q(q({},r),{},{target:s})),s&&s.fire("mouseout",q({},r))}),this._hoveredTargets=[]}_onMouseEnter(e){this._currentTransform||this.findTarget(e)||(this.fire("mouse:over",q({e},Fa(this,e))),this._hoveredTarget=void 0,this._hoveredTargets=[])}_onDragStart(e){this._isClick=!1;const t=this.getActiveObject();if(t&&t.onDragStart(e)){this._dragSource=t;const r={e,target:t};return this.fire("dragstart",r),t.fire("dragstart",r),void Si(this.upperCanvasEl,"drag",this._onDragProgress)}Qy(e)}_renderDragEffects(e,t,r){let s=!1;const i=this._dropTarget;i&&i!==t&&i!==r&&(i.clearContextTop(),s=!0),t==null||t.clearContextTop(),r!==t&&(r==null||r.clearContextTop());const o=this.contextTop;o.save(),o.transform(...this.viewportTransform),t&&(o.save(),t.transform(o),t.renderDragSourceEffect(e),o.restore(),s=!0),r&&(o.save(),r.transform(o),r.renderDropTargetEffect(e),o.restore(),s=!0),o.restore(),s&&(this.contextTopDirty=!0)}_onDragEnd(e){const t=!!e.dataTransfer&&e.dataTransfer.dropEffect!==Zn,r=t?this._activeObject:void 0,s={e,target:this._dragSource,subTargets:this.targets,dragSource:this._dragSource,didDrop:t,dropTarget:r};xr(this.upperCanvasEl,"drag",this._onDragProgress),this.fire("dragend",s),this._dragSource&&this._dragSource.fire("dragend",s),delete this._dragSource,this._onMouseUp(e)}_onDragProgress(e){const t={e,target:this._dragSource,dragSource:this._dragSource,dropTarget:this._draggedoverTarget};this.fire("drag",t),this._dragSource&&this._dragSource.fire("drag",t)}findDragTargets(e){return this.targets=[],{target:this._searchPossibleTargets(this._objects,this.getViewportPoint(e)),targets:[...this.targets]}}_onDragOver(e){const t="dragover",{target:r,targets:s}=this.findDragTargets(e),i=this._dragSource,o={e,target:r,subTargets:s,dragSource:i,canDrop:!1,dropTarget:void 0};let a;this.fire(t,o),this._fireEnterLeaveEvents(r,o),r&&(r.canDrop(e)&&(a=r),r.fire(t,o));for(let l=0;l<s.length;l++){const c=s[l];c.canDrop(e)&&(a=c),c.fire(t,o)}this._renderDragEffects(e,i,a),this._dropTarget=a}_onDragEnter(e){const{target:t,targets:r}=this.findDragTargets(e),s={e,target:t,subTargets:r,dragSource:this._dragSource};this.fire("dragenter",s),this._fireEnterLeaveEvents(t,s)}_onDragLeave(e){const t={e,target:this._draggedoverTarget,subTargets:this.targets,dragSource:this._dragSource};this.fire("dragleave",t),this._fireEnterLeaveEvents(void 0,t),this._renderDragEffects(e,this._dragSource),this._dropTarget=void 0,this.targets=[],this._hoveredTargets=[]}_onDrop(e){const{target:t,targets:r}=this.findDragTargets(e),s=this._basicEventHandler("drop:before",q({e,target:t,subTargets:r,dragSource:this._dragSource},Fa(this,e)));s.didDrop=!1,s.dropTarget=void 0,this._basicEventHandler("drop",s),this.fire("drop:after",s)}_onContextMenu(e){const t=this.findTarget(e),r=this.targets||[],s=this._basicEventHandler("contextmenu:before",{e,target:t,subTargets:r});return this.stopContextMenu&&Qy(e),this._basicEventHandler("contextmenu",s),!1}_onDoubleClick(e){this._cacheTransformEventData(e),this._handleEvent(e,"dblclick"),this._resetTransformEventData()}getPointerId(e){const t=e.changedTouches;return t?t[0]&&t[0].identifier:this.enablePointerEvents?e.pointerId:-1}_isMainEvent(e){return e.isPrimary===!0||e.isPrimary!==!1&&(e.type==="touchend"&&e.touches.length===0||!e.changedTouches||e.changedTouches[0].identifier===this.mainTouchId)}_onTouchStart(e){e.preventDefault(),this.mainTouchId===void 0&&(this.mainTouchId=this.getPointerId(e)),this.__onMouseDown(e),this._resetTransformEventData();const t=this.upperCanvasEl,r=this._getEventPrefix(),s=qr(t);Si(s,"touchend",this._onTouchEnd,ir),Si(s,"touchmove",this._onMouseMove,ir),xr(t,"".concat(r,"down"),this._onMouseDown)}_onMouseDown(e){this.__onMouseDown(e),this._resetTransformEventData();const t=this.upperCanvasEl,r=this._getEventPrefix();xr(t,"".concat(r,"move"),this._onMouseMove,ir);const s=qr(t);Si(s,"".concat(r,"up"),this._onMouseUp),Si(s,"".concat(r,"move"),this._onMouseMove,ir)}_onTouchEnd(e){if(e.touches.length>0)return;this.__onMouseUp(e),this._resetTransformEventData(),delete this.mainTouchId;const t=this._getEventPrefix(),r=qr(this.upperCanvasEl);xr(r,"touchend",this._onTouchEnd,ir),xr(r,"touchmove",this._onMouseMove,ir),this._willAddMouseDown&&clearTimeout(this._willAddMouseDown),this._willAddMouseDown=setTimeout(()=>{Si(this.upperCanvasEl,"".concat(t,"down"),this._onMouseDown),this._willAddMouseDown=0},400)}_onMouseUp(e){this.__onMouseUp(e),this._resetTransformEventData();const t=this.upperCanvasEl,r=this._getEventPrefix();if(this._isMainEvent(e)){const s=qr(this.upperCanvasEl);xr(s,"".concat(r,"up"),this._onMouseUp),xr(s,"".concat(r,"move"),this._onMouseMove,ir),Si(t,"".concat(r,"move"),this._onMouseMove,ir)}}_onMouseMove(e){const t=this.getActiveObject();!this.allowTouchScrolling&&(!t||!t.shouldStartDragging(e))&&e.preventDefault&&e.preventDefault(),this.__onMouseMove(e)}_onResize(){this.calcOffset(),this._resetTransformEventData()}_shouldRender(e){const t=this.getActiveObject();return!!t!=!!e||t&&e&&t!==e}__onMouseUp(e){var t;this._cacheTransformEventData(e),this._handleEvent(e,"up:before");const r=this._currentTransform,s=this._isClick,i=this._target,{button:o}=e;if(o)return(this.fireMiddleClick&&o===1||this.fireRightClick&&o===2)&&this._handleEvent(e,"up"),void this._resetTransformEventData();if(this.isDrawingMode&&this._isCurrentlyDrawing)return void this._onMouseUpInDrawingMode(e);if(!this._isMainEvent(e))return;let a,l,c=!1;if(r&&(this._finalizeCurrentTransform(e),c=r.actionPerformed),!s){const u=i===this._activeObject;this.handleSelection(e),c||(c=this._shouldRender(i)||!u&&i===this._activeObject)}if(i){const u=i.findControl(this.getViewportPoint(e),Jy(e)),{key:h,control:d}=u||{};if(l=h,i.selectable&&i!==this._activeObject&&i.activeOn==="up")this.setActiveObject(i,e),c=!0;else if(d){const p=d.getMouseUpHandler(e,i,d);p&&(a=this.getScenePoint(e),p.call(d,e,r,a.x,a.y))}i.isMoving=!1}if(r&&(r.target!==i||r.corner!==l)){const u=r.target&&r.target.controls[r.corner],h=u&&u.getMouseUpHandler(e,r.target,u);a=a||this.getScenePoint(e),h&&h.call(u,e,r,a.x,a.y)}this._setCursorFromEvent(e,i),this._handleEvent(e,"up"),this._groupSelector=null,this._currentTransform=null,i&&(i.__corner=void 0),c?this.requestRenderAll():s||(t=this._activeObject)!==null&&t!==void 0&&t.isEditing||this.renderTop()}_basicEventHandler(e,t){const{target:r,subTargets:s=[]}=t;this.fire(e,t),r&&r.fire(e,t);for(let i=0;i<s.length;i++)s[i]!==r&&s[i].fire(e,t);return t}_handleEvent(e,t){const r=this._target,s=this.targets||[],i=q(q({e,target:r,subTargets:s},Fa(this,e)),{},{transform:this._currentTransform},t==="up:before"||t==="up"?{isClick:this._isClick,currentTarget:this.findTarget(e),currentSubTargets:this.targets}:{});this.fire("mouse:".concat(t),i),r&&r.fire("mouse".concat(t),i);for(let o=0;o<s.length;o++)s[o]!==r&&s[o].fire("mouse".concat(t),i)}_onMouseDownInDrawingMode(e){this._isCurrentlyDrawing=!0,this.getActiveObject()&&(this.discardActiveObject(e),this.requestRenderAll());const t=this.getScenePoint(e);this.freeDrawingBrush&&this.freeDrawingBrush.onMouseDown(t,{e,pointer:t}),this._handleEvent(e,"down")}_onMouseMoveInDrawingMode(e){if(this._isCurrentlyDrawing){const t=this.getScenePoint(e);this.freeDrawingBrush&&this.freeDrawingBrush.onMouseMove(t,{e,pointer:t})}this.setCursor(this.freeDrawingCursor),this._handleEvent(e,"move")}_onMouseUpInDrawingMode(e){const t=this.getScenePoint(e);this.freeDrawingBrush?this._isCurrentlyDrawing=!!this.freeDrawingBrush.onMouseUp({e,pointer:t}):this._isCurrentlyDrawing=!1,this._handleEvent(e,"up")}__onMouseDown(e){this._isClick=!0,this._cacheTransformEventData(e),this._handleEvent(e,"down:before");let t=this._target;const{button:r}=e;if(r)return(this.fireMiddleClick&&r===1||this.fireRightClick&&r===2)&&this._handleEvent(e,"down"),void this._resetTransformEventData();if(this.isDrawingMode)return void this._onMouseDownInDrawingMode(e);if(!this._isMainEvent(e)||this._currentTransform)return;let s=this._shouldRender(t),i=!1;if(this.handleMultiSelection(e,t)?(t=this._activeObject,i=!0,s=!0):this._shouldClearSelection(e,t)&&this.discardActiveObject(e),this.selection&&(!t||!t.selectable&&!t.isEditing&&t!==this._activeObject)){const o=this.getScenePoint(e);this._groupSelector={x:o.x,y:o.y,deltaY:0,deltaX:0}}if(t){const o=t===this._activeObject;t.selectable&&t.activeOn==="down"&&this.setActiveObject(t,e);const a=t.findControl(this.getViewportPoint(e),Jy(e));if(t===this._activeObject&&(a||!i)){this._setupCurrentTransform(e,t,o);const l=a?a.control:void 0,c=this.getScenePoint(e),u=l&&l.getMouseDownHandler(e,t,l);u&&u.call(l,e,this._currentTransform,c.x,c.y)}}s&&(this._objectsToRender=void 0),this._handleEvent(e,"down"),s&&this.requestRenderAll()}_resetTransformEventData(){this._target=void 0,this._pointer=void 0,this._absolutePointer=void 0}_cacheTransformEventData(e){this._resetTransformEventData(),this._pointer=this.getViewportPoint(e),this._absolutePointer=El(this._pointer,void 0,this.viewportTransform),this._target=this._currentTransform?this._currentTransform.target:this.findTarget(e)}__onMouseMove(e){if(this._isClick=!1,this._cacheTransformEventData(e),this._handleEvent(e,"move:before"),this.isDrawingMode)return void this._onMouseMoveInDrawingMode(e);if(!this._isMainEvent(e))return;const t=this._groupSelector;if(t){const r=this.getScenePoint(e);t.deltaX=r.x-t.x,t.deltaY=r.y-t.y,this.renderTop()}else if(this._currentTransform)this._transformObject(e);else{const r=this.findTarget(e);this._setCursorFromEvent(e,r),this._fireOverOutEvents(e,r)}this.textEditingManager.onMouseMove(e),this._handleEvent(e,"move"),this._resetTransformEventData()}_fireOverOutEvents(e,t){const r=this._hoveredTarget,s=this._hoveredTargets,i=this.targets,o=Math.max(s.length,i.length);this.fireSyntheticInOutEvents("mouse",{e,target:t,oldTarget:r,fireCanvas:!0});for(let a=0;a<o;a++)this.fireSyntheticInOutEvents("mouse",{e,target:i[a],oldTarget:s[a]});this._hoveredTarget=t,this._hoveredTargets=this.targets.concat()}_fireEnterLeaveEvents(e,t){const r=this._draggedoverTarget,s=this._hoveredTargets,i=this.targets,o=Math.max(s.length,i.length);this.fireSyntheticInOutEvents("drag",q(q({},t),{},{target:e,oldTarget:r,fireCanvas:!0}));for(let a=0;a<o;a++)this.fireSyntheticInOutEvents("drag",q(q({},t),{},{target:i[a],oldTarget:s[a]}));this._draggedoverTarget=e}fireSyntheticInOutEvents(e,t){let{target:r,oldTarget:s,fireCanvas:i,e:o}=t,a=Ct(t,OG);const{targetIn:l,targetOut:c,canvasIn:u,canvasOut:h}=IG[e],d=s!==r;if(s&&d){const p=q(q({},a),{},{e:o,target:s,nextTarget:r},Fa(this,o));i&&this.fire(h,p),s.fire(c,p)}if(r&&d){const p=q(q({},a),{},{e:o,target:r,previousTarget:s},Fa(this,o));i&&this.fire(u,p),r.fire(l,p)}}__onMouseWheel(e){this._cacheTransformEventData(e),this._handleEvent(e,"wheel"),this._resetTransformEventData()}_transformObject(e){const t=this.getScenePoint(e),r=this._currentTransform,s=r.target,i=s.group?El(t,void 0,s.group.calcTransformMatrix()):t;r.shiftKey=e.shiftKey,r.altKey=!!this.centeredKey&&e[this.centeredKey],this._performTransformAction(e,r,i),r.actionPerformed&&this.requestRenderAll()}_performTransformAction(e,t,r){const{action:s,actionHandler:i,target:o}=t,a=!!i&&i(e,t,r.x,r.y);a&&o.setCoords(),s==="drag"&&a&&(t.target.isMoving=!0,this.setCursor(t.target.moveCursor||this.moveCursor)),t.actionPerformed=t.actionPerformed||a}_setCursorFromEvent(e,t){if(!t)return void this.setCursor(this.defaultCursor);let r=t.hoverCursor||this.hoverCursor;const s=Wo(this._activeObject)?this._activeObject:null,i=(!s||t.group!==s)&&t.findControl(this.getViewportPoint(e));if(i){const o=i.control;this.setCursor(o.cursorStyleHandler(e,o,t))}else t.subTargetCheck&&this.targets.concat().reverse().map(o=>{r=o.hoverCursor||r}),this.setCursor(r)}handleMultiSelection(e,t){const r=this._activeObject,s=Wo(r);if(r&&this._isSelectionKeyPressed(e)&&this.selection&&t&&t.selectable&&(r!==t||s)&&(s||!t.isDescendantOf(r)&&!r.isDescendantOf(t))&&!t.onSelect({e})&&!r.getActiveControl()){if(s){const i=r.getObjects();if(t===r){const o=this.getViewportPoint(e);if(!(t=this.searchPossibleTargets(i,o)||this.searchPossibleTargets(this._objects,o))||!t.selectable)return!1}t.group===r?(r.remove(t),this._hoveredTarget=t,this._hoveredTargets=[...this.targets],r.size()===1&&this._setActiveObject(r.item(0),e)):(r.multiSelectAdd(t),this._hoveredTarget=r,this._hoveredTargets=[...this.targets]),this._fireSelectionEvents(i,e)}else{r.exitEditing&&r.exitEditing();const i=new(me.getClass("ActiveSelection"))([],{canvas:this});i.multiSelectAdd(r,t),this._hoveredTarget=i,this._setActiveObject(i,e),this._fireSelectionEvents([r],e)}return!0}return!1}handleSelection(e){if(!this.selection||!this._groupSelector)return!1;const{x:t,y:r,deltaX:s,deltaY:i}=this._groupSelector,o=new Z(t,r),a=o.add(new Z(s,i)),l=o.min(a),c=o.max(a).subtract(l),u=this.collectObjects({left:l.x,top:l.y,width:c.x,height:c.y},{includeIntersecting:!this.selectionFullyContained}),h=o.eq(a)?u[0]?[u[0]]:[]:u.length>1?u.filter(d=>!d.onSelect({e})).reverse():u;if(h.length===1)this.setActiveObject(h[0],e);else if(h.length>1){const d=me.getClass("ActiveSelection");this.setActiveObject(new d(h,{canvas:this}),e)}return this._groupSelector=null,!0}clear(){this.textEditingManager.clear(),super.clear()}destroy(){this.removeListeners(),this.textEditingManager.dispose(),super.destroy()}}const IO={x1:0,y1:0,x2:0,y2:0},RG=q(q({},IO),{},{r1:0,r2:0}),al=(n,e)=>isNaN(n)&&typeof e=="number"?e:n,NG=/^(\d+\.\d+)%|(\d+)%$/;function RO(n){return n&&NG.test(n)}function NO(n,e){const t=typeof n=="number"?n:typeof n=="string"?parseFloat(n)/(RO(n)?100:1):NaN;return tc(0,al(t,e),1)}const jG=/\s*;\s*/,LG=/\s*:\s*/;function MG(n,e){let t,r;const s=n.getAttribute("style");if(s){const o=s.split(jG);o[o.length-1]===""&&o.pop();for(let a=o.length;a--;){const[l,c]=o[a].split(LG).map(u=>u.trim());l==="stop-color"?t=c:l==="stop-opacity"&&(r=c)}}const i=new dt(t||n.getAttribute("stop-color")||"rgb(0,0,0)");return{offset:NO(n.getAttribute("offset"),0),color:i.toRgb(),opacity:al(parseFloat(r||n.getAttribute("stop-opacity")||""),1)*i.getAlpha()*e}}function FG(n,e){const t=[],r=n.getElementsByTagName("stop"),s=NO(e,1);for(let i=r.length;i--;)t.push(MG(r[i],s));return t}function jO(n){return n.nodeName==="linearGradient"||n.nodeName==="LINEARGRADIENT"?"linear":"radial"}function LO(n){return n.getAttribute("gradientUnits")==="userSpaceOnUse"?"pixels":"percentage"}function Rr(n,e){return n.getAttribute(e)}function BG(n,e){return function(t,r){let s,{width:i,height:o,gradientUnits:a}=r;return Object.keys(t).reduce((l,c)=>{const u=t[c];return u==="Infinity"?s=1:u==="-Infinity"?s=0:(s=typeof u=="string"?parseFloat(u):u,typeof u=="string"&&RO(u)&&(s*=.01,a==="pixels"&&(c!=="x1"&&c!=="x2"&&c!=="r2"||(s*=i),c!=="y1"&&c!=="y2"||(s*=o)))),l[c]=s,l},{})}(jO(n)==="linear"?function(t){return{x1:Rr(t,"x1")||0,y1:Rr(t,"y1")||0,x2:Rr(t,"x2")||"100%",y2:Rr(t,"y2")||0}}(n):function(t){return{x1:Rr(t,"fx")||Rr(t,"cx")||"50%",y1:Rr(t,"fy")||Rr(t,"cy")||"50%",r1:0,x2:Rr(t,"cx")||"50%",y2:Rr(t,"cy")||"50%",r2:Rr(t,"r")||"50%"}}(n),q(q({},e),{},{gradientUnits:LO(n)}))}class xh{constructor(e){const{type:t="linear",gradientUnits:r="pixels",coords:s={},colorStops:i=[],offsetX:o=0,offsetY:a=0,gradientTransform:l,id:c}=e||{};Object.assign(this,{type:t,gradientUnits:r,coords:q(q({},t==="radial"?RG:IO),s),colorStops:i,offsetX:o,offsetY:a,gradientTransform:l,id:c?"".concat(c,"_").concat(go()):go()})}addColorStop(e){for(const t in e){const r=new dt(e[t]);this.colorStops.push({offset:parseFloat(t),color:r.toRgb(),opacity:r.getAlpha()})}return this}toObject(e){return q(q({},yc(this,e)),{},{type:this.type,coords:q({},this.coords),colorStops:this.colorStops.map(t=>q({},t)),offsetX:this.offsetX,offsetY:this.offsetY,gradientUnits:this.gradientUnits,gradientTransform:this.gradientTransform?[...this.gradientTransform]:void 0})}toSVG(e){let{additionalTransform:t}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const r=[],s=this.gradientTransform?this.gradientTransform.concat():Fn.concat(),i=this.gradientUnits==="pixels"?"userSpaceOnUse":"objectBoundingBox",o=this.colorStops.map(h=>q({},h)).sort((h,d)=>h.offset-d.offset);let a=-this.offsetX,l=-this.offsetY;var c;i==="objectBoundingBox"?(a/=e.width,l/=e.height):(a+=e.width/2,l+=e.height/2),(c=e)&&typeof c._renderPathCommands=="function"&&this.gradientUnits!=="percentage"&&(a-=e.pathOffset.x,l-=e.pathOffset.y),s[4]-=a,s[5]-=l;const u=['id="SVGID_'.concat(this.id,'"'),'gradientUnits="'.concat(i,'"'),'gradientTransform="'.concat(t?t+" ":"").concat(gp(s),'"'),""].join(" ");if(this.type==="linear"){const{x1:h,y1:d,x2:p,y2:m}=this.coords;r.push("<linearGradient ",u,' x1="',h,'" y1="',d,'" x2="',p,'" y2="',m,`">
`)}else if(this.type==="radial"){const{x1:h,y1:d,x2:p,y2:m,r1:g,r2:y}=this.coords,x=g>y;r.push("<radialGradient ",u,' cx="',x?h:p,'" cy="',x?d:m,'" r="',x?g:y,'" fx="',x?p:h,'" fy="',x?m:d,`">
`),x&&(o.reverse(),o.forEach(w=>{w.offset=1-w.offset}));const v=Math.min(g,y);if(v>0){const w=v/Math.max(g,y);o.forEach(_=>{_.offset+=w*(1-_.offset)})}}return o.forEach(h=>{let{color:d,offset:p,opacity:m}=h;r.push("<stop ",'offset="',100*p+"%",'" style="stop-color:',d,m!==void 0?";stop-opacity: "+m:";",`"/>
`)}),r.push(this.type==="linear"?"</linearGradient>":"</radialGradient>",`
`),r.join("")}toLive(e){const{x1:t,y1:r,x2:s,y2:i,r1:o,r2:a}=this.coords,l=this.type==="linear"?e.createLinearGradient(t,r,s,i):e.createRadialGradient(t,r,o,s,i,a);return this.colorStops.forEach(c=>{let{color:u,opacity:h,offset:d}=c;l.addColorStop(d,h!==void 0?new dt(u).setAlpha(h).toRgba():u)}),l}static async fromObject(e){const{colorStops:t,gradientTransform:r}=e;return new this(q(q({},e),{},{colorStops:t?t.map(s=>q({},s)):void 0,gradientTransform:r?[...r]:void 0}))}static fromElement(e,t,r){const s=LO(e),i=t._findCenterFromElement();return new this(q({id:e.getAttribute("id")||void 0,type:jO(e),coords:BG(e,{width:r.viewBoxWidth||r.width,height:r.viewBoxHeight||r.height}),colorStops:FG(e,r.opacity),gradientUnits:s,gradientTransform:nx(e.getAttribute("gradientTransform")||"")},s==="pixels"?{offsetX:t.width/2-i.x,offsetY:t.height/2-i.y}:{offsetX:0,offsetY:0}))}}V(xh,"type","Gradient"),me.setClass(xh,"gradient"),me.setClass(xh,"linear"),me.setClass(xh,"radial");const UG=["type","source","patternTransform"];class em{get type(){return"pattern"}set type(e){po("warn","Setting type has no effect",e)}constructor(e){V(this,"repeat","repeat"),V(this,"offsetX",0),V(this,"offsetY",0),V(this,"crossOrigin",""),this.id=go(),Object.assign(this,e)}isImageSource(){return!!this.source&&typeof this.source.src=="string"}isCanvasSource(){return!!this.source&&!!this.source.toDataURL}sourceToString(){return this.isImageSource()?this.source.src:this.isCanvasSource()?this.source.toDataURL():""}toLive(e){return this.source&&(!this.isImageSource()||this.source.complete&&this.source.naturalWidth!==0&&this.source.naturalHeight!==0)?e.createPattern(this.source,this.repeat):null}toObject(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];const{repeat:t,crossOrigin:r}=this;return q(q({},yc(this,e)),{},{type:"pattern",source:this.sourceToString(),repeat:t,crossOrigin:r,offsetX:Tt(this.offsetX,nt.NUM_FRACTION_DIGITS),offsetY:Tt(this.offsetY,nt.NUM_FRACTION_DIGITS),patternTransform:this.patternTransform?[...this.patternTransform]:null})}toSVG(e){let{width:t,height:r}=e;const{source:s,repeat:i,id:o}=this,a=al(this.offsetX/t,0),l=al(this.offsetY/r,0),c=i==="repeat-y"||i==="no-repeat"?1+Math.abs(a||0):al(s.width/t,0),u=i==="repeat-x"||i==="no-repeat"?1+Math.abs(l||0):al(s.height/r,0);return['<pattern id="SVGID_'.concat(o,'" x="').concat(a,'" y="').concat(l,'" width="').concat(c,'" height="').concat(u,'">'),'<image x="0" y="0" width="'.concat(s.width,'" height="').concat(s.height,'" xlink:href="').concat(this.sourceToString(),'"></image>'),"</pattern>",""].join(`
`)}static async fromObject(e,t){let{type:r,source:s,patternTransform:i}=e,o=Ct(e,UG);const a=await xf(s,q(q({},t),{},{crossOrigin:o.crossOrigin}));return new this(q(q({},o),{},{patternTransform:i&&i.slice(0),source:a}))}}V(em,"type","Pattern"),me.setClass(em),me.setClass(em,"pattern");const $G=["path","left","top"],zG=["d"];class Ho extends En{constructor(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},{path:r,left:s,top:i}=t,o=Ct(t,$G);super(),Object.assign(this,Ho.ownDefaults),this.setOptions(o),this._setPath(e||[],!0),typeof s=="number"&&this.set(lt,s),typeof i=="number"&&this.set(Qn,i)}_setPath(e,t){this.path=yG(Array.isArray(e)?e:PG(e)),this.setBoundingBox(t)}_findCenterFromElement(){const e=this._calcBoundsFromPath();return new Z(e.left+e.width/2,e.top+e.height/2)}_renderPathCommands(e){const t=-this.pathOffset.x,r=-this.pathOffset.y;e.beginPath();for(const s of this.path)switch(s[0]){case"L":e.lineTo(s[1]+t,s[2]+r);break;case"M":e.moveTo(s[1]+t,s[2]+r);break;case"C":e.bezierCurveTo(s[1]+t,s[2]+r,s[3]+t,s[4]+r,s[5]+t,s[6]+r);break;case"Q":e.quadraticCurveTo(s[1]+t,s[2]+r,s[3]+t,s[4]+r);break;case"Z":e.closePath()}}_render(e){this._renderPathCommands(e),this._renderPaintInOrder(e)}toString(){return"#<Path (".concat(this.complexity(),'): { "top": ').concat(this.top,', "left": ').concat(this.left," }>")}toObject(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return q(q({},super.toObject(e)),{},{path:this.path.map(t=>t.slice())})}toDatalessObject(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];const t=this.toObject(e);return this.sourcePath&&(delete t.path,t.sourcePath=this.sourcePath),t}_toSVG(){const e=TG(this.path,nt.NUM_FRACTION_DIGITS);return["<path ","COMMON_PARTS",'d="'.concat(e,`" stroke-linecap="round" />
`)]}_getOffsetTransform(){const e=nt.NUM_FRACTION_DIGITS;return" translate(".concat(Tt(-this.pathOffset.x,e),", ").concat(Tt(-this.pathOffset.y,e),")")}toClipPathSVG(e){const t=this._getOffsetTransform();return"	"+this._createBaseClipPathSVGMarkup(this._toSVG(),{reviver:e,additionalTransform:t})}toSVG(e){const t=this._getOffsetTransform();return this._createBaseSVGMarkup(this._toSVG(),{reviver:e,additionalTransform:t})}complexity(){return this.path.length}setDimensions(){this.setBoundingBox()}setBoundingBox(e){const{width:t,height:r,pathOffset:s}=this._calcDimensions();this.set({width:t,height:r,pathOffset:s}),e&&this.setPositionByOrigin(s,qe,qe)}_calcBoundsFromPath(){const e=[];let t=0,r=0,s=0,i=0;for(const o of this.path)switch(o[0]){case"L":s=o[1],i=o[2],e.push({x:t,y:r},{x:s,y:i});break;case"M":s=o[1],i=o[2],t=s,r=i;break;case"C":e.push(...nE(s,i,o[1],o[2],o[3],o[4],o[5],o[6])),s=o[5],i=o[6];break;case"Q":e.push(...nE(s,i,o[1],o[2],o[1],o[2],o[3],o[4])),s=o[3],i=o[4];break;case"Z":s=t,i=r}return Xs(e)}_calcDimensions(){const e=this._calcBoundsFromPath();return q(q({},e),{},{pathOffset:new Z(e.left+e.width/2,e.top+e.height/2)})}static fromObject(e){return this._fromObject(e,{extraParam:"path"})}static async fromElement(e,t,r){const s=fi(e,this.ATTRIBUTE_NAMES,r),{d:i}=s;return new this(i,q(q(q({},Ct(s,zG)),t),{},{left:void 0,top:void 0}))}}V(Ho,"type","Path"),V(Ho,"cacheProperties",[...hi,"path","fillRule"]),V(Ho,"ATTRIBUTE_NAMES",[...Eo,"d"]),me.setClass(Ho),me.setSVGClass(Ho);const WG=["left","top","radius"],MO=["radius","startAngle","endAngle","counterClockwise"];class Rs extends En{static getDefaults(){return q(q({},super.getDefaults()),Rs.ownDefaults)}constructor(e){super(),Object.assign(this,Rs.ownDefaults),this.setOptions(e)}_set(e,t){return super._set(e,t),e==="radius"&&this.setRadius(t),this}_render(e){e.beginPath(),e.arc(0,0,this.radius,Ft(this.startAngle),Ft(this.endAngle),this.counterClockwise),this._renderPaintInOrder(e)}getRadiusX(){return this.get("radius")*this.get(nr)}getRadiusY(){return this.get("radius")*this.get(Dr)}setRadius(e){this.radius=e,this.set({width:2*e,height:2*e})}toObject(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return super.toObject([...MO,...e])}_toSVG(){const e=(this.endAngle-this.startAngle)%360;if(e===0)return["<circle ","COMMON_PARTS",'cx="0" cy="0" ','r="',"".concat(this.radius),`" />
`];{const{radius:t}=this,r=Ft(this.startAngle),s=Ft(this.endAngle),i=ai(r)*t,o=li(r)*t,a=ai(s)*t,l=li(s)*t,c=e>180?1:0,u=this.counterClockwise?0:1;return['<path d="M '.concat(i," ").concat(o," A ").concat(t," ").concat(t," 0 ").concat(c," ").concat(u," ").concat(a," ").concat(l,'" '),"COMMON_PARTS",` />
`]}}static async fromElement(e,t,r){const s=fi(e,this.ATTRIBUTE_NAMES,r),{left:i=0,top:o=0,radius:a=0}=s;return new this(q(q({},Ct(s,WG)),{},{radius:a,left:i-a,top:o-a}))}static fromObject(e){return super._fromObject(e)}}V(Rs,"type","Circle"),V(Rs,"cacheProperties",[...hi,...MO]),V(Rs,"ownDefaults",{radius:0,startAngle:0,endAngle:360,counterClockwise:!1}),V(Rs,"ATTRIBUTE_NAMES",["cx","cy","r",...Eo]),me.setClass(Rs),me.setSVGClass(Rs);const HG=["x1","y1","x2","y2"],VG=["x1","y1","x2","y2"],ox=["x1","x2","y1","y2"];class Vo extends En{constructor(){let[e,t,r,s]=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[0,0,0,0],i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(),Object.assign(this,Vo.ownDefaults),this.setOptions(i),this.x1=e,this.x2=r,this.y1=t,this.y2=s,this._setWidthHeight();const{left:o,top:a}=i;typeof o=="number"&&this.set(lt,o),typeof a=="number"&&this.set(Qn,a)}_setWidthHeight(){const{x1:e,y1:t,x2:r,y2:s}=this;this.width=Math.abs(r-e),this.height=Math.abs(s-t);const{left:i,top:o,width:a,height:l}=Xs([{x:e,y:t},{x:r,y:s}]),c=new Z(i+a/2,o+l/2);this.setPositionByOrigin(c,qe,qe)}_set(e,t){return super._set(e,t),ox.includes(e)&&this._setWidthHeight(),this}_render(e){e.beginPath();const t=this.calcLinePoints();e.moveTo(t.x1,t.y1),e.lineTo(t.x2,t.y2),e.lineWidth=this.strokeWidth;const r=e.strokeStyle;var s;Sr(this.stroke)?e.strokeStyle=this.stroke.toLive(e):e.strokeStyle=(s=this.stroke)!==null&&s!==void 0?s:e.fillStyle,this.stroke&&this._renderStroke(e),e.strokeStyle=r}_findCenterFromElement(){return new Z((this.x1+this.x2)/2,(this.y1+this.y2)/2)}toObject(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return q(q({},super.toObject(e)),this.calcLinePoints())}_getNonTransformedDimensions(){const e=super._getNonTransformedDimensions();return this.strokeLineCap==="butt"&&(this.width===0&&(e.y-=this.strokeWidth),this.height===0&&(e.x-=this.strokeWidth)),e}calcLinePoints(){const{x1:e,x2:t,y1:r,y2:s,width:i,height:o}=this,a=e<=t?-1:1,l=r<=s?-1:1;return{x1:a*i/2,x2:a*-i/2,y1:l*o/2,y2:l*-o/2}}_toSVG(){const{x1:e,x2:t,y1:r,y2:s}=this.calcLinePoints();return["<line ","COMMON_PARTS",'x1="'.concat(e,'" y1="').concat(r,'" x2="').concat(t,'" y2="').concat(s,`" />
`)]}static async fromElement(e,t,r){const s=fi(e,this.ATTRIBUTE_NAMES,r),{x1:i=0,y1:o=0,x2:a=0,y2:l=0}=s;return new this([i,o,a,l],Ct(s,HG))}static fromObject(e){let{x1:t,y1:r,x2:s,y2:i}=e,o=Ct(e,VG);return this._fromObject(q(q({},o),{},{points:[t,r,s,i]}),{extraParam:"points"})}}V(Vo,"type","Line"),V(Vo,"cacheProperties",[...hi,...ox]),V(Vo,"ATTRIBUTE_NAMES",Eo.concat(ox)),me.setClass(Vo),me.setSVGClass(Vo);class Xo extends En{static getDefaults(){return q(q({},super.getDefaults()),Xo.ownDefaults)}constructor(e){super(),Object.assign(this,Xo.ownDefaults),this.setOptions(e)}_render(e){const t=this.width/2,r=this.height/2;e.beginPath(),e.moveTo(-t,r),e.lineTo(0,-r),e.lineTo(t,r),e.closePath(),this._renderPaintInOrder(e)}_toSVG(){const e=this.width/2,t=this.height/2;return["<polygon ","COMMON_PARTS",'points="',"".concat(-e," ").concat(t,",0 ").concat(-t,",").concat(e," ").concat(t),'" />']}}V(Xo,"type","Triangle"),V(Xo,"ownDefaults",{width:100,height:100}),me.setClass(Xo),me.setSVGClass(Xo);const FO=["rx","ry"];class Ns extends En{static getDefaults(){return q(q({},super.getDefaults()),Ns.ownDefaults)}constructor(e){super(),Object.assign(this,Ns.ownDefaults),this.setOptions(e)}_set(e,t){switch(super._set(e,t),e){case"rx":this.rx=t,this.set("width",2*t);break;case"ry":this.ry=t,this.set("height",2*t)}return this}getRx(){return this.get("rx")*this.get(nr)}getRy(){return this.get("ry")*this.get(Dr)}toObject(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return super.toObject([...FO,...e])}_toSVG(){return["<ellipse ","COMMON_PARTS",'cx="0" cy="0" rx="'.concat(this.rx,'" ry="').concat(this.ry,`" />
`)]}_render(e){e.beginPath(),e.save(),e.transform(1,0,0,this.ry/this.rx,0,0),e.arc(0,0,this.rx,0,up,!1),e.restore(),this._renderPaintInOrder(e)}static async fromElement(e,t,r){const s=fi(e,this.ATTRIBUTE_NAMES,r);return s.left=(s.left||0)-s.rx,s.top=(s.top||0)-s.ry,new this(s)}}function GG(n){if(!n)return[];const e=n.replace(/,/g," ").trim().split(/\s+/),t=[];for(let r=0;r<e.length;r+=2)t.push({x:parseFloat(e[r]),y:parseFloat(e[r+1])});return t}V(Ns,"type","Ellipse"),V(Ns,"cacheProperties",[...hi,...FO]),V(Ns,"ownDefaults",{rx:0,ry:0}),V(Ns,"ATTRIBUTE_NAMES",[...Eo,"cx","cy","rx","ry"]),me.setClass(Ns),me.setSVGClass(Ns);const qG=["left","top"],BO={exactBoundingBox:!1};class zr extends En{static getDefaults(){return q(q({},super.getDefaults()),zr.ownDefaults)}constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(),V(this,"strokeDiff",void 0),Object.assign(this,zr.ownDefaults),this.setOptions(t),this.points=e;const{left:r,top:s}=t;this.initialized=!0,this.setBoundingBox(!0),typeof r=="number"&&this.set(lt,r),typeof s=="number"&&this.set(Qn,s)}isOpen(){return!0}_projectStrokeOnPoints(e){return LV(this.points,e,this.isOpen())}_calcDimensions(e){e=q({scaleX:this.scaleX,scaleY:this.scaleY,skewX:this.skewX,skewY:this.skewY,strokeLineCap:this.strokeLineCap,strokeLineJoin:this.strokeLineJoin,strokeMiterLimit:this.strokeMiterLimit,strokeUniform:this.strokeUniform,strokeWidth:this.strokeWidth},e||{});const t=this.exactBoundingBox?this._projectStrokeOnPoints(e).map(c=>c.projectedPoint):this.points;if(t.length===0)return{left:0,top:0,width:0,height:0,pathOffset:new Z,strokeOffset:new Z,strokeDiff:new Z};const r=Xs(t),s=E0(q(q({},e),{},{scaleX:1,scaleY:1})),i=Xs(this.points.map(c=>Wn(c,s,!0))),o=new Z(this.scaleX,this.scaleY);let a=r.left+r.width/2,l=r.top+r.height/2;return this.exactBoundingBox&&(a-=l*Math.tan(Ft(this.skewX)),l-=a*Math.tan(Ft(this.skewY))),q(q({},r),{},{pathOffset:new Z(a,l),strokeOffset:new Z(i.left,i.top).subtract(new Z(r.left,r.top)).multiply(o),strokeDiff:new Z(r.width,r.height).subtract(new Z(i.width,i.height)).multiply(o)})}_findCenterFromElement(){const e=Xs(this.points);return new Z(e.left+e.width/2,e.top+e.height/2)}setDimensions(){this.setBoundingBox()}setBoundingBox(e){const{left:t,top:r,width:s,height:i,pathOffset:o,strokeOffset:a,strokeDiff:l}=this._calcDimensions();this.set({width:s,height:i,pathOffset:o,strokeOffset:a,strokeDiff:l}),e&&this.setPositionByOrigin(new Z(t+s/2,r+i/2),qe,qe)}isStrokeAccountedForInDimensions(){return this.exactBoundingBox}_getNonTransformedDimensions(){return this.exactBoundingBox?new Z(this.width,this.height):super._getNonTransformedDimensions()}_getTransformedDimensions(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(this.exactBoundingBox){let o;if(Object.keys(e).some(a=>this.strokeUniform||this.constructor.layoutProperties.includes(a))){var t,r;const{width:a,height:l}=this._calcDimensions(e);o=new Z((t=e.width)!==null&&t!==void 0?t:a,(r=e.height)!==null&&r!==void 0?r:l)}else{var s,i;o=new Z((s=e.width)!==null&&s!==void 0?s:this.width,(i=e.height)!==null&&i!==void 0?i:this.height)}return o.multiply(new Z(e.scaleX||this.scaleX,e.scaleY||this.scaleY))}return super._getTransformedDimensions(e)}_set(e,t){const r=this.initialized&&this[e]!==t,s=super._set(e,t);return this.exactBoundingBox&&r&&((e===nr||e===Dr)&&this.strokeUniform&&this.constructor.layoutProperties.includes("strokeUniform")||this.constructor.layoutProperties.includes(e))&&this.setDimensions(),s}toObject(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return q(q({},super.toObject(e)),{},{points:this.points.map(t=>{let{x:r,y:s}=t;return{x:r,y:s}})})}_toSVG(){const e=[],t=this.pathOffset.x,r=this.pathOffset.y,s=nt.NUM_FRACTION_DIGITS;for(let i=0,o=this.points.length;i<o;i++)e.push(Tt(this.points[i].x-t,s),",",Tt(this.points[i].y-r,s)," ");return["<".concat(this.constructor.type.toLowerCase()," "),"COMMON_PARTS",'points="'.concat(e.join(""),`" />
`)]}_render(e){const t=this.points.length,r=this.pathOffset.x,s=this.pathOffset.y;if(t&&!isNaN(this.points[t-1].y)){e.beginPath(),e.moveTo(this.points[0].x-r,this.points[0].y-s);for(let i=0;i<t;i++){const o=this.points[i];e.lineTo(o.x-r,o.y-s)}!this.isOpen()&&e.closePath(),this._renderPaintInOrder(e)}}complexity(){return this.points.length}static async fromElement(e,t,r){return new this(GG(e.getAttribute("points")),q(q({},Ct(fi(e,this.ATTRIBUTE_NAMES,r),qG)),t))}static fromObject(e){return this._fromObject(e,{extraParam:"points"})}}V(zr,"ownDefaults",BO),V(zr,"type","Polyline"),V(zr,"layoutProperties",[mc,vc,"strokeLineCap","strokeLineJoin","strokeMiterLimit","strokeWidth","strokeUniform","points"]),V(zr,"cacheProperties",[...hi,"points"]),V(zr,"ATTRIBUTE_NAMES",[...Eo]),me.setClass(zr),me.setSVGClass(zr);class wh extends zr{isOpen(){return!1}}V(wh,"ownDefaults",BO),V(wh,"type","Polygon"),me.setClass(wh),me.setSVGClass(wh);const UO=["fontSize","fontWeight","fontFamily","fontStyle"],$O=["underline","overline","linethrough"],zO=[...UO,"lineHeight","text","charSpacing","textAlign","styles","path","pathStartOffset","pathSide","pathAlign"],WO=[...zO,...$O,"textBackgroundColor","direction"],YG=[...UO,...$O,er,"strokeWidth",Gt,"deltaY","textBackgroundColor"],XG={_reNewline:y1,_reSpacesAndTabs:/[ \t\r]/g,_reSpaceAndTab:/[ \t\r]/,_reWords:/\S+/g,fontSize:40,fontWeight:"normal",fontFamily:"Times New Roman",underline:!1,overline:!1,linethrough:!1,textAlign:lt,fontStyle:"normal",lineHeight:1.16,superscript:{size:.6,baseline:-.35},subscript:{size:.6,baseline:.11},textBackgroundColor:"",stroke:null,shadow:null,path:void 0,pathStartOffset:0,pathSide:lt,pathAlign:"baseline",_fontSizeFraction:.222,offsets:{underline:.1,linethrough:-.315,overline:-.88},_fontSizeMult:1.13,charSpacing:0,deltaY:0,direction:"ltr",CACHE_FONT_SIZE:400,MIN_TEXT_WIDTH:2},ds="justify",bp="justify-left",Cu="justify-right",Eu="justify-center";class HO extends En{isEmptyStyles(e){if(!this.styles||e!==void 0&&!this.styles[e])return!0;const t=e===void 0?this.styles:{line:this.styles[e]};for(const r in t)for(const s in t[r])for(const i in t[r][s])return!1;return!0}styleHas(e,t){if(!this.styles||t!==void 0&&!this.styles[t])return!1;const r=t===void 0?this.styles:{0:this.styles[t]};for(const s in r)for(const i in r[s])if(r[s][i][e]!==void 0)return!0;return!1}cleanStyle(e){if(!this.styles)return!1;const t=this.styles;let r,s,i=0,o=!0,a=0;for(const l in t){r=0;for(const c in t[l]){const u=t[l][c]||{};i++,u[e]!==void 0?(s?u[e]!==s&&(o=!1):s=u[e],u[e]===this[e]&&delete u[e]):o=!1,Object.keys(u).length!==0?r++:delete t[l][c]}r===0&&delete t[l]}for(let l=0;l<this._textLines.length;l++)a+=this._textLines[l].length;o&&i===a&&(this[e]=s,this.removeStyle(e))}removeStyle(e){if(!this.styles)return;const t=this.styles;let r,s,i;for(s in t){for(i in r=t[s],r)delete r[i][e],Object.keys(r[i]).length===0&&delete r[i];Object.keys(r).length===0&&delete t[s]}}_extendStyles(e,t){const{lineIndex:r,charIndex:s}=this.get2DCursorLocation(e);this._getLineStyle(r)||this._setLineStyle(r);const i=S1(q(q({},this._getStyleDeclaration(r,s)),t),o=>o!==void 0);this._setStyleDeclaration(r,s,i)}getSelectionStyles(e,t,r){const s=[];for(let i=e;i<(t||e);i++)s.push(this.getStyleAtPosition(i,r));return s}getStyleAtPosition(e,t){const{lineIndex:r,charIndex:s}=this.get2DCursorLocation(e);return t?this.getCompleteStyleDeclaration(r,s):this._getStyleDeclaration(r,s)}setSelectionStyles(e,t,r){for(let s=t;s<(r||t);s++)this._extendStyles(s,e);this._forceClearCache=!0}_getStyleDeclaration(e,t){var r;const s=this.styles&&this.styles[e];return s&&(r=s[t])!==null&&r!==void 0?r:{}}getCompleteStyleDeclaration(e,t){return q(q({},yc(this,this.constructor._styleProperties)),this._getStyleDeclaration(e,t))}_setStyleDeclaration(e,t,r){this.styles[e][t]=r}_deleteStyleDeclaration(e,t){delete this.styles[e][t]}_getLineStyle(e){return!!this.styles[e]}_setLineStyle(e){this.styles[e]={}}_deleteLineStyle(e){delete this.styles[e]}}V(HO,"_styleProperties",YG);const KG=/  +/g,JG=/"/g;function tm(n,e,t,r,s){return"		".concat(function(i,o){let{left:a,top:l,width:c,height:u}=o,h=arguments.length>2&&arguments[2]!==void 0?arguments[2]:nt.NUM_FRACTION_DIGITS;const d=ad(Gt,i,!1),[p,m,g,y]=[a,l,c,u].map(x=>Tt(x,h));return"<rect ".concat(d,' x="').concat(p,'" y="').concat(m,'" width="').concat(g,'" height="').concat(y,'"></rect>')}(n,{left:e,top:t,width:r,height:s}),`
`)}const QG=["textAnchor","textDecoration","dx","dy","top","left","fontSize","strokeWidth"];let nm;class on extends HO{static getDefaults(){return q(q({},super.getDefaults()),on.ownDefaults)}constructor(e,t){super(),V(this,"__charBounds",[]),Object.assign(this,on.ownDefaults),this.setOptions(t),this.styles||(this.styles={}),this.text=e,this.initialized=!0,this.path&&this.setPathInfo(),this.initDimensions(),this.setCoords()}setPathInfo(){const e=this.path;e&&(e.segmentsInfo=OO(e.path))}_splitText(){const e=this._splitTextIntoLines(this.text);return this.textLines=e.lines,this._textLines=e.graphemeLines,this._unwrappedTextLines=e._unwrappedLines,this._text=e.graphemeText,e}initDimensions(){this._splitText(),this._clearCache(),this.dirty=!0,this.path?(this.width=this.path.width,this.height=this.path.height):(this.width=this.calcTextWidth()||this.cursorWidth||this.MIN_TEXT_WIDTH,this.height=this.calcTextHeight()),this.textAlign.includes(ds)&&this.enlargeSpaces()}enlargeSpaces(){let e,t,r,s,i,o,a;for(let l=0,c=this._textLines.length;l<c;l++)if((this.textAlign===ds||l!==c-1&&!this.isEndOfWrapping(l))&&(s=0,i=this._textLines[l],t=this.getLineWidth(l),t<this.width&&(a=this.textLines[l].match(this._reSpacesAndTabs)))){r=a.length,e=(this.width-t)/r;for(let u=0;u<=i.length;u++)o=this.__charBounds[l][u],this._reSpaceAndTab.test(i[u])?(o.width+=e,o.kernedWidth+=e,o.left+=s,s+=e):o.left+=s}}isEndOfWrapping(e){return e===this._textLines.length-1}missingNewlineOffset(e){return 1}get2DCursorLocation(e,t){const r=t?this._unwrappedTextLines:this._textLines;let s;for(s=0;s<r.length;s++){if(e<=r[s].length)return{lineIndex:s,charIndex:e};e-=r[s].length+this.missingNewlineOffset(s,t)}return{lineIndex:s-1,charIndex:r[s-1].length<e?r[s-1].length:e}}toString(){return"#<Text (".concat(this.complexity(),'): { "text": "').concat(this.text,'", "fontFamily": "').concat(this.fontFamily,'" }>')}_getCacheCanvasDimensions(){const e=super._getCacheCanvasDimensions(),t=this.fontSize;return e.width+=t*e.zoomX,e.height+=t*e.zoomY,e}_render(e){const t=this.path;t&&!t.isNotVisible()&&t._render(e),this._setTextStyles(e),this._renderTextLinesBackground(e),this._renderTextDecoration(e,"underline"),this._renderText(e),this._renderTextDecoration(e,"overline"),this._renderTextDecoration(e,"linethrough")}_renderText(e){this.paintFirst===er?(this._renderTextStroke(e),this._renderTextFill(e)):(this._renderTextFill(e),this._renderTextStroke(e))}_setTextStyles(e,t,r){if(e.textBaseline="alphabetic",this.path)switch(this.pathAlign){case qe:e.textBaseline="middle";break;case"ascender":e.textBaseline=Qn;break;case"descender":e.textBaseline=Xy}e.font=this._getFontDeclaration(t,r)}calcTextWidth(){let e=this.getLineWidth(0);for(let t=1,r=this._textLines.length;t<r;t++){const s=this.getLineWidth(t);s>e&&(e=s)}return e}_renderTextLine(e,t,r,s,i,o){this._renderChars(e,t,r,s,i,o)}_renderTextLinesBackground(e){if(!this.textBackgroundColor&&!this.styleHas("textBackgroundColor"))return;const t=e.fillStyle,r=this._getLeftOffset();let s=this._getTopOffset();for(let i=0,o=this._textLines.length;i<o;i++){const a=this.getHeightOfLine(i);if(!this.textBackgroundColor&&!this.styleHas("textBackgroundColor",i)){s+=a;continue}const l=this._textLines[i].length,c=this._getLineLeftOffset(i);let u,h,d=0,p=0,m=this.getValueOfPropertyAt(i,0,"textBackgroundColor");for(let g=0;g<l;g++){const y=this.__charBounds[i][g];h=this.getValueOfPropertyAt(i,g,"textBackgroundColor"),this.path?(e.save(),e.translate(y.renderLeft,y.renderTop),e.rotate(y.angle),e.fillStyle=h,h&&e.fillRect(-y.width/2,-a/this.lineHeight*(1-this._fontSizeFraction),y.width,a/this.lineHeight),e.restore()):h!==m?(u=r+c+p,this.direction==="rtl"&&(u=this.width-u-d),e.fillStyle=m,m&&e.fillRect(u,s,d,a/this.lineHeight),p=y.left,d=y.width,m=h):d+=y.kernedWidth}h&&!this.path&&(u=r+c+p,this.direction==="rtl"&&(u=this.width-u-d),e.fillStyle=h,e.fillRect(u,s,d,a/this.lineHeight)),s+=a}e.fillStyle=t,this._removeShadow(e)}_measureChar(e,t,r,s){const i=_u.getFontCache(t),o=this._getFontDeclaration(t),a=r+e,l=r&&o===this._getFontDeclaration(s),c=t.fontSize/this.CACHE_FONT_SIZE;let u,h,d,p;if(r&&i[r]!==void 0&&(d=i[r]),i[e]!==void 0&&(p=u=i[e]),l&&i[a]!==void 0&&(h=i[a],p=h-d),u===void 0||d===void 0||h===void 0){const m=function(){if(!nm){const g=Zt();g.width=g.height=0,nm=g.getContext("2d")}return nm}();this._setTextStyles(m,t,!0),u===void 0&&(p=u=m.measureText(e).width,i[e]=u),d===void 0&&l&&r&&(d=m.measureText(r).width,i[r]=d),l&&h===void 0&&(h=m.measureText(a).width,i[a]=h,p=h-d)}return{width:u*c,kernedWidth:p*c}}getHeightOfChar(e,t){return this.getValueOfPropertyAt(e,t,"fontSize")}measureLine(e){const t=this._measureLine(e);return this.charSpacing!==0&&(t.width-=this._getWidthOfCharSpacing()),t.width<0&&(t.width=0),t}_measureLine(e){let t,r,s=0;const i=this.pathSide===Lt,o=this.path,a=this._textLines[e],l=a.length,c=new Array(l);this.__charBounds[e]=c;for(let u=0;u<l;u++){const h=a[u];r=this._getGraphemeBox(h,e,u,t),c[u]=r,s+=r.kernedWidth,t=h}if(c[l]={left:r?r.left+r.width:0,width:0,kernedWidth:0,height:this.fontSize,deltaY:0},o&&o.segmentsInfo){let u=0;const h=o.segmentsInfo[o.segmentsInfo.length-1].length;switch(this.textAlign){case lt:u=i?h-s:0;break;case qe:u=(h-s)/2;break;case Lt:u=i?0:h-s}u+=this.pathStartOffset*(i?-1:1);for(let d=i?l-1:0;i?d>=0:d<l;i?d--:d++)r=c[d],u>h?u%=h:u<0&&(u+=h),this._setGraphemeOnPath(u,r),u+=r.kernedWidth}return{width:s,numOfSpaces:0}}_setGraphemeOnPath(e,t){const r=e+t.kernedWidth/2,s=this.path,i=SG(s.path,r,s.segmentsInfo);t.renderLeft=i.x-s.pathOffset.x,t.renderTop=i.y-s.pathOffset.y,t.angle=i.angle+(this.pathSide===Lt?Math.PI:0)}_getGraphemeBox(e,t,r,s,i){const o=this.getCompleteStyleDeclaration(t,r),a=s?this.getCompleteStyleDeclaration(t,r-1):{},l=this._measureChar(e,o,s,a);let c,u=l.kernedWidth,h=l.width;this.charSpacing!==0&&(c=this._getWidthOfCharSpacing(),h+=c,u+=c);const d={width:h,left:0,height:o.fontSize,kernedWidth:u,deltaY:o.deltaY};if(r>0&&!i){const p=this.__charBounds[t][r-1];d.left=p.left+p.width+l.kernedWidth-l.width}return d}getHeightOfLine(e){if(this.__lineHeights[e])return this.__lineHeights[e];let t=this.getHeightOfChar(e,0);for(let r=1,s=this._textLines[e].length;r<s;r++)t=Math.max(this.getHeightOfChar(e,r),t);return this.__lineHeights[e]=t*this.lineHeight*this._fontSizeMult}calcTextHeight(){let e,t=0;for(let r=0,s=this._textLines.length;r<s;r++)e=this.getHeightOfLine(r),t+=r===s-1?e/this.lineHeight:e;return t}_getLeftOffset(){return this.direction==="ltr"?-this.width/2:this.width/2}_getTopOffset(){return-this.height/2}_renderTextCommon(e,t){e.save();let r=0;const s=this._getLeftOffset(),i=this._getTopOffset();for(let o=0,a=this._textLines.length;o<a;o++){const l=this.getHeightOfLine(o),c=l/this.lineHeight,u=this._getLineLeftOffset(o);this._renderTextLine(t,e,this._textLines[o],s+u,i+r+c,o),r+=l}e.restore()}_renderTextFill(e){(this.fill||this.styleHas(Gt))&&this._renderTextCommon(e,"fillText")}_renderTextStroke(e){(this.stroke&&this.strokeWidth!==0||!this.isEmptyStyles())&&(this.shadow&&!this.shadow.affectStroke&&this._removeShadow(e),e.save(),this._setLineDash(e,this.strokeDashArray),e.beginPath(),this._renderTextCommon(e,"strokeText"),e.closePath(),e.restore())}_renderChars(e,t,r,s,i,o){const a=this.getHeightOfLine(o),l=this.textAlign.includes(ds),c=this.path,u=!l&&this.charSpacing===0&&this.isEmptyStyles(o)&&!c,h=this.direction==="ltr",d=this.direction==="ltr"?1:-1,p=t.direction;let m,g,y,x,v,w="",_=0;if(t.save(),p!==this.direction&&(t.canvas.setAttribute("dir",h?"ltr":"rtl"),t.direction=h?"ltr":"rtl",t.textAlign=h?lt:Lt),i-=a*this._fontSizeFraction/this.lineHeight,u)return this._renderChar(e,t,o,0,r.join(""),s,i),void t.restore();for(let S=0,E=r.length-1;S<=E;S++)x=S===E||this.charSpacing||c,w+=r[S],y=this.__charBounds[o][S],_===0?(s+=d*(y.kernedWidth-y.width),_+=y.width):_+=y.kernedWidth,l&&!x&&this._reSpaceAndTab.test(r[S])&&(x=!0),x||(m=m||this.getCompleteStyleDeclaration(o,S),g=this.getCompleteStyleDeclaration(o,S+1),x=O1(m,g,!1)),x&&(c?(t.save(),t.translate(y.renderLeft,y.renderTop),t.rotate(y.angle),this._renderChar(e,t,o,S,w,-_/2,0),t.restore()):(v=s,this._renderChar(e,t,o,S,w,v,i)),w="",m=g,s+=d*_,_=0);t.restore()}_applyPatternGradientTransformText(e){const t=Zt(),r=this.width+this.strokeWidth,s=this.height+this.strokeWidth,i=t.getContext("2d");return t.width=r,t.height=s,i.beginPath(),i.moveTo(0,0),i.lineTo(r,0),i.lineTo(r,s),i.lineTo(0,s),i.closePath(),i.translate(r/2,s/2),i.fillStyle=e.toLive(i),this._applyPatternGradientTransform(i,e),i.fill(),i.createPattern(t,"no-repeat")}handleFiller(e,t,r){let s,i;return Sr(r)?r.gradientUnits==="percentage"||r.gradientTransform||r.patternTransform?(s=-this.width/2,i=-this.height/2,e.translate(s,i),e[t]=this._applyPatternGradientTransformText(r),{offsetX:s,offsetY:i}):(e[t]=r.toLive(e),this._applyPatternGradientTransform(e,r)):(e[t]=r,{offsetX:0,offsetY:0})}_setStrokeStyles(e,t){let{stroke:r,strokeWidth:s}=t;return e.lineWidth=s,e.lineCap=this.strokeLineCap,e.lineDashOffset=this.strokeDashOffset,e.lineJoin=this.strokeLineJoin,e.miterLimit=this.strokeMiterLimit,this.handleFiller(e,"strokeStyle",r)}_setFillStyles(e,t){let{fill:r}=t;return this.handleFiller(e,"fillStyle",r)}_renderChar(e,t,r,s,i,o,a){const l=this._getStyleDeclaration(r,s),c=this.getCompleteStyleDeclaration(r,s),u=e==="fillText"&&c.fill,h=e==="strokeText"&&c.stroke&&c.strokeWidth;if(h||u){if(t.save(),t.font=this._getFontDeclaration(c),l.textBackgroundColor&&this._removeShadow(t),l.deltaY&&(a+=l.deltaY),u){const d=this._setFillStyles(t,c);t.fillText(i,o-d.offsetX,a-d.offsetY)}if(h){const d=this._setStrokeStyles(t,c);t.strokeText(i,o-d.offsetX,a-d.offsetY)}t.restore()}}setSuperscript(e,t){this._setScript(e,t,this.superscript)}setSubscript(e,t){this._setScript(e,t,this.subscript)}_setScript(e,t,r){const s=this.get2DCursorLocation(e,!0),i=this.getValueOfPropertyAt(s.lineIndex,s.charIndex,"fontSize"),o=this.getValueOfPropertyAt(s.lineIndex,s.charIndex,"deltaY"),a={fontSize:i*r.size,deltaY:o+i*r.baseline};this.setSelectionStyles(a,e,t)}_getLineLeftOffset(e){const t=this.getLineWidth(e),r=this.width-t,s=this.textAlign,i=this.direction,o=this.isEndOfWrapping(e);let a=0;return s===ds||s===Eu&&!o||s===Cu&&!o||s===bp&&!o?0:(s===qe&&(a=r/2),s===Lt&&(a=r),s===Eu&&(a=r/2),s===Cu&&(a=r),i==="rtl"&&(s===Lt||s===ds||s===Cu?a=0:s===lt||s===bp?a=-r:s!==qe&&s!==Eu||(a=-r/2)),a)}_clearCache(){this._forceClearCache=!1,this.__lineWidths=[],this.__lineHeights=[],this.__charBounds=[]}getLineWidth(e){if(this.__lineWidths[e]!==void 0)return this.__lineWidths[e];const{width:t}=this.measureLine(e);return this.__lineWidths[e]=t,t}_getWidthOfCharSpacing(){return this.charSpacing!==0?this.fontSize*this.charSpacing/1e3:0}getValueOfPropertyAt(e,t,r){var s;return(s=this._getStyleDeclaration(e,t)[r])!==null&&s!==void 0?s:this[r]}_renderTextDecoration(e,t){if(!this[t]&&!this.styleHas(t))return;let r=this._getTopOffset();const s=this._getLeftOffset(),i=this.path,o=this._getWidthOfCharSpacing(),a=this.offsets[t];for(let l=0,c=this._textLines.length;l<c;l++){const u=this.getHeightOfLine(l);if(!this[t]&&!this.styleHas(t,l)){r+=u;continue}const h=this._textLines[l],d=u/this.lineHeight,p=this._getLineLeftOffset(l);let m,g,y=0,x=0,v=this.getValueOfPropertyAt(l,0,t),w=this.getValueOfPropertyAt(l,0,Gt);const _=r+d*(1-this._fontSizeFraction);let S=this.getHeightOfChar(l,0),E=this.getValueOfPropertyAt(l,0,"deltaY");for(let P=0,O=h.length;P<O;P++){const A=this.__charBounds[l][P];m=this.getValueOfPropertyAt(l,P,t),g=this.getValueOfPropertyAt(l,P,Gt);const R=this.getHeightOfChar(l,P),B=this.getValueOfPropertyAt(l,P,"deltaY");if(i&&m&&g)e.save(),e.fillStyle=w,e.translate(A.renderLeft,A.renderTop),e.rotate(A.angle),e.fillRect(-A.kernedWidth/2,a*R+B,A.kernedWidth,this.fontSize/15),e.restore();else if((m!==v||g!==w||R!==S||B!==E)&&x>0){let I=s+p+y;this.direction==="rtl"&&(I=this.width-I-x),v&&w&&(e.fillStyle=w,e.fillRect(I,_+a*S+E,x,this.fontSize/15)),y=A.left,x=A.width,v=m,w=g,S=R,E=B}else x+=A.kernedWidth}let C=s+p+y;this.direction==="rtl"&&(C=this.width-C-x),e.fillStyle=g,m&&g&&e.fillRect(C,_+a*S+E,x-o,this.fontSize/15),r+=u}this._removeShadow(e)}_getFontDeclaration(){let{fontFamily:e=this.fontFamily,fontStyle:t=this.fontStyle,fontWeight:r=this.fontWeight,fontSize:s=this.fontSize}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},i=arguments.length>1?arguments[1]:void 0;const o=e.includes("'")||e.includes('"')||e.includes(",")||on.genericFonts.includes(e.toLowerCase())?e:'"'.concat(e,'"');return[t,r,"".concat(i?this.CACHE_FONT_SIZE:s,"px"),o].join(" ")}render(e){this.visible&&(this.canvas&&this.canvas.skipOffscreen&&!this.group&&!this.isOnScreen()||(this._forceClearCache&&this.initDimensions(),super.render(e)))}graphemeSplit(e){return D1(e)}_splitTextIntoLines(e){const t=e.split(this._reNewline),r=new Array(t.length),s=[`
`];let i=[];for(let o=0;o<t.length;o++)r[o]=this.graphemeSplit(t[o]),i=i.concat(r[o],s);return i.pop(),{_unwrappedLines:r,lines:t,graphemeText:i,graphemeLines:r}}toObject(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return q(q({},super.toObject([...WO,...e])),{},{styles:BV(this.styles,this.text)},this.path?{path:this.path.toObject()}:{})}set(e,t){const{textLayoutProperties:r}=this.constructor;super.set(e,t);let s=!1,i=!1;if(typeof e=="object")for(const o in e)o==="path"&&this.setPathInfo(),s=s||r.includes(o),i=i||o==="path";else s=r.includes(e),i=e==="path";return i&&this.setPathInfo(),s&&this.initialized&&(this.initDimensions(),this.setCoords()),this}complexity(){return 1}static async fromElement(e,t,r){const s=fi(e,on.ATTRIBUTE_NAMES,r),i=q(q({},t),s),{textAnchor:o=lt,textDecoration:a="",dx:l=0,dy:c=0,top:u=0,left:h=0,fontSize:d=v1,strokeWidth:p=1}=i,m=Ct(i,QG),g=new this((e.textContent||"").replace(/^\s+|\s+$|\n+/g,"").replace(/\s+/g," "),q({left:h+l,top:u+c,underline:a.includes("underline"),overline:a.includes("overline"),linethrough:a.includes("line-through"),strokeWidth:0,fontSize:d},m)),y=g.getScaledHeight()/g.height,x=((g.height+g.strokeWidth)*g.lineHeight-g.height)*y,v=g.getScaledHeight()+x;let w=0;return o===qe&&(w=g.getScaledWidth()/2),o===Lt&&(w=g.getScaledWidth()),g.set({left:g.left-w,top:g.top-(v-g.fontSize*(.07+g._fontSizeFraction))/g.lineHeight,strokeWidth:p}),g}static fromObject(e){return this._fromObject(q(q({},e),{},{styles:UV(e.styles||{},e.text)}),{extraParam:"text"})}}V(on,"textLayoutProperties",zO),V(on,"cacheProperties",[...hi,...WO]),V(on,"ownDefaults",XG),V(on,"type","Text"),V(on,"genericFonts",["serif","sans-serif","monospace","cursive","fantasy","system-ui","ui-serif","ui-sans-serif","ui-monospace","ui-rounded","math","emoji","fangsong"]),V(on,"ATTRIBUTE_NAMES",Eo.concat("x","y","dx","dy","font-family","font-style","font-weight","font-size","letter-spacing","text-decoration","text-anchor")),_O(on,[class extends fO{_toSVG(){const n=this._getSVGLeftTopOffsets(),e=this._getSVGTextAndBg(n.textTop,n.textLeft);return this._wrapSVGTextAndBg(e)}toSVG(n){return this._createBaseSVGMarkup(this._toSVG(),{reviver:n,noStyle:!0,withShadow:!0})}_getSVGLeftTopOffsets(){return{textLeft:-this.width/2,textTop:-this.height/2,lineTop:this.getHeightOfLine(0)}}_wrapSVGTextAndBg(n){let{textBgRects:e,textSpans:t}=n;const r=this.getSvgTextDecoration(this);return[e.join(""),'		<text xml:space="preserve" ',this.fontFamily?'font-family="'.concat(this.fontFamily.replace(JG,"'"),'" '):"",this.fontSize?'font-size="'.concat(this.fontSize,'" '):"",this.fontStyle?'font-style="'.concat(this.fontStyle,'" '):"",this.fontWeight?'font-weight="'.concat(this.fontWeight,'" '):"",r?'text-decoration="'.concat(r,'" '):"",this.direction==="rtl"?'direction="'.concat(this.direction,'" '):"",'style="',this.getSvgStyles(!0),'"',this.addPaintOrder()," >",t.join(""),`</text>
`]}_getSVGTextAndBg(n,e){const t=[],r=[];let s,i=n;this.backgroundColor&&r.push(...tm(this.backgroundColor,-this.width/2,-this.height/2,this.width,this.height));for(let o=0,a=this._textLines.length;o<a;o++)s=this._getLineLeftOffset(o),this.direction==="rtl"&&(s+=this.width),(this.textBackgroundColor||this.styleHas("textBackgroundColor",o))&&this._setSVGTextLineBg(r,o,e+s,i),this._setSVGTextLineText(t,o,e+s,i),i+=this.getHeightOfLine(o);return{textSpans:t,textBgRects:r}}_createTextCharSpan(n,e,t,r){const s=this.getSvgSpanStyles(e,n!==n.trim()||!!n.match(KG)),i=s?'style="'.concat(s,'"'):"",o=e.deltaY,a=o?' dy="'.concat(Tt(o,nt.NUM_FRACTION_DIGITS),'" '):"";return'<tspan x="'.concat(Tt(t,nt.NUM_FRACTION_DIGITS),'" y="').concat(Tt(r,nt.NUM_FRACTION_DIGITS),'" ').concat(a).concat(i,">").concat(MV(n),"</tspan>")}_setSVGTextLineText(n,e,t,r){const s=this.getHeightOfLine(e),i=this.textAlign.includes(ds),o=this._textLines[e];let a,l,c,u,h,d="",p=0;r+=s*(1-this._fontSizeFraction)/this.lineHeight;for(let m=0,g=o.length-1;m<=g;m++)h=m===g||this.charSpacing,d+=o[m],c=this.__charBounds[e][m],p===0?(t+=c.kernedWidth-c.width,p+=c.width):p+=c.kernedWidth,i&&!h&&this._reSpaceAndTab.test(o[m])&&(h=!0),h||(a=a||this.getCompleteStyleDeclaration(e,m),l=this.getCompleteStyleDeclaration(e,m+1),h=O1(a,l,!0)),h&&(u=this._getStyleDeclaration(e,m),n.push(this._createTextCharSpan(d,u,t,r)),d="",a=l,this.direction==="rtl"?t-=p:t+=p,p=0)}_setSVGTextLineBg(n,e,t,r){const s=this._textLines[e],i=this.getHeightOfLine(e)/this.lineHeight;let o,a=0,l=0,c=this.getValueOfPropertyAt(e,0,"textBackgroundColor");for(let u=0;u<s.length;u++){const{left:h,width:d,kernedWidth:p}=this.__charBounds[e][u];o=this.getValueOfPropertyAt(e,u,"textBackgroundColor"),o!==c?(c&&n.push(...tm(c,t+l,r,a,i)),l=h,a=d,c=o):a+=p}o&&n.push(...tm(c,t+l,r,a,i))}_getSVGLineTopOffset(n){let e,t=0;for(e=0;e<n;e++)t+=this.getHeightOfLine(e);const r=this.getHeightOfLine(e);return{lineTop:t,offset:(this._fontSizeMult-this._fontSizeFraction)*r/(this.lineHeight*this._fontSizeMult)}}getSvgStyles(n){return"".concat(super.getSvgStyles(n)," white-space: pre;")}getSvgSpanStyles(n,e){const{fontFamily:t,strokeWidth:r,stroke:s,fill:i,fontSize:o,fontStyle:a,fontWeight:l,deltaY:c}=n,u=this.getSvgTextDecoration(n);return[s?ad(er,s):"",r?"stroke-width: ".concat(r,"; "):"",t?"font-family: ".concat(t.includes("'")||t.includes('"')?t:"'".concat(t,"'"),"; "):"",o?"font-size: ".concat(o,"px; "):"",a?"font-style: ".concat(a,"; "):"",l?"font-weight: ".concat(l,"; "):"",u&&"text-decoration: ".concat(u,"; "),i?ad(Gt,i):"",c?"baseline-shift: ".concat(-c,"; "):"",e?"white-space: pre; ":""].join("")}getSvgTextDecoration(n){return["overline","underline","line-through"].filter(e=>n[e.replace("-","")]).join(" ")}}]),me.setClass(on),me.setSVGClass(on);class ZG{constructor(e){V(this,"target",void 0),V(this,"__mouseDownInPlace",!1),V(this,"__dragStartFired",!1),V(this,"__isDraggingOver",!1),V(this,"__dragStartSelection",void 0),V(this,"__dragImageDisposer",void 0),V(this,"_dispose",void 0),this.target=e;const t=[this.target.on("dragenter",this.dragEnterHandler.bind(this)),this.target.on("dragover",this.dragOverHandler.bind(this)),this.target.on("dragleave",this.dragLeaveHandler.bind(this)),this.target.on("dragend",this.dragEndHandler.bind(this)),this.target.on("drop",this.dropHandler.bind(this))];this._dispose=()=>{t.forEach(r=>r()),this._dispose=void 0}}isPointerOverSelection(e){const t=this.target,r=t.getSelectionStartFromPointer(e);return t.isEditing&&r>=t.selectionStart&&r<=t.selectionEnd&&t.selectionStart<t.selectionEnd}start(e){return this.__mouseDownInPlace=this.isPointerOverSelection(e)}isActive(){return this.__mouseDownInPlace}end(e){const t=this.isActive();return t&&!this.__dragStartFired&&(this.target.setCursorByClick(e),this.target.initDelayedCursor(!0)),this.__mouseDownInPlace=!1,this.__dragStartFired=!1,this.__isDraggingOver=!1,t}getDragStartSelection(){return this.__dragStartSelection}setDragImage(e,t){var r;let{selectionStart:s,selectionEnd:i}=t;const o=this.target,a=o.canvas,l=new Z(o.flipX?-1:1,o.flipY?-1:1),c=o._getCursorBoundaries(s),u=new Z(c.left+c.leftOffset,c.top+c.topOffset).multiply(l).transform(o.calcTransformMatrix()),h=a.getScenePoint(e).subtract(u),d=o.getCanvasRetinaScaling(),p=o.getBoundingRect(),m=u.subtract(new Z(p.left,p.top)),g=a.viewportTransform,y=m.add(h).transform(g,!0),x=o.backgroundColor,v=A1(o.styles);o.backgroundColor="";const w={stroke:"transparent",fill:"transparent",textBackgroundColor:"transparent"};o.setSelectionStyles(w,0,s),o.setSelectionStyles(w,i,o.text.length),o.dirty=!0;const _=o.toCanvasElement({enableRetinaScaling:a.enableRetinaScaling,viewportTransform:!0});o.backgroundColor=x,o.styles=v,o.dirty=!0,ix(_,{position:"fixed",left:"".concat(-_.width,"px"),border:Zn,width:"".concat(_.width/d,"px"),height:"".concat(_.height/d,"px")}),this.__dragImageDisposer&&this.__dragImageDisposer(),this.__dragImageDisposer=()=>{_.remove()},qr(e.target||this.target.hiddenTextarea).body.appendChild(_),(r=e.dataTransfer)===null||r===void 0||r.setDragImage(_,y.x,y.y)}onDragStart(e){this.__dragStartFired=!0;const t=this.target,r=this.isActive();if(r&&e.dataTransfer){const s=this.__dragStartSelection={selectionStart:t.selectionStart,selectionEnd:t.selectionEnd},i=t._text.slice(s.selectionStart,s.selectionEnd).join(""),o=q({text:t.text,value:i},s);e.dataTransfer.setData("text/plain",i),e.dataTransfer.setData("application/fabric",JSON.stringify({value:i,styles:t.getSelectionStyles(s.selectionStart,s.selectionEnd,!0)})),e.dataTransfer.effectAllowed="copyMove",this.setDragImage(e,o)}return t.abortCursorAnimation(),r}canDrop(e){if(this.target.editable&&!this.target.getActiveControl()&&!e.defaultPrevented){if(this.isActive()&&this.__dragStartSelection){const t=this.target.getSelectionStartFromPointer(e),r=this.__dragStartSelection;return t<r.selectionStart||t>r.selectionEnd}return!0}return!1}targetCanDrop(e){return this.target.canDrop(e)}dragEnterHandler(e){let{e:t}=e;const r=this.targetCanDrop(t);!this.__isDraggingOver&&r&&(this.__isDraggingOver=!0)}dragOverHandler(e){const{e:t}=e,r=this.targetCanDrop(t);!this.__isDraggingOver&&r?this.__isDraggingOver=!0:this.__isDraggingOver&&!r&&(this.__isDraggingOver=!1),this.__isDraggingOver&&(t.preventDefault(),e.canDrop=!0,e.dropTarget=this.target)}dragLeaveHandler(){(this.__isDraggingOver||this.isActive())&&(this.__isDraggingOver=!1)}dropHandler(e){var t;const{e:r}=e,s=r.defaultPrevented;this.__isDraggingOver=!1,r.preventDefault();let i=(t=r.dataTransfer)===null||t===void 0?void 0:t.getData("text/plain");if(i&&!s){const o=this.target,a=o.canvas;let l=o.getSelectionStartFromPointer(r);const{styles:c}=r.dataTransfer.types.includes("application/fabric")?JSON.parse(r.dataTransfer.getData("application/fabric")):{},u=i[Math.max(0,i.length-1)],h=0;if(this.__dragStartSelection){const d=this.__dragStartSelection.selectionStart,p=this.__dragStartSelection.selectionEnd;l>d&&l<=p?l=d:l>p&&(l-=p-d),o.removeChars(d,p),delete this.__dragStartSelection}o._reNewline.test(u)&&(o._reNewline.test(o._text[l])||l===o._text.length)&&(i=i.trimEnd()),e.didDrop=!0,e.dropTarget=o,o.insertChars(i,c,l),a.setActiveObject(o),o.enterEditing(r),o.selectionStart=Math.min(l+h,o._text.length),o.selectionEnd=Math.min(o.selectionStart+i.length,o._text.length),o.hiddenTextarea.value=o.text,o._updateTextarea(),o.hiddenTextarea.focus(),o.fire(dp,{index:l+h,action:"drop"}),a.fire("text:changed",{target:o}),a.contextTopDirty=!0,a.requestRenderAll()}}dragEndHandler(e){let{e:t}=e;if(this.isActive()&&this.__dragStartFired&&this.__dragStartSelection){var r;const s=this.target,i=this.target.canvas,{selectionStart:o,selectionEnd:a}=this.__dragStartSelection,l=((r=t.dataTransfer)===null||r===void 0?void 0:r.dropEffect)||Zn;l===Zn?(s.selectionStart=o,s.selectionEnd=a,s._updateTextarea(),s.hiddenTextarea.focus()):(s.clearContextTop(),l==="move"&&(s.removeChars(o,a),s.selectionStart=s.selectionEnd=o,s.hiddenTextarea&&(s.hiddenTextarea.value=s.text),s._updateTextarea(),s.fire(dp,{index:o,action:"dragend"}),i.fire("text:changed",{target:s}),i.requestRenderAll()),s.exitEditing())}this.__dragImageDisposer&&this.__dragImageDisposer(),delete this.__dragImageDisposer,delete this.__dragStartSelection,this.__isDraggingOver=!1}dispose(){this._dispose&&this._dispose()}}const iE=/[ \n\.,;!\?\-]/;class eq extends on{constructor(){super(...arguments),V(this,"_currentCursorOpacity",1)}initBehavior(){this._tick=this._tick.bind(this),this._onTickComplete=this._onTickComplete.bind(this),this.updateSelectionOnMouseMove=this.updateSelectionOnMouseMove.bind(this)}onDeselect(e){return this.isEditing&&this.exitEditing(),this.selected=!1,super.onDeselect(e)}_animateCursor(e){let{toValue:t,duration:r,delay:s,onComplete:i}=e;return vO({startValue:this._currentCursorOpacity,endValue:t,duration:r,delay:s,onComplete:i,abort:()=>!this.canvas||this.selectionStart!==this.selectionEnd,onChange:o=>{this._currentCursorOpacity=o,this.renderCursorOrSelection()}})}_tick(e){this._currentTickState=this._animateCursor({toValue:0,duration:this.cursorDuration/2,delay:Math.max(e||0,100),onComplete:this._onTickComplete})}_onTickComplete(){var e;(e=this._currentTickCompleteState)===null||e===void 0||e.abort(),this._currentTickCompleteState=this._animateCursor({toValue:1,duration:this.cursorDuration,onComplete:this._tick})}initDelayedCursor(e){this.abortCursorAnimation(),this._tick(e?0:this.cursorDelay)}abortCursorAnimation(){let e=!1;[this._currentTickState,this._currentTickCompleteState].forEach(t=>{t&&!t.isDone()&&(e=!0,t.abort())}),this._currentCursorOpacity=1,e&&this.clearContextTop()}restartCursorIfNeeded(){[this._currentTickState,this._currentTickCompleteState].some(e=>!e||e.isDone())&&this.initDelayedCursor()}selectAll(){return this.selectionStart=0,this.selectionEnd=this._text.length,this._fireSelectionChanged(),this._updateTextarea(),this}getSelectedText(){return this._text.slice(this.selectionStart,this.selectionEnd).join("")}findWordBoundaryLeft(e){let t=0,r=e-1;if(this._reSpace.test(this._text[r]))for(;this._reSpace.test(this._text[r]);)t++,r--;for(;/\S/.test(this._text[r])&&r>-1;)t++,r--;return e-t}findWordBoundaryRight(e){let t=0,r=e;if(this._reSpace.test(this._text[r]))for(;this._reSpace.test(this._text[r]);)t++,r++;for(;/\S/.test(this._text[r])&&r<this._text.length;)t++,r++;return e+t}findLineBoundaryLeft(e){let t=0,r=e-1;for(;!/\n/.test(this._text[r])&&r>-1;)t++,r--;return e-t}findLineBoundaryRight(e){let t=0,r=e;for(;!/\n/.test(this._text[r])&&r<this._text.length;)t++,r++;return e+t}searchWordBoundary(e,t){const r=this._text;let s=e>0&&this._reSpace.test(r[e])&&(t===-1||!y1.test(r[e-1]))?e-1:e,i=r[s];for(;s>0&&s<r.length&&!iE.test(i);)s+=t,i=r[s];return t===-1&&iE.test(i)&&s++,s}selectWord(e){e=e||this.selectionStart;const t=this.searchWordBoundary(e,-1),r=Math.max(t,this.searchWordBoundary(e,1));this.selectionStart=t,this.selectionEnd=r,this._fireSelectionChanged(),this._updateTextarea(),this.renderCursorOrSelection()}selectLine(e){e=e||this.selectionStart;const t=this.findLineBoundaryLeft(e),r=this.findLineBoundaryRight(e);return this.selectionStart=t,this.selectionEnd=r,this._fireSelectionChanged(),this._updateTextarea(),this}enterEditing(e){!this.isEditing&&this.editable&&(this.canvas&&(this.canvas.calcOffset(),this.canvas.textEditingManager.exitTextEditing()),this.isEditing=!0,this.initHiddenTextarea(),this.hiddenTextarea.focus(),this.hiddenTextarea.value=this.text,this._updateTextarea(),this._saveEditingProps(),this._setEditingProps(),this._textBeforeEdit=this.text,this._tick(),this.fire("editing:entered",e?{e}:void 0),this._fireSelectionChanged(),this.canvas&&(this.canvas.fire("text:editing:entered",{target:this,e}),this.canvas.requestRenderAll()))}updateSelectionOnMouseMove(e){if(this.getActiveControl())return;const t=this.hiddenTextarea;qr(t).activeElement!==t&&t.focus();const r=this.getSelectionStartFromPointer(e),s=this.selectionStart,i=this.selectionEnd;(r===this.__selectionStartOnMouseDown&&s!==i||s!==r&&i!==r)&&(r>this.__selectionStartOnMouseDown?(this.selectionStart=this.__selectionStartOnMouseDown,this.selectionEnd=r):(this.selectionStart=r,this.selectionEnd=this.__selectionStartOnMouseDown),this.selectionStart===s&&this.selectionEnd===i||(this._fireSelectionChanged(),this._updateTextarea(),this.renderCursorOrSelection()))}_setEditingProps(){this.hoverCursor="text",this.canvas&&(this.canvas.defaultCursor=this.canvas.moveCursor="text"),this.borderColor=this.editingBorderColor,this.hasControls=this.selectable=!1,this.lockMovementX=this.lockMovementY=!0}fromStringToGraphemeSelection(e,t,r){const s=r.slice(0,e),i=this.graphemeSplit(s).length;if(e===t)return{selectionStart:i,selectionEnd:i};const o=r.slice(e,t);return{selectionStart:i,selectionEnd:i+this.graphemeSplit(o).length}}fromGraphemeToStringSelection(e,t,r){const s=r.slice(0,e).join("").length;return e===t?{selectionStart:s,selectionEnd:s}:{selectionStart:s,selectionEnd:s+r.slice(e,t).join("").length}}_updateTextarea(){if(this.cursorOffsetCache={},this.hiddenTextarea){if(!this.inCompositionMode){const e=this.fromGraphemeToStringSelection(this.selectionStart,this.selectionEnd,this._text);this.hiddenTextarea.selectionStart=e.selectionStart,this.hiddenTextarea.selectionEnd=e.selectionEnd}this.updateTextareaPosition()}}updateFromTextArea(){if(!this.hiddenTextarea)return;this.cursorOffsetCache={};const e=this.hiddenTextarea;this.text=e.value,this.set("dirty",!0),this.initDimensions(),this.setCoords();const t=this.fromStringToGraphemeSelection(e.selectionStart,e.selectionEnd,e.value);this.selectionEnd=this.selectionStart=t.selectionEnd,this.inCompositionMode||(this.selectionStart=t.selectionStart),this.updateTextareaPosition()}updateTextareaPosition(){if(this.selectionStart===this.selectionEnd){const e=this._calcTextareaPosition();this.hiddenTextarea.style.left=e.left,this.hiddenTextarea.style.top=e.top}}_calcTextareaPosition(){if(!this.canvas)return{left:"1px",top:"1px"};const e=this.inCompositionMode?this.compositionStart:this.selectionStart,t=this._getCursorBoundaries(e),r=this.get2DCursorLocation(e),s=r.lineIndex,i=r.charIndex,o=this.getValueOfPropertyAt(s,i,"fontSize")*this.lineHeight,a=t.leftOffset,l=this.getCanvasRetinaScaling(),c=this.canvas.upperCanvasEl,u=c.width/l,h=c.height/l,d=u-o,p=h-o,m=new Z(t.left+a,t.top+t.topOffset+o).transform(this.calcTransformMatrix()).transform(this.canvas.viewportTransform).multiply(new Z(c.clientWidth/u,c.clientHeight/h));return m.x<0&&(m.x=0),m.x>d&&(m.x=d),m.y<0&&(m.y=0),m.y>p&&(m.y=p),m.x+=this.canvas._offset.left,m.y+=this.canvas._offset.top,{left:"".concat(m.x,"px"),top:"".concat(m.y,"px"),fontSize:"".concat(o,"px"),charHeight:o}}_saveEditingProps(){this._savedProps={hasControls:this.hasControls,borderColor:this.borderColor,lockMovementX:this.lockMovementX,lockMovementY:this.lockMovementY,hoverCursor:this.hoverCursor,selectable:this.selectable,defaultCursor:this.canvas&&this.canvas.defaultCursor,moveCursor:this.canvas&&this.canvas.moveCursor}}_restoreEditingProps(){this._savedProps&&(this.hoverCursor=this._savedProps.hoverCursor,this.hasControls=this._savedProps.hasControls,this.borderColor=this._savedProps.borderColor,this.selectable=this._savedProps.selectable,this.lockMovementX=this._savedProps.lockMovementX,this.lockMovementY=this._savedProps.lockMovementY,this.canvas&&(this.canvas.defaultCursor=this._savedProps.defaultCursor||this.canvas.defaultCursor,this.canvas.moveCursor=this._savedProps.moveCursor||this.canvas.moveCursor),delete this._savedProps)}_exitEditing(){const e=this.hiddenTextarea;this.selected=!1,this.isEditing=!1,e&&(e.blur&&e.blur(),e.parentNode&&e.parentNode.removeChild(e)),this.hiddenTextarea=null,this.abortCursorAnimation(),this.selectionStart!==this.selectionEnd&&this.clearContextTop()}exitEditing(){const e=this._textBeforeEdit!==this.text;return this._exitEditing(),this.selectionEnd=this.selectionStart,this._restoreEditingProps(),this._forceClearCache&&(this.initDimensions(),this.setCoords()),this.fire("editing:exited"),e&&this.fire(hp),this.canvas&&(this.canvas.fire("text:editing:exited",{target:this}),e&&this.canvas.fire("object:modified",{target:this})),this}_removeExtraneousStyles(){for(const e in this.styles)this._textLines[e]||delete this.styles[e]}removeStyleFromTo(e,t){const{lineIndex:r,charIndex:s}=this.get2DCursorLocation(e,!0),{lineIndex:i,charIndex:o}=this.get2DCursorLocation(t,!0);if(r!==i){if(this.styles[r])for(let a=s;a<this._unwrappedTextLines[r].length;a++)delete this.styles[r][a];if(this.styles[i])for(let a=o;a<this._unwrappedTextLines[i].length;a++){const l=this.styles[i][a];l&&(this.styles[r]||(this.styles[r]={}),this.styles[r][s+a-o]=l)}for(let a=r+1;a<=i;a++)delete this.styles[a];this.shiftLineStyles(i,r-i)}else if(this.styles[r]){const a=this.styles[r],l=o-s;for(let c=s;c<o;c++)delete a[c];for(const c in this.styles[r]){const u=parseInt(c,10);u>=o&&(a[u-l]=a[c],delete a[c])}}}shiftLineStyles(e,t){const r=Object.assign({},this.styles);for(const s in this.styles){const i=parseInt(s,10);i>e&&(this.styles[i+t]=r[i],r[i-t]||delete this.styles[i])}}insertNewlineStyleObject(e,t,r,s){const i={},o=this._unwrappedTextLines[e].length,a=o===t;let l=!1;r||(r=1),this.shiftLineStyles(e,r);const c=this.styles[e]?this.styles[e][t===0?t:t-1]:void 0;for(const h in this.styles[e]){const d=parseInt(h,10);d>=t&&(l=!0,i[d-t]=this.styles[e][h],a&&t===0||delete this.styles[e][h])}let u=!1;for(l&&!a&&(this.styles[e+r]=i,u=!0),(u||o>t)&&r--;r>0;)s&&s[r-1]?this.styles[e+r]={0:q({},s[r-1])}:c?this.styles[e+r]={0:q({},c)}:delete this.styles[e+r],r--;this._forceClearCache=!0}insertCharStyleObject(e,t,r,s){this.styles||(this.styles={});const i=this.styles[e],o=i?q({},i):{};r||(r=1);for(const l in o){const c=parseInt(l,10);c>=t&&(i[c+r]=o[c],o[c-r]||delete i[c])}if(this._forceClearCache=!0,s){for(;r--;)Object.keys(s[r]).length&&(this.styles[e]||(this.styles[e]={}),this.styles[e][t+r]=q({},s[r]));return}if(!i)return;const a=i[t?t-1:1];for(;a&&r--;)this.styles[e][t+r]=q({},a)}insertNewStyleBlock(e,t,r){const s=this.get2DCursorLocation(t,!0),i=[0];let o,a=0;for(let l=0;l<e.length;l++)e[l]===`
`?(a++,i[a]=0):i[a]++;for(i[0]>0&&(this.insertCharStyleObject(s.lineIndex,s.charIndex,i[0],r),r=r&&r.slice(i[0]+1)),a&&this.insertNewlineStyleObject(s.lineIndex,s.charIndex+i[0],a),o=1;o<a;o++)i[o]>0?this.insertCharStyleObject(s.lineIndex+o,0,i[o],r):r&&this.styles[s.lineIndex+o]&&r[0]&&(this.styles[s.lineIndex+o][0]=r[0]),r=r&&r.slice(i[o]+1);i[o]>0&&this.insertCharStyleObject(s.lineIndex+o,0,i[o],r)}removeChars(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e+1;this.removeStyleFromTo(e,t),this._text.splice(e,t-e),this.text=this._text.join(""),this.set("dirty",!0),this.initDimensions(),this.setCoords(),this._removeExtraneousStyles()}insertChars(e,t,r){let s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:r;s>r&&this.removeStyleFromTo(r,s);const i=this.graphemeSplit(e);this.insertNewStyleBlock(i,r,t),this._text=[...this._text.slice(0,r),...i,...this._text.slice(s)],this.text=this._text.join(""),this.set("dirty",!0),this.initDimensions(),this.setCoords(),this._removeExtraneousStyles()}setSelectionStartEndWithShift(e,t,r){r<=e?(t===e?this._selectionDirection=lt:this._selectionDirection===Lt&&(this._selectionDirection=lt,this.selectionEnd=e),this.selectionStart=r):r>e&&r<t?this._selectionDirection===Lt?this.selectionEnd=r:this.selectionStart=r:(t===e?this._selectionDirection=Lt:this._selectionDirection===lt&&(this._selectionDirection=Lt,this.selectionStart=t),this.selectionEnd=r)}}class tq extends eq{initHiddenTextarea(){const e=this.canvas&&qr(this.canvas.getElement())||gc(),t=e.createElement("textarea");Object.entries({autocapitalize:"off",autocorrect:"off",autocomplete:"off",spellcheck:"false","data-fabric":"textarea",wrap:"off"}).map(o=>{let[a,l]=o;return t.setAttribute(a,l)});const{top:r,left:s,fontSize:i}=this._calcTextareaPosition();t.style.cssText="position: absolute; top: ".concat(r,"; left: ").concat(s,"; z-index: -999; opacity: 0; width: 1px; height: 1px; font-size: 1px; padding-top: ").concat(i,";"),(this.hiddenTextareaContainer||e.body).appendChild(t),Object.entries({blur:"blur",keydown:"onKeyDown",keyup:"onKeyUp",input:"onInput",copy:"copy",cut:"copy",paste:"paste",compositionstart:"onCompositionStart",compositionupdate:"onCompositionUpdate",compositionend:"onCompositionEnd"}).map(o=>{let[a,l]=o;return t.addEventListener(a,this[l].bind(this))}),this.hiddenTextarea=t}blur(){this.abortCursorAnimation()}onKeyDown(e){if(!this.isEditing)return;const t=this.direction==="rtl"?this.keysMapRtl:this.keysMap;if(e.keyCode in t)this[t[e.keyCode]](e);else{if(!(e.keyCode in this.ctrlKeysMapDown)||!e.ctrlKey&&!e.metaKey)return;this[this.ctrlKeysMapDown[e.keyCode]](e)}e.stopImmediatePropagation(),e.preventDefault(),e.keyCode>=33&&e.keyCode<=40?(this.inCompositionMode=!1,this.clearContextTop(),this.renderCursorOrSelection()):this.canvas&&this.canvas.requestRenderAll()}onKeyUp(e){!this.isEditing||this._copyDone||this.inCompositionMode?this._copyDone=!1:e.keyCode in this.ctrlKeysMapUp&&(e.ctrlKey||e.metaKey)&&(this[this.ctrlKeysMapUp[e.keyCode]](e),e.stopImmediatePropagation(),e.preventDefault(),this.canvas&&this.canvas.requestRenderAll())}onInput(e){const t=this.fromPaste;if(this.fromPaste=!1,e&&e.stopPropagation(),!this.isEditing)return;const r=()=>{this.updateFromTextArea(),this.fire(dp),this.canvas&&(this.canvas.fire("text:changed",{target:this}),this.canvas.requestRenderAll())};if(this.hiddenTextarea.value==="")return this.styles={},void r();const s=this._splitTextIntoLines(this.hiddenTextarea.value).graphemeText,i=this._text.length,o=s.length,a=this.selectionStart,l=this.selectionEnd,c=a!==l;let u,h,d,p,m=o-i;const g=this.fromStringToGraphemeSelection(this.hiddenTextarea.selectionStart,this.hiddenTextarea.selectionEnd,this.hiddenTextarea.value),y=a>g.selectionStart;c?(h=this._text.slice(a,l),m+=l-a):o<i&&(h=y?this._text.slice(l+m,l):this._text.slice(a,a-m));const x=s.slice(g.selectionEnd-m,g.selectionEnd);if(h&&h.length&&(x.length&&(u=this.getSelectionStyles(a,a+1,!1),u=x.map(()=>u[0])),c?(d=a,p=l):y?(d=l-h.length,p=l):(d=l,p=l+h.length),this.removeStyleFromTo(d,p)),x.length){const{copyPasteData:v}=xs();t&&x.join("")===v.copiedText&&!nt.disableStyleCopyPaste&&(u=v.copiedTextStyle),this.insertNewStyleBlock(x,a,u)}r()}onCompositionStart(){this.inCompositionMode=!0}onCompositionEnd(){this.inCompositionMode=!1}onCompositionUpdate(e){let{target:t}=e;const{selectionStart:r,selectionEnd:s}=t;this.compositionStart=r,this.compositionEnd=s,this.updateTextareaPosition()}copy(){if(this.selectionStart===this.selectionEnd)return;const{copyPasteData:e}=xs();e.copiedText=this.getSelectedText(),nt.disableStyleCopyPaste?e.copiedTextStyle=void 0:e.copiedTextStyle=this.getSelectionStyles(this.selectionStart,this.selectionEnd,!0),this._copyDone=!0}paste(){this.fromPaste=!0}_getWidthBeforeCursor(e,t){let r,s=this._getLineLeftOffset(e);return t>0&&(r=this.__charBounds[e][t-1],s+=r.left+r.width),s}getDownCursorOffset(e,t){const r=this._getSelectionForOffset(e,t),s=this.get2DCursorLocation(r),i=s.lineIndex;if(i===this._textLines.length-1||e.metaKey||e.keyCode===34)return this._text.length-r;const o=s.charIndex,a=this._getWidthBeforeCursor(i,o),l=this._getIndexOnLine(i+1,a);return this._textLines[i].slice(o).length+l+1+this.missingNewlineOffset(i)}_getSelectionForOffset(e,t){return e.shiftKey&&this.selectionStart!==this.selectionEnd&&t?this.selectionEnd:this.selectionStart}getUpCursorOffset(e,t){const r=this._getSelectionForOffset(e,t),s=this.get2DCursorLocation(r),i=s.lineIndex;if(i===0||e.metaKey||e.keyCode===33)return-r;const o=s.charIndex,a=this._getWidthBeforeCursor(i,o),l=this._getIndexOnLine(i-1,a),c=this._textLines[i].slice(0,o),u=this.missingNewlineOffset(i-1);return-this._textLines[i-1].length+l-c.length+(1-u)}_getIndexOnLine(e,t){const r=this._textLines[e];let s,i,o=this._getLineLeftOffset(e),a=0;for(let l=0,c=r.length;l<c;l++)if(s=this.__charBounds[e][l].width,o+=s,o>t){i=!0;const u=o-s,h=o,d=Math.abs(u-t);a=Math.abs(h-t)<d?l:l-1;break}return i||(a=r.length-1),a}moveCursorDown(e){this.selectionStart>=this._text.length&&this.selectionEnd>=this._text.length||this._moveCursorUpOrDown("Down",e)}moveCursorUp(e){this.selectionStart===0&&this.selectionEnd===0||this._moveCursorUpOrDown("Up",e)}_moveCursorUpOrDown(e,t){const r=this["get".concat(e,"CursorOffset")](t,this._selectionDirection===Lt);if(t.shiftKey?this.moveCursorWithShift(r):this.moveCursorWithoutShift(r),r!==0){const s=this.text.length;this.selectionStart=tc(0,this.selectionStart,s),this.selectionEnd=tc(0,this.selectionEnd,s),this.abortCursorAnimation(),this.initDelayedCursor(),this._fireSelectionChanged(),this._updateTextarea()}}moveCursorWithShift(e){const t=this._selectionDirection===lt?this.selectionStart+e:this.selectionEnd+e;return this.setSelectionStartEndWithShift(this.selectionStart,this.selectionEnd,t),e!==0}moveCursorWithoutShift(e){return e<0?(this.selectionStart+=e,this.selectionEnd=this.selectionStart):(this.selectionEnd+=e,this.selectionStart=this.selectionEnd),e!==0}moveCursorLeft(e){this.selectionStart===0&&this.selectionEnd===0||this._moveCursorLeftOrRight("Left",e)}_move(e,t,r){let s;if(e.altKey)s=this["findWordBoundary".concat(r)](this[t]);else{if(!e.metaKey&&e.keyCode!==35&&e.keyCode!==36)return this[t]+=r==="Left"?-1:1,!0;s=this["findLineBoundary".concat(r)](this[t])}return s!==void 0&&this[t]!==s&&(this[t]=s,!0)}_moveLeft(e,t){return this._move(e,t,"Left")}_moveRight(e,t){return this._move(e,t,"Right")}moveCursorLeftWithoutShift(e){let t=!0;return this._selectionDirection=lt,this.selectionEnd===this.selectionStart&&this.selectionStart!==0&&(t=this._moveLeft(e,"selectionStart")),this.selectionEnd=this.selectionStart,t}moveCursorLeftWithShift(e){return this._selectionDirection===Lt&&this.selectionStart!==this.selectionEnd?this._moveLeft(e,"selectionEnd"):this.selectionStart!==0?(this._selectionDirection=lt,this._moveLeft(e,"selectionStart")):void 0}moveCursorRight(e){this.selectionStart>=this._text.length&&this.selectionEnd>=this._text.length||this._moveCursorLeftOrRight("Right",e)}_moveCursorLeftOrRight(e,t){const r="moveCursor".concat(e).concat(t.shiftKey?"WithShift":"WithoutShift");this._currentCursorOpacity=1,this[r](t)&&(this.abortCursorAnimation(),this.initDelayedCursor(),this._fireSelectionChanged(),this._updateTextarea())}moveCursorRightWithShift(e){return this._selectionDirection===lt&&this.selectionStart!==this.selectionEnd?this._moveRight(e,"selectionStart"):this.selectionEnd!==this._text.length?(this._selectionDirection=Lt,this._moveRight(e,"selectionEnd")):void 0}moveCursorRightWithoutShift(e){let t=!0;return this._selectionDirection=Lt,this.selectionStart===this.selectionEnd?(t=this._moveRight(e,"selectionStart"),this.selectionEnd=this.selectionStart):this.selectionStart=this.selectionEnd,t}}const rm=n=>!!n.button;class nq extends tq{constructor(){super(...arguments),V(this,"draggableTextDelegate",void 0)}initBehavior(){this.on("mousedown",this._mouseDownHandler),this.on("mousedown:before",this._mouseDownHandlerBefore),this.on("mouseup",this.mouseUpHandler),this.on("mousedblclick",this.doubleClickHandler),this.on("tripleclick",this.tripleClickHandler),this.__lastClickTime=+new Date,this.__lastLastClickTime=+new Date,this.__lastPointer={},this.on("mousedown",this.onMouseDown),this.draggableTextDelegate=new ZG(this),super.initBehavior()}shouldStartDragging(){return this.draggableTextDelegate.isActive()}onDragStart(e){return this.draggableTextDelegate.onDragStart(e)}canDrop(e){return this.draggableTextDelegate.canDrop(e)}onMouseDown(e){if(!this.canvas)return;this.__newClickTime=+new Date;const t=e.pointer;this.isTripleClick(t)&&(this.fire("tripleclick",e),Qy(e.e)),this.__lastLastClickTime=this.__lastClickTime,this.__lastClickTime=this.__newClickTime,this.__lastPointer=t,this.__lastSelected=this.selected&&!this.getActiveControl()}isTripleClick(e){return this.__newClickTime-this.__lastClickTime<500&&this.__lastClickTime-this.__lastLastClickTime<500&&this.__lastPointer.x===e.x&&this.__lastPointer.y===e.y}doubleClickHandler(e){this.isEditing&&this.selectWord(this.getSelectionStartFromPointer(e.e))}tripleClickHandler(e){this.isEditing&&this.selectLine(this.getSelectionStartFromPointer(e.e))}_mouseDownHandler(e){let{e:t}=e;this.canvas&&this.editable&&!rm(t)&&!this.getActiveControl()&&(this.draggableTextDelegate.start(t)||(this.canvas.textEditingManager.register(this),this.selected&&(this.inCompositionMode=!1,this.setCursorByClick(t)),this.isEditing&&(this.__selectionStartOnMouseDown=this.selectionStart,this.selectionStart===this.selectionEnd&&this.abortCursorAnimation(),this.renderCursorOrSelection())))}_mouseDownHandlerBefore(e){let{e:t}=e;this.canvas&&this.editable&&!rm(t)&&(this.selected=this===this.canvas._activeObject)}mouseUpHandler(e){let{e:t,transform:r}=e;const s=this.draggableTextDelegate.end(t);if(this.canvas){this.canvas.textEditingManager.unregister(this);const i=this.canvas._activeObject;if(i&&i!==this)return}!this.editable||this.group&&!this.group.interactive||r&&r.actionPerformed||rm(t)||s||(this.__lastSelected&&!this.getActiveControl()?(this.selected=!1,this.__lastSelected=!1,this.enterEditing(t),this.selectionStart===this.selectionEnd?this.initDelayedCursor(!0):this.renderCursorOrSelection()):this.selected=!0)}setCursorByClick(e){const t=this.getSelectionStartFromPointer(e),r=this.selectionStart,s=this.selectionEnd;e.shiftKey?this.setSelectionStartEndWithShift(r,s,t):(this.selectionStart=t,this.selectionEnd=t),this.isEditing&&(this._fireSelectionChanged(),this._updateTextarea())}getSelectionStartFromPointer(e){const t=this.canvas.getScenePoint(e).transform(Xr(this.calcTransformMatrix())).add(new Z(-this._getLeftOffset(),-this._getTopOffset()));let r=0,s=0,i=0;for(let c=0;c<this._textLines.length&&r<=t.y;c++)r+=this.getHeightOfLine(c),i=c,c>0&&(s+=this._textLines[c-1].length+this.missingNewlineOffset(c-1));let o=Math.abs(this._getLineLeftOffset(i));const a=this._textLines[i].length,l=this.__charBounds[i];for(let c=0;c<a;c++){const u=o+l[c].kernedWidth;if(t.x<=u){Math.abs(t.x-u)<=Math.abs(t.x-o)&&s++;break}o=u,s++}return Math.min(this.flipX?a-s:s,this._text.length)}}const bh="moveCursorUp",_h="moveCursorDown",Sh="moveCursorLeft",Ch="moveCursorRight",Eh="exitEditing",rq=q({selectionStart:0,selectionEnd:0,selectionColor:"rgba(17,119,255,0.3)",isEditing:!1,editable:!0,editingBorderColor:"rgba(102,153,255,0.25)",cursorWidth:2,cursorColor:"",cursorDelay:1e3,cursorDuration:600,caching:!0,hiddenTextareaContainer:null,keysMap:{9:Eh,27:Eh,33:bh,34:_h,35:Ch,36:Sh,37:Sh,38:bh,39:Ch,40:_h},keysMapRtl:{9:Eh,27:Eh,33:bh,34:_h,35:Sh,36:Ch,37:Ch,38:bh,39:Sh,40:_h},ctrlKeysMapDown:{65:"selectAll"},ctrlKeysMapUp:{67:"copy",88:"cut"}},{_selectionDirection:null,_reSpace:/\s|\r?\n/,inCompositionMode:!1});class zs extends nq{static getDefaults(){return q(q({},super.getDefaults()),zs.ownDefaults)}get type(){const e=super.type;return e==="itext"?"i-text":e}constructor(e,t){super(e,q(q({},zs.ownDefaults),t)),this.initBehavior()}_set(e,t){return this.isEditing&&this._savedProps&&e in this._savedProps?(this._savedProps[e]=t,this):(e==="canvas"&&(this.canvas instanceof ol&&this.canvas.textEditingManager.remove(this),t instanceof ol&&t.textEditingManager.add(this)),super._set(e,t))}setSelectionStart(e){e=Math.max(e,0),this._updateAndFire("selectionStart",e)}setSelectionEnd(e){e=Math.min(e,this.text.length),this._updateAndFire("selectionEnd",e)}_updateAndFire(e,t){this[e]!==t&&(this._fireSelectionChanged(),this[e]=t),this._updateTextarea()}_fireSelectionChanged(){this.fire("selection:changed"),this.canvas&&this.canvas.fire("text:selection:changed",{target:this})}initDimensions(){this.isEditing&&this.initDelayedCursor(),super.initDimensions()}getSelectionStyles(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.selectionStart||0,t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.selectionEnd,r=arguments.length>2?arguments[2]:void 0;return super.getSelectionStyles(e,t,r)}setSelectionStyles(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.selectionStart||0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.selectionEnd;return super.setSelectionStyles(e,t,r)}get2DCursorLocation(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.selectionStart,t=arguments.length>1?arguments[1]:void 0;return super.get2DCursorLocation(e,t)}render(e){super.render(e),this.cursorOffsetCache={},this.renderCursorOrSelection()}toCanvasElement(e){const t=this.isEditing;this.isEditing=!1;const r=super.toCanvasElement(e);return this.isEditing=t,r}renderCursorOrSelection(){if(!this.isEditing)return;const e=this.clearContextTop(!0);if(!e)return;const t=this._getCursorBoundaries();this.selectionStart===this.selectionEnd?this.renderCursor(e,t):this.renderSelection(e,t),this.canvas.contextTopDirty=!0,e.restore()}_getCursorBoundaries(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.selectionStart,t=arguments.length>1?arguments[1]:void 0;const r=this._getLeftOffset(),s=this._getTopOffset(),i=this._getCursorBoundariesOffsets(e,t);return{left:r,top:s,leftOffset:i.left,topOffset:i.top}}_getCursorBoundariesOffsets(e,t){return t?this.__getCursorBoundariesOffsets(e):this.cursorOffsetCache&&"top"in this.cursorOffsetCache?this.cursorOffsetCache:this.cursorOffsetCache=this.__getCursorBoundariesOffsets(e)}__getCursorBoundariesOffsets(e){let t=0,r=0;const{charIndex:s,lineIndex:i}=this.get2DCursorLocation(e);for(let c=0;c<i;c++)t+=this.getHeightOfLine(c);const o=this._getLineLeftOffset(i),a=this.__charBounds[i][s];a&&(r=a.left),this.charSpacing!==0&&s===this._textLines[i].length&&(r-=this._getWidthOfCharSpacing());const l={top:t,left:o+(r>0?r:0)};return this.direction==="rtl"&&(this.textAlign===Lt||this.textAlign===ds||this.textAlign===Cu?l.left*=-1:this.textAlign===lt||this.textAlign===bp?l.left=o-(r>0?r:0):this.textAlign!==qe&&this.textAlign!==Eu||(l.left=o-(r>0?r:0))),l}renderCursorAt(e){const t=this._getCursorBoundaries(e,!0);this._renderCursor(this.canvas.contextTop,t,e)}renderCursor(e,t){this._renderCursor(e,t,this.selectionStart)}_renderCursor(e,t,r){const s=this.get2DCursorLocation(r),i=s.lineIndex,o=s.charIndex>0?s.charIndex-1:0,a=this.getValueOfPropertyAt(i,o,"fontSize"),l=this.getObjectScaling().x*this.canvas.getZoom(),c=this.cursorWidth/l,u=this.getValueOfPropertyAt(i,o,"deltaY"),h=t.topOffset+(1-this._fontSizeFraction)*this.getHeightOfLine(i)/this.lineHeight-a*(1-this._fontSizeFraction);this.inCompositionMode&&this.renderSelection(e,t),e.fillStyle=this.cursorColor||this.getValueOfPropertyAt(i,o,Gt),e.globalAlpha=this._currentCursorOpacity,e.fillRect(t.left+t.leftOffset-c/2,h+t.top+u,c,a)}renderSelection(e,t){const r={selectionStart:this.inCompositionMode?this.hiddenTextarea.selectionStart:this.selectionStart,selectionEnd:this.inCompositionMode?this.hiddenTextarea.selectionEnd:this.selectionEnd};this._renderSelection(e,r,t)}renderDragSourceEffect(){const e=this.draggableTextDelegate.getDragStartSelection();this._renderSelection(this.canvas.contextTop,e,this._getCursorBoundaries(e.selectionStart,!0))}renderDropTargetEffect(e){const t=this.getSelectionStartFromPointer(e);this.renderCursorAt(t)}_renderSelection(e,t,r){const s=t.selectionStart,i=t.selectionEnd,o=this.textAlign.includes(ds),a=this.get2DCursorLocation(s),l=this.get2DCursorLocation(i),c=a.lineIndex,u=l.lineIndex,h=a.charIndex<0?0:a.charIndex,d=l.charIndex<0?0:l.charIndex;for(let p=c;p<=u;p++){const m=this._getLineLeftOffset(p)||0;let g=this.getHeightOfLine(p),y=0,x=0,v=0;if(p===c&&(x=this.__charBounds[c][h].left),p>=c&&p<u)v=o&&!this.isEndOfWrapping(p)?this.width:this.getLineWidth(p)||5;else if(p===u)if(d===0)v=this.__charBounds[u][d].left;else{const C=this._getWidthOfCharSpacing();v=this.__charBounds[u][d-1].left+this.__charBounds[u][d-1].width-C}y=g,(this.lineHeight<1||p===u&&this.lineHeight>1)&&(g/=this.lineHeight);let w=r.left+m+x,_=g,S=0;const E=v-x;this.inCompositionMode?(e.fillStyle=this.compositionColor||"black",_=1,S=g):e.fillStyle=this.selectionColor,this.direction==="rtl"&&(this.textAlign===Lt||this.textAlign===ds||this.textAlign===Cu?w=this.width-w-E:this.textAlign===lt||this.textAlign===bp?w=r.left+m-v:this.textAlign!==qe&&this.textAlign!==Eu||(w=r.left+m-v)),e.fillRect(w,r.top+r.topOffset+S,E,_),r.topOffset+=y}}getCurrentCharFontSize(){const e=this._getCurrentCharIndex();return this.getValueOfPropertyAt(e.l,e.c,"fontSize")}getCurrentCharColor(){const e=this._getCurrentCharIndex();return this.getValueOfPropertyAt(e.l,e.c,Gt)}_getCurrentCharIndex(){const e=this.get2DCursorLocation(this.selectionStart,!0),t=e.charIndex>0?e.charIndex-1:0;return{l:e.lineIndex,c:t}}dispose(){this._exitEditing(),this.draggableTextDelegate.dispose(),super.dispose()}}V(zs,"ownDefaults",rq),V(zs,"type","IText"),me.setClass(zs),me.setClass(zs,"i-text");class Ko extends zs{static getDefaults(){return q(q({},super.getDefaults()),Ko.ownDefaults)}constructor(e,t){super(e,q(q({},Ko.ownDefaults),t))}static createControls(){return{controls:RV()}}initDimensions(){this.initialized&&(this.isEditing&&this.initDelayedCursor(),this._clearCache(),this.dynamicMinWidth=0,this._styleMap=this._generateStyleMap(this._splitText()),this.dynamicMinWidth>this.width&&this._set("width",this.dynamicMinWidth),this.textAlign.includes(ds)&&this.enlargeSpaces(),this.height=this.calcTextHeight())}_generateStyleMap(e){let t=0,r=0,s=0;const i={};for(let o=0;o<e.graphemeLines.length;o++)e.graphemeText[s]===`
`&&o>0?(r=0,s++,t++):!this.splitByGrapheme&&this._reSpaceAndTab.test(e.graphemeText[s])&&o>0&&(r++,s++),i[o]={line:t,offset:r},s+=e.graphemeLines[o].length,r+=e.graphemeLines[o].length;return i}styleHas(e,t){if(this._styleMap&&!this.isWrapping){const r=this._styleMap[t];r&&(t=r.line)}return super.styleHas(e,t)}isEmptyStyles(e){if(!this.styles)return!0;let t,r=0,s=e+1,i=!1;const o=this._styleMap[e],a=this._styleMap[e+1];o&&(e=o.line,r=o.offset),a&&(s=a.line,i=s===e,t=a.offset);const l=e===void 0?this.styles:{line:this.styles[e]};for(const c in l)for(const u in l[c]){const h=parseInt(u,10);if(h>=r&&(!i||h<t))for(const d in l[c][u])return!1}return!0}_getStyleDeclaration(e,t){if(this._styleMap&&!this.isWrapping){const r=this._styleMap[e];if(!r)return{};e=r.line,t=r.offset+t}return super._getStyleDeclaration(e,t)}_setStyleDeclaration(e,t,r){const s=this._styleMap[e];super._setStyleDeclaration(s.line,s.offset+t,r)}_deleteStyleDeclaration(e,t){const r=this._styleMap[e];super._deleteStyleDeclaration(r.line,r.offset+t)}_getLineStyle(e){const t=this._styleMap[e];return!!this.styles[t.line]}_setLineStyle(e){const t=this._styleMap[e];super._setLineStyle(t.line)}_wrapText(e,t){this.isWrapping=!0;const r=this.getGraphemeDataForRender(e),s=[];for(let i=0;i<r.wordsData.length;i++)s.push(...this._wrapLine(i,t,r));return this.isWrapping=!1,s}getGraphemeDataForRender(e){const t=this.splitByGrapheme,r=t?"":" ";let s=0;return{wordsData:e.map((i,o)=>{let a=0;const l=t?this.graphemeSplit(i):this.wordSplit(i);return l.length===0?[{word:[],width:0}]:l.map(c=>{const u=t?[c]:this.graphemeSplit(c),h=this._measureWord(u,o,a);return s=Math.max(h,s),a+=u.length+r.length,{word:u,width:h}})}),largestWordWidth:s}}_measureWord(e,t){let r,s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,i=0;for(let o=0,a=e.length;o<a;o++)i+=this._getGraphemeBox(e[o],t,o+s,r,!0).kernedWidth,r=e[o];return i}wordSplit(e){return e.split(this._wordJoiners)}_wrapLine(e,t,r){let{largestWordWidth:s,wordsData:i}=r,o=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0;const a=this._getWidthOfCharSpacing(),l=this.splitByGrapheme,c=[],u=l?"":" ";let h=0,d=[],p=0,m=0,g=!0;t-=o;const y=Math.max(t,s,this.dynamicMinWidth),x=i[e];let v;for(p=0,v=0;v<x.length;v++){const{word:w,width:_}=x[v];p+=w.length,h+=m+_-a,h>y&&!g?(c.push(d),d=[],h=_,g=!0):h+=a,g||l||d.push(u),d=d.concat(w),m=l?0:this._measureWord([u],e,p),p++,g=!1}return v&&c.push(d),s+o>this.dynamicMinWidth&&(this.dynamicMinWidth=s-a+o),c}isEndOfWrapping(e){return!this._styleMap[e+1]||this._styleMap[e+1].line!==this._styleMap[e].line}missingNewlineOffset(e,t){return this.splitByGrapheme&&!t?this.isEndOfWrapping(e)?1:0:1}_splitTextIntoLines(e){const t=super._splitTextIntoLines(e),r=this._wrapText(t.lines,this.width),s=new Array(r.length);for(let i=0;i<r.length;i++)s[i]=r[i].join("");return t.lines=s,t.graphemeLines=r,t}getMinWidth(){return Math.max(this.minWidth,this.dynamicMinWidth)}_removeExtraneousStyles(){const e=new Map;for(const t in this._styleMap){const r=parseInt(t,10);if(this._textLines[r]){const s=this._styleMap[t].line;e.set("".concat(s),!0)}}for(const t in this.styles)e.has(t)||delete this.styles[t]}toObject(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return super.toObject(["minWidth","splitByGrapheme",...e])}}V(Ko,"type","Textbox"),V(Ko,"textLayoutProperties",[...zs.textLayoutProperties,"width"]),V(Ko,"ownDefaults",{minWidth:20,dynamicMinWidth:2,lockScalingFlip:!0,noScaleCache:!1,_wordJoiners:/[ \t\r]/,splitByGrapheme:!1}),me.setClass(Ko);class oE extends D0{shouldPerformLayout(e){return!!e.target.clipPath&&super.shouldPerformLayout(e)}shouldLayoutClipPath(){return!1}calcLayoutResult(e,t){const{target:r}=e,{clipPath:s,group:i}=r;if(!s||!this.shouldPerformLayout(e))return;const{width:o,height:a}=Xs(EO(r,s)),l=new Z(o,a);if(s.absolutePositioned)return{center:El(s.getRelativeCenterPoint(),void 0,i?i.calcTransformMatrix():void 0),size:l};{const c=s.getRelativeCenterPoint().transform(r.calcOwnMatrix(),!0);if(this.shouldPerformLayout(e)){const{center:u=new Z,correction:h=new Z}=this.calcBoundingBox(t,e)||{};return{center:u.add(c),correction:h.subtract(c),size:l}}return{center:r.getRelativeCenterPoint().add(c),size:l}}}}V(oE,"type","clip-path"),me.setClass(oE);class aE extends D0{getInitialSize(e,t){let{target:r}=e,{size:s}=t;return new Z(r.width||s.x,r.height||s.y)}}V(aE,"type","fixed"),me.setClass(aE);class sq extends cd{subscribeTargets(e){const t=e.target;e.targets.reduce((r,s)=>(s.parent&&r.add(s.parent),r),new Set).forEach(r=>{r.layoutManager.subscribeTargets({target:r,targets:[t]})})}unsubscribeTargets(e){const t=e.target,r=t.getObjects();e.targets.reduce((s,i)=>(i.parent&&s.add(i.parent),s),new Set).forEach(s=>{!r.some(i=>i.parent===s)&&s.layoutManager.unsubscribeTargets({target:s,targets:[t]})})}}class Jo extends sa{static getDefaults(){return q(q({},super.getDefaults()),Jo.ownDefaults)}constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(),Object.assign(this,Jo.ownDefaults),this.setOptions(t);const{left:r,top:s,layoutManager:i}=t;this.groupInit(e,{left:r,top:s,layoutManager:i??new sq})}_shouldSetNestedCoords(){return!0}__objectSelectionMonitor(){}multiSelectAdd(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];this.multiSelectionStacking==="selection-order"?this.add(...t):t.forEach(s=>{const i=this._objects.findIndex(a=>a.isInFrontOf(s)),o=i===-1?this.size():i;this.insertAt(o,s)})}canEnterGroup(e){return this.getObjects().some(t=>t.isDescendantOf(e)||e.isDescendantOf(t))?(po("error","ActiveSelection: circular object trees are not supported, this call has no effect"),!1):super.canEnterGroup(e)}enterGroup(e,t){e.parent&&e.parent===e.group?e.parent._exitGroup(e):e.group&&e.parent!==e.group&&e.group.remove(e),this._enterGroup(e,t)}exitGroup(e,t){this._exitGroup(e,t),e.parent&&e.parent._enterGroup(e,!0)}_onAfterObjectsChange(e,t){super._onAfterObjectsChange(e,t);const r=new Set;t.forEach(s=>{const{parent:i}=s;i&&r.add(i)}),e===R1?r.forEach(s=>{s._onAfterObjectsChange(yp,t)}):r.forEach(s=>{s._set("dirty",!0)})}onDeselect(){return this.removeAll(),!1}toString(){return"#<ActiveSelection: (".concat(this.complexity(),")>")}shouldCache(){return!1}isOnACache(){return!1}_renderControls(e,t,r){e.save(),e.globalAlpha=this.isMoving?this.borderOpacityWhenMoving:1;const s=q(q({hasControls:!1},r),{},{forActiveSelection:!0});for(let i=0;i<this._objects.length;i++)this._objects[i]._renderControls(e,s);super._renderControls(e,t),e.restore()}}V(Jo,"type","ActiveSelection"),V(Jo,"ownDefaults",{multiSelectionStacking:"canvas-stacking"}),me.setClass(Jo),me.setClass(Jo,"activeSelection");class iq{constructor(){V(this,"resources",{})}applyFilters(e,t,r,s,i){const o=i.getContext("2d");if(!o)return;o.drawImage(t,0,0,r,s);const a={sourceWidth:r,sourceHeight:s,imageData:o.getImageData(0,0,r,s),originalEl:t,originalImageData:o.getImageData(0,0,r,s),canvasEl:i,ctx:o,filterBackend:this};e.forEach(c=>{c.applyTo(a)});const{imageData:l}=a;return l.width===r&&l.height===s||(i.width=l.width,i.height=l.height),o.putImageData(l,0,0),a}}class VO{constructor(){let{tileSize:e=nt.textureSize}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};V(this,"aPosition",new Float32Array([0,0,0,1,1,0,1,1])),V(this,"resources",{}),this.tileSize=e,this.setupGLContext(e,e),this.captureGPUInfo()}setupGLContext(e,t){this.dispose(),this.createWebGLCanvas(e,t)}createWebGLCanvas(e,t){const r=Zt();r.width=e,r.height=t;const s=r.getContext("webgl",{alpha:!0,premultipliedAlpha:!1,depth:!1,stencil:!1,antialias:!1});s&&(s.clearColor(0,0,0,0),this.canvas=r,this.gl=s)}applyFilters(e,t,r,s,i,o){const a=this.gl,l=i.getContext("2d");if(!a||!l)return;let c;o&&(c=this.getCachedTexture(o,t));const u={originalWidth:t.width||t.originalWidth||0,originalHeight:t.height||t.originalHeight||0,sourceWidth:r,sourceHeight:s,destinationWidth:r,destinationHeight:s,context:a,sourceTexture:this.createTexture(a,r,s,c?void 0:t),targetTexture:this.createTexture(a,r,s),originalTexture:c||this.createTexture(a,r,s,c?void 0:t),passes:e.length,webgl:!0,aPosition:this.aPosition,programCache:this.programCache,pass:0,filterBackend:this,targetCanvas:i},h=a.createFramebuffer();return a.bindFramebuffer(a.FRAMEBUFFER,h),e.forEach(d=>{d&&d.applyTo(u)}),function(d){const p=d.targetCanvas,m=p.width,g=p.height,y=d.destinationWidth,x=d.destinationHeight;m===y&&g===x||(p.width=y,p.height=x)}(u),this.copyGLTo2D(a,u),a.bindTexture(a.TEXTURE_2D,null),a.deleteTexture(u.sourceTexture),a.deleteTexture(u.targetTexture),a.deleteFramebuffer(h),l.setTransform(1,0,0,1,0,0),u}dispose(){this.canvas&&(this.canvas=null,this.gl=null),this.clearWebGLCaches()}clearWebGLCaches(){this.programCache={},this.textureCache={}}createTexture(e,t,r,s,i){const{NEAREST:o,TEXTURE_2D:a,RGBA:l,UNSIGNED_BYTE:c,CLAMP_TO_EDGE:u,TEXTURE_MAG_FILTER:h,TEXTURE_MIN_FILTER:d,TEXTURE_WRAP_S:p,TEXTURE_WRAP_T:m}=e,g=e.createTexture();return e.bindTexture(a,g),e.texParameteri(a,h,i||o),e.texParameteri(a,d,i||o),e.texParameteri(a,p,u),e.texParameteri(a,m,u),s?e.texImage2D(a,0,l,l,c,s):e.texImage2D(a,0,l,t,r,0,l,c,null),g}getCachedTexture(e,t,r){const{textureCache:s}=this;if(s[e])return s[e];{const i=this.createTexture(this.gl,t.width,t.height,t,r);return i&&(s[e]=i),i}}evictCachesForKey(e){this.textureCache[e]&&(this.gl.deleteTexture(this.textureCache[e]),delete this.textureCache[e])}copyGLTo2D(e,t){const r=e.canvas,s=t.targetCanvas,i=s.getContext("2d");if(!i)return;i.translate(0,s.height),i.scale(1,-1);const o=r.height-s.height;i.drawImage(r,0,o,s.width,s.height,0,0,s.width,s.height)}copyGLTo2DPutImageData(e,t){const r=t.targetCanvas.getContext("2d"),s=t.destinationWidth,i=t.destinationHeight,o=s*i*4;if(!r)return;const a=new Uint8Array(this.imageBuffer,0,o),l=new Uint8ClampedArray(this.imageBuffer,0,o);e.readPixels(0,0,s,i,e.RGBA,e.UNSIGNED_BYTE,a);const c=new ImageData(l,s,i);r.putImageData(c,0,0)}captureGPUInfo(){if(this.gpuInfo)return this.gpuInfo;const e=this.gl,t={renderer:"",vendor:""};if(!e)return t;const r=e.getExtension("WEBGL_debug_renderer_info");if(r){const s=e.getParameter(r.UNMASKED_RENDERER_WEBGL),i=e.getParameter(r.UNMASKED_VENDOR_WEBGL);s&&(t.renderer=s.toLowerCase()),i&&(t.vendor=i.toLowerCase())}return this.gpuInfo=t,t}}let sm;function oq(){const{WebGLProbe:n}=xs();return n.queryWebGL(Zt()),nt.enableGLFiltering&&n.isSupported(nt.textureSize)?new VO({tileSize:nt.textureSize}):new iq}function im(){return!sm&&(!(arguments.length>0&&arguments[0]!==void 0)||arguments[0])&&(sm=oq()),sm}const aq=["filters","resizeFilter","src","crossOrigin","type"],GO=["cropX","cropY"];class Hn extends En{static getDefaults(){return q(q({},super.getDefaults()),Hn.ownDefaults)}constructor(e,t){super(),V(this,"_lastScaleX",1),V(this,"_lastScaleY",1),V(this,"_filterScalingX",1),V(this,"_filterScalingY",1),this.filters=[],Object.assign(this,Hn.ownDefaults),this.setOptions(t),this.cacheKey="texture".concat(go()),this.setElement(typeof e=="string"?(this.canvas&&qr(this.canvas.getElement())||gc()).getElementById(e):e,t)}getElement(){return this._element}setElement(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.removeTexture(this.cacheKey),this.removeTexture("".concat(this.cacheKey,"_filtered")),this._element=e,this._originalElement=e,this._setWidthHeight(t),e.classList.add(Hn.CSS_CANVAS),this.filters.length!==0&&this.applyFilters(),this.resizeFilter&&this.applyResizeFilters()}removeTexture(e){const t=im(!1);t instanceof VO&&t.evictCachesForKey(e)}dispose(){super.dispose(),this.removeTexture(this.cacheKey),this.removeTexture("".concat(this.cacheKey,"_filtered")),this._cacheContext=null,["_originalElement","_element","_filteredEl","_cacheCanvas"].forEach(e=>{const t=this[e];t&&xs().dispose(t),this[e]=void 0})}getCrossOrigin(){return this._originalElement&&(this._originalElement.crossOrigin||null)}getOriginalSize(){const e=this.getElement();return e?{width:e.naturalWidth||e.width,height:e.naturalHeight||e.height}:{width:0,height:0}}_stroke(e){if(!this.stroke||this.strokeWidth===0)return;const t=this.width/2,r=this.height/2;e.beginPath(),e.moveTo(-t,-r),e.lineTo(t,-r),e.lineTo(t,r),e.lineTo(-t,r),e.lineTo(-t,-r),e.closePath()}toObject(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];const t=[];return this.filters.forEach(r=>{r&&t.push(r.toObject())}),q(q({},super.toObject([...GO,...e])),{},{src:this.getSrc(),crossOrigin:this.getCrossOrigin(),filters:t},this.resizeFilter?{resizeFilter:this.resizeFilter.toObject()}:{})}hasCrop(){return!!this.cropX||!!this.cropY||this.width<this._element.width||this.height<this._element.height}_toSVG(){const e=[],t=this._element,r=-this.width/2,s=-this.height/2;let i=[],o=[],a="",l="";if(!t)return[];if(this.hasCrop()){const c=go();i.push('<clipPath id="imageCrop_'+c+`">
`,'	<rect x="'+r+'" y="'+s+'" width="'+this.width+'" height="'+this.height+`" />
`,`</clipPath>
`),a=' clip-path="url(#imageCrop_'+c+')" '}if(this.imageSmoothing||(l=' image-rendering="optimizeSpeed"'),e.push("	<image ","COMMON_PARTS",'xlink:href="'.concat(this.getSvgSrc(!0),'" x="').concat(r-this.cropX,'" y="').concat(s-this.cropY,'" width="').concat(t.width||t.naturalWidth,'" height="').concat(t.height||t.naturalHeight,'"').concat(l).concat(a,`></image>
`)),this.stroke||this.strokeDashArray){const c=this.fill;this.fill=null,o=['	<rect x="'.concat(r,'" y="').concat(s,'" width="').concat(this.width,'" height="').concat(this.height,'" style="').concat(this.getSvgStyles(),`" />
`)],this.fill=c}return i=this.paintFirst!==Gt?i.concat(o,e):i.concat(e,o),i}getSrc(e){const t=e?this._element:this._originalElement;return t?t.toDataURL?t.toDataURL():this.srcFromAttribute?t.getAttribute("src")||"":t.src:this.src||""}getSvgSrc(e){return this.getSrc(e)}setSrc(e){let{crossOrigin:t,signal:r}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return xf(e,{crossOrigin:t,signal:r}).then(s=>{t!==void 0&&this.set({crossOrigin:t}),this.setElement(s)})}toString(){return'#<Image: { src: "'.concat(this.getSrc(),'" }>')}applyResizeFilters(){const e=this.resizeFilter,t=this.minimumScaleTrigger,r=this.getTotalObjectScaling(),s=r.x,i=r.y,o=this._filteredEl||this._originalElement;if(this.group&&this.set("dirty",!0),!e||s>t&&i>t)return this._element=o,this._filterScalingX=1,this._filterScalingY=1,this._lastScaleX=s,void(this._lastScaleY=i);const a=Zt(),l=o.width,c=o.height;a.width=l,a.height=c,this._element=a,this._lastScaleX=e.scaleX=s,this._lastScaleY=e.scaleY=i,im().applyFilters([e],o,l,c,this._element),this._filterScalingX=a.width/this._originalElement.width,this._filterScalingY=a.height/this._originalElement.height}applyFilters(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.filters||[];if(e=e.filter(i=>i&&!i.isNeutralState()),this.set("dirty",!0),this.removeTexture("".concat(this.cacheKey,"_filtered")),e.length===0)return this._element=this._originalElement,this._filteredEl=void 0,this._filterScalingX=1,void(this._filterScalingY=1);const t=this._originalElement,r=t.naturalWidth||t.width,s=t.naturalHeight||t.height;if(this._element===this._originalElement){const i=Zt();i.width=r,i.height=s,this._element=i,this._filteredEl=i}else this._filteredEl&&(this._element=this._filteredEl,this._filteredEl.getContext("2d").clearRect(0,0,r,s),this._lastScaleX=1,this._lastScaleY=1);im().applyFilters(e,this._originalElement,r,s,this._element),this._originalElement.width===this._element.width&&this._originalElement.height===this._element.height||(this._filterScalingX=this._element.width/this._originalElement.width,this._filterScalingY=this._element.height/this._originalElement.height)}_render(e){e.imageSmoothingEnabled=this.imageSmoothing,this.isMoving!==!0&&this.resizeFilter&&this._needsResize()&&this.applyResizeFilters(),this._stroke(e),this._renderPaintInOrder(e)}drawCacheOnCanvas(e){e.imageSmoothingEnabled=this.imageSmoothing,super.drawCacheOnCanvas(e)}shouldCache(){return this.needsItsOwnCache()}_renderFill(e){const t=this._element;if(!t)return;const r=this._filterScalingX,s=this._filterScalingY,i=this.width,o=this.height,a=Math.max(this.cropX,0),l=Math.max(this.cropY,0),c=t.naturalWidth||t.width,u=t.naturalHeight||t.height,h=a*r,d=l*s,p=Math.min(i*r,c-h),m=Math.min(o*s,u-d),g=-i/2,y=-o/2,x=Math.min(i,c/r-a),v=Math.min(o,u/s-l);t&&e.drawImage(t,h,d,p,m,g,y,x,v)}_needsResize(){const e=this.getTotalObjectScaling();return e.x!==this._lastScaleX||e.y!==this._lastScaleY}_resetWidthHeight(){this.set(this.getOriginalSize())}_setWidthHeight(){let{width:e,height:t}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const r=this.getOriginalSize();this.width=e||r.width,this.height=t||r.height}parsePreserveAspectRatioAttribute(){const e=WH(this.preserveAspectRatio||""),t=this.width,r=this.height,s={width:t,height:r};let i,o=this._element.width,a=this._element.height,l=1,c=1,u=0,h=0,d=0,p=0;return!e||e.alignX===Zn&&e.alignY===Zn?(l=t/o,c=r/a):(e.meetOrSlice==="meet"&&(l=c=hG(this._element,s),i=(t-o*l)/2,e.alignX==="Min"&&(u=-i),e.alignX==="Max"&&(u=i),i=(r-a*c)/2,e.alignY==="Min"&&(h=-i),e.alignY==="Max"&&(h=i)),e.meetOrSlice==="slice"&&(l=c=fG(this._element,s),i=o-t/l,e.alignX==="Mid"&&(d=i/2),e.alignX==="Max"&&(d=i),i=a-r/c,e.alignY==="Mid"&&(p=i/2),e.alignY==="Max"&&(p=i),o=t/l,a=r/c)),{width:o,height:a,scaleX:l,scaleY:c,offsetLeft:u,offsetTop:h,cropX:d,cropY:p}}static fromObject(e,t){let{filters:r,resizeFilter:s,src:i,crossOrigin:o,type:a}=e,l=Ct(e,aq);return Promise.all([xf(i,q(q({},t),{},{crossOrigin:o})),r&&od(r,t),s&&od([s],t),k0(l,t)]).then(c=>{let[u,h=[],[d]=[],p={}]=c;return new this(u,q(q({},l),{},{src:i,filters:h,resizeFilter:d},p))})}static fromURL(e){let{crossOrigin:t=null,signal:r}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},s=arguments.length>2?arguments[2]:void 0;return xf(e,{crossOrigin:t,signal:r}).then(i=>new this(i,s))}static async fromElement(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=arguments.length>2?arguments[2]:void 0;const s=fi(e,this.ATTRIBUTE_NAMES,r);return this.fromURL(s["xlink:href"],t,s).catch(i=>(po("log","Unable to parse Image",i),null))}}V(Hn,"type","Image"),V(Hn,"cacheProperties",[...hi,...GO]),V(Hn,"ownDefaults",{strokeWidth:0,srcFromAttribute:!1,minimumScaleTrigger:.5,cropX:0,cropY:0,imageSmoothing:!0}),V(Hn,"CSS_CANVAS","canvas-img"),V(Hn,"ATTRIBUTE_NAMES",[...Eo,"x","y","width","height","preserveAspectRatio","xlink:href","crossOrigin","image-rendering"]),me.setClass(Hn),me.setSVGClass(Hn);T0(["pattern","defs","symbol","metadata","clipPath","mask","desc"]);const I0=n=>n.webgl!==void 0,N1="precision highp float",lq=`
    `.concat(N1,`;
    varying vec2 vTexCoord;
    uniform sampler2D uTexture;
    void main() {
      gl_FragColor = texture2D(uTexture, vTexCoord);
    }`),cq=["type"],uq=["type"],dq=new RegExp(N1,"g");class en{get type(){return this.constructor.type}constructor(){let e=Ct(arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},cq);Object.assign(this,this.constructor.defaults,e)}getFragmentSource(){return lq}getVertexSource(){return`
    attribute vec2 aPosition;
    varying vec2 vTexCoord;
    void main() {
      vTexCoord = aPosition;
      gl_Position = vec4(aPosition * 2.0 - 1.0, 0.0, 1.0);
    }`}createProgram(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.getFragmentSource(),r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.getVertexSource();const{WebGLProbe:{GLPrecision:s="highp"}}=xs();s!=="highp"&&(t=t.replace(dq,N1.replace("highp",s)));const i=e.createShader(e.VERTEX_SHADER),o=e.createShader(e.FRAGMENT_SHADER),a=e.createProgram();if(!i||!o||!a)throw new fs("Vertex, fragment shader or program creation error");if(e.shaderSource(i,r),e.compileShader(i),!e.getShaderParameter(i,e.COMPILE_STATUS))throw new fs("Vertex shader compile error for ".concat(this.type,": ").concat(e.getShaderInfoLog(i)));if(e.shaderSource(o,t),e.compileShader(o),!e.getShaderParameter(o,e.COMPILE_STATUS))throw new fs("Fragment shader compile error for ".concat(this.type,": ").concat(e.getShaderInfoLog(o)));if(e.attachShader(a,i),e.attachShader(a,o),e.linkProgram(a),!e.getProgramParameter(a,e.LINK_STATUS))throw new fs('Shader link error for "'.concat(this.type,'" ').concat(e.getProgramInfoLog(a)));const l=this.getUniformLocations(e,a)||{};return l.uStepW=e.getUniformLocation(a,"uStepW"),l.uStepH=e.getUniformLocation(a,"uStepH"),{program:a,attributeLocations:this.getAttributeLocations(e,a),uniformLocations:l}}getAttributeLocations(e,t){return{aPosition:e.getAttribLocation(t,"aPosition")}}getUniformLocations(e,t){const r=this.constructor.uniformLocations,s={};for(let i=0;i<r.length;i++)s[r[i]]=e.getUniformLocation(t,r[i]);return s}sendAttributeData(e,t,r){const s=t.aPosition,i=e.createBuffer();e.bindBuffer(e.ARRAY_BUFFER,i),e.enableVertexAttribArray(s),e.vertexAttribPointer(s,2,e.FLOAT,!1,0,0),e.bufferData(e.ARRAY_BUFFER,r,e.STATIC_DRAW)}_setupFrameBuffer(e){const t=e.context;if(e.passes>1){const r=e.destinationWidth,s=e.destinationHeight;e.sourceWidth===r&&e.sourceHeight===s||(t.deleteTexture(e.targetTexture),e.targetTexture=e.filterBackend.createTexture(t,r,s)),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,e.targetTexture,0)}else t.bindFramebuffer(t.FRAMEBUFFER,null),t.finish()}_swapTextures(e){e.passes--,e.pass++;const t=e.targetTexture;e.targetTexture=e.sourceTexture,e.sourceTexture=t}isNeutralState(e){return!1}applyTo(e){I0(e)?(this._setupFrameBuffer(e),this.applyToWebGL(e),this._swapTextures(e)):this.applyTo2d(e)}applyTo2d(e){}getCacheKey(){return this.type}retrieveShader(e){const t=this.getCacheKey();return e.programCache[t]||(e.programCache[t]=this.createProgram(e.context)),e.programCache[t]}applyToWebGL(e){const t=e.context,r=this.retrieveShader(e);e.pass===0&&e.originalTexture?t.bindTexture(t.TEXTURE_2D,e.originalTexture):t.bindTexture(t.TEXTURE_2D,e.sourceTexture),t.useProgram(r.program),this.sendAttributeData(t,r.attributeLocations,e.aPosition),t.uniform1f(r.uniformLocations.uStepW,1/e.sourceWidth),t.uniform1f(r.uniformLocations.uStepH,1/e.sourceHeight),this.sendUniformData(t,r.uniformLocations),t.viewport(0,0,e.destinationWidth,e.destinationHeight),t.drawArrays(t.TRIANGLE_STRIP,0,4)}bindAdditionalTexture(e,t,r){e.activeTexture(r),e.bindTexture(e.TEXTURE_2D,t),e.activeTexture(e.TEXTURE0)}unbindAdditionalTexture(e,t){e.activeTexture(t),e.bindTexture(e.TEXTURE_2D,null),e.activeTexture(e.TEXTURE0)}sendUniformData(e,t){}createHelpLayer(e){if(!e.helpLayer){const t=Zt();t.width=e.sourceWidth,t.height=e.sourceHeight,e.helpLayer=t}}toObject(){const e=Object.keys(this.constructor.defaults||{});return q({type:this.type},e.reduce((t,r)=>(t[r]=this[r],t),{}))}toJSON(){return this.toObject()}static async fromObject(e,t){return new this(Ct(e,uq))}}V(en,"type","BaseFilter"),V(en,"uniformLocations",[]);const hq={multiply:`gl_FragColor.rgb *= uColor.rgb;
`,screen:`gl_FragColor.rgb = 1.0 - (1.0 - gl_FragColor.rgb) * (1.0 - uColor.rgb);
`,add:`gl_FragColor.rgb += uColor.rgb;
`,difference:`gl_FragColor.rgb = abs(gl_FragColor.rgb - uColor.rgb);
`,subtract:`gl_FragColor.rgb -= uColor.rgb;
`,lighten:`gl_FragColor.rgb = max(gl_FragColor.rgb, uColor.rgb);
`,darken:`gl_FragColor.rgb = min(gl_FragColor.rgb, uColor.rgb);
`,exclusion:`gl_FragColor.rgb += uColor.rgb - 2.0 * (uColor.rgb * gl_FragColor.rgb);
`,overlay:`
    if (uColor.r < 0.5) {
      gl_FragColor.r *= 2.0 * uColor.r;
    } else {
      gl_FragColor.r = 1.0 - 2.0 * (1.0 - gl_FragColor.r) * (1.0 - uColor.r);
    }
    if (uColor.g < 0.5) {
      gl_FragColor.g *= 2.0 * uColor.g;
    } else {
      gl_FragColor.g = 1.0 - 2.0 * (1.0 - gl_FragColor.g) * (1.0 - uColor.g);
    }
    if (uColor.b < 0.5) {
      gl_FragColor.b *= 2.0 * uColor.b;
    } else {
      gl_FragColor.b = 1.0 - 2.0 * (1.0 - gl_FragColor.b) * (1.0 - uColor.b);
    }
    `,tint:`
    gl_FragColor.rgb *= (1.0 - uColor.a);
    gl_FragColor.rgb += uColor.rgb;
    `};class kh extends en{getCacheKey(){return"".concat(this.type,"_").concat(this.mode)}getFragmentSource(){return`
      precision highp float;
      uniform sampler2D uTexture;
      uniform vec4 uColor;
      varying vec2 vTexCoord;
      void main() {
        vec4 color = texture2D(uTexture, vTexCoord);
        gl_FragColor = color;
        if (color.a > 0.0) {
          `.concat(hq[this.mode],`
        }
      }
      `)}applyTo2d(e){let{imageData:{data:t}}=e;const r=new dt(this.color).getSource(),s=r[0]*this.alpha,i=r[1]*this.alpha,o=r[2]*this.alpha,a=1-this.alpha;for(let l=0;l<t.length;l+=4){const c=t[l],u=t[l+1],h=t[l+2];switch(this.mode){case"multiply":t[l]=c*s/255,t[l+1]=u*i/255,t[l+2]=h*o/255;break;case"screen":t[l]=255-(255-c)*(255-s)/255,t[l+1]=255-(255-u)*(255-i)/255,t[l+2]=255-(255-h)*(255-o)/255;break;case"add":t[l]=c+s,t[l+1]=u+i,t[l+2]=h+o;break;case"difference":t[l]=Math.abs(c-s),t[l+1]=Math.abs(u-i),t[l+2]=Math.abs(h-o);break;case"subtract":t[l]=c-s,t[l+1]=u-i,t[l+2]=h-o;break;case"darken":t[l]=Math.min(c,s),t[l+1]=Math.min(u,i),t[l+2]=Math.min(h,o);break;case"lighten":t[l]=Math.max(c,s),t[l+1]=Math.max(u,i),t[l+2]=Math.max(h,o);break;case"overlay":t[l]=s<128?2*c*s/255:255-2*(255-c)*(255-s)/255,t[l+1]=i<128?2*u*i/255:255-2*(255-u)*(255-i)/255,t[l+2]=o<128?2*h*o/255:255-2*(255-h)*(255-o)/255;break;case"exclusion":t[l]=s+c-2*s*c/255,t[l+1]=i+u-2*i*u/255,t[l+2]=o+h-2*o*h/255;break;case"tint":t[l]=s+c*a,t[l+1]=i+u*a,t[l+2]=o+h*a}}}sendUniformData(e,t){const r=new dt(this.color).getSource();r[0]=this.alpha*r[0]/255,r[1]=this.alpha*r[1]/255,r[2]=this.alpha*r[2]/255,r[3]=this.alpha,e.uniform4fv(t.uColor,r)}}V(kh,"defaults",{color:"#F95C63",mode:"multiply",alpha:1}),V(kh,"type","BlendColor"),V(kh,"uniformLocations",["uColor"]),me.setClass(kh);const fq={multiply:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform sampler2D uImage;
    uniform vec4 uColor;
    varying vec2 vTexCoord;
    varying vec2 vTexCoord2;
    void main() {
      vec4 color = texture2D(uTexture, vTexCoord);
      vec4 color2 = texture2D(uImage, vTexCoord2);
      color.rgba *= color2.rgba;
      gl_FragColor = color;
    }
    `,mask:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform sampler2D uImage;
    uniform vec4 uColor;
    varying vec2 vTexCoord;
    varying vec2 vTexCoord2;
    void main() {
      vec4 color = texture2D(uTexture, vTexCoord);
      vec4 color2 = texture2D(uImage, vTexCoord2);
      color.a = color2.a;
      gl_FragColor = color;
    }
    `},pq=["type","image"];class Ph extends en{getCacheKey(){return"".concat(this.type,"_").concat(this.mode)}getFragmentSource(){return fq[this.mode]}getVertexSource(){return`
    attribute vec2 aPosition;
    varying vec2 vTexCoord;
    varying vec2 vTexCoord2;
    uniform mat3 uTransformMatrix;
    void main() {
      vTexCoord = aPosition;
      vTexCoord2 = (uTransformMatrix * vec3(aPosition, 1.0)).xy;
      gl_Position = vec4(aPosition * 2.0 - 1.0, 0.0, 1.0);
    }
    `}applyToWebGL(e){const t=e.context,r=this.createTexture(e.filterBackend,this.image);this.bindAdditionalTexture(t,r,t.TEXTURE1),super.applyToWebGL(e),this.unbindAdditionalTexture(t,t.TEXTURE1)}createTexture(e,t){return e.getCachedTexture(t.cacheKey,t.getElement())}calculateMatrix(){const e=this.image,{width:t,height:r}=e.getElement();return[1/e.scaleX,0,0,0,1/e.scaleY,0,-e.left/t,-e.top/r,1]}applyTo2d(e){let{imageData:{data:t,width:r,height:s},filterBackend:{resources:i}}=e;const o=this.image;i.blendImage||(i.blendImage=Zt());const a=i.blendImage,l=a.getContext("2d");a.width!==r||a.height!==s?(a.width=r,a.height=s):l.clearRect(0,0,r,s),l.setTransform(o.scaleX,0,0,o.scaleY,o.left,o.top),l.drawImage(o.getElement(),0,0,r,s);const c=l.getImageData(0,0,r,s).data;for(let u=0;u<t.length;u+=4){const h=t[u],d=t[u+1],p=t[u+2],m=t[u+3],g=c[u],y=c[u+1],x=c[u+2],v=c[u+3];switch(this.mode){case"multiply":t[u]=h*g/255,t[u+1]=d*y/255,t[u+2]=p*x/255,t[u+3]=m*v/255;break;case"mask":t[u+3]=v}}}sendUniformData(e,t){const r=this.calculateMatrix();e.uniform1i(t.uImage,1),e.uniformMatrix3fv(t.uTransformMatrix,!1,r)}toObject(){return q(q({},super.toObject()),{},{image:this.image&&this.image.toObject()})}static async fromObject(e,t){let{type:r,image:s}=e,i=Ct(e,pq);return Hn.fromObject(s,t).then(o=>new this(q(q({},i),{},{image:o})))}}V(Ph,"type","BlendImage"),V(Ph,"defaults",{mode:"multiply",alpha:1}),V(Ph,"uniformLocations",["uTransformMatrix","uImage"]),me.setClass(Ph);class Th extends en{getFragmentSource(){return`
    precision highp float;
    uniform sampler2D uTexture;
    uniform vec2 uDelta;
    varying vec2 vTexCoord;
    const float nSamples = 15.0;
    vec3 v3offset = vec3(12.9898, 78.233, 151.7182);
    float random(vec3 scale) {
      /* use the fragment position for a different seed per-pixel */
      return fract(sin(dot(gl_FragCoord.xyz, scale)) * 43758.5453);
    }
    void main() {
      vec4 color = vec4(0.0);
      float total = 0.0;
      float offset = random(v3offset);
      for (float t = -nSamples; t <= nSamples; t++) {
        float percent = (t + offset - 0.5) / nSamples;
        float weight = 1.0 - abs(percent);
        color += texture2D(uTexture, vTexCoord + uDelta * percent) * weight;
        total += weight;
      }
      gl_FragColor = color / total;
    }
  `}applyTo(e){I0(e)?(this.aspectRatio=e.sourceWidth/e.sourceHeight,e.passes++,this._setupFrameBuffer(e),this.horizontal=!0,this.applyToWebGL(e),this._swapTextures(e),this._setupFrameBuffer(e),this.horizontal=!1,this.applyToWebGL(e),this._swapTextures(e)):this.applyTo2d(e)}applyTo2d(e){e.imageData=this.simpleBlur(e)}simpleBlur(e){let{ctx:t,imageData:r,filterBackend:{resources:s}}=e;const{width:i,height:o}=r;s.blurLayer1||(s.blurLayer1=Zt(),s.blurLayer2=Zt());const a=s.blurLayer1,l=s.blurLayer2;a.width===i&&a.height===o||(l.width=a.width=i,l.height=a.height=o);const c=a.getContext("2d"),u=l.getContext("2d"),h=15,d=.06*this.blur*.5;let p,m,g,y;for(c.putImageData(r,0,0),u.clearRect(0,0,i,o),y=-15;y<=h;y++)p=(Math.random()-.5)/4,m=y/h,g=d*m*i+p,u.globalAlpha=1-Math.abs(m),u.drawImage(a,g,p),c.drawImage(l,0,0),u.globalAlpha=1,u.clearRect(0,0,l.width,l.height);for(y=-15;y<=h;y++)p=(Math.random()-.5)/4,m=y/h,g=d*m*o+p,u.globalAlpha=1-Math.abs(m),u.drawImage(a,p,g),c.drawImage(l,0,0),u.globalAlpha=1,u.clearRect(0,0,l.width,l.height);t.drawImage(a,0,0);const x=t.getImageData(0,0,a.width,a.height);return c.globalAlpha=1,c.clearRect(0,0,a.width,a.height),x}sendUniformData(e,t){const r=this.chooseRightDelta();e.uniform2fv(t.uDelta,r)}isNeutralState(){return this.blur===0}chooseRightDelta(){let e=1;const t=[0,0];this.horizontal?this.aspectRatio>1&&(e=1/this.aspectRatio):this.aspectRatio<1&&(e=this.aspectRatio);const r=e*this.blur*.12;return this.horizontal?t[0]=r:t[1]=r,t}}V(Th,"type","Blur"),V(Th,"defaults",{blur:0}),V(Th,"uniformLocations",["uDelta"]),me.setClass(Th);class Ah extends en{getFragmentSource(){return`
  precision highp float;
  uniform sampler2D uTexture;
  uniform float uBrightness;
  varying vec2 vTexCoord;
  void main() {
    vec4 color = texture2D(uTexture, vTexCoord);
    color.rgb += uBrightness;
    gl_FragColor = color;
  }
`}applyTo2d(e){let{imageData:{data:t}}=e;const r=Math.round(255*this.brightness);for(let s=0;s<t.length;s+=4)t[s]=t[s]+r,t[s+1]=t[s+1]+r,t[s+2]=t[s+2]+r}isNeutralState(){return this.brightness===0}sendUniformData(e,t){e.uniform1f(t.uBrightness,this.brightness)}}V(Ah,"type","Brightness"),V(Ah,"defaults",{brightness:0}),V(Ah,"uniformLocations",["uBrightness"]),me.setClass(Ah);class ll extends en{getFragmentSource(){return`
  precision highp float;
  uniform sampler2D uTexture;
  varying vec2 vTexCoord;
  uniform mat4 uColorMatrix;
  uniform vec4 uConstants;
  void main() {
    vec4 color = texture2D(uTexture, vTexCoord);
    color *= uColorMatrix;
    color += uConstants;
    gl_FragColor = color;
  }`}applyTo2d(e){const t=e.imageData.data,r=this.matrix,s=this.colorsOnly;for(let i=0;i<t.length;i+=4){const o=t[i],a=t[i+1],l=t[i+2];if(s)t[i]=o*r[0]+a*r[1]+l*r[2]+255*r[4],t[i+1]=o*r[5]+a*r[6]+l*r[7]+255*r[9],t[i+2]=o*r[10]+a*r[11]+l*r[12]+255*r[14];else{const c=t[i+3];t[i]=o*r[0]+a*r[1]+l*r[2]+c*r[3]+255*r[4],t[i+1]=o*r[5]+a*r[6]+l*r[7]+c*r[8]+255*r[9],t[i+2]=o*r[10]+a*r[11]+l*r[12]+c*r[13]+255*r[14],t[i+3]=o*r[15]+a*r[16]+l*r[17]+c*r[18]+255*r[19]}}}sendUniformData(e,t){const r=this.matrix,s=[r[0],r[1],r[2],r[3],r[5],r[6],r[7],r[8],r[10],r[11],r[12],r[13],r[15],r[16],r[17],r[18]],i=[r[4],r[9],r[14],r[19]];e.uniformMatrix4fv(t.uColorMatrix,!1,s),e.uniform4fv(t.uConstants,i)}toObject(){return q(q({},super.toObject()),{},{matrix:[...this.matrix]})}}function ka(n,e){var t;const r=(V(t=class extends ll{toObject(){return{type:this.type,colorsOnly:this.colorsOnly}}},"type",n),V(t,"defaults",{colorsOnly:!1,matrix:e}),t);return me.setClass(r,n),r}V(ll,"type","ColorMatrix"),V(ll,"defaults",{matrix:[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0],colorsOnly:!0}),V(ll,"uniformLocations",["uColorMatrix","uConstants"]),me.setClass(ll);ka("Brownie",[.5997,.34553,-.27082,0,.186,-.0377,.86095,.15059,0,-.1449,.24113,-.07441,.44972,0,-.02965,0,0,0,1,0]);ka("Vintage",[.62793,.32021,-.03965,0,.03784,.02578,.64411,.03259,0,.02926,.0466,-.08512,.52416,0,.02023,0,0,0,1,0]);ka("Kodachrome",[1.12855,-.39673,-.03992,0,.24991,-.16404,1.08352,-.05498,0,.09698,-.16786,-.56034,1.60148,0,.13972,0,0,0,1,0]);ka("Technicolor",[1.91252,-.85453,-.09155,0,.04624,-.30878,1.76589,-.10601,0,-.27589,-.2311,-.75018,1.84759,0,.12137,0,0,0,1,0]);ka("Polaroid",[1.438,-.062,-.062,0,0,-.122,1.378,-.122,0,0,-.016,-.016,1.483,0,0,0,0,0,1,0]);ka("Sepia",[.393,.769,.189,0,0,.349,.686,.168,0,0,.272,.534,.131,0,0,0,0,0,1,0]);ka("BlackWhite",[1.5,1.5,1.5,0,-1,1.5,1.5,1.5,0,-1,1.5,1.5,1.5,0,-1,0,0,0,1,0]);class lE extends en{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};super(e),this.subFilters=e.subFilters||[]}applyTo(e){I0(e)&&(e.passes+=this.subFilters.length-1),this.subFilters.forEach(t=>{t.applyTo(e)})}toObject(){return{type:this.type,subFilters:this.subFilters.map(e=>e.toObject())}}isNeutralState(){return!this.subFilters.some(e=>!e.isNeutralState())}static fromObject(e,t){return Promise.all((e.subFilters||[]).map(r=>me.getClass(r.type).fromObject(r,t))).then(r=>new this({subFilters:r}))}}V(lE,"type","Composed"),me.setClass(lE);class Dh extends en{getFragmentSource(){return`
  precision highp float;
  uniform sampler2D uTexture;
  uniform float uContrast;
  varying vec2 vTexCoord;
  void main() {
    vec4 color = texture2D(uTexture, vTexCoord);
    float contrastF = 1.015 * (uContrast + 1.0) / (1.0 * (1.015 - uContrast));
    color.rgb = contrastF * (color.rgb - 0.5) + 0.5;
    gl_FragColor = color;
  }`}isNeutralState(){return this.contrast===0}applyTo2d(e){let{imageData:{data:t}}=e;const r=Math.floor(255*this.contrast),s=259*(r+255)/(255*(259-r));for(let i=0;i<t.length;i+=4)t[i]=s*(t[i]-128)+128,t[i+1]=s*(t[i+1]-128)+128,t[i+2]=s*(t[i+2]-128)+128}sendUniformData(e,t){e.uniform1f(t.uContrast,this.contrast)}}V(Dh,"type","Contrast"),V(Dh,"defaults",{contrast:0}),V(Dh,"uniformLocations",["uContrast"]),me.setClass(Dh);const gq={Convolute_3_1:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform float uMatrix[9];
    uniform float uStepW;
    uniform float uStepH;
    varying vec2 vTexCoord;
    void main() {
      vec4 color = vec4(0, 0, 0, 0);
      for (float h = 0.0; h < 3.0; h+=1.0) {
        for (float w = 0.0; w < 3.0; w+=1.0) {
          vec2 matrixPos = vec2(uStepW * (w - 1), uStepH * (h - 1));
          color += texture2D(uTexture, vTexCoord + matrixPos) * uMatrix[int(h * 3.0 + w)];
        }
      }
      gl_FragColor = color;
    }
    `,Convolute_3_0:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform float uMatrix[9];
    uniform float uStepW;
    uniform float uStepH;
    varying vec2 vTexCoord;
    void main() {
      vec4 color = vec4(0, 0, 0, 1);
      for (float h = 0.0; h < 3.0; h+=1.0) {
        for (float w = 0.0; w < 3.0; w+=1.0) {
          vec2 matrixPos = vec2(uStepW * (w - 1.0), uStepH * (h - 1.0));
          color.rgb += texture2D(uTexture, vTexCoord + matrixPos).rgb * uMatrix[int(h * 3.0 + w)];
        }
      }
      float alpha = texture2D(uTexture, vTexCoord).a;
      gl_FragColor = color;
      gl_FragColor.a = alpha;
    }
    `,Convolute_5_1:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform float uMatrix[25];
    uniform float uStepW;
    uniform float uStepH;
    varying vec2 vTexCoord;
    void main() {
      vec4 color = vec4(0, 0, 0, 0);
      for (float h = 0.0; h < 5.0; h+=1.0) {
        for (float w = 0.0; w < 5.0; w+=1.0) {
          vec2 matrixPos = vec2(uStepW * (w - 2.0), uStepH * (h - 2.0));
          color += texture2D(uTexture, vTexCoord + matrixPos) * uMatrix[int(h * 5.0 + w)];
        }
      }
      gl_FragColor = color;
    }
    `,Convolute_5_0:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform float uMatrix[25];
    uniform float uStepW;
    uniform float uStepH;
    varying vec2 vTexCoord;
    void main() {
      vec4 color = vec4(0, 0, 0, 1);
      for (float h = 0.0; h < 5.0; h+=1.0) {
        for (float w = 0.0; w < 5.0; w+=1.0) {
          vec2 matrixPos = vec2(uStepW * (w - 2.0), uStepH * (h - 2.0));
          color.rgb += texture2D(uTexture, vTexCoord + matrixPos).rgb * uMatrix[int(h * 5.0 + w)];
        }
      }
      float alpha = texture2D(uTexture, vTexCoord).a;
      gl_FragColor = color;
      gl_FragColor.a = alpha;
    }
    `,Convolute_7_1:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform float uMatrix[49];
    uniform float uStepW;
    uniform float uStepH;
    varying vec2 vTexCoord;
    void main() {
      vec4 color = vec4(0, 0, 0, 0);
      for (float h = 0.0; h < 7.0; h+=1.0) {
        for (float w = 0.0; w < 7.0; w+=1.0) {
          vec2 matrixPos = vec2(uStepW * (w - 3.0), uStepH * (h - 3.0));
          color += texture2D(uTexture, vTexCoord + matrixPos) * uMatrix[int(h * 7.0 + w)];
        }
      }
      gl_FragColor = color;
    }
    `,Convolute_7_0:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform float uMatrix[49];
    uniform float uStepW;
    uniform float uStepH;
    varying vec2 vTexCoord;
    void main() {
      vec4 color = vec4(0, 0, 0, 1);
      for (float h = 0.0; h < 7.0; h+=1.0) {
        for (float w = 0.0; w < 7.0; w+=1.0) {
          vec2 matrixPos = vec2(uStepW * (w - 3.0), uStepH * (h - 3.0));
          color.rgb += texture2D(uTexture, vTexCoord + matrixPos).rgb * uMatrix[int(h * 7.0 + w)];
        }
      }
      float alpha = texture2D(uTexture, vTexCoord).a;
      gl_FragColor = color;
      gl_FragColor.a = alpha;
    }
    `,Convolute_9_1:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform float uMatrix[81];
    uniform float uStepW;
    uniform float uStepH;
    varying vec2 vTexCoord;
    void main() {
      vec4 color = vec4(0, 0, 0, 0);
      for (float h = 0.0; h < 9.0; h+=1.0) {
        for (float w = 0.0; w < 9.0; w+=1.0) {
          vec2 matrixPos = vec2(uStepW * (w - 4.0), uStepH * (h - 4.0));
          color += texture2D(uTexture, vTexCoord + matrixPos) * uMatrix[int(h * 9.0 + w)];
        }
      }
      gl_FragColor = color;
    }
    `,Convolute_9_0:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform float uMatrix[81];
    uniform float uStepW;
    uniform float uStepH;
    varying vec2 vTexCoord;
    void main() {
      vec4 color = vec4(0, 0, 0, 1);
      for (float h = 0.0; h < 9.0; h+=1.0) {
        for (float w = 0.0; w < 9.0; w+=1.0) {
          vec2 matrixPos = vec2(uStepW * (w - 4.0), uStepH * (h - 4.0));
          color.rgb += texture2D(uTexture, vTexCoord + matrixPos).rgb * uMatrix[int(h * 9.0 + w)];
        }
      }
      float alpha = texture2D(uTexture, vTexCoord).a;
      gl_FragColor = color;
      gl_FragColor.a = alpha;
    }
    `};class Oh extends en{getCacheKey(){return"".concat(this.type,"_").concat(Math.sqrt(this.matrix.length),"_").concat(this.opaque?1:0)}getFragmentSource(){return gq[this.getCacheKey()]}applyTo2d(e){const t=e.imageData,r=t.data,s=this.matrix,i=Math.round(Math.sqrt(s.length)),o=Math.floor(i/2),a=t.width,l=t.height,c=e.ctx.createImageData(a,l),u=c.data,h=this.opaque?1:0;let d,p,m,g,y,x,v,w,_,S,E,C,P;for(E=0;E<l;E++)for(S=0;S<a;S++){for(y=4*(E*a+S),d=0,p=0,m=0,g=0,P=0;P<i;P++)for(C=0;C<i;C++)v=E+P-o,x=S+C-o,v<0||v>=l||x<0||x>=a||(w=4*(v*a+x),_=s[P*i+C],d+=r[w]*_,p+=r[w+1]*_,m+=r[w+2]*_,h||(g+=r[w+3]*_));u[y]=d,u[y+1]=p,u[y+2]=m,u[y+3]=h?r[y+3]:g}e.imageData=c}sendUniformData(e,t){e.uniform1fv(t.uMatrix,this.matrix)}toObject(){return q(q({},super.toObject()),{},{opaque:this.opaque,matrix:[...this.matrix]})}}V(Oh,"type","Convolute"),V(Oh,"defaults",{opaque:!1,matrix:[0,0,0,0,1,0,0,0,0]}),V(Oh,"uniformLocations",["uMatrix","uOpaque","uHalfSize","uSize"]),me.setClass(Oh);const qO="Gamma";class Ih extends en{getFragmentSource(){return`
  precision highp float;
  uniform sampler2D uTexture;
  uniform vec3 uGamma;
  varying vec2 vTexCoord;
  void main() {
    vec4 color = texture2D(uTexture, vTexCoord);
    vec3 correction = (1.0 / uGamma);
    color.r = pow(color.r, correction.r);
    color.g = pow(color.g, correction.g);
    color.b = pow(color.b, correction.b);
    gl_FragColor = color;
    gl_FragColor.rgb *= color.a;
  }
`}constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};super(e),this.gamma=e.gamma||this.constructor.defaults.gamma.concat()}applyTo2d(e){let{imageData:{data:t}}=e;const r=this.gamma,s=1/r[0],i=1/r[1],o=1/r[2];this.rgbValues||(this.rgbValues={r:new Uint8Array(256),g:new Uint8Array(256),b:new Uint8Array(256)});const a=this.rgbValues;for(let l=0;l<256;l++)a.r[l]=255*Math.pow(l/255,s),a.g[l]=255*Math.pow(l/255,i),a.b[l]=255*Math.pow(l/255,o);for(let l=0;l<t.length;l+=4)t[l]=a.r[t[l]],t[l+1]=a.g[t[l+1]],t[l+2]=a.b[t[l+2]]}sendUniformData(e,t){e.uniform3fv(t.uGamma,this.gamma)}isNeutralState(){const{gamma:e}=this;return e[0]===1&&e[1]===1&&e[2]===1}toObject(){return{type:qO,gamma:this.gamma.concat()}}}V(Ih,"type",qO),V(Ih,"defaults",{gamma:[1,1,1]}),V(Ih,"uniformLocations",["uGamma"]),me.setClass(Ih);const mq={average:`
    precision highp float;
    uniform sampler2D uTexture;
    varying vec2 vTexCoord;
    void main() {
      vec4 color = texture2D(uTexture, vTexCoord);
      float average = (color.r + color.b + color.g) / 3.0;
      gl_FragColor = vec4(average, average, average, color.a);
    }
    `,lightness:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform int uMode;
    varying vec2 vTexCoord;
    void main() {
      vec4 col = texture2D(uTexture, vTexCoord);
      float average = (max(max(col.r, col.g),col.b) + min(min(col.r, col.g),col.b)) / 2.0;
      gl_FragColor = vec4(average, average, average, col.a);
    }
    `,luminosity:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform int uMode;
    varying vec2 vTexCoord;
    void main() {
      vec4 col = texture2D(uTexture, vTexCoord);
      float average = 0.21 * col.r + 0.72 * col.g + 0.07 * col.b;
      gl_FragColor = vec4(average, average, average, col.a);
    }
    `};class Rh extends en{applyTo2d(e){let{imageData:{data:t}}=e;for(let r,s=0;s<t.length;s+=4){switch(this.mode){case"average":r=(t[s]+t[s+1]+t[s+2])/3;break;case"lightness":r=(Math.min(t[s],t[s+1],t[s+2])+Math.max(t[s],t[s+1],t[s+2]))/2;break;case"luminosity":r=.21*t[s]+.72*t[s+1]+.07*t[s+2]}t[s]=r,t[s+1]=r,t[s+2]=r}}getCacheKey(){return"".concat(this.type,"_").concat(this.mode)}getFragmentSource(){return mq[this.mode]}sendUniformData(e,t){e.uniform1i(t.uMode,1)}isNeutralState(){return!1}}V(Rh,"type","Grayscale"),V(Rh,"defaults",{mode:"average"}),V(Rh,"uniformLocations",["uMode"]),me.setClass(Rh);class om extends ll{calculateMatrix(){const e=this.rotation*Math.PI,t=ai(e),r=li(e),s=1/3,i=Math.sqrt(s)*r,o=1-t;this.matrix=[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0],this.matrix[0]=t+o/3,this.matrix[1]=s*o-i,this.matrix[2]=s*o+i,this.matrix[5]=s*o+i,this.matrix[6]=t+s*o,this.matrix[7]=s*o-i,this.matrix[10]=s*o-i,this.matrix[11]=s*o+i,this.matrix[12]=t+s*o}isNeutralState(){return this.rotation===0}applyTo(e){this.calculateMatrix(),super.applyTo(e)}toObject(){return{type:this.type,rotation:this.rotation}}}V(om,"type","HueRotation"),V(om,"defaults",{rotation:0}),me.setClass(om);class Nh extends en{applyTo2d(e){let{imageData:{data:t}}=e;for(let r=0;r<t.length;r+=4)t[r]=255-t[r],t[r+1]=255-t[r+1],t[r+2]=255-t[r+2],this.alpha&&(t[r+3]=255-t[r+3])}getFragmentSource(){return`
  precision highp float;
  uniform sampler2D uTexture;
  uniform int uInvert;
  uniform int uAlpha;
  varying vec2 vTexCoord;
  void main() {
    vec4 color = texture2D(uTexture, vTexCoord);
    if (uInvert == 1) {
      if (uAlpha == 1) {
        gl_FragColor = vec4(1.0 - color.r,1.0 -color.g,1.0 -color.b,1.0 -color.a);
      } else {
        gl_FragColor = vec4(1.0 - color.r,1.0 -color.g,1.0 -color.b,color.a);
      }
    } else {
      gl_FragColor = color;
    }
  }
`}isNeutralState(){return!this.invert}sendUniformData(e,t){e.uniform1i(t.uInvert,Number(this.invert)),e.uniform1i(t.uAlpha,Number(this.alpha))}}V(Nh,"type","Invert"),V(Nh,"defaults",{alpha:!1,invert:!0}),V(Nh,"uniformLocations",["uInvert","uAlpha"]),me.setClass(Nh);class jh extends en{getFragmentSource(){return`
  precision highp float;
  uniform sampler2D uTexture;
  uniform float uStepH;
  uniform float uNoise;
  uniform float uSeed;
  varying vec2 vTexCoord;
  float rand(vec2 co, float seed, float vScale) {
    return fract(sin(dot(co.xy * vScale ,vec2(12.9898 , 78.233))) * 43758.5453 * (seed + 0.01) / 2.0);
  }
  void main() {
    vec4 color = texture2D(uTexture, vTexCoord);
    color.rgb += (0.5 - rand(vTexCoord, uSeed, 0.1 / uStepH)) * uNoise;
    gl_FragColor = color;
  }
`}applyTo2d(e){let{imageData:{data:t}}=e;const r=this.noise;for(let s=0;s<t.length;s+=4){const i=(.5-Math.random())*r;t[s]+=i,t[s+1]+=i,t[s+2]+=i}}sendUniformData(e,t){e.uniform1f(t.uNoise,this.noise/255),e.uniform1f(t.uSeed,Math.random())}isNeutralState(){return this.noise===0}}V(jh,"type","Noise"),V(jh,"defaults",{noise:0}),V(jh,"uniformLocations",["uNoise","uSeed"]),me.setClass(jh);class Lh extends en{applyTo2d(e){let{imageData:{data:t,width:r,height:s}}=e;for(let i=0;i<s;i+=this.blocksize)for(let o=0;o<r;o+=this.blocksize){const a=4*i*r+4*o,l=t[a],c=t[a+1],u=t[a+2],h=t[a+3];for(let d=i;d<Math.min(i+this.blocksize,s);d++)for(let p=o;p<Math.min(o+this.blocksize,r);p++){const m=4*d*r+4*p;t[m]=l,t[m+1]=c,t[m+2]=u,t[m+3]=h}}}isNeutralState(){return this.blocksize===1}getFragmentSource(){return`
  precision highp float;
  uniform sampler2D uTexture;
  uniform float uBlocksize;
  uniform float uStepW;
  uniform float uStepH;
  varying vec2 vTexCoord;
  void main() {
    float blockW = uBlocksize * uStepW;
    float blockH = uBlocksize * uStepH;
    int posX = int(vTexCoord.x / blockW);
    int posY = int(vTexCoord.y / blockH);
    float fposX = float(posX);
    float fposY = float(posY);
    vec2 squareCoords = vec2(fposX * blockW, fposY * blockH);
    vec4 color = texture2D(uTexture, squareCoords);
    gl_FragColor = color;
  }
`}sendUniformData(e,t){e.uniform1f(t.uBlocksize,this.blocksize)}}V(Lh,"type","Pixelate"),V(Lh,"defaults",{blocksize:4}),V(Lh,"uniformLocations",["uBlocksize"]),me.setClass(Lh);class Mh extends en{getFragmentSource(){return`
precision highp float;
uniform sampler2D uTexture;
uniform vec4 uLow;
uniform vec4 uHigh;
varying vec2 vTexCoord;
void main() {
  gl_FragColor = texture2D(uTexture, vTexCoord);
  if(all(greaterThan(gl_FragColor.rgb,uLow.rgb)) && all(greaterThan(uHigh.rgb,gl_FragColor.rgb))) {
    gl_FragColor.a = 0.0;
  }
}
`}applyTo2d(e){let{imageData:{data:t}}=e;const r=255*this.distance,s=new dt(this.color).getSource(),i=[s[0]-r,s[1]-r,s[2]-r],o=[s[0]+r,s[1]+r,s[2]+r];for(let a=0;a<t.length;a+=4){const l=t[a],c=t[a+1],u=t[a+2];l>i[0]&&c>i[1]&&u>i[2]&&l<o[0]&&c<o[1]&&u<o[2]&&(t[a+3]=0)}}sendUniformData(e,t){const r=new dt(this.color).getSource(),s=this.distance,i=[0+r[0]/255-s,0+r[1]/255-s,0+r[2]/255-s,1],o=[r[0]/255+s,r[1]/255+s,r[2]/255+s,1];e.uniform4fv(t.uLow,i),e.uniform4fv(t.uHigh,o)}}V(Mh,"type","RemoveColor"),V(Mh,"defaults",{color:"#FFFFFF",distance:.02,useAlpha:!1}),V(Mh,"uniformLocations",["uLow","uHigh"]),me.setClass(Mh);class Fh extends en{sendUniformData(e,t){e.uniform2fv(t.uDelta,this.horizontal?[1/this.width,0]:[0,1/this.height]),e.uniform1fv(t.uTaps,this.taps)}getFilterWindow(){const e=this.tempScale;return Math.ceil(this.lanczosLobes/e)}getCacheKey(){const e=this.getFilterWindow();return"".concat(this.type,"_").concat(e)}getFragmentSource(){const e=this.getFilterWindow();return this.generateShader(e)}getTaps(){const e=this.lanczosCreate(this.lanczosLobes),t=this.tempScale,r=this.getFilterWindow(),s=new Array(r);for(let i=1;i<=r;i++)s[i-1]=e(i*t);return s}generateShader(e){const t=new Array(e);for(let r=1;r<=e;r++)t[r-1]="".concat(r,".0 * uDelta");return`
      precision highp float;
      uniform sampler2D uTexture;
      uniform vec2 uDelta;
      varying vec2 vTexCoord;
      uniform float uTaps[`.concat(e,`];
      void main() {
        vec4 color = texture2D(uTexture, vTexCoord);
        float sum = 1.0;
        `).concat(t.map((r,s)=>`
              color += texture2D(uTexture, vTexCoord + `.concat(r,") * uTaps[").concat(s,"] + texture2D(uTexture, vTexCoord - ").concat(r,") * uTaps[").concat(s,`];
              sum += 2.0 * uTaps[`).concat(s,`];
            `)).join(`
`),`
        gl_FragColor = color / sum;
      }
    `)}applyToForWebgl(e){e.passes++,this.width=e.sourceWidth,this.horizontal=!0,this.dW=Math.round(this.width*this.scaleX),this.dH=e.sourceHeight,this.tempScale=this.dW/this.width,this.taps=this.getTaps(),e.destinationWidth=this.dW,super.applyTo(e),e.sourceWidth=e.destinationWidth,this.height=e.sourceHeight,this.horizontal=!1,this.dH=Math.round(this.height*this.scaleY),this.tempScale=this.dH/this.height,this.taps=this.getTaps(),e.destinationHeight=this.dH,super.applyTo(e),e.sourceHeight=e.destinationHeight}applyTo(e){I0(e)?this.applyToForWebgl(e):this.applyTo2d(e)}isNeutralState(){return this.scaleX===1&&this.scaleY===1}lanczosCreate(e){return t=>{if(t>=e||t<=-e)return 0;if(t<11920929e-14&&t>-11920929e-14)return 1;const r=(t*=Math.PI)/e;return Math.sin(t)/t*Math.sin(r)/r}}applyTo2d(e){const t=e.imageData,r=this.scaleX,s=this.scaleY;this.rcpScaleX=1/r,this.rcpScaleY=1/s;const i=t.width,o=t.height,a=Math.round(i*r),l=Math.round(o*s);let c;c=this.resizeType==="sliceHack"?this.sliceByTwo(e,i,o,a,l):this.resizeType==="hermite"?this.hermiteFastResize(e,i,o,a,l):this.resizeType==="bilinear"?this.bilinearFiltering(e,i,o,a,l):this.resizeType==="lanczos"?this.lanczosResize(e,i,o,a,l):new ImageData(a,l),e.imageData=c}sliceByTwo(e,t,r,s,i){const o=e.imageData,a=.5;let l=!1,c=!1,u=t*a,h=r*a;const d=e.filterBackend.resources;let p=0,m=0;const g=t;let y=0;d.sliceByTwo||(d.sliceByTwo=Zt());const x=d.sliceByTwo;(x.width<1.5*t||x.height<r)&&(x.width=1.5*t,x.height=r);const v=x.getContext("2d");for(v.clearRect(0,0,1.5*t,r),v.putImageData(o,0,0),s=Math.floor(s),i=Math.floor(i);!l||!c;)t=u,r=h,s<Math.floor(u*a)?u=Math.floor(u*a):(u=s,l=!0),i<Math.floor(h*a)?h=Math.floor(h*a):(h=i,c=!0),v.drawImage(x,p,m,t,r,g,y,u,h),p=g,m=y,y+=h;return v.getImageData(p,m,s,i)}lanczosResize(e,t,r,s,i){const o=e.imageData.data,a=e.ctx.createImageData(s,i),l=a.data,c=this.lanczosCreate(this.lanczosLobes),u=this.rcpScaleX,h=this.rcpScaleY,d=2/this.rcpScaleX,p=2/this.rcpScaleY,m=Math.ceil(u*this.lanczosLobes/2),g=Math.ceil(h*this.lanczosLobes/2),y={},x={x:0,y:0},v={x:0,y:0};return function w(_){let S,E,C,P,O,A,R,B,I,L,U;for(x.x=(_+.5)*u,v.x=Math.floor(x.x),S=0;S<i;S++){for(x.y=(S+.5)*h,v.y=Math.floor(x.y),O=0,A=0,R=0,B=0,I=0,E=v.x-m;E<=v.x+m;E++)if(!(E<0||E>=t)){L=Math.floor(1e3*Math.abs(E-x.x)),y[L]||(y[L]={});for(let F=v.y-g;F<=v.y+g;F++)F<0||F>=r||(U=Math.floor(1e3*Math.abs(F-x.y)),y[L][U]||(y[L][U]=c(Math.sqrt(Math.pow(L*d,2)+Math.pow(U*p,2))/1e3)),C=y[L][U],C>0&&(P=4*(F*t+E),O+=C,A+=C*o[P],R+=C*o[P+1],B+=C*o[P+2],I+=C*o[P+3]))}P=4*(S*s+_),l[P]=A/O,l[P+1]=R/O,l[P+2]=B/O,l[P+3]=I/O}return++_<s?w(_):a}(0)}bilinearFiltering(e,t,r,s,i){let o,a,l,c,u,h,d,p,m,g,y,x,v,w=0;const _=this.rcpScaleX,S=this.rcpScaleY,E=4*(t-1),C=e.imageData.data,P=e.ctx.createImageData(s,i),O=P.data;for(d=0;d<i;d++)for(p=0;p<s;p++)for(u=Math.floor(_*p),h=Math.floor(S*d),m=_*p-u,g=S*d-h,v=4*(h*t+u),y=0;y<4;y++)o=C[v+y],a=C[v+4+y],l=C[v+E+y],c=C[v+E+4+y],x=o*(1-m)*(1-g)+a*m*(1-g)+l*g*(1-m)+c*m*g,O[w++]=x;return P}hermiteFastResize(e,t,r,s,i){const o=this.rcpScaleX,a=this.rcpScaleY,l=Math.ceil(o/2),c=Math.ceil(a/2),u=e.imageData.data,h=e.ctx.createImageData(s,i),d=h.data;for(let p=0;p<i;p++)for(let m=0;m<s;m++){const g=4*(m+p*s);let y=0,x=0,v=0,w=0,_=0,S=0,E=0;const C=(p+.5)*a;for(let P=Math.floor(p*a);P<(p+1)*a;P++){const O=Math.abs(C-(P+.5))/c,A=(m+.5)*o,R=O*O;for(let B=Math.floor(m*o);B<(m+1)*o;B++){let I=Math.abs(A-(B+.5))/l;const L=Math.sqrt(R+I*I);L>1&&L<-1||(y=2*L*L*L-3*L*L+1,y>0&&(I=4*(B+P*t),E+=y*u[I+3],v+=y,u[I+3]<255&&(y=y*u[I+3]/250),w+=y*u[I],_+=y*u[I+1],S+=y*u[I+2],x+=y))}}d[g]=w/x,d[g+1]=_/x,d[g+2]=S/x,d[g+3]=E/v}return h}}V(Fh,"type","Resize"),V(Fh,"defaults",{resizeType:"hermite",scaleX:1,scaleY:1,lanczosLobes:3}),V(Fh,"uniformLocations",["uDelta","uTaps"]),me.setClass(Fh);class Bh extends en{getFragmentSource(){return`
  precision highp float;
  uniform sampler2D uTexture;
  uniform float uSaturation;
  varying vec2 vTexCoord;
  void main() {
    vec4 color = texture2D(uTexture, vTexCoord);
    float rgMax = max(color.r, color.g);
    float rgbMax = max(rgMax, color.b);
    color.r += rgbMax != color.r ? (rgbMax - color.r) * uSaturation : 0.00;
    color.g += rgbMax != color.g ? (rgbMax - color.g) * uSaturation : 0.00;
    color.b += rgbMax != color.b ? (rgbMax - color.b) * uSaturation : 0.00;
    gl_FragColor = color;
  }
`}applyTo2d(e){let{imageData:{data:t}}=e;const r=-this.saturation;for(let s=0;s<t.length;s+=4){const i=Math.max(t[s],t[s+1],t[s+2]);t[s]+=i!==t[s]?(i-t[s])*r:0,t[s+1]+=i!==t[s+1]?(i-t[s+1])*r:0,t[s+2]+=i!==t[s+2]?(i-t[s+2])*r:0}}sendUniformData(e,t){e.uniform1f(t.uSaturation,-this.saturation)}isNeutralState(){return this.saturation===0}}V(Bh,"type","Saturation"),V(Bh,"defaults",{saturation:0}),V(Bh,"uniformLocations",["uSaturation"]),me.setClass(Bh);class Uh extends en{getFragmentSource(){return`
  precision highp float;
  uniform sampler2D uTexture;
  uniform float uVibrance;
  varying vec2 vTexCoord;
  void main() {
    vec4 color = texture2D(uTexture, vTexCoord);
    float max = max(color.r, max(color.g, color.b));
    float avg = (color.r + color.g + color.b) / 3.0;
    float amt = (abs(max - avg) * 2.0) * uVibrance;
    color.r += max != color.r ? (max - color.r) * amt : 0.00;
    color.g += max != color.g ? (max - color.g) * amt : 0.00;
    color.b += max != color.b ? (max - color.b) * amt : 0.00;
    gl_FragColor = color;
  }
`}applyTo2d(e){let{imageData:{data:t}}=e;const r=-this.vibrance;for(let s=0;s<t.length;s+=4){const i=Math.max(t[s],t[s+1],t[s+2]),o=(t[s]+t[s+1]+t[s+2])/3,a=2*Math.abs(i-o)/255*r;t[s]+=i!==t[s]?(i-t[s])*a:0,t[s+1]+=i!==t[s+1]?(i-t[s+1])*a:0,t[s+2]+=i!==t[s+2]?(i-t[s+2])*a:0}}sendUniformData(e,t){e.uniform1f(t.uVibrance,-this.vibrance)}isNeutralState(){return this.vibrance===0}}V(Uh,"type","Vibrance"),V(Uh,"defaults",{vibrance:0}),V(Uh,"uniformLocations",["uVibrance"]),me.setClass(Uh);const vq=["Roboto","Poppins","Montserrat","Open Sans","Lato","Oswald","Raleway","Nunito","Source Sans Pro","Inter","Playfair Display","Merriweather","PT Sans","Ubuntu","Work Sans","Quicksand","Rubik","Fira Sans"],yq=["","","","","","","","","","","","","","","","","","","","","","","",""];class nc{constructor({imagePath:e,onSave:t,onCancel:r,mode:s="edit"}){It(this,"imagePath");It(this,"onSave");It(this,"onCancel");It(this,"mode");It(this,"canvas",null);It(this,"container",null);It(this,"backgroundImage",null);It(this,"currentColor","#ffffff");It(this,"currentFontSize",32);It(this,"currentFont","Roboto");It(this,"cropRect",null);It(this,"originalImageSize",{width:0,height:0});It(this,"_immediateHandlersBound",!1);It(this,"_cleanupPointerEvents",null);It(this,"_cleanupKeyboard",null);It(this,"activeTool","none");if(console.log(" FabricPhotoEditor constructor called with:",{imagePath:e,mode:s}),this.imagePath=e,this.onSave=t,this.onCancel=r,this.mode=s,!e)throw new Error("imagePath is required");if(!t||typeof t!="function")throw new Error("onSave callback is required");if(!r||typeof r!="function")throw new Error("onCancel callback is required");console.log(" FabricPhotoEditor constructor completed successfully")}static testFabricAvailability(){try{if(console.log(" Testing Fabric.js availability..."),console.log(" User Agent:",navigator.userAgent),console.log(" Is mobile:",/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)),console.log(" FabricCanvas available:",typeof ol),console.log(" FabricImage available:",typeof Hn),console.log(" FabricText available:",typeof on),typeof ol!="function")return console.error(" FabricCanvas not available as function"),!1;const e=document.createElement("canvas");e.width=100,e.height=100,document.body.appendChild(e);const t=new ol(e,{enableRetinaScaling:!0,allowTouchScrolling:!1,selection:!0}),r=t!==null;if(/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)){console.log(" Mobile detected, testing touch events...");try{const s=new TouchEvent("touchstart",{touches:[],targetTouches:[],changedTouches:[]});console.log(" Touch events supported:",s!==null)}catch(s){console.warn(" Touch events may not be fully supported:",s)}}return t.dispose(),document.body.removeChild(e),console.log(" Fabric.js test canvas creation:",r?"SUCCESS":"FAILED"),r}catch(e){return console.error(" Fabric.js availability test failed:",e),console.error(" Error details:",{message:e instanceof Error?e.message:"Unknown error",stack:e instanceof Error?e.stack:"No stack trace"}),!1}}async show(){if(console.log(" Showing enhanced Fabric.js photo editor, mode:",this.mode),!nc.testFabricAvailability()){console.error(" Fabric.js not available, cannot show editor"),this.onCancel({edited:!1});return}console.log(" Fabric.js available, proceeding with editor initialization");try{this.lockBackgroundScroll(),this.container=document.createElement("div"),this.container.id="fabric-photo-editor-modal",this.container.className="fixed inset-0 z-[9999] bg-background/95 backdrop-blur-sm overflow-hidden",this.container.innerHTML=this.getModalHTML(),document.body.appendChild(this.container),this.setupImmediateButtonHandlers(),this.setupDiagnosticLogging(),await new Promise(e=>setTimeout(e,100)),console.log(" Initializing canvas..."),await this.initializeCanvas(),console.log(" Setting up touch gestures..."),this.applyTouchGestureSettings(),console.log(" Loading image..."),await this.loadImage(),console.log(" Setting up event listeners..."),this.setupEventListeners(),this.mode.startsWith("crop-")&&(console.log(" Initializing crop mode..."),this.initializeCropMode()),console.log(" Photo editor initialization complete")}catch(e){throw console.error(" Error during photo editor initialization:",e),e}}getModalHTML(){const e=this.mode==="edit",t=this.mode.startsWith("crop-");return`
      <div class="flex flex-col h-full max-h-screen bg-background">
        <!-- Header -->
        <div class="safe-area-header flex items-center justify-between px-4 py-3 border-b border-border/30 bg-card/70">
          <button id="fabric-cancel-btn" class="px-4 py-2 text-foreground font-medium active:scale-95" style="touch-action: manipulation; -webkit-tap-highlight-color: transparent;">
            Cancel
          </button>
          <h2 class="text-lg font-semibold text-foreground">
            ${t?"Crop Image":"Edit Photo"}
          </h2>
          <button id="fabric-save-btn" class="px-4 py-2 text-primary font-semibold active:scale-95" style="touch-action: manipulation; -webkit-tap-highlight-color: transparent;">
            Done
          </button>
        </div>
        
        <!-- Canvas Container -->
        <div class="flex-1 flex items-center justify-center p-2 bg-black min-h-0">
          <div class="w-full h-full flex items-center justify-center">
            <canvas id="fabric-editor-canvas" class="max-w-full max-h-full"></canvas>
          </div>
        </div>
        
        <!-- Tool-specific Controls Panel (slides up when tool is active) -->
        <div id="tool-controls-panel" class="hidden bg-card/95 backdrop-blur-sm border-t border-border/30 px-4 py-3 safe-area-bottom">
          <!-- Text Controls -->
          <div id="text-controls" class="hidden space-y-2">
            <!-- Row 1: Action Buttons -->
            <div class="flex items-center gap-2 overflow-x-auto pb-2">
              <button id="text-add-btn" class="flex-shrink-0 px-4 py-2 bg-primary text-primary-foreground rounded-full text-sm font-medium active:scale-95">
                Add Text
              </button>
              <div class="flex items-center gap-2">
                <input id="color-picker" type="color" value="#ffffff" class="w-10 h-10 rounded-full border-2 border-border cursor-pointer">
              </div>
              <select id="font-select" class="px-3 py-2 text-sm border border-border rounded-lg bg-background text-foreground">
                ${vq.map(r=>`<option value="${r}">${r}</option>`).join("")}
              </select>
              <button id="text-size-toggle-btn" class="flex items-center gap-1 px-3 py-2 border border-border rounded-lg bg-background text-foreground active:scale-95">
                <svg class="w-4 h-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h8m-8 6h16" />
                </svg>
                <span class="text-xs">Size</span>
              </button>
            </div>
            
            <!-- Row 2: Dynamic Modification Area -->
            <div id="text-modification-area" class="min-h-[44px]">
              <!-- Text Input (shown when text is selected or added) -->
              <div id="text-input-container" class="hidden">
                <input 
                  id="text-input-field" 
                  type="text" 
                  placeholder="Enter text..." 
                  class="w-full px-3 py-2 border border-border rounded-lg bg-background text-foreground focus:outline-none focus:ring-2 focus:ring-primary"
                />
              </div>
              
              <!-- Size Slider (shown when size button is clicked) -->
              <div id="text-size-container" class="hidden">
                <div class="flex items-center gap-3">
                  <svg class="w-4 h-4 text-muted-foreground" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h8m-8 6h16" />
                  </svg>
                  <input id="font-size" type="range" min="16" max="120" value="32" class="flex-1 accent-primary">
                  <svg class="w-6 h-6 text-muted-foreground" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h8m-8 6h16" />
                  </svg>
                  <span id="font-size-value" class="text-sm font-medium text-foreground w-10 text-center">32</span>
                </div>
              </div>
            </div>
          </div>
          
          <!-- Sticker Controls -->
          <div id="sticker-controls" class="hidden">
            <div class="grid grid-cols-8 gap-2 max-h-32 overflow-y-auto">
              ${yq.map(r=>`
                <button class="emoji-btn text-2xl p-2 hover:bg-muted/30 rounded-lg transition-all hover:scale-110 active:scale-95" data-emoji="${r}">
                  ${r}
                </button>
              `).join("")}
            </div>
          </div>
        </div>
        
        <!-- Bottom Action Bar -->
        ${e?`
          <div class="flex items-center justify-around p-4 pb-8 border-t border-border/30 bg-card/70 safe-area-bottom">
            <button id="tool-text-btn" data-tool="text" class="flex flex-col items-center gap-1 p-2 rounded-lg transition-all active:scale-95">
              <svg class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h7" />
              </svg>
              <span class="text-xs font-medium">Text</span>
            </button>
            
            <button id="tool-sticker-btn" data-tool="sticker" class="flex flex-col items-center gap-1 p-2 rounded-lg transition-all active:scale-95">
              <span class="text-2xl"></span>
              <span class="text-xs font-medium">Stickers</span>
            </button>
            
            <button id="fabric-clear-btn" class="flex flex-col items-center gap-1 p-2 rounded-lg transition-all active:scale-95">
              <svg class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16" />
              </svg>
              <span class="text-xs font-medium">Clear</span>
            </button>
            
            <button id="fabric-undo-btn" class="flex flex-col items-center gap-1 p-2 rounded-lg transition-all active:scale-95">
              <svg class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 10h10a8 8 0 018 8v2M3 10l6 6m-6-6l6-6" />
              </svg>
              <span class="text-xs font-medium">Undo</span>
            </button>
          </div>
        `:`
          <div class="flex items-center justify-center p-4 pb-8 border-t border-border/30 bg-card/70 safe-area-bottom">
            <div class="text-sm text-muted-foreground">
              ${this.mode==="crop-header"?"Crop to 4:1 ratio":"Crop to 1:1 ratio"}
            </div>
          </div>
        `}
      </div>
    `}setActiveTool(e){this.activeTool=e;const t=document.getElementById("text-controls"),r=document.getElementById("sticker-controls"),s=document.getElementById("tool-controls-panel");if(t&&t.classList.add("hidden"),r&&r.classList.add("hidden"),document.querySelectorAll("[data-tool]").forEach(i=>{i.classList.remove("text-primary"),i.classList.add("text-foreground")}),e!=="none"&&s){s.classList.remove("hidden");const i=document.querySelector(`[data-tool="${e}"]`);i&&(i.classList.remove("text-foreground"),i.classList.add("text-primary")),e==="text"&&t?(t.classList.remove("hidden"),this.showTextInput()):e==="sticker"&&r&&r.classList.remove("hidden")}else s&&s.classList.add("hidden")}showTextInput(){const e=document.getElementById("text-input-container"),t=document.getElementById("text-size-container");e&&e.classList.remove("hidden"),t&&t.classList.add("hidden")}showTextSize(){const e=document.getElementById("text-input-container"),t=document.getElementById("text-size-container");e&&e.classList.add("hidden"),t&&t.classList.remove("hidden")}hideAllTextModifications(){const e=document.getElementById("text-input-container"),t=document.getElementById("text-size-container");e&&e.classList.add("hidden"),t&&t.classList.add("hidden")}getCropToolbarHTML(){return`
      <div class="flex items-center gap-4">
        <div class="flex items-center gap-2">
          <label class="text-sm font-medium text-foreground">Crop Mode:</label>
          <span class="px-3 py-1 text-sm bg-primary text-primary-foreground rounded">
            ${this.mode==="crop-header"?"4:1 Header":"1:1 Square"}
          </span>
        </div>
      </div>
    `}async initializeCanvas(){console.log(" initializeCanvas: Starting canvas initialization");try{const e=document.getElementById("fabric-editor-canvas");if(!e)throw new Error("Canvas element not found in DOM");console.log(" initializeCanvas: Canvas element found, creating Fabric canvas");const t=/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);console.log(" initializeCanvas: Mobile device detected:",t),this.canvas=new ol(e,{backgroundColor:"transparent",preserveObjectStacking:!0,selection:!0,allowTouchScrolling:!1,enableRetinaScaling:!0,imageSmoothingEnabled:!0,targetFindTolerance:t?15:5,perPixelTargetFind:!t}),t&&(console.log(" initializeCanvas: Setting up mobile touch handling"),e.addEventListener("touchstart",s=>{s.touches.length>1&&s.preventDefault()},{passive:!1}),e.addEventListener("touchmove",s=>{s.touches.length>1&&s.preventDefault()},{passive:!1})),console.log(" initializeCanvas: Fabric canvas created successfully"),this.canvas.on("mouse:dblclick",s=>{var o,a;const i=s.target;if(i&&i.type==="text"){console.log(" Double-clicked on text - entering edit mode");const l=i;l.set({editable:!0,selectable:!0}),(o=this.canvas)==null||o.setActiveObject(l),(a=this.canvas)==null||a.renderAll()}}),this.canvas.on("text:editing:entered",s=>{console.log(" Text editing started");const i=s.target;i&&this.updateUIFromTextObject(i)}),this.canvas.on("text:editing:exited",s=>{var i;console.log(" Text editing completed"),(i=this.canvas)==null||i.renderAll()}),this.canvas.on("text:changed",s=>{var i;(i=this.canvas)==null||i.renderAll()}),this.canvas.on("mouse:down",s=>{var i;console.log(" canvas mouse:down",{target:(i=s.target)==null?void 0:i.type,pointer:s.pointer})}),this.canvas.on("mouse:move",s=>{var i;console.log(" canvas mouse:move",{target:(i=s.target)==null?void 0:i.type,pointer:s.pointer})}),this.canvas.on("mouse:up",s=>{var i;console.log(" canvas mouse:up",{target:(i=s.target)==null?void 0:i.type})}),this.canvas.on("object:scaling",s=>{var i;console.log(" object:scaling",{target:(i=s.target)==null?void 0:i.type})}),this.canvas.on("object:moving",s=>{var i;console.log(" object:moving",{target:(i=s.target)==null?void 0:i.type})});const r=this.canvas.upperCanvasEl;r&&(r.addEventListener("pointerdown",()=>console.log(" upperCanvas pointerdown"),{passive:!1}),r.addEventListener("touchstart",()=>console.log(" upperCanvas touchstart"),{passive:!1})),console.log(" initializeCanvas: All event listeners attached")}catch(e){throw console.error(" initializeCanvas: Error during canvas initialization:",e),e}}async loadImage(){return console.log(" loadImage: Starting image load process for:",this.imagePath),new Promise((e,t)=>{console.log(" loadImage: Creating FabricImage from URL"),Hn.fromURL(this.imagePath,{crossOrigin:"anonymous"}).then(r=>{if(console.log(" loadImage: FabricImage created successfully"),!this.canvas)return console.error(" loadImage: Canvas not initialized"),t("Canvas not initialized");this.originalImageSize={width:r.width||800,height:r.height||600},console.log(" loadImage: Original image size:",this.originalImageSize);const s=120,i=100,o=16,a=window.innerWidth-o,l=window.innerHeight-s-i-o;console.log(" loadImage: Available space:",{width:a,height:l});const c=a/this.originalImageSize.width,u=l/this.originalImageSize.height,h=Math.min(c,u,1),d=this.originalImageSize.width*h,p=this.originalImageSize.height*h;console.log(" loadImage: Canvas sizing:",{original:this.originalImageSize,available:{width:a,height:l},scale:h,final:{width:d,height:p}});try{this.canvas.setDimensions({width:d,height:p}),console.log(" loadImage: Canvas dimensions set successfully"),r.set({scaleX:h,scaleY:h,left:0,top:0,selectable:!1,evented:!1}),console.log(" loadImage: Image properties set"),this.backgroundImage=r,this.canvas.add(r),this.canvas.renderAll(),console.log(" loadImage: Image added to canvas and rendered"),e()}catch(m){console.error(" loadImage: Error setting up canvas:",m),t(m)}}).catch(r=>{console.error(" loadImage: Error loading image from URL:",r),console.error(" loadImage: Image path was:",this.imagePath),t(r)})})}initializeCropMode(){if(!this.canvas)return;const e=this.canvas.getWidth(),t=this.canvas.getHeight(),r=this.isMobile(),s=this.mode==="crop-header"?4/1:1;let i,o;const a=r?.9:.8;if(s>1)i=Math.min(e*a,t*a*s),o=i/s;else{const l=Math.min(e,t)*(r?.8:.7);i=l,o=l}this.canvas.selection=!1,this.cropRect=new Vr({left:(e-i)/2,top:(t-o)/2,width:i,height:o,originX:"left",originY:"top",fill:"transparent",stroke:"#007bff",strokeWidth:r?3:2,strokeDashArray:[5,5],selectable:!0,evented:!0,hasControls:!0,hasBorders:!0,hoverCursor:"move",moveCursor:"move",lockRotation:!0,lockUniScaling:!0,lockScalingFlip:!0,transparentCorners:!1,cornerColor:"#007bff",cornerStyle:"circle",cornerSize:r?24:10,touchCornerSize:r?32:24,borderColor:"#007bff",borderScaleFactor:r?2:1}),this.cropRect.on("scaling",()=>{this.cropRect&&this.enforceCropBoundsWhileScaling()}),this.cropRect.on("moving",()=>{this.cropRect&&this.constrainCropToImageBounds()}),this.cropRect.on("modified",()=>{this.cropRect&&this.constrainCropToImageBounds()}),this.canvas.add(this.cropRect),this.canvas.setActiveObject(this.cropRect),r&&this.applyTouchGestureSettings(),this.canvas.renderAll(),r&&this.setupPinchZoom(s),console.log(" Crop mode initialized with",r?"mobile-optimized":"desktop","controls")}setupImmediateButtonHandlers(){if(this._immediateHandlersBound)return;this._immediateHandlersBound=!0,console.log(" Binding immediate button handlers for Cancel and Save buttons");const e=(t,r)=>{const s=document.getElementById(t);if(!s){console.warn(` Button ${t} not found for immediate binding`);return}s.style.touchAction="manipulation",s.style.WebkitTapHighlightColor="transparent";const i=typeof window<"u"&&"PointerEvent"in window;let o=!1;i?(s.addEventListener("pointerdown",()=>{s.style.opacity="0.7",s.style.transform="scale(0.95)"},{passive:!0}),s.addEventListener("pointerup",a=>{s.style.opacity="1",s.style.transform="scale(1)",a.preventDefault(),r()},{passive:!1}),s.addEventListener("pointercancel",()=>{s.style.opacity="1",s.style.transform="scale(1)"},{passive:!0})):(s.addEventListener("touchstart",()=>{s.style.opacity="0.7",s.style.transform="scale(0.95)"},{passive:!0}),s.addEventListener("touchend",a=>{s.style.opacity="1",s.style.transform="scale(1)",o=!0,setTimeout(()=>{o=!1},300),a.preventDefault(),r()},{passive:!1}),s.addEventListener("touchcancel",()=>{s.style.opacity="1",s.style.transform="scale(1)"},{passive:!0})),s.addEventListener("click",()=>{i||o||r()})};e("fabric-cancel-btn",()=>this.cancel()),e("fabric-save-btn",()=>this.save())}setupEventListeners(){var s,i,o,a,l,c;const e=this._immediateHandlersBound?["fabric-cancel-btn","fabric-save-btn"]:[],t=(u,h)=>{if(e.includes(u)){console.log(` Skipping ${u} - already bound immediately`);return}const d=document.getElementById(u);if(!d)return;d.style.touchAction="manipulation",d.style.WebkitTapHighlightColor="transparent";const p=typeof window<"u"&&"PointerEvent"in window;let m=!1;p?(d.addEventListener("pointerdown",()=>{d.style.opacity="0.7",d.style.transform="scale(0.95)"},{passive:!0}),d.addEventListener("pointerup",g=>{d.style.opacity="1",d.style.transform="scale(1)",g.preventDefault(),h()},{passive:!1}),d.addEventListener("pointercancel",()=>{d.style.opacity="1",d.style.transform="scale(1)"},{passive:!0})):(d.addEventListener("touchstart",()=>{d.style.opacity="0.7",d.style.transform="scale(0.95)"},{passive:!0}),d.addEventListener("touchend",g=>{d.style.opacity="1",d.style.transform="scale(1)",m=!0,setTimeout(()=>{m=!1},300),g.preventDefault(),h()},{passive:!1}),d.addEventListener("touchcancel",()=>{d.style.opacity="1",d.style.transform="scale(1)"},{passive:!0})),d.addEventListener("click",()=>{p||m||h()})};t("tool-text-btn",()=>{this.activeTool==="text"?this.setActiveTool("none"):this.setActiveTool("text")}),t("tool-sticker-btn",()=>{this.activeTool==="sticker"?this.setActiveTool("none"):this.setActiveTool("sticker")}),t("text-add-btn",()=>this.addText()),t("text-size-toggle-btn",()=>{const u=document.getElementById("text-size-container");u!=null&&u.classList.contains("hidden")?this.showTextSize():this.showTextInput()});const r=document.getElementById("text-input-field");r==null||r.addEventListener("input",u=>{const h=u.target.value;this.updateSelectedTextContent(h)}),this.setupKeyboardHandling(),(s=document.getElementById("font-select"))==null||s.addEventListener("change",u=>{this.currentFont=u.target.value,this.updateSelectedTextFont()}),(i=document.getElementById("font-size"))==null||i.addEventListener("input",u=>{this.currentFontSize=parseInt(u.target.value),document.getElementById("font-size-value").textContent=this.currentFontSize.toString(),this.updateSelectedObjectFontSize()}),(o=document.getElementById("color-picker"))==null||o.addEventListener("change",u=>{this.currentColor=u.target.value,this.updateSelectedObjectColor()}),document.querySelectorAll(".emoji-btn").forEach(u=>{let h=!1;u.addEventListener("touchend",d=>{d.preventDefault(),h=!0,setTimeout(()=>{h=!1},500);const p=d.target.dataset.emoji;p&&(this.addEmoji(p),this.setActiveTool("none"))},{passive:!1}),u.addEventListener("click",d=>{if(!h){const p=d.target.dataset.emoji;p&&(this.addEmoji(p),this.setActiveTool("none"))}})}),t("fabric-save-btn",()=>this.save()),t("fabric-cancel-btn",()=>this.cancel()),t("fabric-undo-btn",()=>this.undo()),t("fabric-clear-btn",()=>this.clearAll()),document.addEventListener("keydown",this.handleKeyDown.bind(this)),(a=this.canvas)==null||a.on("selection:created",u=>{var d;const h=(d=u.selected)==null?void 0:d[0];h&&h.type==="text"&&(this.updateUIFromTextObject(h),this.activeTool==="text"&&this.showTextInput())}),(l=this.canvas)==null||l.on("selection:updated",u=>{var d;const h=(d=u.selected)==null?void 0:d[0];h&&h.type==="text"&&(this.updateUIFromTextObject(h),this.activeTool==="text"&&this.showTextInput())}),(c=this.canvas)==null||c.on("selection:cleared",()=>{const u=document.getElementById("text-input-field");u&&(u.value="")})}addText(){if(!this.canvas)return;const e=document.getElementById("text-input-field"),t=(e==null?void 0:e.value)||"Tap to edit",r=new on(t,{left:this.canvas.getWidth()/2-80,top:this.canvas.getHeight()/2-16,fill:this.currentColor,fontSize:this.currentFontSize,fontFamily:this.currentFont,editable:!1,textAlign:"center",selectable:!0,hasControls:!0,hasBorders:!0,lockUniScaling:!1,cornerStyle:"circle",cornerColor:"rgba(0, 123, 255, 0.8)",cornerSize:this.isMobile()?16:8,transparentCorners:!1});this.canvas.add(r),this.canvas.setActiveObject(r),this.canvas.renderAll(),this.updateUIFromTextObject(r),console.log(" Added text element:",t)}updateSelectedTextContent(e){if(!this.canvas)return;const t=this.canvas.getActiveObject();t&&t.type==="text"&&(t.set("text",e),this.canvas.renderAll())}addEmoji(e){if(!this.canvas)return;const t=new on(e,{left:this.canvas.getWidth()/2-25,top:this.canvas.getHeight()/2-25,fontSize:50,editable:!1,selectable:!0});this.canvas.add(t),this.canvas.setActiveObject(t),this.canvas.renderAll(),console.log(" Added emoji sticker:",e)}setCropRatio(e){if(!this.cropRect||!this.canvas)return;const t=this.canvas.getWidth(),r=this.canvas.getHeight();let s=t*.7,i=s/e;i>r*.8&&(i=r*.7,s=i*e),this.cropRect.set({width:s,height:i,left:(t-s)/2,top:(r-i)/2}),this.canvas.renderAll()}updateSelectedObjectColor(){if(!this.canvas)return;const e=this.canvas.getActiveObject();e&&e.type==="text"&&(e.set("fill",this.currentColor),this.canvas.renderAll())}updateSelectedObjectFontSize(){if(!this.canvas)return;const e=this.canvas.getActiveObject();e&&e.type==="text"&&(e.set("fontSize",this.currentFontSize),this.canvas.renderAll())}updateSelectedTextFont(){if(!this.canvas)return;const e=this.canvas.getActiveObject();e&&e.type==="text"&&(e.set("fontFamily",this.currentFont),this.canvas.renderAll())}maintainCropAspectRatio(e){if(!this.cropRect)return;const t=this.cropRect.width*this.cropRect.scaleX,r=this.cropRect.height*this.cropRect.scaleY;let s=t,i=t/e;i>r*1.1&&(i=r,s=i*e),this.cropRect.set({width:s/this.cropRect.scaleX,height:i/this.cropRect.scaleY,scaleX:1,scaleY:1})}constrainCropToImageBounds(){var p;if(!this.cropRect||!this.backgroundImage)return;const e=this.backgroundImage.left||0,t=this.backgroundImage.top||0,r=(this.backgroundImage.width||0)*(this.backgroundImage.scaleX||1),s=(this.backgroundImage.height||0)*(this.backgroundImage.scaleY||1),i=this.cropRect.width*this.cropRect.scaleX,o=this.cropRect.height*this.cropRect.scaleY;let a=this.cropRect.left,l=this.cropRect.top;const c=e,u=e+r-i,h=t,d=t+s-o;a=Math.max(c,Math.min(u,a)),l=Math.max(h,Math.min(d,l)),this.cropRect.set({left:a,top:l}),(p=this.canvas)==null||p.renderAll()}isMobile(){return/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)||"ontouchstart"in window}setupPinchZoom(e){if(!this.canvas)return;const t=this.canvas.upperCanvasEl,r=new Map;let s=0,i=1,o=!1;const a=(d,p)=>Math.sqrt(Math.pow(p.x-d.x,2)+Math.pow(p.y-d.y,2)),l=d=>{var p;if(r.set(d.pointerId,{x:d.clientX,y:d.clientY}),r.size===2&&this.cropRect){d.preventDefault();for(const g of r.keys())try{t.setPointerCapture(g)}catch{}const m=Array.from(r.values());s=a(m[0],m[1]),i=this.cropRect.scaleX||1,o=!0,console.log(" Pinch started:",{initialDistance:s,initialScale:i}),(p=this.canvas)==null||p.setActiveObject(this.cropRect)}},c=d=>{if(r.has(d.pointerId)&&(d.preventDefault(),r.set(d.pointerId,{x:d.clientX,y:d.clientY}),r.size===2&&o&&this.cropRect&&s>0)){const p=Array.from(r.values()),m=a(p[0],p[1]),g=m/s,y=i*g;console.log(" Pinch scaling:",{currentDistance:m,scaleRatio:g,newScale:y}),this.scaleCropRect(y)}},u=d=>{r.delete(d.pointerId),t.hasPointerCapture(d.pointerId)&&t.releasePointerCapture(d.pointerId),r.size<2&&(o=!1,s=0,i=1,console.log(" Pinch ended"))},h=d=>{console.log(" Pointer cancelled"),r.delete(d.pointerId),t.hasPointerCapture(d.pointerId)&&t.releasePointerCapture(d.pointerId),r.size<2&&(o=!1,s=0,i=1)};if(t.addEventListener("pointerdown",l,{passive:!1}),t.addEventListener("pointermove",c,{passive:!1}),t.addEventListener("pointerup",u,{passive:!1}),t.addEventListener("pointercancel",h,{passive:!1}),this._cleanupPointerEvents=()=>{t.removeEventListener("pointerdown",l),t.removeEventListener("pointermove",c),t.removeEventListener("pointerup",u),t.removeEventListener("pointercancel",h)},!this.isMobile()){const d=p=>{var m;if(this.cropRect&&((m=this.canvas)==null?void 0:m.getActiveObject())===this.cropRect){p.preventDefault();const g=p.deltaY>0?.9:1.1,x=(this.cropRect.scaleX||1)*g;this.scaleCropRect(x)}};t.addEventListener("wheel",d,{passive:!1}),this._cleanupWheel=()=>{t.removeEventListener("wheel",d)}}}scaleCropRect(e){if(!this.cropRect||!this.backgroundImage)return;const t=this.backgroundImage.left||0,r=this.backgroundImage.top||0,s=(this.backgroundImage.width||0)*(this.backgroundImage.scaleX||1),i=(this.backgroundImage.height||0)*(this.backgroundImage.scaleY||1),o=this.cropRect.width||1,a=this.cropRect.height||1,l=this.cropRect.left||0,c=this.cropRect.top||0,u=(t+s-l)/o,h=(r+i-c)/a,d=Math.min(u,h),p=40,m=p/o,g=p/a,y=Math.max(m,g,.05),x=Math.max(y,Math.min(d,e));this.cropRect.set({scaleX:x,scaleY:x}),this.constrainCropToImageBounds()}updateUIFromTextObject(e){this.currentColor=e.fill||this.currentColor,this.currentFontSize=e.fontSize||this.currentFontSize,this.currentFont=e.fontFamily||this.currentFont;const t=document.getElementById("color-picker"),r=document.getElementById("font-size"),s=document.getElementById("font-select"),i=document.getElementById("font-size-value"),o=document.getElementById("text-input-field");t&&(t.value=this.currentColor),r&&(r.value=this.currentFontSize.toString()),i&&(i.textContent=this.currentFontSize.toString()),s&&(s.value=this.currentFont),o&&e.text&&(o.value=e.text)}enforceCropBoundsWhileScaling(){var w;if(!this.cropRect||!this.backgroundImage)return;const e=this.backgroundImage.left||0,t=this.backgroundImage.top||0,r=(this.backgroundImage.width||0)*(this.backgroundImage.scaleX||1),s=(this.backgroundImage.height||0)*(this.backgroundImage.scaleY||1),i=this.cropRect.width||1,o=this.cropRect.height||1;let a=this.cropRect.scaleX||1;const l=this.cropRect.left||0,c=this.cropRect.top||0,u=(e+r-l)/i,h=(t+s-c)/o,d=Math.min(u,h),p=40,m=p/i,g=p/o,y=Math.max(m,g,.05);a=Math.max(y,Math.min(d,a)),this.cropRect.scaleX=a,this.cropRect.scaleY=a;const x=i*a,v=o*a;this.cropRect.left=Math.min(Math.max(l,e),e+r-x),this.cropRect.top=Math.min(Math.max(c,t),t+s-v),(w=this.canvas)==null||w.renderAll()}undo(){if(!this.canvas)return;const e=this.canvas.getObjects();if(e.length>1){const t=e[e.length-1];this.canvas.remove(t),this.canvas.renderAll()}}clearAll(){if(!this.canvas)return;this.canvas.getObjects().forEach(t=>{var r;t!==this.backgroundImage&&((r=this.canvas)==null||r.remove(t))}),this.canvas.renderAll(),console.log(" Cleared all editing objects")}handleKeyDown(e){e.key==="Delete"||e.key==="Backspace"?this.deleteSelected():e.key==="Escape"&&this.cancel()}lockBackgroundScroll(){const e=window.scrollY;document.body.style.position="fixed",document.body.style.top=`-${e}px`,document.body.style.width="100%",document.body.style.overflow="hidden",document.body._scrollY=e}unlockBackgroundScroll(){const e=document.body._scrollY||0;document.body.style.position="",document.body.style.top="",document.body.style.width="",document.body.style.overflow="",window.scrollTo(0,e),delete document.body._scrollY}deleteSelected(){if(!this.canvas)return;const e=this.canvas.getActiveObjects();e.length&&(e.forEach(t=>{var r;t!==this.backgroundImage&&((r=this.canvas)==null||r.remove(t))}),this.canvas.discardActiveObject(),this.canvas.renderAll(),console.log(" Deleted selected objects"))}save(){if(this.canvas){console.log(" Saving edited photo, mode:",this.mode);try{let e;this.mode.startsWith("crop-")&&this.cropRect?e=this.getCroppedImage():e=this.canvas.toDataURL({format:"jpeg",quality:.9,multiplier:1}),this.cleanup(),this.onSave({edited:!0,webPath:e}),console.log(" Photo saved successfully")}catch(e){console.error(" Error saving photo:",e),this.cleanup(),this.onCancel({edited:!1})}}}getCroppedImage(){if(!this.canvas||!this.cropRect)return"";this.cropRect.set("visible",!1),this.canvas.renderAll();const e=this.cropRect.left||0,t=this.cropRect.top||0,r=(this.cropRect.width||100)*(this.cropRect.scaleX||1),s=(this.cropRect.height||100)*(this.cropRect.scaleY||1),i=this.canvas.toDataURL({format:"jpeg",quality:.9,multiplier:1,left:e,top:t,width:r,height:s});return this.cropRect.set("visible",!0),this.canvas.renderAll(),i}cancel(){console.log(" Cancelling photo edit"),this.cleanup(),this.onCancel({edited:!1})}setupDiagnosticLogging(){const e=t=>{if(!this.container||!this.container.contains(t.target))return;const r=t.target,s=document.elementFromPoint(t.clientX,t.clientY);console.log(" Tap diagnostic:",{targetId:r.id,targetClass:r.className,hitElementId:s==null?void 0:s.id,hitElementClass:s==null?void 0:s.className,targetZIndex:window.getComputedStyle(r).zIndex,footerZIndex:window.getComputedStyle(document.querySelector(".safe-area-bottom")||document.body).zIndex,coordinates:{x:t.clientX,y:t.clientY}})};document.addEventListener("pointerdown",e,{passive:!0}),this._cleanupPointerEvents=()=>{document.removeEventListener("pointerdown",e),console.log(" Diagnostic logging cleaned up")}}applyTouchGestureSettings(){if(console.log(" Applying touch gesture settings"),this.container&&(this.container.style.touchAction="manipulation",this.container.style.overscrollBehavior="none",this.container.style.webkitUserSelect="none",this.container.style.msUserSelect="none",this.container.style.userSelect="none",this.container.style.webkitTouchCallout="none"),this.canvas){const e=this.canvas.lowerCanvasEl,t=this.canvas.upperCanvasEl;[e,t].forEach(r=>{r&&(r.style.touchAction="none",r.style.webkitUserSelect="none",r.style.msUserSelect="none",r.style.userSelect="none",r.style.webkitTouchCallout="none",r.style.overscrollBehavior="none",r.style.pointerEvents="auto")})}this.cropRect&&console.log(" Crop rect found, ensuring it captures touch events")}setupKeyboardHandling(){if(!this.isMobile())return;console.log(" Setting up keyboard handling for text input");const e=document.getElementById("tool-controls-panel");if(!e)return;let t,r;try{t=Ut.addListener("keyboardWillShow",s=>{console.log(" Keyboard will show, height:",s.keyboardHeight),e.style.transition="transform 0.3s ease-out",e.style.transform=`translateY(-${s.keyboardHeight}px)`}),r=Ut.addListener("keyboardWillHide",()=>{console.log(" Keyboard will hide"),e.style.transform="translateY(0)"}),this._cleanupKeyboard=()=>{console.log(" Cleaning up keyboard listeners"),t==null||t.remove(),r==null||r.remove(),e&&(e.style.transform="translateY(0)")}}catch(s){if(console.warn(" Keyboard plugin not available, using fallback",s),"visualViewport"in window&&window.visualViewport){const i=()=>{const o=window.visualViewport,a=window.innerHeight-o.height;a>100?(console.log(" Keyboard detected (viewport), height:",a),e.style.transition="transform 0.3s ease-out",e.style.transform=`translateY(-${a}px)`):e.style.transform="translateY(0)"};window.visualViewport.addEventListener("resize",i),this._cleanupKeyboard=()=>{var o;console.log(" Cleaning up viewport listeners"),(o=window.visualViewport)==null||o.removeEventListener("resize",i),e&&(e.style.transform="translateY(0)")}}}}cleanup(){console.log(" Cleaning up photo editor"),this._cleanupKeyboard&&(this._cleanupKeyboard(),this._cleanupKeyboard=null),this._cleanupPointerEvents&&(this._cleanupPointerEvents(),this._cleanupPointerEvents=null),this._cleanupWheel&&this._cleanupWheel(),this.unlockBackgroundScroll(),document.removeEventListener("keydown",this.handleKeyDown.bind(this)),this.canvas&&(this.canvas.dispose(),this.canvas=null),this.container&&(this.container.remove(),this.container=null),this._immediateHandlersBound=!1,console.log(" Photo editor cleanup complete")}}const xq=()=>{const{takePicture:n,isTakingPicture:e}=V4();return b.useEffect(()=>{console.log(" Setting up Fabric.js photo editor launcher...");const t=async r=>{console.log(" Bundled Fabric.js photo editor launcher called with:",r);try{if(!nc.testFabricAvailability())return console.error(" Fabric.js not available, skipping photo editor"),{edited:!1};let s,i;if(fo(r))console.log(" Converting data URL to blob (CSP compliant)"),s=p1(r),console.log(" Blob created from data URL, size:",s.size,"type:",s.type),i=URL.createObjectURL(s);else{console.log(" Fetching image from:",r);const o=await fetch(r);console.log(" Fetch response status:",o.status),s=await o.blob(),console.log(" Blob created, size:",s.size,"type:",s.type),i=URL.createObjectURL(s)}return console.log(" Converted to blob URL:",i),console.log(" Creating FabricPhotoEditor instance..."),new Promise(o=>{const a=new nc({imagePath:i,onSave:l=>{console.log(" Editor saved:",l),o(l)},onCancel:l=>{console.log(" Editor cancelled:",l),o(l)}});console.log(" FabricPhotoEditor instance created, calling show()..."),a.show().catch(l=>{console.error(" Error showing editor:",l),o({edited:!1})})})}catch(s){return console.error(" Error with bundled Fabric.js editor:",s),{edited:!1}}};return console.log(" Registering photo editor launcher..."),qy(t),window.launchPhotoEditor=t,console.log(" Photo editor launcher registered successfully"),()=>{console.log(" Cleaning up photo editor launcher..."),qy(null),window.launchPhotoEditor===t&&delete window.launchPhotoEditor}},[]),{takePicture:n,isTakingPicture:e}},wq=n=>{const[e,t]=b.useState(null),[r,s]=b.useState(!0),[i,o]=b.useState(null),a=b.useCallback(async()=>{if(!n){console.log(" useEventPhotosSectioned: No eventId provided");return}console.log(" useEventPhotosSectioned: Starting fetch for eventId:",n),s(!0),o(null);try{const{data:c}=await ue.auth.getSession(),u=c.session;if(!u)throw console.error(" useEventPhotosSectioned: Not authenticated"),new Error("Not authenticated");console.log(" useEventPhotosSectioned: Session valid, user:",u.user.id);const h="https://jgfcfdlfcnmaripgpepl.supabase.co",d="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImpnZmNmZGxmY25tYXJpcGdwZXBsIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTI1NDM2MjgsImV4cCI6MjA2ODExOTYyOH0.OmkqPDJM8-BKLDo5WxsL8Nop03XxAaygNaToOMKkzGY",p=`${h}/functions/v1/get-uploaded-photos?event_id=${n}&section=true&limit=100`;console.log(" useEventPhotosSectioned: Fetching from URL:",p);const m=await fetch(p,{method:"GET",headers:{Authorization:`Bearer ${u.access_token}`,apikey:d}});if(console.log(" useEventPhotosSectioned: Response status:",m.status,m.statusText),!m.ok){const x=await m.text();throw console.error(" useEventPhotosSectioned: Response not OK:",x),new Error(`Failed to fetch photos: ${m.status} ${x}`)}const g=await m.json();if(console.log(" useEventPhotosSectioned: Response data:",{success:g.success,totalCount:g.totalCount,otherPhotosCount:g.otherPhotosCount,myPhotosCount:g.myPhotosCount,hasOtherPhotos:!!g.otherPhotos,hasMyPhotos:!!g.myPhotos}),g.error)throw console.error(" useEventPhotosSectioned: API returned error:",g.error),new Error(g.error);const y={otherPhotos:g.otherPhotos||[],myPhotos:g.myPhotos||[],totalCount:g.totalCount||0,otherPhotosCount:g.otherPhotosCount||0,myPhotosCount:g.myPhotosCount||0};console.log(" useEventPhotosSectioned: Setting data:",{otherPhotos:y.otherPhotos.length,myPhotos:y.myPhotos.length,totalCount:y.totalCount}),t(y)}catch(c){console.error(" useEventPhotosSectioned: Error fetching sectioned photos:",c),o(c.message||"Failed to fetch photos")}finally{s(!1),console.log(" useEventPhotosSectioned: Fetch complete")}},[n]),l=b.useCallback(()=>{a()},[a]);return b.useEffect(()=>{a()},[a]),{otherPhotos:(e==null?void 0:e.otherPhotos)||[],myPhotos:(e==null?void 0:e.myPhotos)||[],totalCount:(e==null?void 0:e.totalCount)||0,otherPhotosCount:(e==null?void 0:e.otherPhotosCount)||0,myPhotosCount:(e==null?void 0:e.myPhotosCount)||0,loading:r,error:i,refetch:l,fetchPhotos:a}},bq=()=>{const[n,e]=b.useState([]),[t,r]=b.useState([]),s=b.useCallback((h,d)=>{d==="other"?e(p=>p.includes(h)?p.filter(m=>m!==h):[...p,h]):r(p=>p.includes(h)?p.filter(m=>m!==h):[...p,h])},[]),i=b.useCallback(h=>{e(h)},[]),o=b.useCallback(h=>{r(h)},[]),a=b.useCallback(()=>{e([]),r([])},[]),l=b.useCallback(()=>n.length+t.length,[n,t]),c=b.useCallback((h,d)=>d==="other"?n.includes(h):t.includes(h),[n,t]),u=b.useCallback(()=>[...n,...t],[n,t]);return{selectedOtherPhotos:n,selectedMyPhotos:t,togglePhoto:s,selectAllOther:i,selectAllMine:o,clearSelection:a,getSelectedCount:l,isPhotoSelected:c,getAllSelected:u}},YO=(n,e="")=>{const[t,r]=b.useState(e),[s,i]=b.useState(!0),o=b.useCallback(async()=>{try{const{data:{user:l}}=await ue.auth.getUser();if(!l){r(e),i(!1);return}const{data:c,error:u}=await ue.from("user_preferences").select("preference_value").eq("user_id",l.id).eq("preference_key",n).maybeSingle();u?(console.error("Error loading preference:",u),r(e)):r((c==null?void 0:c.preference_value)||e)}catch(l){console.error("Error in loadPreference:",l),r(e)}finally{i(!1)}},[n,e]),a=b.useCallback(async l=>{try{const{data:{user:c}}=await ue.auth.getUser();if(!c)return console.error("No user found"),!1;const{error:u}=await ue.from("user_preferences").upsert({user_id:c.id,preference_key:n,preference_value:l,updated_at:new Date().toISOString()},{onConflict:"user_id,preference_key"});return u?(console.error("Error saving preference:",u),!1):(r(l),!0)}catch(c){return console.error("Error in savePreference:",c),!1}},[n]);return b.useEffect(()=>{o()},[o]),{preference:t,loading:s,setPreference:a,reload:o}},_q=()=>{const[n,e]=b.useState(!1),{toast:t}=Bt(),{connectionType:r}=a1(),{preference:s}=YO("wifiOnlyDownloads","false"),i=b.useCallback(async(o,a)=>{if(a.length===0)return t({title:"No photos selected",description:"Please select photos to download",variant:"destructive"}),!1;if(s==="true"&&!(r==="wifi"))return!1;e(!0);try{console.log(`Starting bulk download of ${a.length} photos`);const{data:u}=await ue.auth.getSession(),h=u.session;if(!h)throw new Error("Not authenticated");const m=await fetch("https://jgfcfdlfcnmaripgpepl.supabase.co/functions/v1/bulk-download-photos",{method:"POST",headers:{Authorization:`Bearer ${h.access_token}`,"Content-Type":"application/json",apikey:"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImpnZmNmZGxmY25tYXJpcGdwZXBsIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTI1NDM2MjgsImV4cCI6MjA2ODExOTYyOH0.OmkqPDJM8-BKLDo5WxsL8Nop03XxAaygNaToOMKkzGY"},body:JSON.stringify({eventId:o,photoIds:a})});if(!m.ok){const _=await m.json();throw new Error(_.error||"Download failed")}const g=await m.blob(),y=m.headers.get("Content-Disposition");let x="photos.zip";if(y){const _=y.match(/filename="?(.+)"?/);_&&(x=_[1])}const v=window.URL.createObjectURL(g),w=document.createElement("a");return w.href=v,w.download=x,document.body.appendChild(w),w.click(),window.URL.revokeObjectURL(v),document.body.removeChild(w),t({title:"Download started",description:`Downloading ${a.length} photos as ${x}`}),!0}catch(u){return console.error("Bulk download error:",u),t({title:"Download failed",description:u.message||"Failed to download photos",variant:"destructive"}),!1}finally{e(!1)}},[r,s,t]);return{isDownloading:n,startDownload:i}},Sq=async()=>{try{return de.isNativePlatform()?{granted:!1,message:"This app needs camera access to take photos and scan QR codes.",needsPrompt:!0,canPrompt:!0}:{granted:!0,canPrompt:!0}}catch(n){return console.error("Error checking camera permissions:",n),{granted:!1,message:"Error checking camera permissions. Please try again.",canPrompt:!0}}},ax=async()=>{var n;try{if(!de.isNativePlatform())return{granted:!0};console.log(" Using AppPermissions plugin for camera permissions");try{const s=(n=window.Capacitor)==null?void 0:n.Plugins,i=s==null?void 0:s.AppPermissions;if(i&&i.requestCameraPermission){const o=await i.requestCameraPermission();return{granted:(o==null?void 0:o.granted)||!1,message:o!=null&&o.granted?void 0:(o==null?void 0:o.error)||"Camera permission required for photo capture",needsPrompt:!(o!=null&&o.granted)}}}catch(s){console.log(" AppPermissions plugin not available, falling back to Camera API:",s)}console.log(" Using Capacitor Camera API fallback for camera permissions");const{Camera:e}=await Ae(async()=>{const{Camera:s}=await Promise.resolve().then(()=>f1);return{Camera:s}},void 0),t=await e.checkPermissions();if(t.camera==="granted")return{granted:!0};if(t.camera==="denied")return{granted:!1,message:"Camera permission denied. Please enable in settings.",needsPrompt:!1,canPrompt:!1};const r=await e.requestPermissions({permissions:["camera"]});return{granted:r.camera==="granted",message:r.camera==="granted"?void 0:"Camera permission required for camera functionality",needsPrompt:r.camera!=="granted"}}catch(e){return console.error(" Error requesting camera permissions:",e),{granted:!1,message:e instanceof Error?e.message:"Failed to request camera permissions",needsPrompt:!0}}},am=async()=>{const n=await Sq();return n.granted?n:n.canPrompt&&n.needsPrompt?await ax():n},Cq=async()=>{try{if(!de.isNativePlatform())return console.log("Cannot open settings on web platform - permissions are handled by browser"),!1;if(de.getPlatform()==="ios")try{return window.open("app-settings:","_system"),!0}catch(n){return console.error("Failed to open iOS settings:",n),!1}if(de.getPlatform()==="android")try{const{NativeSettings:n,AndroidSettings:e}=await Ae(async()=>{const{NativeSettings:t,AndroidSettings:r}=await import("./index-BgDt9Bqt.js");return{NativeSettings:t,AndroidSettings:r}},[]);return await n.openAndroid({option:e.ApplicationDetails}),!0}catch(n){console.log("Native settings plugin failed:",n);try{const t="intent://package=app.lovable.6915f975bb6c42d0a28ad854c5271c90#Intent;action=android.settings.APPLICATION_DETAILS_SETTINGS;scheme=package;end";return window.location.href=t,!0}catch(e){console.error("Intent fallback failed:",e);try{return window.location.href="intent:#Intent;action=android.settings.MANAGE_APPLICATIONS_SETTINGS;end",!0}catch(t){return console.error("All Android methods failed:",t),!1}}}return!1}catch(n){return console.error("Error opening app settings:",n),!1}};var lm="focusScope.autoFocusOnMount",cm="focusScope.autoFocusOnUnmount",cE={bubbles:!1,cancelable:!0},Eq="FocusScope",j1=b.forwardRef((n,e)=>{const{loop:t=!1,trapped:r=!1,onMountAutoFocus:s,onUnmountAutoFocus:i,...o}=n,[a,l]=b.useState(null),c=tr(s),u=tr(i),h=b.useRef(null),d=ct(e,g=>l(g)),p=b.useRef({paused:!1,pause(){this.paused=!0},resume(){this.paused=!1}}).current;b.useEffect(()=>{if(r){let g=function(w){if(p.paused||!a)return;const _=w.target;a.contains(_)?h.current=_:Ti(h.current,{select:!0})},y=function(w){if(p.paused||!a)return;const _=w.relatedTarget;_!==null&&(a.contains(_)||Ti(h.current,{select:!0}))},x=function(w){if(document.activeElement===document.body)for(const S of w)S.removedNodes.length>0&&Ti(a)};document.addEventListener("focusin",g),document.addEventListener("focusout",y);const v=new MutationObserver(x);return a&&v.observe(a,{childList:!0,subtree:!0}),()=>{document.removeEventListener("focusin",g),document.removeEventListener("focusout",y),v.disconnect()}}},[r,a,p.paused]),b.useEffect(()=>{if(a){dE.add(p);const g=document.activeElement;if(!a.contains(g)){const x=new CustomEvent(lm,cE);a.addEventListener(lm,c),a.dispatchEvent(x),x.defaultPrevented||(kq(Oq(XO(a)),{select:!0}),document.activeElement===g&&Ti(a))}return()=>{a.removeEventListener(lm,c),setTimeout(()=>{const x=new CustomEvent(cm,cE);a.addEventListener(cm,u),a.dispatchEvent(x),x.defaultPrevented||Ti(g??document.body,{select:!0}),a.removeEventListener(cm,u),dE.remove(p)},0)}}},[a,c,u,p]);const m=b.useCallback(g=>{if(!t&&!r||p.paused)return;const y=g.key==="Tab"&&!g.altKey&&!g.ctrlKey&&!g.metaKey,x=document.activeElement;if(y&&x){const v=g.currentTarget,[w,_]=Pq(v);w&&_?!g.shiftKey&&x===_?(g.preventDefault(),t&&Ti(w,{select:!0})):g.shiftKey&&x===w&&(g.preventDefault(),t&&Ti(_,{select:!0})):x===v&&g.preventDefault()}},[t,r,p.paused]);return f.jsx(Le.div,{tabIndex:-1,...o,ref:d,onKeyDown:m})});j1.displayName=Eq;function kq(n,{select:e=!1}={}){const t=document.activeElement;for(const r of n)if(Ti(r,{select:e}),document.activeElement!==t)return}function Pq(n){const e=XO(n),t=uE(e,n),r=uE(e.reverse(),n);return[t,r]}function XO(n){const e=[],t=document.createTreeWalker(n,NodeFilter.SHOW_ELEMENT,{acceptNode:r=>{const s=r.tagName==="INPUT"&&r.type==="hidden";return r.disabled||r.hidden||s?NodeFilter.FILTER_SKIP:r.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;t.nextNode();)e.push(t.currentNode);return e}function uE(n,e){for(const t of n)if(!Tq(t,{upTo:e}))return t}function Tq(n,{upTo:e}){if(getComputedStyle(n).visibility==="hidden")return!0;for(;n;){if(e!==void 0&&n===e)return!1;if(getComputedStyle(n).display==="none")return!0;n=n.parentElement}return!1}function Aq(n){return n instanceof HTMLInputElement&&"select"in n}function Ti(n,{select:e=!1}={}){if(n&&n.focus){const t=document.activeElement;n.focus({preventScroll:!0}),n!==t&&Aq(n)&&e&&n.select()}}var dE=Dq();function Dq(){let n=[];return{add(e){const t=n[0];e!==t&&(t==null||t.pause()),n=hE(n,e),n.unshift(e)},remove(e){var t;n=hE(n,e),(t=n[0])==null||t.resume()}}}function hE(n,e){const t=[...n],r=t.indexOf(e);return r!==-1&&t.splice(r,1),t}function Oq(n){return n.filter(e=>e.tagName!=="A")}var um=0;function KO(){b.useEffect(()=>{const n=document.querySelectorAll("[data-radix-focus-guard]");return document.body.insertAdjacentElement("afterbegin",n[0]??fE()),document.body.insertAdjacentElement("beforeend",n[1]??fE()),um++,()=>{um===1&&document.querySelectorAll("[data-radix-focus-guard]").forEach(e=>e.remove()),um--}},[])}function fE(){const n=document.createElement("span");return n.setAttribute("data-radix-focus-guard",""),n.tabIndex=0,n.style.outline="none",n.style.opacity="0",n.style.position="fixed",n.style.pointerEvents="none",n}var hs=function(){return hs=Object.assign||function(e){for(var t,r=1,s=arguments.length;r<s;r++){t=arguments[r];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e},hs.apply(this,arguments)};function JO(n,e){var t={};for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&e.indexOf(r)<0&&(t[r]=n[r]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,r=Object.getOwnPropertySymbols(n);s<r.length;s++)e.indexOf(r[s])<0&&Object.prototype.propertyIsEnumerable.call(n,r[s])&&(t[r[s]]=n[r[s]]);return t}function Iq(n,e,t){if(t||arguments.length===2)for(var r=0,s=e.length,i;r<s;r++)(i||!(r in e))&&(i||(i=Array.prototype.slice.call(e,0,r)),i[r]=e[r]);return n.concat(i||Array.prototype.slice.call(e))}var bf="right-scroll-bar-position",_f="width-before-scroll-bar",Rq="with-scroll-bars-hidden",Nq="--removed-body-scroll-bar-size";function dm(n,e){return typeof n=="function"?n(e):n&&(n.current=e),n}function jq(n,e){var t=b.useState(function(){return{value:n,callback:e,facade:{get current(){return t.value},set current(r){var s=t.value;s!==r&&(t.value=r,t.callback(r,s))}}}})[0];return t.callback=e,t.facade}var Lq=typeof window<"u"?b.useLayoutEffect:b.useEffect,pE=new WeakMap;function Mq(n,e){var t=jq(null,function(r){return n.forEach(function(s){return dm(s,r)})});return Lq(function(){var r=pE.get(t);if(r){var s=new Set(r),i=new Set(n),o=t.current;s.forEach(function(a){i.has(a)||dm(a,null)}),i.forEach(function(a){s.has(a)||dm(a,o)})}pE.set(t,n)},[n]),t}function Fq(n){return n}function Bq(n,e){e===void 0&&(e=Fq);var t=[],r=!1,s={read:function(){if(r)throw new Error("Sidecar: could not `read` from an `assigned` medium. `read` could be used only with `useMedium`.");return t.length?t[t.length-1]:n},useMedium:function(i){var o=e(i,r);return t.push(o),function(){t=t.filter(function(a){return a!==o})}},assignSyncMedium:function(i){for(r=!0;t.length;){var o=t;t=[],o.forEach(i)}t={push:function(a){return i(a)},filter:function(){return t}}},assignMedium:function(i){r=!0;var o=[];if(t.length){var a=t;t=[],a.forEach(i),o=t}var l=function(){var u=o;o=[],u.forEach(i)},c=function(){return Promise.resolve().then(l)};c(),t={push:function(u){o.push(u),c()},filter:function(u){return o=o.filter(u),t}}}};return s}function Uq(n){n===void 0&&(n={});var e=Bq(null);return e.options=hs({async:!0,ssr:!1},n),e}var QO=function(n){var e=n.sideCar,t=JO(n,["sideCar"]);if(!e)throw new Error("Sidecar: please provide `sideCar` property to import the right car");var r=e.read();if(!r)throw new Error("Sidecar medium not found");return b.createElement(r,hs({},t))};QO.isSideCarExport=!0;function $q(n,e){return n.useMedium(e),QO}var ZO=Uq(),hm=function(){},R0=b.forwardRef(function(n,e){var t=b.useRef(null),r=b.useState({onScrollCapture:hm,onWheelCapture:hm,onTouchMoveCapture:hm}),s=r[0],i=r[1],o=n.forwardProps,a=n.children,l=n.className,c=n.removeScrollBar,u=n.enabled,h=n.shards,d=n.sideCar,p=n.noIsolation,m=n.inert,g=n.allowPinchZoom,y=n.as,x=y===void 0?"div":y,v=n.gapMode,w=JO(n,["forwardProps","children","className","removeScrollBar","enabled","shards","sideCar","noIsolation","inert","allowPinchZoom","as","gapMode"]),_=d,S=Mq([t,e]),E=hs(hs({},w),s);return b.createElement(b.Fragment,null,u&&b.createElement(_,{sideCar:ZO,removeScrollBar:c,shards:h,noIsolation:p,inert:m,setCallbacks:i,allowPinchZoom:!!g,lockRef:t,gapMode:v}),o?b.cloneElement(b.Children.only(a),hs(hs({},E),{ref:S})):b.createElement(x,hs({},E,{className:l,ref:S}),a))});R0.defaultProps={enabled:!0,removeScrollBar:!0,inert:!1};R0.classNames={fullWidth:_f,zeroRight:bf};var zq=function(){if(typeof __webpack_nonce__<"u")return __webpack_nonce__};function Wq(){if(!document)return null;var n=document.createElement("style");n.type="text/css";var e=zq();return e&&n.setAttribute("nonce",e),n}function Hq(n,e){n.styleSheet?n.styleSheet.cssText=e:n.appendChild(document.createTextNode(e))}function Vq(n){var e=document.head||document.getElementsByTagName("head")[0];e.appendChild(n)}var Gq=function(){var n=0,e=null;return{add:function(t){n==0&&(e=Wq())&&(Hq(e,t),Vq(e)),n++},remove:function(){n--,!n&&e&&(e.parentNode&&e.parentNode.removeChild(e),e=null)}}},qq=function(){var n=Gq();return function(e,t){b.useEffect(function(){return n.add(e),function(){n.remove()}},[e&&t])}},eI=function(){var n=qq(),e=function(t){var r=t.styles,s=t.dynamic;return n(r,s),null};return e},Yq={left:0,top:0,right:0,gap:0},fm=function(n){return parseInt(n||"",10)||0},Xq=function(n){var e=window.getComputedStyle(document.body),t=e[n==="padding"?"paddingLeft":"marginLeft"],r=e[n==="padding"?"paddingTop":"marginTop"],s=e[n==="padding"?"paddingRight":"marginRight"];return[fm(t),fm(r),fm(s)]},Kq=function(n){if(n===void 0&&(n="margin"),typeof window>"u")return Yq;var e=Xq(n),t=document.documentElement.clientWidth,r=window.innerWidth;return{left:e[0],top:e[1],right:e[2],gap:Math.max(0,r-t+e[2]-e[0])}},Jq=eI(),Pl="data-scroll-locked",Qq=function(n,e,t,r){var s=n.left,i=n.top,o=n.right,a=n.gap;return t===void 0&&(t="margin"),`
  .`.concat(Rq,` {
   overflow: hidden `).concat(r,`;
   padding-right: `).concat(a,"px ").concat(r,`;
  }
  body[`).concat(Pl,`] {
    overflow: hidden `).concat(r,`;
    overscroll-behavior: contain;
    `).concat([e&&"position: relative ".concat(r,";"),t==="margin"&&`
    padding-left: `.concat(s,`px;
    padding-top: `).concat(i,`px;
    padding-right: `).concat(o,`px;
    margin-left:0;
    margin-top:0;
    margin-right: `).concat(a,"px ").concat(r,`;
    `),t==="padding"&&"padding-right: ".concat(a,"px ").concat(r,";")].filter(Boolean).join(""),`
  }
  
  .`).concat(bf,` {
    right: `).concat(a,"px ").concat(r,`;
  }
  
  .`).concat(_f,` {
    margin-right: `).concat(a,"px ").concat(r,`;
  }
  
  .`).concat(bf," .").concat(bf,` {
    right: 0 `).concat(r,`;
  }
  
  .`).concat(_f," .").concat(_f,` {
    margin-right: 0 `).concat(r,`;
  }
  
  body[`).concat(Pl,`] {
    `).concat(Nq,": ").concat(a,`px;
  }
`)},gE=function(){var n=parseInt(document.body.getAttribute(Pl)||"0",10);return isFinite(n)?n:0},Zq=function(){b.useEffect(function(){return document.body.setAttribute(Pl,(gE()+1).toString()),function(){var n=gE()-1;n<=0?document.body.removeAttribute(Pl):document.body.setAttribute(Pl,n.toString())}},[])},eY=function(n){var e=n.noRelative,t=n.noImportant,r=n.gapMode,s=r===void 0?"margin":r;Zq();var i=b.useMemo(function(){return Kq(s)},[s]);return b.createElement(Jq,{styles:Qq(i,!e,s,t?"":"!important")})},lx=!1;if(typeof window<"u")try{var $h=Object.defineProperty({},"passive",{get:function(){return lx=!0,!0}});window.addEventListener("test",$h,$h),window.removeEventListener("test",$h,$h)}catch{lx=!1}var Ba=lx?{passive:!1}:!1,tY=function(n){return n.tagName==="TEXTAREA"},tI=function(n,e){if(!(n instanceof Element))return!1;var t=window.getComputedStyle(n);return t[e]!=="hidden"&&!(t.overflowY===t.overflowX&&!tY(n)&&t[e]==="visible")},nY=function(n){return tI(n,"overflowY")},rY=function(n){return tI(n,"overflowX")},mE=function(n,e){var t=e.ownerDocument,r=e;do{typeof ShadowRoot<"u"&&r instanceof ShadowRoot&&(r=r.host);var s=nI(n,r);if(s){var i=rI(n,r),o=i[1],a=i[2];if(o>a)return!0}r=r.parentNode}while(r&&r!==t.body);return!1},sY=function(n){var e=n.scrollTop,t=n.scrollHeight,r=n.clientHeight;return[e,t,r]},iY=function(n){var e=n.scrollLeft,t=n.scrollWidth,r=n.clientWidth;return[e,t,r]},nI=function(n,e){return n==="v"?nY(e):rY(e)},rI=function(n,e){return n==="v"?sY(e):iY(e)},oY=function(n,e){return n==="h"&&e==="rtl"?-1:1},aY=function(n,e,t,r,s){var i=oY(n,window.getComputedStyle(e).direction),o=i*r,a=t.target,l=e.contains(a),c=!1,u=o>0,h=0,d=0;do{var p=rI(n,a),m=p[0],g=p[1],y=p[2],x=g-y-i*m;(m||x)&&nI(n,a)&&(h+=x,d+=m),a instanceof ShadowRoot?a=a.host:a=a.parentNode}while(!l&&a!==document.body||l&&(e.contains(a)||e===a));return(u&&(Math.abs(h)<1||!s)||!u&&(Math.abs(d)<1||!s))&&(c=!0),c},zh=function(n){return"changedTouches"in n?[n.changedTouches[0].clientX,n.changedTouches[0].clientY]:[0,0]},vE=function(n){return[n.deltaX,n.deltaY]},yE=function(n){return n&&"current"in n?n.current:n},lY=function(n,e){return n[0]===e[0]&&n[1]===e[1]},cY=function(n){return`
  .block-interactivity-`.concat(n,` {pointer-events: none;}
  .allow-interactivity-`).concat(n,` {pointer-events: all;}
`)},uY=0,Ua=[];function dY(n){var e=b.useRef([]),t=b.useRef([0,0]),r=b.useRef(),s=b.useState(uY++)[0],i=b.useState(eI)[0],o=b.useRef(n);b.useEffect(function(){o.current=n},[n]),b.useEffect(function(){if(n.inert){document.body.classList.add("block-interactivity-".concat(s));var g=Iq([n.lockRef.current],(n.shards||[]).map(yE),!0).filter(Boolean);return g.forEach(function(y){return y.classList.add("allow-interactivity-".concat(s))}),function(){document.body.classList.remove("block-interactivity-".concat(s)),g.forEach(function(y){return y.classList.remove("allow-interactivity-".concat(s))})}}},[n.inert,n.lockRef.current,n.shards]);var a=b.useCallback(function(g,y){if("touches"in g&&g.touches.length===2||g.type==="wheel"&&g.ctrlKey)return!o.current.allowPinchZoom;var x=zh(g),v=t.current,w="deltaX"in g?g.deltaX:v[0]-x[0],_="deltaY"in g?g.deltaY:v[1]-x[1],S,E=g.target,C=Math.abs(w)>Math.abs(_)?"h":"v";if("touches"in g&&C==="h"&&E.type==="range")return!1;var P=mE(C,E);if(!P)return!0;if(P?S=C:(S=C==="v"?"h":"v",P=mE(C,E)),!P)return!1;if(!r.current&&"changedTouches"in g&&(w||_)&&(r.current=S),!S)return!0;var O=r.current||S;return aY(O,y,g,O==="h"?w:_,!0)},[]),l=b.useCallback(function(g){var y=g;if(!(!Ua.length||Ua[Ua.length-1]!==i)){var x="deltaY"in y?vE(y):zh(y),v=e.current.filter(function(S){return S.name===y.type&&(S.target===y.target||y.target===S.shadowParent)&&lY(S.delta,x)})[0];if(v&&v.should){y.cancelable&&y.preventDefault();return}if(!v){var w=(o.current.shards||[]).map(yE).filter(Boolean).filter(function(S){return S.contains(y.target)}),_=w.length>0?a(y,w[0]):!o.current.noIsolation;_&&y.cancelable&&y.preventDefault()}}},[]),c=b.useCallback(function(g,y,x,v){var w={name:g,delta:y,target:x,should:v,shadowParent:hY(x)};e.current.push(w),setTimeout(function(){e.current=e.current.filter(function(_){return _!==w})},1)},[]),u=b.useCallback(function(g){t.current=zh(g),r.current=void 0},[]),h=b.useCallback(function(g){c(g.type,vE(g),g.target,a(g,n.lockRef.current))},[]),d=b.useCallback(function(g){c(g.type,zh(g),g.target,a(g,n.lockRef.current))},[]);b.useEffect(function(){return Ua.push(i),n.setCallbacks({onScrollCapture:h,onWheelCapture:h,onTouchMoveCapture:d}),document.addEventListener("wheel",l,Ba),document.addEventListener("touchmove",l,Ba),document.addEventListener("touchstart",u,Ba),function(){Ua=Ua.filter(function(g){return g!==i}),document.removeEventListener("wheel",l,Ba),document.removeEventListener("touchmove",l,Ba),document.removeEventListener("touchstart",u,Ba)}},[]);var p=n.removeScrollBar,m=n.inert;return b.createElement(b.Fragment,null,m?b.createElement(i,{styles:cY(s)}):null,p?b.createElement(eY,{gapMode:n.gapMode}):null)}function hY(n){for(var e=null;n!==null;)n instanceof ShadowRoot&&(e=n.host,n=n.host),n=n.parentNode;return e}const fY=$q(ZO,dY);var L1=b.forwardRef(function(n,e){return b.createElement(R0,hs({},n,{ref:e,sideCar:fY}))});L1.classNames=R0.classNames;var pY=function(n){if(typeof document>"u")return null;var e=Array.isArray(n)?n[0]:n;return e.ownerDocument.body},$a=new WeakMap,Wh=new WeakMap,Hh={},pm=0,sI=function(n){return n&&(n.host||sI(n.parentNode))},gY=function(n,e){return e.map(function(t){if(n.contains(t))return t;var r=sI(t);return r&&n.contains(r)?r:(console.error("aria-hidden",t,"in not contained inside",n,". Doing nothing"),null)}).filter(function(t){return!!t})},mY=function(n,e,t,r){var s=gY(e,Array.isArray(n)?n:[n]);Hh[t]||(Hh[t]=new WeakMap);var i=Hh[t],o=[],a=new Set,l=new Set(s),c=function(h){!h||a.has(h)||(a.add(h),c(h.parentNode))};s.forEach(c);var u=function(h){!h||l.has(h)||Array.prototype.forEach.call(h.children,function(d){if(a.has(d))u(d);else try{var p=d.getAttribute(r),m=p!==null&&p!=="false",g=($a.get(d)||0)+1,y=(i.get(d)||0)+1;$a.set(d,g),i.set(d,y),o.push(d),g===1&&m&&Wh.set(d,!0),y===1&&d.setAttribute(t,"true"),m||d.setAttribute(r,"true")}catch(x){console.error("aria-hidden: cannot operate on ",d,x)}})};return u(e),a.clear(),pm++,function(){o.forEach(function(h){var d=$a.get(h)-1,p=i.get(h)-1;$a.set(h,d),i.set(h,p),d||(Wh.has(h)||h.removeAttribute(r),Wh.delete(h)),p||h.removeAttribute(t)}),pm--,pm||($a=new WeakMap,$a=new WeakMap,Wh=new WeakMap,Hh={})}},iI=function(n,e,t){t===void 0&&(t="data-aria-hidden");var r=Array.from(Array.isArray(n)?n:[n]),s=pY(n);return s?(r.push.apply(r,Array.from(s.querySelectorAll("[aria-live]"))),mY(r,s,t,"aria-hidden")):function(){return null}},M1="Dialog",[oI,aI]=xo(M1),[vY,rs]=oI(M1),lI=n=>{const{__scopeDialog:e,children:t,open:r,defaultOpen:s,onOpenChange:i,modal:o=!0}=n,a=b.useRef(null),l=b.useRef(null),[c=!1,u]=ti({prop:r,defaultProp:s,onChange:i});return f.jsx(vY,{scope:e,triggerRef:a,contentRef:l,contentId:Hs(),titleId:Hs(),descriptionId:Hs(),open:c,onOpenChange:u,onOpenToggle:b.useCallback(()=>u(h=>!h),[u]),modal:o,children:t})};lI.displayName=M1;var cI="DialogTrigger",uI=b.forwardRef((n,e)=>{const{__scopeDialog:t,...r}=n,s=rs(cI,t),i=ct(e,s.triggerRef);return f.jsx(Le.button,{type:"button","aria-haspopup":"dialog","aria-expanded":s.open,"aria-controls":s.contentId,"data-state":U1(s.open),...r,ref:i,onClick:De(n.onClick,s.onOpenToggle)})});uI.displayName=cI;var F1="DialogPortal",[yY,dI]=oI(F1,{forceMount:void 0}),hI=n=>{const{__scopeDialog:e,forceMount:t,children:r,container:s}=n,i=rs(F1,e);return f.jsx(yY,{scope:e,forceMount:t,children:b.Children.map(r,o=>f.jsx(wo,{present:t||i.open,children:f.jsx(Gp,{asChild:!0,container:s,children:o})}))})};hI.displayName=F1;var _p="DialogOverlay",fI=b.forwardRef((n,e)=>{const t=dI(_p,n.__scopeDialog),{forceMount:r=t.forceMount,...s}=n,i=rs(_p,n.__scopeDialog);return i.modal?f.jsx(wo,{present:r||i.open,children:f.jsx(xY,{...s,ref:e})}):null});fI.displayName=_p;var xY=b.forwardRef((n,e)=>{const{__scopeDialog:t,...r}=n,s=rs(_p,t);return f.jsx(L1,{as:ua,allowPinchZoom:!0,shards:[s.contentRef],children:f.jsx(Le.div,{"data-state":U1(s.open),...r,ref:e,style:{pointerEvents:"auto",...r.style}})})}),va="DialogContent",pI=b.forwardRef((n,e)=>{const t=dI(va,n.__scopeDialog),{forceMount:r=t.forceMount,...s}=n,i=rs(va,n.__scopeDialog);return f.jsx(wo,{present:r||i.open,children:i.modal?f.jsx(wY,{...s,ref:e}):f.jsx(bY,{...s,ref:e})})});pI.displayName=va;var wY=b.forwardRef((n,e)=>{const t=rs(va,n.__scopeDialog),r=b.useRef(null),s=ct(e,t.contentRef,r);return b.useEffect(()=>{const i=r.current;if(i)return iI(i)},[]),f.jsx(gI,{...n,ref:s,trapFocus:t.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:De(n.onCloseAutoFocus,i=>{var o;i.preventDefault(),(o=t.triggerRef.current)==null||o.focus()}),onPointerDownOutside:De(n.onPointerDownOutside,i=>{const o=i.detail.originalEvent,a=o.button===0&&o.ctrlKey===!0;(o.button===2||a)&&i.preventDefault()}),onFocusOutside:De(n.onFocusOutside,i=>i.preventDefault())})}),bY=b.forwardRef((n,e)=>{const t=rs(va,n.__scopeDialog),r=b.useRef(!1),s=b.useRef(!1);return f.jsx(gI,{...n,ref:e,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:i=>{var o,a;(o=n.onCloseAutoFocus)==null||o.call(n,i),i.defaultPrevented||(r.current||(a=t.triggerRef.current)==null||a.focus(),i.preventDefault()),r.current=!1,s.current=!1},onInteractOutside:i=>{var l,c;(l=n.onInteractOutside)==null||l.call(n,i),i.defaultPrevented||(r.current=!0,i.detail.originalEvent.type==="pointerdown"&&(s.current=!0));const o=i.target;((c=t.triggerRef.current)==null?void 0:c.contains(o))&&i.preventDefault(),i.detail.originalEvent.type==="focusin"&&s.current&&i.preventDefault()}})}),gI=b.forwardRef((n,e)=>{const{__scopeDialog:t,trapFocus:r,onOpenAutoFocus:s,onCloseAutoFocus:i,...o}=n,a=rs(va,t),l=b.useRef(null),c=ct(e,l);return KO(),f.jsxs(f.Fragment,{children:[f.jsx(j1,{asChild:!0,loop:!0,trapped:r,onMountAutoFocus:s,onUnmountAutoFocus:i,children:f.jsx(yd,{role:"dialog",id:a.contentId,"aria-describedby":a.descriptionId,"aria-labelledby":a.titleId,"data-state":U1(a.open),...o,ref:c,onDismiss:()=>a.onOpenChange(!1)})}),f.jsxs(f.Fragment,{children:[f.jsx(SY,{titleId:a.titleId}),f.jsx(EY,{contentRef:l,descriptionId:a.descriptionId})]})]})}),B1="DialogTitle",mI=b.forwardRef((n,e)=>{const{__scopeDialog:t,...r}=n,s=rs(B1,t);return f.jsx(Le.h2,{id:s.titleId,...r,ref:e})});mI.displayName=B1;var vI="DialogDescription",yI=b.forwardRef((n,e)=>{const{__scopeDialog:t,...r}=n,s=rs(vI,t);return f.jsx(Le.p,{id:s.descriptionId,...r,ref:e})});yI.displayName=vI;var xI="DialogClose",wI=b.forwardRef((n,e)=>{const{__scopeDialog:t,...r}=n,s=rs(xI,t);return f.jsx(Le.button,{type:"button",...r,ref:e,onClick:De(n.onClick,()=>s.onOpenChange(!1))})});wI.displayName=xI;function U1(n){return n?"open":"closed"}var bI="DialogTitleWarning",[_Y,_I]=Nj(bI,{contentName:va,titleName:B1,docsSlug:"dialog"}),SY=({titleId:n})=>{const e=_I(bI),t=`\`${e.contentName}\` requires a \`${e.titleName}\` for the component to be accessible for screen reader users.

If you want to hide the \`${e.titleName}\`, you can wrap it with our VisuallyHidden component.

For more information, see https://radix-ui.com/primitives/docs/components/${e.docsSlug}`;return b.useEffect(()=>{n&&(document.getElementById(n)||console.error(t))},[t,n]),null},CY="DialogDescriptionWarning",EY=({contentRef:n,descriptionId:e})=>{const r=`Warning: Missing \`Description\` or \`aria-describedby={undefined}\` for {${_I(CY).contentName}}.`;return b.useEffect(()=>{var i;const s=(i=n.current)==null?void 0:i.getAttribute("aria-describedby");e&&s&&(document.getElementById(e)||console.warn(r))},[r,n,e]),null},$1=lI,z1=uI,W1=hI,N0=fI,j0=pI,L0=mI,M0=yI,F0=wI;const Md=$1,kY=z1,PY=W1,SI=b.forwardRef(({className:n,...e},t)=>f.jsx(N0,{ref:t,className:Oe("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",n),...e}));SI.displayName=N0.displayName;const bc=b.forwardRef(({className:n,children:e,...t},r)=>{const s=b.useRef(null);return b.useEffect(()=>{const i=s.current;if(!i)return;const o=a=>{const l=a.target;(l.tagName==="INPUT"||l.tagName==="TEXTAREA"||l.contentEditable==="true")&&setTimeout(()=>{l.scrollIntoView({behavior:"smooth",block:"center",inline:"nearest"})},150)};return i.addEventListener("focusin",o),()=>{i.removeEventListener("focusin",o)}},[]),f.jsxs(PY,{children:[f.jsx(SI,{}),f.jsxs(j0,{ref:r,className:Oe("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg radix-dialog-content",n),...t,children:[f.jsx("div",{ref:s,className:"dialog-body overflow-auto -mx-6 px-6",children:e}),f.jsxs(F0,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground h-12 w-12 flex items-center justify-center z-10",children:[f.jsx(ha,{className:"h-6 w-6"}),f.jsx("span",{className:"sr-only",children:"Close"})]})]})]})});bc.displayName=j0.displayName;const _c=({className:n,...e})=>f.jsx("div",{className:Oe("flex flex-col space-y-1.5 text-center sm:text-left",n),...e});_c.displayName="DialogHeader";const TY=({className:n,...e})=>f.jsx("div",{className:Oe("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2 kb-safe-padding",n),...e});TY.displayName="DialogFooter";const Sc=b.forwardRef(({className:n,...e},t)=>f.jsx(L0,{ref:t,className:Oe("text-lg font-semibold leading-none tracking-tight",n),...e}));Sc.displayName=L0.displayName;const Cc=b.forwardRef(({className:n,...e},t)=>f.jsx(M0,{ref:t,className:Oe("text-sm text-muted-foreground",n),...e}));Cc.displayName=M0.displayName;const AY=({isOpen:n,onClose:e,onRequestPermission:t,onOpenSettings:r,message:s,canPrompt:i,title:o="Photo Library Access Required"})=>f.jsx(Md,{open:n,onOpenChange:e,children:f.jsxs(bc,{className:"sm:max-w-md w-[90vw] mx-auto",children:[f.jsxs(_c,{children:[f.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[f.jsx("div",{className:"p-1.5 bg-primary/10 rounded-full",children:f.jsx(ql,{className:"h-5 w-5 text-primary"})}),f.jsx(Sc,{className:"text-base",children:"Photo Library Access Required"})]}),f.jsx(Cc,{className:"text-base",children:"Please allow access to photos in your settings to use this feature."})]}),f.jsx("div",{className:"flex flex-col gap-3 mt-4",children:i?f.jsxs(_e,{onClick:t,className:"w-full",children:[f.jsx(ql,{className:"h-4 w-4 mr-2"}),"Allow Photo Library Access"]}):f.jsxs(_e,{onClick:r,className:"w-full",children:[f.jsx(Sw,{className:"h-4 w-4 mr-2"}),"Open Settings"]})})]})}),DY=({isOpen:n,onClose:e,onRequestPermission:t,onOpenSettings:r,message:s,canPrompt:i,title:o="Camera Access Required"})=>f.jsx(Md,{open:n,onOpenChange:e,children:f.jsxs(bc,{className:"sm:max-w-md w-[90vw] mx-auto",children:[f.jsxs(_c,{children:[f.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[f.jsx("div",{className:"p-1.5 bg-primary/10 rounded-full",children:f.jsx(kr,{className:"h-5 w-5 text-primary"})}),f.jsx(Sc,{className:"text-base",children:"Camera Access Required"})]}),f.jsx(Cc,{className:"text-base",children:"Please enable camera permissions in your settings to use this feature."})]}),f.jsx("div",{className:"flex flex-col gap-3 mt-4",children:i?f.jsxs(_e,{onClick:t,className:"w-full camera-button",children:[f.jsx(kr,{className:"h-4 w-4 mr-2"}),"Allow Camera Access"]}):f.jsxs(_e,{onClick:r,className:"w-full camera-button",children:[f.jsx(Sw,{className:"h-4 w-4 mr-2"}),"Open Settings"]})})]})}),OY=wd("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function Kr({className:n,variant:e,...t}){return f.jsx("div",{className:Oe(OY({variant:e}),n),...t})}function CI(n){const e=b.useRef({value:n,previous:n});return b.useMemo(()=>(e.current.value!==n&&(e.current.previous=e.current.value,e.current.value=n),e.current.previous),[n])}var H1="Switch",[IY,Lee]=xo(H1),[RY,NY]=IY(H1),EI=b.forwardRef((n,e)=>{const{__scopeSwitch:t,name:r,checked:s,defaultChecked:i,required:o,disabled:a,value:l="on",onCheckedChange:c,form:u,...h}=n,[d,p]=b.useState(null),m=ct(e,w=>p(w)),g=b.useRef(!1),y=d?u||!!d.closest("form"):!0,[x=!1,v]=ti({prop:s,defaultProp:i,onChange:c});return f.jsxs(RY,{scope:t,checked:x,disabled:a,children:[f.jsx(Le.button,{type:"button",role:"switch","aria-checked":x,"aria-required":o,"data-state":TI(x),"data-disabled":a?"":void 0,disabled:a,value:l,...h,ref:m,onClick:De(n.onClick,w=>{v(_=>!_),y&&(g.current=w.isPropagationStopped(),g.current||w.stopPropagation())})}),y&&f.jsx(jY,{control:d,bubbles:!g.current,name:r,value:l,checked:x,required:o,disabled:a,form:u,style:{transform:"translateX(-100%)"}})]})});EI.displayName=H1;var kI="SwitchThumb",PI=b.forwardRef((n,e)=>{const{__scopeSwitch:t,...r}=n,s=NY(kI,t);return f.jsx(Le.span,{"data-state":TI(s.checked),"data-disabled":s.disabled?"":void 0,...r,ref:e})});PI.displayName=kI;var jY=n=>{const{control:e,checked:t,bubbles:r=!0,...s}=n,i=b.useRef(null),o=CI(t),a=iA(e);return b.useEffect(()=>{const l=i.current,c=window.HTMLInputElement.prototype,h=Object.getOwnPropertyDescriptor(c,"checked").set;if(o!==t&&h){const d=new Event("click",{bubbles:r});h.call(l,t),l.dispatchEvent(d)}},[o,t,r]),f.jsx("input",{type:"checkbox","aria-hidden":!0,defaultChecked:t,...s,tabIndex:-1,ref:i,style:{...n.style,...a,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})};function TI(n){return n?"checked":"unchecked"}var AI=EI,LY=PI;const Tl=b.forwardRef(({className:n,...e},t)=>f.jsx(AI,{className:Oe("peer inline-flex h-12 w-20 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=unchecked]:bg-input",n),...e,ref:t,children:f.jsx(LY,{className:Oe("pointer-events-none block h-10 w-10 rounded-full bg-background shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-8 data-[state=unchecked]:translate-x-0")})}));Tl.displayName=AI.displayName;const MY=({eventId:n,onSettingsChange:e}={})=>{const{user:t}=Or(),r=b.useCallback(i=>{console.log(" Auto-upload settings changed:",i),e==null||e(i);const o=document.querySelector("iframe[data-mobile-frame]");o&&o.contentWindow&&o.contentWindow.postMessage({type:"AUTO_UPLOAD_SETTINGS_CHANGED",data:i},"*")},[e]);return b.useEffect(()=>{if(!(t!=null&&t.id)||!n)return;console.log(" Setting up auto-upload sync for user:",t.id,"event:",n);const i=ue.channel(`user_auto_upload_${t.id}`).on("postgres_changes",{event:"UPDATE",schema:"public",table:"event_participants",filter:`user_id=eq.${t.id}`},o=>{if(console.log(" Received auto-upload update:",o),o.new&&o.new.event_id===n){const a={event_id:o.new.event_id,user_id:o.new.user_id,auto_upload_enabled:o.new.auto_upload_enabled,auto_upload_start_time:o.new.auto_upload_start_time,auto_upload_end_time:o.new.auto_upload_end_time,timestamp:new Date().toISOString()};r(a)}}).subscribe();return()=>{console.log(" Cleaning up auto-upload sync"),ue.removeChannel(i)}},[t==null?void 0:t.id,n,r]),{updateAutoUploadSettings:b.useCallback(async(i,o,a)=>{if(!(t!=null&&t.id)||!n)return!1;try{console.log(" Updating auto-upload settings:",{enabled:i,startTime:o,endTime:a});const{data:l,error:c}=await ue.rpc("update_auto_upload_settings",{event_uuid:n,enabled:i,start_time:i&&o?new Date(o).toISOString():null,end_time:i&&a?new Date(a).toISOString():null});if(c)throw console.error(" Error updating auto-upload settings:",c),c;return console.log(" Auto-upload settings updated successfully"),l}catch(l){throw console.error(" Failed to update auto-upload settings:",l),l}},[t==null?void 0:t.id,n])}},B0=Pn("PushNotifications",{});var xE;(function(n){n[n.Min=1]="Min",n[n.Low=2]="Low",n[n.Default=3]="Default",n[n.High=4]="High",n[n.Max=5]="Max"})(xE||(xE={}));var wE;(function(n){n[n.Secret=-1]="Secret",n[n.Private=0]="Private",n[n.Public=1]="Public"})(wE||(wE={}));const U0=Pn("FirebaseMessaging",{web:()=>Ae(()=>import("./web-DzajsMRg.js"),[]).then(n=>new n.FirebaseMessagingWeb)}),ci=()=>de.isNativePlatform()?de.getPlatform()==="ios"?"ios":"android":"web",DI=async()=>{const n=ci();try{return n==="android"?{granted:(await U0.requestPermissions()).receive==="granted"}:n==="ios"?{granted:(await B0.requestPermissions()).receive==="granted"}:"Notification"in window?{granted:await Notification.requestPermission()==="granted"}:{granted:!0}}catch(e){return{granted:!1,error:e.message||"Permission request failed"}}},FY=async()=>{const n=ci();try{return n==="android"?await U0.checkPermissions():n==="ios"?await B0.checkPermissions():{receive:"granted"}}catch(e){return console.error("Error checking permissions:",e),{receive:"prompt"}}},BY=async()=>{if(ci()==="android")try{return{token:(await U0.getToken()).token,platform:"android"}}catch(e){return console.error("Error getting Android FCM token:",e),null}return null},UY=async()=>{ci()==="ios"&&await B0.register()},$Y=()=>ci()==="android"?{tokenReceived:"tokenReceived",notificationReceived:"notificationReceived",notificationActionPerformed:"notificationActionPerformed",error:"error"}:{tokenReceived:"registration",notificationReceived:"pushNotificationReceived",notificationActionPerformed:"pushNotificationActionPerformed",error:"registrationError"},Vh=async(n,e)=>{const t=ci(),s=$Y()[n];return t==="android"?await U0.addListener(s,e):t==="ios"?await B0.addListener(s,e):{remove:()=>{}}},zY=n=>ci()==="android"?n.token:n.value,WY=()=>new Promise(n=>{var r;if((r=window.Capacitor)!=null&&r.Plugins){n();return}let e=0;const t=setInterval(()=>{var s;e++,(s=window.Capacitor)!=null&&s.Plugins?(clearInterval(t),console.log(" Capacitor plugins ready after",e*50,"ms"),n()):e>100&&(clearInterval(t),console.warn(" Capacitor plugins timeout - proceeding anyway"),n())},50)}),OI=()=>{const[n,e]=b.useState("prompt"),[t,r]=b.useState("prompt"),[s,i]=b.useState("prompt"),[o,a]=b.useState(!0),[l,c]=b.useState(!1),u=async()=>{var d,p;try{console.log(" Checking permission statuses..."),a(!0),await WY(),console.log(" Capacitor ready, checking platform...");const m=de.isNativePlatform();if(c(m),!m){console.log(" Web platform detected - skipping permission checks"),e("granted"),r("granted"),i("granted"),a(!1);return}const g=de.getPlatform();console.log(` Native ${g} detected - checking permissions...`);const y=(p=(d=window.Capacitor)==null?void 0:d.Plugins)==null?void 0:p.AppPermissions;if(y!=null&&y.hasCompletedOnboarding)try{const x=await y.hasCompletedOnboarding();if(x!=null&&x.completed){console.log(" Onboarding completed - all permissions granted"),e("granted"),r("granted"),i("granted"),a(!1);return}}catch(x){console.warn(" Could not check onboarding status:",x)}try{if(y!=null&&y.checkNotificationPermission){const x=await y.checkNotificationPermission();console.log(" Notification permission status:",x.status),e(x.status)}else{const x=await FY(),v=x.receive==="granted"?"granted":x.receive==="denied"?"denied":"prompt";console.log(" Notification permission status (fallback):",v),e(v)}}catch(x){console.warn(" Could not check notification permission:",x),e("prompt")}try{if(y!=null&&y.checkCameraPermission){const x=await y.checkCameraPermission(),v=x.status||x.permission||"prompt";console.log(" Camera permission status:",v),r(v)}else console.log(" Camera permission check plugin not available"),r("prompt")}catch(x){console.warn(" Could not check camera permission:",x),r("prompt")}try{if(y!=null&&y.checkPhotoPermission){const x=await y.checkPhotoPermission(),v=x.status||x.permission||"prompt";console.log(" Photo permission status:",v),i(v)}else console.log(" Photo permission check plugin not available"),i("prompt")}catch(x){console.warn(" Could not check photo permission:",x),i("prompt")}console.log(" Permission check complete")}catch(m){console.error(" Error checking permissions:",m)}finally{a(!1)}};return b.useEffect(()=>{u()},[]),{notifications:n,camera:t,photos:s,isLoading:o,hasAllPermissions:l?n==="granted"&&t==="granted"&&s==="granted":!0,refresh:u}},HY=({eventId:n,eventName:e,eventStartTime:t,eventEndTime:r,variant:s="card"})=>{const{toast:i}=Bt(),{user:o}=Or(),{updateAutoUploadSettings:a}=MY({eventId:n}),{settings:l,loading:c,currentEventId:u,setEventContext:h,clearEventContext:d,checkCanUploadNow:p,networkStatus:m}=JW(),{photos:g,isLoading:y}=OI(),[x,v]=b.useState(!1),[w,_]=b.useState(!1),S=p(),E=de.isNativePlatform();b.useEffect(()=>{(async()=>{if(!o||!n)return;const{supabase:R}=await Ae(async()=>{const{supabase:I}=await Promise.resolve().then(()=>bU);return{supabase:I}},void 0),{data:B}=await R.from("event_participants").select("auto_upload_enabled").eq("event_id",n).eq("user_id",o.id).maybeSingle();B&&_(B.auto_upload_enabled||!1)})()},[n,o]),b.useEffect(()=>(n&&l.autoUploadEnabled&&w&&!y&&g==="granted"&&(h(n,e,t,r),v(!0)),()=>{x&&(d(),v(!1))}),[n,l.autoUploadEnabled,w,e,t,r,g,y]);const C=async()=>{if(!E){i({title:"Mobile App Required",description:"Auto-upload is only available on the mobile app. Install the iOS or Android app to use this feature.",variant:"default"});return}if(!o)return;const A=!w;try{await a(A,t,r),_(A),A&&l.autoUploadEnabled?(await h(n,e,t,r),v(!0),i({title:"Auto-Upload Enabled",description:"Photos will be automatically uploaded for this event."})):(await d(),v(!1),i({title:"Auto-Upload Disabled",description:"Auto-upload has been disabled for this event."}))}catch(R){console.error("Failed to update auto-upload settings:",R),i({title:"Error",description:"Failed to update auto-upload settings",variant:"destructive"})}},P=()=>{if(!w)return"Auto-upload disabled for this event";if(!l.autoUploadEnabled)return"Auto-upload disabled globally";if(y)return"Checking permissions...";if(g!=="granted")return"Photo permission required";if(!S.canUpload)switch(S.reason){case"wifi_required":return"Waiting for WiFi connection";case"no_network":return"No internet connection";default:return"Auto-upload paused"}return"Auto-upload active"},O=()=>{if(!w||!l.autoUploadEnabled)return f.jsx(da,{className:"h-4 w-4 text-muted-foreground"});if(y)return f.jsx(da,{className:"h-4 w-4 text-muted-foreground animate-pulse"});if(g!=="granted")return f.jsx(uy,{className:"h-4 w-4 text-amber-500"});if(!S.canUpload)switch(S.reason){case"wifi_required":return f.jsx(Yf,{className:"h-4 w-4 text-orange-500"});case"no_network":return f.jsx(Yf,{className:"h-4 w-4 text-red-500"});default:return f.jsx(uy,{className:"h-4 w-4 text-orange-500"})}return m.isWifi?f.jsx(LL,{className:"h-4 w-4 text-green-500"}):f.jsx(FT,{className:"h-4 w-4 text-blue-500"})};return s==="compact"?f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx(Tl,{checked:w,onCheckedChange:C,disabled:c||!E}),f.jsxs("div",{className:"flex items-center gap-1",children:[O(),f.jsx("span",{className:"text-xs text-muted-foreground",children:"Auto-Upload"})]})]}):s==="inline"?f.jsxs("div",{className:"flex items-center justify-between p-3 bg-muted/30 rounded-lg",children:[f.jsxs("div",{className:"flex items-center gap-2",children:[O(),f.jsxs("div",{children:[f.jsx(js,{htmlFor:`auto-upload-${n}`,className:"text-sm font-medium cursor-pointer",children:"Auto-Upload"}),f.jsx("p",{className:"text-xs text-muted-foreground",children:P()})]})]}),f.jsx(Tl,{id:`auto-upload-${n}`,checked:w,onCheckedChange:C,disabled:c||!E})]}):f.jsx(Ht,{className:"w-full",children:f.jsx(Qt,{className:"p-4",children:f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsxs("div",{className:"flex items-center gap-3",children:[O(),f.jsxs("div",{children:[f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx(js,{htmlFor:`auto-upload-card-${n}`,className:"text-sm font-medium cursor-pointer",children:"Auto-Upload Photos"}),!E&&f.jsx(Kr,{variant:"secondary",className:"text-xs",children:"Mobile Only"})]}),f.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:P()}),l.wifiOnlyUpload&&f.jsx("p",{className:"text-xs text-muted-foreground",children:"WiFi only mode enabled"})]})]}),f.jsx("div",{className:"flex items-center gap-2",children:E?f.jsx(Tl,{id:`auto-upload-card-${n}`,checked:w,onCheckedChange:C,disabled:c}):f.jsxs(_e,{variant:"outline",size:"sm",onClick:()=>i({title:"Mobile App Required",description:"Install the mobile app to use auto-upload features."}),children:[f.jsx(Sw,{className:"h-4 w-4 mr-1"}),"Get App"]})})]})})})},II=async()=>{var n;try{if(!de.isNativePlatform())return{granted:!0,canPrompt:!0};console.log(" Checking photo permissions...");try{const r=(n=window.Capacitor)==null?void 0:n.Plugins,s=r==null?void 0:r.AppPermissions;if(s&&s.checkPhotoPermission){const i=await s.checkPhotoPermission(),o=(i==null?void 0:i.status)||(i==null?void 0:i.permission);return o==="granted"?{granted:!0}:o==="denied"?{granted:!1,message:"Photo library permission denied. Please enable in settings.",needsPrompt:!1,canPrompt:!1}:{granted:!1,message:"This app needs photo library access to select photos for upload.",needsPrompt:!0,canPrompt:!0}}}catch(r){console.log(" AppPermissions plugin not available, falling back to Camera API:",r)}console.log(" Using Capacitor Camera API fallback for checking permissions");const{Camera:e}=await Ae(async()=>{const{Camera:r}=await Promise.resolve().then(()=>f1);return{Camera:r}},void 0),t=await e.checkPermissions();return t.photos==="granted"?{granted:!0}:t.photos==="denied"?{granted:!1,message:"Photo library permission denied. Please enable in settings.",needsPrompt:!1,canPrompt:!1}:{granted:!1,message:"This app needs photo library access to select photos for upload.",needsPrompt:!0,canPrompt:!0}}catch(e){return console.error("Error checking photo permissions:",e),{granted:!1,message:"Error checking photo permissions. Please try again.",canPrompt:!0}}},cx=async()=>{var n;try{if(!de.isNativePlatform())return{granted:!0};console.log(" Using AppPermissions plugin for photo permissions");try{const s=(n=window.Capacitor)==null?void 0:n.Plugins,i=s==null?void 0:s.AppPermissions;if(i&&i.requestPhotoPermission){const o=await i.requestPhotoPermission();return{granted:(o==null?void 0:o.granted)||!1,message:o!=null&&o.granted?void 0:(o==null?void 0:o.error)||"Photo library permission required for photo selection",needsPrompt:!(o!=null&&o.granted)}}}catch(s){console.log(" AppPermissions plugin not available, falling back to Camera API:",s)}console.log(" Using Capacitor Camera API fallback for photo permissions");const{Camera:e}=await Ae(async()=>{const{Camera:s}=await Promise.resolve().then(()=>f1);return{Camera:s}},void 0),t=await e.checkPermissions();if(t.photos==="granted")return{granted:!0};if(t.photos==="denied")return{granted:!1,message:"Photo library permission denied. Please enable in settings.",needsPrompt:!1,canPrompt:!1};const r=await e.requestPermissions({permissions:["photos"]});return{granted:r.photos==="granted",message:r.photos==="granted"?void 0:"Photo library permission required for photo selection",needsPrompt:r.photos!=="granted"}}catch(e){return console.error(" Error requesting photo permissions:",e),{granted:!1,message:e instanceof Error?e.message:"Failed to request photo permissions",needsPrompt:!0}}},VY=async()=>{const n=await II();return n.granted?n:n.canPrompt&&n.needsPrompt?await cx():n},GY=async()=>{try{return de.isNativePlatform()?de.getPlatform()==="ios"?(window.open("app-settings:","_system"),!0):de.getPlatform()==="android"?(window.open("intent:#Intent;action=android.settings.APPLICATION_DETAILS_SETTINGS;data=package:app.lovable.6915f975bb6c42d0a28ad854c5271c90;end","_system"),!0):!1:(console.log("Cannot open settings on web platform"),!1)}catch(n){return console.error("Error opening app settings:",n),!1}},RI="/assets/default-header-Co1pc_20.png";var qY="Toggle",NI=b.forwardRef((n,e)=>{const{pressed:t,defaultPressed:r=!1,onPressedChange:s,...i}=n,[o=!1,a]=ti({prop:t,onChange:s,defaultProp:r});return f.jsx(Le.button,{type:"button","aria-pressed":o,"data-state":o?"on":"off","data-disabled":n.disabled?"":void 0,...i,ref:e,onClick:De(n.onClick,()=>{n.disabled||a(!o)})})});NI.displayName=qY;var jI=NI;const YY=wd("inline-flex items-center justify-center rounded-md text-sm font-medium ring-offset-background transition-colors hover:bg-muted hover:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=on]:bg-accent data-[state=on]:text-accent-foreground",{variants:{variant:{default:"bg-transparent",outline:"border border-input bg-transparent hover:bg-accent hover:text-accent-foreground"},size:{default:"h-12 px-3",sm:"h-12 px-2.5",lg:"h-12 px-5"}},defaultVariants:{variant:"default",size:"default"}}),LI=b.forwardRef(({className:n,variant:e,size:t,...r},s)=>f.jsx(jI,{ref:s,className:Oe(YY({variant:e,size:t,className:n})),...r}));LI.displayName=jI.displayName;var V1="Collapsible",[XY,Mee]=xo(V1),[KY,G1]=XY(V1),MI=b.forwardRef((n,e)=>{const{__scopeCollapsible:t,open:r,defaultOpen:s,disabled:i,onOpenChange:o,...a}=n,[l=!1,c]=ti({prop:r,defaultProp:s,onChange:o});return f.jsx(KY,{scope:t,disabled:i,contentId:Hs(),open:l,onOpenToggle:b.useCallback(()=>c(u=>!u),[c]),children:f.jsx(Le.div,{"data-state":Y1(l),"data-disabled":i?"":void 0,...a,ref:e})})});MI.displayName=V1;var FI="CollapsibleTrigger",BI=b.forwardRef((n,e)=>{const{__scopeCollapsible:t,...r}=n,s=G1(FI,t);return f.jsx(Le.button,{type:"button","aria-controls":s.contentId,"aria-expanded":s.open||!1,"data-state":Y1(s.open),"data-disabled":s.disabled?"":void 0,disabled:s.disabled,...r,ref:e,onClick:De(n.onClick,s.onOpenToggle)})});BI.displayName=FI;var q1="CollapsibleContent",UI=b.forwardRef((n,e)=>{const{forceMount:t,...r}=n,s=G1(q1,n.__scopeCollapsible);return f.jsx(wo,{present:t||s.open,children:({present:i})=>f.jsx(JY,{...r,ref:e,present:i})})});UI.displayName=q1;var JY=b.forwardRef((n,e)=>{const{__scopeCollapsible:t,present:r,children:s,...i}=n,o=G1(q1,t),[a,l]=b.useState(r),c=b.useRef(null),u=ct(e,c),h=b.useRef(0),d=h.current,p=b.useRef(0),m=p.current,g=o.open||a,y=b.useRef(g),x=b.useRef();return b.useEffect(()=>{const v=requestAnimationFrame(()=>y.current=!1);return()=>cancelAnimationFrame(v)},[]),vn(()=>{const v=c.current;if(v){x.current=x.current||{transitionDuration:v.style.transitionDuration,animationName:v.style.animationName},v.style.transitionDuration="0s",v.style.animationName="none";const w=v.getBoundingClientRect();h.current=w.height,p.current=w.width,y.current||(v.style.transitionDuration=x.current.transitionDuration,v.style.animationName=x.current.animationName),l(r)}},[o.open,r]),f.jsx(Le.div,{"data-state":Y1(o.open),"data-disabled":o.disabled?"":void 0,id:o.contentId,hidden:!g,...i,ref:u,style:{"--radix-collapsible-content-height":d?`${d}px`:void 0,"--radix-collapsible-content-width":m?`${m}px`:void 0,...n.style},children:g&&s})});function Y1(n){return n?"open":"closed"}var QY=MI;const ux=QY,dx=BI,hx=UI,bE={enabled:!1,upcomingEvent:!0,eventStarting:!0,uploadPhotos:!0,downloadPhotos:!0},_E="push_notification_preferences",X1=()=>{var h;const[n,e]=b.useState(bE),[t,r]=b.useState(!0),s=((h=window.CapacitorPushNotifications)==null?void 0:h.isRegistered())||!1,{toast:i}=Bt();b.useEffect(()=>{const d=localStorage.getItem(_E);if(d)try{const p=JSON.parse(d);e({...bE,...p})}catch(p){console.error("Error parsing notification preferences:",p)}r(!1)},[]);const o=b.useCallback(d=>{localStorage.setItem(_E,JSON.stringify(d)),e(d);const p=localStorage.getItem("push_token");p&&de.isNativePlatform()&&a(p,d)},[]),a=async(d,p)=>{try{console.log("Syncing notification preferences with Firebase:",{token:d,preferences:p,platform:de.getPlatform(),timestamp:new Date().toISOString()});const m=JSON.parse(localStorage.getItem("firebase_notification_preferences")||"{}");m[d]={...p,lastUpdated:new Date().toISOString(),platform:de.getPlatform()},localStorage.setItem("firebase_notification_preferences",JSON.stringify(m))}catch(m){console.error("Error syncing preferences with Firebase:",m)}};return{preferences:n,isLoading:t,isRegistered:s,toggleNotifications:async d=>{var m,g,y,x,v,w,_;if(d&&!s){let S="prompt";try{(y=(g=(m=window.Capacitor)==null?void 0:m.Plugins)==null?void 0:g.AppPermissions)!=null&&y.checkNotificationPermission&&(S=(await window.Capacitor.Plugins.AppPermissions.checkNotificationPermission()).status,console.log(" Event notification: Current permission status:",S))}catch(E){console.log(" Could not check notification permission status:",E)}if(S==="granted")console.log(" Notifications already granted, proceeding without re-requesting");else{if(S==="denied")return i({title:"Permission denied",description:"Please enable notifications in your device settings.",variant:"destructive"}),!1;{let E=!1;try{const C=await((w=(v=(x=window.Capacitor)==null?void 0:x.Plugins)==null?void 0:v.AppPermissions)==null?void 0:w.requestNotificationPermission());E=(C==null?void 0:C.granted)||!1,console.log("AppPermissions notification result:",C)}catch(C){if(console.log("AppPermissions plugin not available, trying fallback:",C),de.isNativePlatform()&&de.getPlatform()==="ios"&&window.useMobileTokenHandler)try{const P=await window.useMobileTokenHandler.requestPermissionAndGetToken();E=P.success===!0,console.log("iOS FCM result:",P)}catch(P){console.error("iOS FCM failed:",P),E=!1}else E=await((_=window.CapacitorPushNotifications)==null?void 0:_.requestPermissions())||!1}if(!E)return i({title:"Permission denied",description:"Please enable notifications in your device settings.",variant:"destructive"}),!1}}}const p={...n,enabled:d};return o(p),i(d?{title:"Notifications enabled",description:"You'll receive event notifications based on your preferences."}:{title:"Notifications disabled",description:"You won't receive any push notifications."}),!0},toggleNotificationType:(d,p)=>{const m={...n,[d]:p};o(m)},getNotificationSchedule:(d,p,m,g)=>{if(!n.enabled)return null;const y=[],x=new Date(m),v=new Date(g);if(n.upcomingEvent){const w=new Date(x.getTime()-18e5);y.push({type:"upcoming_event",scheduledTime:w.toISOString(),title:` ${p} starts soon!`,body:"Event begins in 30 minutes. Get ready to capture memories!",data:{eventId:d,eventName:p,type:"upcoming_event"}})}if(n.eventStarting&&y.push({type:"event_starting",scheduledTime:x.toISOString(),title:` ${p} is now LIVE!`,body:"Start taking photos and sharing your moments!",data:{eventId:d,eventName:p,type:"event_starting"}}),n.uploadPhotos){const w=new Date(v.getTime()-9e5);y.push({type:"upload_reminder",scheduledTime:w.toISOString(),title:` Upload your photos to ${p}`,body:"Don't forget to share your moments! Event ends soon.",data:{eventId:d,eventName:p,type:"upload_reminder"}})}if(n.downloadPhotos){const w=new Date(v.getTime()+36e5);y.push({type:"download_reminder",scheduledTime:w.toISOString(),title:` Download photos from ${p}`,body:"Check out all the amazing moments captured at the event!",data:{eventId:d,eventName:p,type:"download_reminder"}})}return y},syncPreferencesWithFirebase:d=>a(d,n)}};var SE;(function(n){n[n.Sunday=1]="Sunday",n[n.Monday=2]="Monday",n[n.Tuesday=3]="Tuesday",n[n.Wednesday=4]="Wednesday",n[n.Thursday=5]="Thursday",n[n.Friday=6]="Friday",n[n.Saturday=7]="Saturday"})(SE||(SE={}));const No=Pn("LocalNotifications",{web:()=>Ae(()=>import("./web-DNG07GLV.js"),[]).then(n=>new n.LocalNotificationsWeb)});function ht(n){const e=Object.prototype.toString.call(n);return n instanceof Date||typeof n=="object"&&e==="[object Date]"?new n.constructor(+n):typeof n=="number"||e==="[object Number]"||typeof n=="string"||e==="[object String]"?new Date(n):new Date(NaN)}function ws(n,e){return n instanceof Date?new n.constructor(e):new Date(e)}function gm(n,e){const t=ht(n);return isNaN(e)?ws(n,NaN):(e&&t.setDate(t.getDate()+e),t)}function $I(n,e){const t=+ht(n);return ws(n,t+e)}const zI=6048e5,ZY=864e5,eX=6e4,tX=36e5,Gh=43200,CE=1440;function nX(n,e){return $I(n,e*tX)}let rX={};function Ec(){return rX}function ud(n,e){var a,l,c,u;const t=Ec(),r=(e==null?void 0:e.weekStartsOn)??((l=(a=e==null?void 0:e.locale)==null?void 0:a.options)==null?void 0:l.weekStartsOn)??t.weekStartsOn??((u=(c=t.locale)==null?void 0:c.options)==null?void 0:u.weekStartsOn)??0,s=ht(n),i=s.getDay(),o=(i<r?7:0)+i-r;return s.setDate(s.getDate()-o),s.setHours(0,0,0,0),s}function Sp(n){return ud(n,{weekStartsOn:1})}function WI(n){const e=ht(n),t=e.getFullYear(),r=ws(n,0);r.setFullYear(t+1,0,4),r.setHours(0,0,0,0);const s=Sp(r),i=ws(n,0);i.setFullYear(t,0,4),i.setHours(0,0,0,0);const o=Sp(i);return e.getTime()>=s.getTime()?t+1:e.getTime()>=o.getTime()?t:t-1}function EE(n){const e=ht(n);return e.setHours(0,0,0,0),e}function Cp(n){const e=ht(n),t=new Date(Date.UTC(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds()));return t.setUTCFullYear(e.getFullYear()),+n-+t}function sX(n,e){const t=EE(n),r=EE(e),s=+t-Cp(t),i=+r-Cp(r);return Math.round((s-i)/ZY)}function iX(n){const e=WI(n),t=ws(n,0);return t.setFullYear(e,0,4),t.setHours(0,0,0,0),Sp(t)}function oX(n,e){return $I(n,e*eX)}function Sf(n,e){const t=ht(n),r=ht(e),s=t.getTime()-r.getTime();return s<0?-1:s>0?1:s}function aX(n){return ws(n,Date.now())}function lX(n){return n instanceof Date||typeof n=="object"&&Object.prototype.toString.call(n)==="[object Date]"}function cX(n){if(!lX(n)&&typeof n!="number")return!1;const e=ht(n);return!isNaN(Number(e))}function uX(n,e){const t=ht(n),r=ht(e),s=t.getFullYear()-r.getFullYear(),i=t.getMonth()-r.getMonth();return s*12+i}function dX(n){return e=>{const r=(n?Math[n]:Math.trunc)(e);return r===0?0:r}}function hX(n,e){return+ht(n)-+ht(e)}function fX(n){const e=ht(n);return e.setHours(23,59,59,999),e}function pX(n){const e=ht(n),t=e.getMonth();return e.setFullYear(e.getFullYear(),t+1,0),e.setHours(23,59,59,999),e}function gX(n){const e=ht(n);return+fX(e)==+pX(e)}function mX(n,e){const t=ht(n),r=ht(e),s=Sf(t,r),i=Math.abs(uX(t,r));let o;if(i<1)o=0;else{t.getMonth()===1&&t.getDate()>27&&t.setDate(30),t.setMonth(t.getMonth()-s*i);let a=Sf(t,r)===-s;gX(ht(n))&&i===1&&Sf(n,r)===1&&(a=!1),o=s*(i-Number(a))}return o===0?0:o}function vX(n,e,t){const r=hX(n,e)/1e3;return dX(t==null?void 0:t.roundingMethod)(r)}function yX(n){const e=ht(n),t=ws(n,0);return t.setFullYear(e.getFullYear(),0,1),t.setHours(0,0,0,0),t}const xX={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},wX=(n,e,t)=>{let r;const s=xX[n];return typeof s=="string"?r=s:e===1?r=s.one:r=s.other.replace("{{count}}",e.toString()),t!=null&&t.addSuffix?t.comparison&&t.comparison>0?"in "+r:r+" ago":r};function mm(n){return(e={})=>{const t=e.width?String(e.width):n.defaultWidth;return n.formats[t]||n.formats[n.defaultWidth]}}const bX={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},_X={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},SX={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},CX={date:mm({formats:bX,defaultWidth:"full"}),time:mm({formats:_X,defaultWidth:"full"}),dateTime:mm({formats:SX,defaultWidth:"full"})},EX={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},kX=(n,e,t,r)=>EX[n];function Vc(n){return(e,t)=>{const r=t!=null&&t.context?String(t.context):"standalone";let s;if(r==="formatting"&&n.formattingValues){const o=n.defaultFormattingWidth||n.defaultWidth,a=t!=null&&t.width?String(t.width):o;s=n.formattingValues[a]||n.formattingValues[o]}else{const o=n.defaultWidth,a=t!=null&&t.width?String(t.width):n.defaultWidth;s=n.values[a]||n.values[o]}const i=n.argumentCallback?n.argumentCallback(e):e;return s[i]}}const PX={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},TX={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},AX={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},DX={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},OX={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},IX={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},RX=(n,e)=>{const t=Number(n),r=t%100;if(r>20||r<10)switch(r%10){case 1:return t+"st";case 2:return t+"nd";case 3:return t+"rd"}return t+"th"},NX={ordinalNumber:RX,era:Vc({values:PX,defaultWidth:"wide"}),quarter:Vc({values:TX,defaultWidth:"wide",argumentCallback:n=>n-1}),month:Vc({values:AX,defaultWidth:"wide"}),day:Vc({values:DX,defaultWidth:"wide"}),dayPeriod:Vc({values:OX,defaultWidth:"wide",formattingValues:IX,defaultFormattingWidth:"wide"})};function Gc(n){return(e,t={})=>{const r=t.width,s=r&&n.matchPatterns[r]||n.matchPatterns[n.defaultMatchWidth],i=e.match(s);if(!i)return null;const o=i[0],a=r&&n.parsePatterns[r]||n.parsePatterns[n.defaultParseWidth],l=Array.isArray(a)?LX(a,h=>h.test(o)):jX(a,h=>h.test(o));let c;c=n.valueCallback?n.valueCallback(l):l,c=t.valueCallback?t.valueCallback(c):c;const u=e.slice(o.length);return{value:c,rest:u}}}function jX(n,e){for(const t in n)if(Object.prototype.hasOwnProperty.call(n,t)&&e(n[t]))return t}function LX(n,e){for(let t=0;t<n.length;t++)if(e(n[t]))return t}function MX(n){return(e,t={})=>{const r=e.match(n.matchPattern);if(!r)return null;const s=r[0],i=e.match(n.parsePattern);if(!i)return null;let o=n.valueCallback?n.valueCallback(i[0]):i[0];o=t.valueCallback?t.valueCallback(o):o;const a=e.slice(s.length);return{value:o,rest:a}}}const FX=/^(\d+)(th|st|nd|rd)?/i,BX=/\d+/i,UX={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},$X={any:[/^b/i,/^(a|c)/i]},zX={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},WX={any:[/1/i,/2/i,/3/i,/4/i]},HX={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},VX={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},GX={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},qX={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},YX={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},XX={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},KX={ordinalNumber:MX({matchPattern:FX,parsePattern:BX,valueCallback:n=>parseInt(n,10)}),era:Gc({matchPatterns:UX,defaultMatchWidth:"wide",parsePatterns:$X,defaultParseWidth:"any"}),quarter:Gc({matchPatterns:zX,defaultMatchWidth:"wide",parsePatterns:WX,defaultParseWidth:"any",valueCallback:n=>n+1}),month:Gc({matchPatterns:HX,defaultMatchWidth:"wide",parsePatterns:VX,defaultParseWidth:"any"}),day:Gc({matchPatterns:GX,defaultMatchWidth:"wide",parsePatterns:qX,defaultParseWidth:"any"}),dayPeriod:Gc({matchPatterns:YX,defaultMatchWidth:"any",parsePatterns:XX,defaultParseWidth:"any"})},HI={code:"en-US",formatDistance:wX,formatLong:CX,formatRelative:kX,localize:NX,match:KX,options:{weekStartsOn:0,firstWeekContainsDate:1}};function JX(n){const e=ht(n);return sX(e,yX(e))+1}function QX(n){const e=ht(n),t=+Sp(e)-+iX(e);return Math.round(t/zI)+1}function VI(n,e){var u,h,d,p;const t=ht(n),r=t.getFullYear(),s=Ec(),i=(e==null?void 0:e.firstWeekContainsDate)??((h=(u=e==null?void 0:e.locale)==null?void 0:u.options)==null?void 0:h.firstWeekContainsDate)??s.firstWeekContainsDate??((p=(d=s.locale)==null?void 0:d.options)==null?void 0:p.firstWeekContainsDate)??1,o=ws(n,0);o.setFullYear(r+1,0,i),o.setHours(0,0,0,0);const a=ud(o,e),l=ws(n,0);l.setFullYear(r,0,i),l.setHours(0,0,0,0);const c=ud(l,e);return t.getTime()>=a.getTime()?r+1:t.getTime()>=c.getTime()?r:r-1}function ZX(n,e){var a,l,c,u;const t=Ec(),r=(e==null?void 0:e.firstWeekContainsDate)??((l=(a=e==null?void 0:e.locale)==null?void 0:a.options)==null?void 0:l.firstWeekContainsDate)??t.firstWeekContainsDate??((u=(c=t.locale)==null?void 0:c.options)==null?void 0:u.firstWeekContainsDate)??1,s=VI(n,e),i=ws(n,0);return i.setFullYear(s,0,r),i.setHours(0,0,0,0),ud(i,e)}function eK(n,e){const t=ht(n),r=+ud(t,e)-+ZX(t,e);return Math.round(r/zI)+1}function ut(n,e){const t=n<0?"-":"",r=Math.abs(n).toString().padStart(e,"0");return t+r}const Ci={y(n,e){const t=n.getFullYear(),r=t>0?t:1-t;return ut(e==="yy"?r%100:r,e.length)},M(n,e){const t=n.getMonth();return e==="M"?String(t+1):ut(t+1,2)},d(n,e){return ut(n.getDate(),e.length)},a(n,e){const t=n.getHours()/12>=1?"pm":"am";switch(e){case"a":case"aa":return t.toUpperCase();case"aaa":return t;case"aaaaa":return t[0];case"aaaa":default:return t==="am"?"a.m.":"p.m."}},h(n,e){return ut(n.getHours()%12||12,e.length)},H(n,e){return ut(n.getHours(),e.length)},m(n,e){return ut(n.getMinutes(),e.length)},s(n,e){return ut(n.getSeconds(),e.length)},S(n,e){const t=e.length,r=n.getMilliseconds(),s=Math.trunc(r*Math.pow(10,t-3));return ut(s,e.length)}},za={am:"am",pm:"pm",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},kE={G:function(n,e,t){const r=n.getFullYear()>0?1:0;switch(e){case"G":case"GG":case"GGG":return t.era(r,{width:"abbreviated"});case"GGGGG":return t.era(r,{width:"narrow"});case"GGGG":default:return t.era(r,{width:"wide"})}},y:function(n,e,t){if(e==="yo"){const r=n.getFullYear(),s=r>0?r:1-r;return t.ordinalNumber(s,{unit:"year"})}return Ci.y(n,e)},Y:function(n,e,t,r){const s=VI(n,r),i=s>0?s:1-s;if(e==="YY"){const o=i%100;return ut(o,2)}return e==="Yo"?t.ordinalNumber(i,{unit:"year"}):ut(i,e.length)},R:function(n,e){const t=WI(n);return ut(t,e.length)},u:function(n,e){const t=n.getFullYear();return ut(t,e.length)},Q:function(n,e,t){const r=Math.ceil((n.getMonth()+1)/3);switch(e){case"Q":return String(r);case"QQ":return ut(r,2);case"Qo":return t.ordinalNumber(r,{unit:"quarter"});case"QQQ":return t.quarter(r,{width:"abbreviated",context:"formatting"});case"QQQQQ":return t.quarter(r,{width:"narrow",context:"formatting"});case"QQQQ":default:return t.quarter(r,{width:"wide",context:"formatting"})}},q:function(n,e,t){const r=Math.ceil((n.getMonth()+1)/3);switch(e){case"q":return String(r);case"qq":return ut(r,2);case"qo":return t.ordinalNumber(r,{unit:"quarter"});case"qqq":return t.quarter(r,{width:"abbreviated",context:"standalone"});case"qqqqq":return t.quarter(r,{width:"narrow",context:"standalone"});case"qqqq":default:return t.quarter(r,{width:"wide",context:"standalone"})}},M:function(n,e,t){const r=n.getMonth();switch(e){case"M":case"MM":return Ci.M(n,e);case"Mo":return t.ordinalNumber(r+1,{unit:"month"});case"MMM":return t.month(r,{width:"abbreviated",context:"formatting"});case"MMMMM":return t.month(r,{width:"narrow",context:"formatting"});case"MMMM":default:return t.month(r,{width:"wide",context:"formatting"})}},L:function(n,e,t){const r=n.getMonth();switch(e){case"L":return String(r+1);case"LL":return ut(r+1,2);case"Lo":return t.ordinalNumber(r+1,{unit:"month"});case"LLL":return t.month(r,{width:"abbreviated",context:"standalone"});case"LLLLL":return t.month(r,{width:"narrow",context:"standalone"});case"LLLL":default:return t.month(r,{width:"wide",context:"standalone"})}},w:function(n,e,t,r){const s=eK(n,r);return e==="wo"?t.ordinalNumber(s,{unit:"week"}):ut(s,e.length)},I:function(n,e,t){const r=QX(n);return e==="Io"?t.ordinalNumber(r,{unit:"week"}):ut(r,e.length)},d:function(n,e,t){return e==="do"?t.ordinalNumber(n.getDate(),{unit:"date"}):Ci.d(n,e)},D:function(n,e,t){const r=JX(n);return e==="Do"?t.ordinalNumber(r,{unit:"dayOfYear"}):ut(r,e.length)},E:function(n,e,t){const r=n.getDay();switch(e){case"E":case"EE":case"EEE":return t.day(r,{width:"abbreviated",context:"formatting"});case"EEEEE":return t.day(r,{width:"narrow",context:"formatting"});case"EEEEEE":return t.day(r,{width:"short",context:"formatting"});case"EEEE":default:return t.day(r,{width:"wide",context:"formatting"})}},e:function(n,e,t,r){const s=n.getDay(),i=(s-r.weekStartsOn+8)%7||7;switch(e){case"e":return String(i);case"ee":return ut(i,2);case"eo":return t.ordinalNumber(i,{unit:"day"});case"eee":return t.day(s,{width:"abbreviated",context:"formatting"});case"eeeee":return t.day(s,{width:"narrow",context:"formatting"});case"eeeeee":return t.day(s,{width:"short",context:"formatting"});case"eeee":default:return t.day(s,{width:"wide",context:"formatting"})}},c:function(n,e,t,r){const s=n.getDay(),i=(s-r.weekStartsOn+8)%7||7;switch(e){case"c":return String(i);case"cc":return ut(i,e.length);case"co":return t.ordinalNumber(i,{unit:"day"});case"ccc":return t.day(s,{width:"abbreviated",context:"standalone"});case"ccccc":return t.day(s,{width:"narrow",context:"standalone"});case"cccccc":return t.day(s,{width:"short",context:"standalone"});case"cccc":default:return t.day(s,{width:"wide",context:"standalone"})}},i:function(n,e,t){const r=n.getDay(),s=r===0?7:r;switch(e){case"i":return String(s);case"ii":return ut(s,e.length);case"io":return t.ordinalNumber(s,{unit:"day"});case"iii":return t.day(r,{width:"abbreviated",context:"formatting"});case"iiiii":return t.day(r,{width:"narrow",context:"formatting"});case"iiiiii":return t.day(r,{width:"short",context:"formatting"});case"iiii":default:return t.day(r,{width:"wide",context:"formatting"})}},a:function(n,e,t){const s=n.getHours()/12>=1?"pm":"am";switch(e){case"a":case"aa":return t.dayPeriod(s,{width:"abbreviated",context:"formatting"});case"aaa":return t.dayPeriod(s,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return t.dayPeriod(s,{width:"narrow",context:"formatting"});case"aaaa":default:return t.dayPeriod(s,{width:"wide",context:"formatting"})}},b:function(n,e,t){const r=n.getHours();let s;switch(r===12?s=za.noon:r===0?s=za.midnight:s=r/12>=1?"pm":"am",e){case"b":case"bb":return t.dayPeriod(s,{width:"abbreviated",context:"formatting"});case"bbb":return t.dayPeriod(s,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return t.dayPeriod(s,{width:"narrow",context:"formatting"});case"bbbb":default:return t.dayPeriod(s,{width:"wide",context:"formatting"})}},B:function(n,e,t){const r=n.getHours();let s;switch(r>=17?s=za.evening:r>=12?s=za.afternoon:r>=4?s=za.morning:s=za.night,e){case"B":case"BB":case"BBB":return t.dayPeriod(s,{width:"abbreviated",context:"formatting"});case"BBBBB":return t.dayPeriod(s,{width:"narrow",context:"formatting"});case"BBBB":default:return t.dayPeriod(s,{width:"wide",context:"formatting"})}},h:function(n,e,t){if(e==="ho"){let r=n.getHours()%12;return r===0&&(r=12),t.ordinalNumber(r,{unit:"hour"})}return Ci.h(n,e)},H:function(n,e,t){return e==="Ho"?t.ordinalNumber(n.getHours(),{unit:"hour"}):Ci.H(n,e)},K:function(n,e,t){const r=n.getHours()%12;return e==="Ko"?t.ordinalNumber(r,{unit:"hour"}):ut(r,e.length)},k:function(n,e,t){let r=n.getHours();return r===0&&(r=24),e==="ko"?t.ordinalNumber(r,{unit:"hour"}):ut(r,e.length)},m:function(n,e,t){return e==="mo"?t.ordinalNumber(n.getMinutes(),{unit:"minute"}):Ci.m(n,e)},s:function(n,e,t){return e==="so"?t.ordinalNumber(n.getSeconds(),{unit:"second"}):Ci.s(n,e)},S:function(n,e){return Ci.S(n,e)},X:function(n,e,t){const r=n.getTimezoneOffset();if(r===0)return"Z";switch(e){case"X":return TE(r);case"XXXX":case"XX":return Uo(r);case"XXXXX":case"XXX":default:return Uo(r,":")}},x:function(n,e,t){const r=n.getTimezoneOffset();switch(e){case"x":return TE(r);case"xxxx":case"xx":return Uo(r);case"xxxxx":case"xxx":default:return Uo(r,":")}},O:function(n,e,t){const r=n.getTimezoneOffset();switch(e){case"O":case"OO":case"OOO":return"GMT"+PE(r,":");case"OOOO":default:return"GMT"+Uo(r,":")}},z:function(n,e,t){const r=n.getTimezoneOffset();switch(e){case"z":case"zz":case"zzz":return"GMT"+PE(r,":");case"zzzz":default:return"GMT"+Uo(r,":")}},t:function(n,e,t){const r=Math.trunc(n.getTime()/1e3);return ut(r,e.length)},T:function(n,e,t){const r=n.getTime();return ut(r,e.length)}};function PE(n,e=""){const t=n>0?"-":"+",r=Math.abs(n),s=Math.trunc(r/60),i=r%60;return i===0?t+String(s):t+String(s)+e+ut(i,2)}function TE(n,e){return n%60===0?(n>0?"-":"+")+ut(Math.abs(n)/60,2):Uo(n,e)}function Uo(n,e=""){const t=n>0?"-":"+",r=Math.abs(n),s=ut(Math.trunc(r/60),2),i=ut(r%60,2);return t+s+e+i}const AE=(n,e)=>{switch(n){case"P":return e.date({width:"short"});case"PP":return e.date({width:"medium"});case"PPP":return e.date({width:"long"});case"PPPP":default:return e.date({width:"full"})}},GI=(n,e)=>{switch(n){case"p":return e.time({width:"short"});case"pp":return e.time({width:"medium"});case"ppp":return e.time({width:"long"});case"pppp":default:return e.time({width:"full"})}},tK=(n,e)=>{const t=n.match(/(P+)(p+)?/)||[],r=t[1],s=t[2];if(!s)return AE(n,e);let i;switch(r){case"P":i=e.dateTime({width:"short"});break;case"PP":i=e.dateTime({width:"medium"});break;case"PPP":i=e.dateTime({width:"long"});break;case"PPPP":default:i=e.dateTime({width:"full"});break}return i.replace("{{date}}",AE(r,e)).replace("{{time}}",GI(s,e))},nK={p:GI,P:tK},rK=/^D+$/,sK=/^Y+$/,iK=["D","DD","YY","YYYY"];function oK(n){return rK.test(n)}function aK(n){return sK.test(n)}function lK(n,e,t){const r=cK(n,e,t);if(console.warn(r),iK.includes(n))throw new RangeError(r)}function cK(n,e,t){const r=n[0]==="Y"?"years":"days of the month";return`Use \`${n.toLowerCase()}\` instead of \`${n}\` (in \`${e}\`) for formatting ${r} to the input \`${t}\`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md`}const uK=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,dK=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,hK=/^'([^]*?)'?$/,fK=/''/g,pK=/[a-zA-Z]/;function qI(n,e,t){var u,h,d,p,m,g,y,x;const r=Ec(),s=(t==null?void 0:t.locale)??r.locale??HI,i=(t==null?void 0:t.firstWeekContainsDate)??((h=(u=t==null?void 0:t.locale)==null?void 0:u.options)==null?void 0:h.firstWeekContainsDate)??r.firstWeekContainsDate??((p=(d=r.locale)==null?void 0:d.options)==null?void 0:p.firstWeekContainsDate)??1,o=(t==null?void 0:t.weekStartsOn)??((g=(m=t==null?void 0:t.locale)==null?void 0:m.options)==null?void 0:g.weekStartsOn)??r.weekStartsOn??((x=(y=r.locale)==null?void 0:y.options)==null?void 0:x.weekStartsOn)??0,a=ht(n);if(!cX(a))throw new RangeError("Invalid time value");let l=e.match(dK).map(v=>{const w=v[0];if(w==="p"||w==="P"){const _=nK[w];return _(v,s.formatLong)}return v}).join("").match(uK).map(v=>{if(v==="''")return{isToken:!1,value:"'"};const w=v[0];if(w==="'")return{isToken:!1,value:gK(v)};if(kE[w])return{isToken:!0,value:v};if(w.match(pK))throw new RangeError("Format string contains an unescaped latin alphabet character `"+w+"`");return{isToken:!1,value:v}});s.localize.preprocessor&&(l=s.localize.preprocessor(a,l));const c={firstWeekContainsDate:i,weekStartsOn:o,locale:s};return l.map(v=>{if(!v.isToken)return v.value;const w=v.value;(!(t!=null&&t.useAdditionalWeekYearTokens)&&aK(w)||!(t!=null&&t.useAdditionalDayOfYearTokens)&&oK(w))&&lK(w,e,String(n));const _=kE[w[0]];return _(a,w,s.localize,c)}).join("")}function gK(n){const e=n.match(hK);return e?e[1].replace(fK,"'"):n}function mK(n,e,t){const r=Ec(),s=(t==null?void 0:t.locale)??r.locale??HI,i=2520,o=Sf(n,e);if(isNaN(o))throw new RangeError("Invalid time value");const a=Object.assign({},t,{addSuffix:t==null?void 0:t.addSuffix,comparison:o});let l,c;o>0?(l=ht(e),c=ht(n)):(l=ht(n),c=ht(e));const u=vX(c,l),h=(Cp(c)-Cp(l))/1e3,d=Math.round((u-h)/60);let p;if(d<2)return t!=null&&t.includeSeconds?u<5?s.formatDistance("lessThanXSeconds",5,a):u<10?s.formatDistance("lessThanXSeconds",10,a):u<20?s.formatDistance("lessThanXSeconds",20,a):u<40?s.formatDistance("halfAMinute",0,a):u<60?s.formatDistance("lessThanXMinutes",1,a):s.formatDistance("xMinutes",1,a):d===0?s.formatDistance("lessThanXMinutes",1,a):s.formatDistance("xMinutes",d,a);if(d<45)return s.formatDistance("xMinutes",d,a);if(d<90)return s.formatDistance("aboutXHours",1,a);if(d<CE){const m=Math.round(d/60);return s.formatDistance("aboutXHours",m,a)}else{if(d<i)return s.formatDistance("xDays",1,a);if(d<Gh){const m=Math.round(d/CE);return s.formatDistance("xDays",m,a)}else if(d<Gh*2)return p=Math.round(d/Gh),s.formatDistance("aboutXMonths",p,a)}if(p=mX(c,l),p<12){const m=Math.round(d/Gh);return s.formatDistance("xMonths",m,a)}else{const m=p%12,g=Math.trunc(p/12);return m<3?s.formatDistance("aboutXYears",g,a):m<9?s.formatDistance("overXYears",g,a):s.formatDistance("almostXYears",g+1,a)}}function ku(n,e){return mK(n,aX(n),e)}function vK(){return Object.assign({},Ec())}function vm(n,e){return oX(n,-e)}const YI=()=>{const[n,e]=b.useState(!1),{isNative:t}=Od(),{toast:r}=Bt();b.useEffect(()=>{t&&s()},[t]);const s=async()=>{if(t)try{const u=await No.checkPermissions();e(u.display==="granted")}catch(u){console.log("LocalNotifications plugin not available on this platform:",u),e(!1)}},i=b.useCallback(async()=>{var u,h,d;if(!t)return r({title:"Device notifications not available",description:"Local notifications are only available on mobile devices",variant:"destructive"}),!1;try{let p=!1,m;try{const g=await((d=(h=(u=window.Capacitor)==null?void 0:u.Plugins)==null?void 0:h.AppPermissions)==null?void 0:d.requestNotificationPermission());p=(g==null?void 0:g.granted)||!1,m=g==null?void 0:g.error}catch(g){console.log("AppPermissions plugin not available, trying fallback:",g),p=(await No.requestPermissions()).display==="granted"}return e(p),p||r({title:"Notifications permission denied",description:m||"Please enable notifications in your device settings to receive event reminders",variant:"destructive"}),p}catch(p){return console.log("LocalNotifications plugin not available on this platform:",p),r({title:"Local notifications not available",description:"This device doesn't support local notifications, but you can still get push notifications"}),!1}},[t,r]),o=b.useCallback(async u=>{if(!(!t||!n))try{const h=new Date(u.startTime),d=new Date(u.endTime),p=new Date(u.deleteDate),m=[],g=vm(h,30);g>new Date&&m.push({title:` ${u.eventName} starts soon!`,body:"Get ready to capture and share your memories!",id:parseInt(`${u.eventId.slice(-6)}1`),schedule:{at:g},extra:{eventId:u.eventId,type:"event_reminder"}}),h>new Date&&m.push({title:` ${u.eventName} is now LIVE!`,body:"Start taking photos and sharing your moments!",id:parseInt(`${u.eventId.slice(-6)}2`),schedule:{at:h},extra:{eventId:u.eventId,type:"event_live"}});const y=vm(d,15);y>new Date&&m.push({title:` ${u.eventName} ending soon`,body:"15 minutes left to upload your photos!",id:parseInt(`${u.eventId.slice(-6)}3`),schedule:{at:y},extra:{eventId:u.eventId,type:"event_ending"}});const x=vm(p,24*60);x>new Date&&m.push({title:` ${u.eventName} photos expiring soon`,body:"Download your photos before they're automatically deleted!",id:parseInt(`${u.eventId.slice(-6)}4`),schedule:{at:x},extra:{eventId:u.eventId,type:"deletion_warning"}}),m.length>0&&(await No.schedule({notifications:m}),r({title:"Event reminders scheduled! ",description:`Set up ${m.length} notifications for ${u.eventName}`}))}catch(h){console.log("LocalNotifications not available on this platform:",h),r({title:"Local reminders not available",description:"This device doesn't support local notifications, but you can still get push notifications"})}},[t,n,r]),a=b.useCallback(async u=>{if(t)try{const h=u.slice(-6),d=[parseInt(`${h}1`),parseInt(`${h}2`),parseInt(`${h}3`),parseInt(`${h}4`)];await No.cancel({notifications:d.map(p=>({id:p}))}),r({title:"Event reminders cancelled",description:"Cancelled notifications for this event"})}catch(h){console.log("LocalNotifications not available for cancelling:",h)}},[t,r]),l=b.useCallback(async()=>{if(t)try{const u=await No.getPending();await No.cancel({notifications:u.notifications}),r({title:"All reminders cancelled",description:"Cancelled all pending local notifications"})}catch(u){console.log("LocalNotifications not available for cancelling all:",u)}},[t,r]),c=b.useCallback(async()=>{if(!t)return[];try{return(await No.getPending()).notifications||[]}catch(u){return console.log("LocalNotifications not available for getting pending:",u),[]}},[t]);return{hasPermission:n,requestPermissions:i,scheduleEventNotifications:o,cancelEventNotifications:a,cancelAllNotifications:l,getPendingNotifications:c}};function yK(n){n.CapacitorUtils.Synapse=new Proxy({},{get(e,t){return new Proxy({},{get(r,s){return(i,o,a)=>{const l=n.Capacitor.Plugins[t];if(l===void 0){a(new Error(`Capacitor plugin ${t} not found`));return}if(typeof l[s]!="function"){a(new Error(`Method ${s} not found in Capacitor plugin ${t}`));return}(async()=>{try{const c=await l[s](i);o(c)}catch(c){a(c)}})()}}})}})}function xK(n){n.CapacitorUtils.Synapse=new Proxy({},{get(e,t){return n.cordova.plugins[t]}})}function wK(n=!1){typeof window>"u"||(window.CapacitorUtils=window.CapacitorUtils||{},window.Capacitor!==void 0&&!n?yK(window):window.cordova!==void 0&&xK(window))}var DE;(function(n){n.Documents="DOCUMENTS",n.Data="DATA",n.Library="LIBRARY",n.Cache="CACHE",n.External="EXTERNAL",n.ExternalStorage="EXTERNAL_STORAGE",n.ExternalCache="EXTERNAL_CACHE",n.LibraryNoCloud="LIBRARY_NO_CLOUD",n.Temporary="TEMPORARY"})(DE||(DE={}));var OE;(function(n){n.UTF8="utf8",n.ASCII="ascii",n.UTF16="utf16"})(OE||(OE={}));const ym=Pn("Filesystem",{web:()=>Ae(()=>import("./web-BLnquuNd.js"),[]).then(n=>new n.FilesystemWeb)});wK();var fx={exports:{}};(function(n,e){(function(){var t={};t.version="1.0.4",t.remove=function(S){var E=!1;if(S.slice(0,2)!="")if(S.slice(0,23)=="data:image/jpeg;base64,"||S.slice(0,22)=="data:image/jpg;base64,")S=d(S.split(",")[1]),E=!0;else throw new Error("Given data is not jpeg.");var C=y(S),P=C.filter(function(A){return!(A.slice(0,2)==""&&A.slice(4,10)=="Exif\0\0")}),O=P.join("");return E&&(O="data:image/jpeg;base64,"+h(O)),O},t.insert=function(S,E){var C=!1;if(S.slice(0,6)!="Exif\0\0")throw new Error("Given data is not exif.");if(E.slice(0,2)!="")if(E.slice(0,23)=="data:image/jpeg;base64,"||E.slice(0,22)=="data:image/jpg;base64,")E=d(E.split(",")[1]),C=!0;else throw new Error("Given data is not jpeg.");var P=""+p(">H",[S.length+2])+S,O=y(E),A=v(O,P);return C&&(A="data:image/jpeg;base64,"+h(A)),A},t.load=function(S){var E;if(typeof S=="string")if(S.slice(0,2)=="")E=S;else if(S.slice(0,23)=="data:image/jpeg;base64,"||S.slice(0,22)=="data:image/jpg;base64,")E=d(S.split(",")[1]);else if(S.slice(0,4)=="Exif")E=S.slice(6);else throw new Error("'load' gots invalid file data.");else throw new Error("'load' gots invalid type argument.");var C={"0th":{},Exif:{},GPS:{},Interop:{},"1st":{},thumbnail:null},P=new u(E);if(P.tiftag===null)return C;P.tiftag.slice(0,2)=="II"?P.endian_mark="<":P.endian_mark=">";var O=m(P.endian_mark+"L",P.tiftag.slice(4,8))[0];C["0th"]=P.get_ifd(O,"0th");var A=C["0th"].first_ifd_pointer;if(delete C["0th"].first_ifd_pointer,34665 in C["0th"]&&(O=C["0th"][34665],C.Exif=P.get_ifd(O,"Exif")),34853 in C["0th"]&&(O=C["0th"][34853],C.GPS=P.get_ifd(O,"GPS")),40965 in C.Exif&&(O=C.Exif[40965],C.Interop=P.get_ifd(O,"Interop")),A!="\0\0\0\0"&&(O=m(P.endian_mark+"L",A)[0],C["1st"]=P.get_ifd(O,"1st"),513 in C["1st"]&&514 in C["1st"])){var R=C["1st"][513]+C["1st"][514],B=P.tiftag.slice(C["1st"][513],R);C.thumbnail=B}return C},t.dump=function(S){var E=8,C=r(S),P="Exif\0\0MM\0*\0\0\0\b",O=!1,A=!1,R=!1,B=!1,I,L,U,F,D;"0th"in C?I=C["0th"]:I={},"Exif"in C&&Object.keys(C.Exif).length||"Interop"in C&&Object.keys(C.Interop).length?(I[34665]=1,O=!0,L=C.Exif,"Interop"in C&&Object.keys(C.Interop).length?(L[40965]=1,R=!0,U=C.Interop):Object.keys(L).indexOf(t.ExifIFD.InteroperabilityTag.toString())>-1&&delete L[40965]):Object.keys(I).indexOf(t.ImageIFD.ExifTag.toString())>-1&&delete I[34665],"GPS"in C&&Object.keys(C.GPS).length?(I[t.ImageIFD.GPSTag]=1,A=!0,F=C.GPS):Object.keys(I).indexOf(t.ImageIFD.GPSTag.toString())>-1&&delete I[t.ImageIFD.GPSTag],"1st"in C&&"thumbnail"in C&&C.thumbnail!=null&&(B=!0,C["1st"][513]=1,C["1st"][514]=1,D=C["1st"]);var k=c(I,"0th",0),N=k[0].length+O*12+A*12+4+k[1].length,M,T="",j=0,$,z="",ee=0,X,J="",K=0,ne,ie="",ae;if(O&&(M=c(L,"Exif",N),j=M[0].length+R*12+M[1].length),A&&($=c(F,"GPS",N+j),z=$.join(""),ee=z.length),R){var W=N+j+ee;X=c(U,"Interop",W),J=X.join(""),K=J.length}if(B){var W=N+j+ee+K;if(ne=c(D,"1st",W),ae=s(C.thumbnail),ae.length>64e3)throw new Error("Given thumbnail is too large. max 64kB")}var H="",G="",Q="",te="\0\0\0\0";if(O){var he=E+N,xe=p(">L",[he]),fe=34665,be=p(">H",[fe]),Pe=p(">H",[w.Long]),Se=p(">L",[1]);H=be+Pe+Se+xe}if(A){var he=E+N+j,xe=p(">L",[he]),fe=34853,be=p(">H",[fe]),Pe=p(">H",[w.Long]),Se=p(">L",[1]);G=be+Pe+Se+xe}if(R){var he=E+N+j+ee,xe=p(">L",[he]),fe=40965,be=p(">H",[fe]),Pe=p(">H",[w.Long]),Se=p(">L",[1]);Q=be+Pe+Se+xe}if(B){var he=E+N+j+ee+K;te=p(">L",[he]);var Ye=he+ne[0].length+24+4+ne[1].length,Ve="\0\0\0\0"+p(">L",[Ye]),Ge="\0\0\0\0"+p(">L",[ae.length]);ie=ne[0]+Ve+Ge+"\0\0\0\0"+ne[1]+ae}var Re=k[0]+H+G+te+k[1];return O&&(T=M[0]+Q+M[1]),P+Re+T+z+J+ie};function r(S){return JSON.parse(JSON.stringify(S))}function s(S){for(var E=y(S);""<=E[1].slice(0,2)&&E[1].slice(0,2)<="";)E=[E[0]].concat(E.slice(2));return E.join("")}function i(S){return p(">"+g("B",S.length),S)}function o(S){return p(">"+g("H",S.length),S)}function a(S){return p(">"+g("L",S.length),S)}function l(S,E,C){var P="",O="",A,R,B,I;if(E=="Byte")A=S.length,A<=4?O=i(S)+g("\0",4-A):(O=p(">L",[C]),P=i(S));else if(E=="Short")A=S.length,A<=2?O=o(S)+g("\0\0",2-A):(O=p(">L",[C]),P=o(S));else if(E=="Long")A=S.length,A<=1?O=a(S):(O=p(">L",[C]),P=a(S));else if(E=="Ascii")R=S+"\0",A=R.length,A>4?(O=p(">L",[C]),P=R):O=R+g("\0",4-A);else if(E=="Rational"){if(typeof S[0]=="number")A=1,B=S[0],I=S[1],R=p(">L",[B])+p(">L",[I]);else{A=S.length,R="";for(var L=0;L<A;L++)B=S[L][0],I=S[L][1],R+=p(">L",[B])+p(">L",[I])}O=p(">L",[C]),P=R}else if(E=="SRational"){if(typeof S[0]=="number")A=1,B=S[0],I=S[1],R=p(">l",[B])+p(">l",[I]);else{A=S.length,R="";for(var L=0;L<A;L++)B=S[L][0],I=S[L][1],R+=p(">l",[B])+p(">l",[I])}O=p(">L",[C]),P=R}else E=="Undefined"&&(A=S.length,A>4?(O=p(">L",[C]),P=S):O=S+g("\0",4-A));var U=p(">L",[A]);return[U,O,P]}function c(S,E,C){var P=8,O=Object.keys(S).length,A=p(">H",[O]),R;["0th","1st"].indexOf(E)>-1?R=2+O*12+4:R=2+O*12;var B="",I="",L;for(var L in S)if(typeof L=="string"&&(L=parseInt(L)),!(E=="0th"&&[34665,34853].indexOf(L)>-1)){{if(E=="Exif"&&L==40965)continue;if(E=="1st"&&[513,514].indexOf(L)>-1)continue}var U=S[L],F=p(">H",[L]),D=_[E][L].type,k=p(">H",[w[D]]);typeof U=="number"&&(U=[U]);var N=P+R+C+I.length,M=l(U,D,N),T=M[0],j=M[1],$=M[2];B+=F+k+T+j,I+=$}return[A+B,I]}function u(S){var E,C;if(S.slice(0,2)=="")E=y(S),C=x(E),C?this.tiftag=C.slice(10):this.tiftag=null;else if(["II","MM"].indexOf(S.slice(0,2))>-1)this.tiftag=S;else if(S.slice(0,4)=="Exif")this.tiftag=S.slice(6);else throw new Error("Given file is neither JPEG nor TIFF.")}if(u.prototype={get_ifd:function(S,E){var C={},P=m(this.endian_mark+"H",this.tiftag.slice(S,S+2))[0],O=S+2,A;["0th","1st"].indexOf(E)>-1?A="Image":A=E;for(var R=0;R<P;R++){S=O+12*R;var B=m(this.endian_mark+"H",this.tiftag.slice(S,S+2))[0],I=m(this.endian_mark+"H",this.tiftag.slice(S+2,S+4))[0],L=m(this.endian_mark+"L",this.tiftag.slice(S+4,S+8))[0],U=this.tiftag.slice(S+8,S+12),F=[I,L,U];B in _[A]&&(C[B]=this.convert_value(F))}return E=="0th"&&(S=O+12*P,C.first_ifd_pointer=this.tiftag.slice(S,S+4)),C},convert_value:function(S){var E=null,C=S[0],P=S[1],O=S[2],A;if(C==1)P>4?(A=m(this.endian_mark+"L",O)[0],E=m(this.endian_mark+g("B",P),this.tiftag.slice(A,A+P))):E=m(this.endian_mark+g("B",P),O.slice(0,P));else if(C==2)P>4?(A=m(this.endian_mark+"L",O)[0],E=this.tiftag.slice(A,A+P-1)):E=O.slice(0,P-1);else if(C==3)P>2?(A=m(this.endian_mark+"L",O)[0],E=m(this.endian_mark+g("H",P),this.tiftag.slice(A,A+P*2))):E=m(this.endian_mark+g("H",P),O.slice(0,P*2));else if(C==4)P>1?(A=m(this.endian_mark+"L",O)[0],E=m(this.endian_mark+g("L",P),this.tiftag.slice(A,A+P*4))):E=m(this.endian_mark+g("L",P),O);else if(C==5)if(A=m(this.endian_mark+"L",O)[0],P>1){E=[];for(var R=0;R<P;R++)E.push([m(this.endian_mark+"L",this.tiftag.slice(A+R*8,A+4+R*8))[0],m(this.endian_mark+"L",this.tiftag.slice(A+4+R*8,A+8+R*8))[0]])}else E=[m(this.endian_mark+"L",this.tiftag.slice(A,A+4))[0],m(this.endian_mark+"L",this.tiftag.slice(A+4,A+8))[0]];else if(C==7)P>4?(A=m(this.endian_mark+"L",O)[0],E=this.tiftag.slice(A,A+P)):E=O.slice(0,P);else if(C==9)P>1?(A=m(this.endian_mark+"L",O)[0],E=m(this.endian_mark+g("l",P),this.tiftag.slice(A,A+P*4))):E=m(this.endian_mark+g("l",P),O);else if(C==10)if(A=m(this.endian_mark+"L",O)[0],P>1){E=[];for(var R=0;R<P;R++)E.push([m(this.endian_mark+"l",this.tiftag.slice(A+R*8,A+4+R*8))[0],m(this.endian_mark+"l",this.tiftag.slice(A+4+R*8,A+8+R*8))[0]])}else E=[m(this.endian_mark+"l",this.tiftag.slice(A,A+4))[0],m(this.endian_mark+"l",this.tiftag.slice(A+4,A+8))[0]];else throw new Error("Exif might be wrong. Got incorrect value type to decode. type:"+C);return E instanceof Array&&E.length==1?E[0]:E}},typeof window<"u"&&typeof window.btoa=="function")var h=window.btoa;if(typeof h>"u")var h=function(E){for(var C="",P,O,A,R,B,I,L,U=0,F="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";U<E.length;)P=E.charCodeAt(U++),O=E.charCodeAt(U++),A=E.charCodeAt(U++),R=P>>2,B=(P&3)<<4|O>>4,I=(O&15)<<2|A>>6,L=A&63,isNaN(O)?I=L=64:isNaN(A)&&(L=64),C=C+F.charAt(R)+F.charAt(B)+F.charAt(I)+F.charAt(L);return C};if(typeof window<"u"&&typeof window.atob=="function")var d=window.atob;if(typeof d>"u")var d=function(E){var C="",P,O,A,R,B,I,L,U=0,F="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";for(E=E.replace(/[^A-Za-z0-9\+\/\=]/g,"");U<E.length;)R=F.indexOf(E.charAt(U++)),B=F.indexOf(E.charAt(U++)),I=F.indexOf(E.charAt(U++)),L=F.indexOf(E.charAt(U++)),P=R<<2|B>>4,O=(B&15)<<4|I>>2,A=(I&3)<<6|L,C=C+String.fromCharCode(P),I!=64&&(C=C+String.fromCharCode(O)),L!=64&&(C=C+String.fromCharCode(A));return C};function p(S,E){if(!(E instanceof Array))throw new Error("'pack' error. Got invalid type argument.");if(S.length-1!=E.length)throw new Error("'pack' error. "+(S.length-1)+" marks, "+E.length+" elements.");var C;if(S[0]=="<")C=!0;else if(S[0]==">")C=!1;else throw new Error("");for(var P="",O=1,A=null,R=null,B=null;R=S[O];){if(R.toLowerCase()=="b"){if(A=E[O-1],R=="b"&&A<0&&(A+=256),A>255||A<0)throw new Error("'pack' error.");B=String.fromCharCode(A)}else if(R=="H"){if(A=E[O-1],A>65535||A<0)throw new Error("'pack' error.");B=String.fromCharCode(Math.floor(A%65536/256))+String.fromCharCode(A%256),C&&(B=B.split("").reverse().join(""))}else if(R.toLowerCase()=="l"){if(A=E[O-1],R=="l"&&A<0&&(A+=4294967296),A>4294967295||A<0)throw new Error("'pack' error.");B=String.fromCharCode(Math.floor(A/16777216))+String.fromCharCode(Math.floor(A%16777216/65536))+String.fromCharCode(Math.floor(A%65536/256))+String.fromCharCode(A%256),C&&(B=B.split("").reverse().join(""))}else throw new Error("'pack' error.");P+=B,O+=1}return P}function m(S,E){if(typeof E!="string")throw new Error("'unpack' error. Got invalid type argument.");for(var C=0,P=1;P<S.length;P++)if(S[P].toLowerCase()=="b")C+=1;else if(S[P].toLowerCase()=="h")C+=2;else if(S[P].toLowerCase()=="l")C+=4;else throw new Error("'unpack' error. Got invalid mark.");if(C!=E.length)throw new Error("'unpack' error. Mismatch between symbol and string length. "+C+":"+E.length);var O;if(S[0]=="<")O=!0;else if(S[0]==">")O=!1;else throw new Error("'unpack' error.");for(var A=[],R=0,B=1,I=null,L=null,U=null,F="";L=S[B];){if(L.toLowerCase()=="b")U=1,F=E.slice(R,R+U),I=F.charCodeAt(0),L=="b"&&I>=128&&(I-=256);else if(L=="H")U=2,F=E.slice(R,R+U),O&&(F=F.split("").reverse().join("")),I=F.charCodeAt(0)*256+F.charCodeAt(1);else if(L.toLowerCase()=="l")U=4,F=E.slice(R,R+U),O&&(F=F.split("").reverse().join("")),I=F.charCodeAt(0)*16777216+F.charCodeAt(1)*65536+F.charCodeAt(2)*256+F.charCodeAt(3),L=="l"&&I>=2147483648&&(I-=4294967296);else throw new Error("'unpack' error. "+L);A.push(I),R+=U,B+=1}return A}function g(S,E){for(var C="",P=0;P<E;P++)C+=S;return C}function y(S){if(S.slice(0,2)!="")throw new Error("Given data isn't JPEG.");for(var E=2,C=[""];;){if(S.slice(E,E+2)==""){C.push(S.slice(E));break}else{var P=m(">H",S.slice(E+2,E+4))[0],O=E+P+2;C.push(S.slice(E,O)),E=O}if(E>=S.length)throw new Error("Wrong JPEG data.")}return C}function x(S){for(var E,C=0;C<S.length;C++)if(E=S[C],E.slice(0,2)==""&&E.slice(4,10)=="Exif\0\0")return E;return null}function v(S,E){var C=!1,P=[];return S.forEach(function(O,A){O.slice(0,2)==""&&O.slice(4,10)=="Exif\0\0"&&(C?P.unshift(A):(S[A]=E,C=!0))}),P.forEach(function(O){S.splice(O,1)}),!C&&E&&(S=[S[0],E].concat(S.slice(1))),S.join("")}var w={Byte:1,Ascii:2,Short:3,Long:4,Rational:5,Undefined:7,SLong:9,SRational:10},_={Image:{11:{name:"ProcessingSoftware",type:"Ascii"},254:{name:"NewSubfileType",type:"Long"},255:{name:"SubfileType",type:"Short"},256:{name:"ImageWidth",type:"Long"},257:{name:"ImageLength",type:"Long"},258:{name:"BitsPerSample",type:"Short"},259:{name:"Compression",type:"Short"},262:{name:"PhotometricInterpretation",type:"Short"},263:{name:"Threshholding",type:"Short"},264:{name:"CellWidth",type:"Short"},265:{name:"CellLength",type:"Short"},266:{name:"FillOrder",type:"Short"},269:{name:"DocumentName",type:"Ascii"},270:{name:"ImageDescription",type:"Ascii"},271:{name:"Make",type:"Ascii"},272:{name:"Model",type:"Ascii"},273:{name:"StripOffsets",type:"Long"},274:{name:"Orientation",type:"Short"},277:{name:"SamplesPerPixel",type:"Short"},278:{name:"RowsPerStrip",type:"Long"},279:{name:"StripByteCounts",type:"Long"},282:{name:"XResolution",type:"Rational"},283:{name:"YResolution",type:"Rational"},284:{name:"PlanarConfiguration",type:"Short"},290:{name:"GrayResponseUnit",type:"Short"},291:{name:"GrayResponseCurve",type:"Short"},292:{name:"T4Options",type:"Long"},293:{name:"T6Options",type:"Long"},296:{name:"ResolutionUnit",type:"Short"},301:{name:"TransferFunction",type:"Short"},305:{name:"Software",type:"Ascii"},306:{name:"DateTime",type:"Ascii"},315:{name:"Artist",type:"Ascii"},316:{name:"HostComputer",type:"Ascii"},317:{name:"Predictor",type:"Short"},318:{name:"WhitePoint",type:"Rational"},319:{name:"PrimaryChromaticities",type:"Rational"},320:{name:"ColorMap",type:"Short"},321:{name:"HalftoneHints",type:"Short"},322:{name:"TileWidth",type:"Short"},323:{name:"TileLength",type:"Short"},324:{name:"TileOffsets",type:"Short"},325:{name:"TileByteCounts",type:"Short"},330:{name:"SubIFDs",type:"Long"},332:{name:"InkSet",type:"Short"},333:{name:"InkNames",type:"Ascii"},334:{name:"NumberOfInks",type:"Short"},336:{name:"DotRange",type:"Byte"},337:{name:"TargetPrinter",type:"Ascii"},338:{name:"ExtraSamples",type:"Short"},339:{name:"SampleFormat",type:"Short"},340:{name:"SMinSampleValue",type:"Short"},341:{name:"SMaxSampleValue",type:"Short"},342:{name:"TransferRange",type:"Short"},343:{name:"ClipPath",type:"Byte"},344:{name:"XClipPathUnits",type:"Long"},345:{name:"YClipPathUnits",type:"Long"},346:{name:"Indexed",type:"Short"},347:{name:"JPEGTables",type:"Undefined"},351:{name:"OPIProxy",type:"Short"},512:{name:"JPEGProc",type:"Long"},513:{name:"JPEGInterchangeFormat",type:"Long"},514:{name:"JPEGInterchangeFormatLength",type:"Long"},515:{name:"JPEGRestartInterval",type:"Short"},517:{name:"JPEGLosslessPredictors",type:"Short"},518:{name:"JPEGPointTransforms",type:"Short"},519:{name:"JPEGQTables",type:"Long"},520:{name:"JPEGDCTables",type:"Long"},521:{name:"JPEGACTables",type:"Long"},529:{name:"YCbCrCoefficients",type:"Rational"},530:{name:"YCbCrSubSampling",type:"Short"},531:{name:"YCbCrPositioning",type:"Short"},532:{name:"ReferenceBlackWhite",type:"Rational"},700:{name:"XMLPacket",type:"Byte"},18246:{name:"Rating",type:"Short"},18249:{name:"RatingPercent",type:"Short"},32781:{name:"ImageID",type:"Ascii"},33421:{name:"CFARepeatPatternDim",type:"Short"},33422:{name:"CFAPattern",type:"Byte"},33423:{name:"BatteryLevel",type:"Rational"},33432:{name:"Copyright",type:"Ascii"},33434:{name:"ExposureTime",type:"Rational"},34377:{name:"ImageResources",type:"Byte"},34665:{name:"ExifTag",type:"Long"},34675:{name:"InterColorProfile",type:"Undefined"},34853:{name:"GPSTag",type:"Long"},34857:{name:"Interlace",type:"Short"},34858:{name:"TimeZoneOffset",type:"Long"},34859:{name:"SelfTimerMode",type:"Short"},37387:{name:"FlashEnergy",type:"Rational"},37388:{name:"SpatialFrequencyResponse",type:"Undefined"},37389:{name:"Noise",type:"Undefined"},37390:{name:"FocalPlaneXResolution",type:"Rational"},37391:{name:"FocalPlaneYResolution",type:"Rational"},37392:{name:"FocalPlaneResolutionUnit",type:"Short"},37393:{name:"ImageNumber",type:"Long"},37394:{name:"SecurityClassification",type:"Ascii"},37395:{name:"ImageHistory",type:"Ascii"},37397:{name:"ExposureIndex",type:"Rational"},37398:{name:"TIFFEPStandardID",type:"Byte"},37399:{name:"SensingMethod",type:"Short"},40091:{name:"XPTitle",type:"Byte"},40092:{name:"XPComment",type:"Byte"},40093:{name:"XPAuthor",type:"Byte"},40094:{name:"XPKeywords",type:"Byte"},40095:{name:"XPSubject",type:"Byte"},50341:{name:"PrintImageMatching",type:"Undefined"},50706:{name:"DNGVersion",type:"Byte"},50707:{name:"DNGBackwardVersion",type:"Byte"},50708:{name:"UniqueCameraModel",type:"Ascii"},50709:{name:"LocalizedCameraModel",type:"Byte"},50710:{name:"CFAPlaneColor",type:"Byte"},50711:{name:"CFALayout",type:"Short"},50712:{name:"LinearizationTable",type:"Short"},50713:{name:"BlackLevelRepeatDim",type:"Short"},50714:{name:"BlackLevel",type:"Rational"},50715:{name:"BlackLevelDeltaH",type:"SRational"},50716:{name:"BlackLevelDeltaV",type:"SRational"},50717:{name:"WhiteLevel",type:"Short"},50718:{name:"DefaultScale",type:"Rational"},50719:{name:"DefaultCropOrigin",type:"Short"},50720:{name:"DefaultCropSize",type:"Short"},50721:{name:"ColorMatrix1",type:"SRational"},50722:{name:"ColorMatrix2",type:"SRational"},50723:{name:"CameraCalibration1",type:"SRational"},50724:{name:"CameraCalibration2",type:"SRational"},50725:{name:"ReductionMatrix1",type:"SRational"},50726:{name:"ReductionMatrix2",type:"SRational"},50727:{name:"AnalogBalance",type:"Rational"},50728:{name:"AsShotNeutral",type:"Short"},50729:{name:"AsShotWhiteXY",type:"Rational"},50730:{name:"BaselineExposure",type:"SRational"},50731:{name:"BaselineNoise",type:"Rational"},50732:{name:"BaselineSharpness",type:"Rational"},50733:{name:"BayerGreenSplit",type:"Long"},50734:{name:"LinearResponseLimit",type:"Rational"},50735:{name:"CameraSerialNumber",type:"Ascii"},50736:{name:"LensInfo",type:"Rational"},50737:{name:"ChromaBlurRadius",type:"Rational"},50738:{name:"AntiAliasStrength",type:"Rational"},50739:{name:"ShadowScale",type:"SRational"},50740:{name:"DNGPrivateData",type:"Byte"},50741:{name:"MakerNoteSafety",type:"Short"},50778:{name:"CalibrationIlluminant1",type:"Short"},50779:{name:"CalibrationIlluminant2",type:"Short"},50780:{name:"BestQualityScale",type:"Rational"},50781:{name:"RawDataUniqueID",type:"Byte"},50827:{name:"OriginalRawFileName",type:"Byte"},50828:{name:"OriginalRawFileData",type:"Undefined"},50829:{name:"ActiveArea",type:"Short"},50830:{name:"MaskedAreas",type:"Short"},50831:{name:"AsShotICCProfile",type:"Undefined"},50832:{name:"AsShotPreProfileMatrix",type:"SRational"},50833:{name:"CurrentICCProfile",type:"Undefined"},50834:{name:"CurrentPreProfileMatrix",type:"SRational"},50879:{name:"ColorimetricReference",type:"Short"},50931:{name:"CameraCalibrationSignature",type:"Byte"},50932:{name:"ProfileCalibrationSignature",type:"Byte"},50934:{name:"AsShotProfileName",type:"Byte"},50935:{name:"NoiseReductionApplied",type:"Rational"},50936:{name:"ProfileName",type:"Byte"},50937:{name:"ProfileHueSatMapDims",type:"Long"},50938:{name:"ProfileHueSatMapData1",type:"Float"},50939:{name:"ProfileHueSatMapData2",type:"Float"},50940:{name:"ProfileToneCurve",type:"Float"},50941:{name:"ProfileEmbedPolicy",type:"Long"},50942:{name:"ProfileCopyright",type:"Byte"},50964:{name:"ForwardMatrix1",type:"SRational"},50965:{name:"ForwardMatrix2",type:"SRational"},50966:{name:"PreviewApplicationName",type:"Byte"},50967:{name:"PreviewApplicationVersion",type:"Byte"},50968:{name:"PreviewSettingsName",type:"Byte"},50969:{name:"PreviewSettingsDigest",type:"Byte"},50970:{name:"PreviewColorSpace",type:"Long"},50971:{name:"PreviewDateTime",type:"Ascii"},50972:{name:"RawImageDigest",type:"Undefined"},50973:{name:"OriginalRawFileDigest",type:"Undefined"},50974:{name:"SubTileBlockSize",type:"Long"},50975:{name:"RowInterleaveFactor",type:"Long"},50981:{name:"ProfileLookTableDims",type:"Long"},50982:{name:"ProfileLookTableData",type:"Float"},51008:{name:"OpcodeList1",type:"Undefined"},51009:{name:"OpcodeList2",type:"Undefined"},51022:{name:"OpcodeList3",type:"Undefined"}},Exif:{33434:{name:"ExposureTime",type:"Rational"},33437:{name:"FNumber",type:"Rational"},34850:{name:"ExposureProgram",type:"Short"},34852:{name:"SpectralSensitivity",type:"Ascii"},34855:{name:"ISOSpeedRatings",type:"Short"},34856:{name:"OECF",type:"Undefined"},34864:{name:"SensitivityType",type:"Short"},34865:{name:"StandardOutputSensitivity",type:"Long"},34866:{name:"RecommendedExposureIndex",type:"Long"},34867:{name:"ISOSpeed",type:"Long"},34868:{name:"ISOSpeedLatitudeyyy",type:"Long"},34869:{name:"ISOSpeedLatitudezzz",type:"Long"},36864:{name:"ExifVersion",type:"Undefined"},36867:{name:"DateTimeOriginal",type:"Ascii"},36868:{name:"DateTimeDigitized",type:"Ascii"},37121:{name:"ComponentsConfiguration",type:"Undefined"},37122:{name:"CompressedBitsPerPixel",type:"Rational"},37377:{name:"ShutterSpeedValue",type:"SRational"},37378:{name:"ApertureValue",type:"Rational"},37379:{name:"BrightnessValue",type:"SRational"},37380:{name:"ExposureBiasValue",type:"SRational"},37381:{name:"MaxApertureValue",type:"Rational"},37382:{name:"SubjectDistance",type:"Rational"},37383:{name:"MeteringMode",type:"Short"},37384:{name:"LightSource",type:"Short"},37385:{name:"Flash",type:"Short"},37386:{name:"FocalLength",type:"Rational"},37396:{name:"SubjectArea",type:"Short"},37500:{name:"MakerNote",type:"Undefined"},37510:{name:"UserComment",type:"Ascii"},37520:{name:"SubSecTime",type:"Ascii"},37521:{name:"SubSecTimeOriginal",type:"Ascii"},37522:{name:"SubSecTimeDigitized",type:"Ascii"},40960:{name:"FlashpixVersion",type:"Undefined"},40961:{name:"ColorSpace",type:"Short"},40962:{name:"PixelXDimension",type:"Long"},40963:{name:"PixelYDimension",type:"Long"},40964:{name:"RelatedSoundFile",type:"Ascii"},40965:{name:"InteroperabilityTag",type:"Long"},41483:{name:"FlashEnergy",type:"Rational"},41484:{name:"SpatialFrequencyResponse",type:"Undefined"},41486:{name:"FocalPlaneXResolution",type:"Rational"},41487:{name:"FocalPlaneYResolution",type:"Rational"},41488:{name:"FocalPlaneResolutionUnit",type:"Short"},41492:{name:"SubjectLocation",type:"Short"},41493:{name:"ExposureIndex",type:"Rational"},41495:{name:"SensingMethod",type:"Short"},41728:{name:"FileSource",type:"Undefined"},41729:{name:"SceneType",type:"Undefined"},41730:{name:"CFAPattern",type:"Undefined"},41985:{name:"CustomRendered",type:"Short"},41986:{name:"ExposureMode",type:"Short"},41987:{name:"WhiteBalance",type:"Short"},41988:{name:"DigitalZoomRatio",type:"Rational"},41989:{name:"FocalLengthIn35mmFilm",type:"Short"},41990:{name:"SceneCaptureType",type:"Short"},41991:{name:"GainControl",type:"Short"},41992:{name:"Contrast",type:"Short"},41993:{name:"Saturation",type:"Short"},41994:{name:"Sharpness",type:"Short"},41995:{name:"DeviceSettingDescription",type:"Undefined"},41996:{name:"SubjectDistanceRange",type:"Short"},42016:{name:"ImageUniqueID",type:"Ascii"},42032:{name:"CameraOwnerName",type:"Ascii"},42033:{name:"BodySerialNumber",type:"Ascii"},42034:{name:"LensSpecification",type:"Rational"},42035:{name:"LensMake",type:"Ascii"},42036:{name:"LensModel",type:"Ascii"},42037:{name:"LensSerialNumber",type:"Ascii"},42240:{name:"Gamma",type:"Rational"}},GPS:{0:{name:"GPSVersionID",type:"Byte"},1:{name:"GPSLatitudeRef",type:"Ascii"},2:{name:"GPSLatitude",type:"Rational"},3:{name:"GPSLongitudeRef",type:"Ascii"},4:{name:"GPSLongitude",type:"Rational"},5:{name:"GPSAltitudeRef",type:"Byte"},6:{name:"GPSAltitude",type:"Rational"},7:{name:"GPSTimeStamp",type:"Rational"},8:{name:"GPSSatellites",type:"Ascii"},9:{name:"GPSStatus",type:"Ascii"},10:{name:"GPSMeasureMode",type:"Ascii"},11:{name:"GPSDOP",type:"Rational"},12:{name:"GPSSpeedRef",type:"Ascii"},13:{name:"GPSSpeed",type:"Rational"},14:{name:"GPSTrackRef",type:"Ascii"},15:{name:"GPSTrack",type:"Rational"},16:{name:"GPSImgDirectionRef",type:"Ascii"},17:{name:"GPSImgDirection",type:"Rational"},18:{name:"GPSMapDatum",type:"Ascii"},19:{name:"GPSDestLatitudeRef",type:"Ascii"},20:{name:"GPSDestLatitude",type:"Rational"},21:{name:"GPSDestLongitudeRef",type:"Ascii"},22:{name:"GPSDestLongitude",type:"Rational"},23:{name:"GPSDestBearingRef",type:"Ascii"},24:{name:"GPSDestBearing",type:"Rational"},25:{name:"GPSDestDistanceRef",type:"Ascii"},26:{name:"GPSDestDistance",type:"Rational"},27:{name:"GPSProcessingMethod",type:"Undefined"},28:{name:"GPSAreaInformation",type:"Undefined"},29:{name:"GPSDateStamp",type:"Ascii"},30:{name:"GPSDifferential",type:"Short"},31:{name:"GPSHPositioningError",type:"Rational"}},Interop:{1:{name:"InteroperabilityIndex",type:"Ascii"}}};_["0th"]=_.Image,_["1st"]=_.Image,t.TAGS=_,t.ImageIFD={ProcessingSoftware:11,NewSubfileType:254,SubfileType:255,ImageWidth:256,ImageLength:257,BitsPerSample:258,Compression:259,PhotometricInterpretation:262,Threshholding:263,CellWidth:264,CellLength:265,FillOrder:266,DocumentName:269,ImageDescription:270,Make:271,Model:272,StripOffsets:273,Orientation:274,SamplesPerPixel:277,RowsPerStrip:278,StripByteCounts:279,XResolution:282,YResolution:283,PlanarConfiguration:284,GrayResponseUnit:290,GrayResponseCurve:291,T4Options:292,T6Options:293,ResolutionUnit:296,TransferFunction:301,Software:305,DateTime:306,Artist:315,HostComputer:316,Predictor:317,WhitePoint:318,PrimaryChromaticities:319,ColorMap:320,HalftoneHints:321,TileWidth:322,TileLength:323,TileOffsets:324,TileByteCounts:325,SubIFDs:330,InkSet:332,InkNames:333,NumberOfInks:334,DotRange:336,TargetPrinter:337,ExtraSamples:338,SampleFormat:339,SMinSampleValue:340,SMaxSampleValue:341,TransferRange:342,ClipPath:343,XClipPathUnits:344,YClipPathUnits:345,Indexed:346,JPEGTables:347,OPIProxy:351,JPEGProc:512,JPEGInterchangeFormat:513,JPEGInterchangeFormatLength:514,JPEGRestartInterval:515,JPEGLosslessPredictors:517,JPEGPointTransforms:518,JPEGQTables:519,JPEGDCTables:520,JPEGACTables:521,YCbCrCoefficients:529,YCbCrSubSampling:530,YCbCrPositioning:531,ReferenceBlackWhite:532,XMLPacket:700,Rating:18246,RatingPercent:18249,ImageID:32781,CFARepeatPatternDim:33421,CFAPattern:33422,BatteryLevel:33423,Copyright:33432,ExposureTime:33434,ImageResources:34377,ExifTag:34665,InterColorProfile:34675,GPSTag:34853,Interlace:34857,TimeZoneOffset:34858,SelfTimerMode:34859,FlashEnergy:37387,SpatialFrequencyResponse:37388,Noise:37389,FocalPlaneXResolution:37390,FocalPlaneYResolution:37391,FocalPlaneResolutionUnit:37392,ImageNumber:37393,SecurityClassification:37394,ImageHistory:37395,ExposureIndex:37397,TIFFEPStandardID:37398,SensingMethod:37399,XPTitle:40091,XPComment:40092,XPAuthor:40093,XPKeywords:40094,XPSubject:40095,PrintImageMatching:50341,DNGVersion:50706,DNGBackwardVersion:50707,UniqueCameraModel:50708,LocalizedCameraModel:50709,CFAPlaneColor:50710,CFALayout:50711,LinearizationTable:50712,BlackLevelRepeatDim:50713,BlackLevel:50714,BlackLevelDeltaH:50715,BlackLevelDeltaV:50716,WhiteLevel:50717,DefaultScale:50718,DefaultCropOrigin:50719,DefaultCropSize:50720,ColorMatrix1:50721,ColorMatrix2:50722,CameraCalibration1:50723,CameraCalibration2:50724,ReductionMatrix1:50725,ReductionMatrix2:50726,AnalogBalance:50727,AsShotNeutral:50728,AsShotWhiteXY:50729,BaselineExposure:50730,BaselineNoise:50731,BaselineSharpness:50732,BayerGreenSplit:50733,LinearResponseLimit:50734,CameraSerialNumber:50735,LensInfo:50736,ChromaBlurRadius:50737,AntiAliasStrength:50738,ShadowScale:50739,DNGPrivateData:50740,MakerNoteSafety:50741,CalibrationIlluminant1:50778,CalibrationIlluminant2:50779,BestQualityScale:50780,RawDataUniqueID:50781,OriginalRawFileName:50827,OriginalRawFileData:50828,ActiveArea:50829,MaskedAreas:50830,AsShotICCProfile:50831,AsShotPreProfileMatrix:50832,CurrentICCProfile:50833,CurrentPreProfileMatrix:50834,ColorimetricReference:50879,CameraCalibrationSignature:50931,ProfileCalibrationSignature:50932,AsShotProfileName:50934,NoiseReductionApplied:50935,ProfileName:50936,ProfileHueSatMapDims:50937,ProfileHueSatMapData1:50938,ProfileHueSatMapData2:50939,ProfileToneCurve:50940,ProfileEmbedPolicy:50941,ProfileCopyright:50942,ForwardMatrix1:50964,ForwardMatrix2:50965,PreviewApplicationName:50966,PreviewApplicationVersion:50967,PreviewSettingsName:50968,PreviewSettingsDigest:50969,PreviewColorSpace:50970,PreviewDateTime:50971,RawImageDigest:50972,OriginalRawFileDigest:50973,SubTileBlockSize:50974,RowInterleaveFactor:50975,ProfileLookTableDims:50981,ProfileLookTableData:50982,OpcodeList1:51008,OpcodeList2:51009,OpcodeList3:51022,NoiseProfile:51041},t.ExifIFD={ExposureTime:33434,FNumber:33437,ExposureProgram:34850,SpectralSensitivity:34852,ISOSpeedRatings:34855,OECF:34856,SensitivityType:34864,StandardOutputSensitivity:34865,RecommendedExposureIndex:34866,ISOSpeed:34867,ISOSpeedLatitudeyyy:34868,ISOSpeedLatitudezzz:34869,ExifVersion:36864,DateTimeOriginal:36867,DateTimeDigitized:36868,ComponentsConfiguration:37121,CompressedBitsPerPixel:37122,ShutterSpeedValue:37377,ApertureValue:37378,BrightnessValue:37379,ExposureBiasValue:37380,MaxApertureValue:37381,SubjectDistance:37382,MeteringMode:37383,LightSource:37384,Flash:37385,FocalLength:37386,SubjectArea:37396,MakerNote:37500,UserComment:37510,SubSecTime:37520,SubSecTimeOriginal:37521,SubSecTimeDigitized:37522,FlashpixVersion:40960,ColorSpace:40961,PixelXDimension:40962,PixelYDimension:40963,RelatedSoundFile:40964,InteroperabilityTag:40965,FlashEnergy:41483,SpatialFrequencyResponse:41484,FocalPlaneXResolution:41486,FocalPlaneYResolution:41487,FocalPlaneResolutionUnit:41488,SubjectLocation:41492,ExposureIndex:41493,SensingMethod:41495,FileSource:41728,SceneType:41729,CFAPattern:41730,CustomRendered:41985,ExposureMode:41986,WhiteBalance:41987,DigitalZoomRatio:41988,FocalLengthIn35mmFilm:41989,SceneCaptureType:41990,GainControl:41991,Contrast:41992,Saturation:41993,Sharpness:41994,DeviceSettingDescription:41995,SubjectDistanceRange:41996,ImageUniqueID:42016,CameraOwnerName:42032,BodySerialNumber:42033,LensSpecification:42034,LensMake:42035,LensModel:42036,LensSerialNumber:42037,Gamma:42240},t.GPSIFD={GPSVersionID:0,GPSLatitudeRef:1,GPSLatitude:2,GPSLongitudeRef:3,GPSLongitude:4,GPSAltitudeRef:5,GPSAltitude:6,GPSTimeStamp:7,GPSSatellites:8,GPSStatus:9,GPSMeasureMode:10,GPSDOP:11,GPSSpeedRef:12,GPSSpeed:13,GPSTrackRef:14,GPSTrack:15,GPSImgDirectionRef:16,GPSImgDirection:17,GPSMapDatum:18,GPSDestLatitudeRef:19,GPSDestLatitude:20,GPSDestLongitudeRef:21,GPSDestLongitude:22,GPSDestBearingRef:23,GPSDestBearing:24,GPSDestDistanceRef:25,GPSDestDistance:26,GPSProcessingMethod:27,GPSAreaInformation:28,GPSDateStamp:29,GPSDifferential:30,GPSHPositioningError:31},t.InteropIFD={InteroperabilityIndex:1},t.GPSHelper={degToDmsRational:function(S){var E=Math.abs(S),C=E%1*60,P=C%1*60,O=Math.floor(E),A=Math.floor(C),R=Math.round(P*100);return[[O,1],[A,1],[R,100]]},dmsRationalToDeg:function(S,E){var C=E==="S"||E==="W"?-1:1,P=S[0][0]/S[0][1]+S[1][0]/S[1][1]/60+S[2][0]/S[2][1]/3600;return P*C}},n.exports&&(e=n.exports=t),e.piexif=t})()})(fx,fx.exports);var Te=fx.exports;async function bK(n){var e;try{const t=Te.load(n);console.log(" EXIF Extraction - Full EXIF object:",{hasExifObj:!!t,exifObjKeys:t?Object.keys(t):[],has0th:!!(t&&t["0th"]),hasExif:!!(t&&t.Exif),hasGPS:!!(t&&t.GPS),hasInterop:!!(t&&t.Interop),hasThumbnail:!!(t&&t.thumbnail)}),t&&t.Exif&&console.log(" EXIF Extraction - Exif IFD tags:",{DateTimeOriginal:t.Exif[Te.ExifIFD.DateTimeOriginal],DateTimeDigitized:t.Exif[Te.ExifIFD.DateTimeDigitized],Make:t.Exif[Te.ExifIFD.Make],Model:t.Exif[Te.ExifIFD.Model]}),t&&t["0th"]&&console.log(" EXIF Extraction - 0th IFD tags:",{DateTime:t["0th"][Te.ImageIFD.DateTime]});let r=null;const s={};if(t&&t.Exif){if(t.Exif[Te.ExifIFD.DateTimeOriginal]){const i=t.Exif[Te.ExifIFD.DateTimeOriginal];r=xm(i),s.source="DateTimeOriginal"}else if(t.Exif[Te.ExifIFD.DateTimeDigitized]){const i=t.Exif[Te.ExifIFD.DateTimeDigitized];r=xm(i),s.source="DateTimeDigitized"}else if(t["0th"]&&t["0th"][Te.ImageIFD.DateTime]){const i=t["0th"][Te.ImageIFD.DateTime];r=xm(i),s.source="DateTime"}t.Exif[Te.ExifIFD.Make]&&(s.cameraMake=t.Exif[Te.ExifIFD.Make]),t.Exif[Te.ExifIFD.Model]&&(s.cameraModel=t.Exif[Te.ExifIFD.Model])}return console.log(" EXIF Extraction - Final result:",{originalTimestamp:(r==null?void 0:r.toISOString())||"null",originalTimestampLocal:(r==null?void 0:r.toLocaleString())||"null",captureMethod:"gallery",metadata:s}),{originalTimestamp:r,captureMethod:"gallery",metadata:s}}catch(t){return console.error(" EXIF Extraction - PIEXIF Error:",{error:t,errorType:(e=t==null?void 0:t.constructor)==null?void 0:e.name,errorMessage:t==null?void 0:t.message,errorStack:t==null?void 0:t.stack}),{originalTimestamp:null,captureMethod:"gallery",metadata:{error:"Failed to parse EXIF data",errorDetails:t==null?void 0:t.message}}}}function xm(n){try{if(typeof n!="string")return null;const e=n.match(/^(\d{4}):(\d{2}):(\d{2})\s+(\d{2}):(\d{2}):(\d{2})$/);if(!e)return null;const[,t,r,s,i,o,a]=e,l=new Date(parseInt(t),parseInt(r)-1,parseInt(s),parseInt(i),parseInt(o),parseInt(a));return console.log("Parsed EXIF date:",{original:n,parsed:l.toISOString(),local:l.toLocaleString()}),isNaN(l.getTime())?null:l}catch(e){return console.warn("Failed to parse EXIF datetime:",e),null}}function Fee(n,e,t,r){const s=n>=e&&n<=t;return console.log("Timestamp validation:",{photoTime:n.toISOString(),photoLocal:n.toLocaleString(),photoTimeMs:n.getTime(),eventStart:e.toISOString(),eventStartLocal:e.toLocaleString(),eventStartMs:e.getTime(),eventEnd:t.toISOString(),eventEndLocal:t.toLocaleString(),eventEndMs:t.getTime(),eventTimezone:r||"unknown",isWithin:s,diffFromStart:(n.getTime()-e.getTime())/1e3/60,diffFromEnd:(t.getTime()-n.getTime())/1e3/60}),s}function Bee(){return{originalTimestamp:new Date,captureMethod:"camera",metadata:{source:"camera_capture"}}}const _K=async(n,e,t=50)=>{try{console.log("Starting device photo scan...");let r=[];try{if(!de.isNativePlatform())console.log("Web platform detected - requesting user to select photos"),r=await SK(t),console.log(`Selected ${r.length} photos via file input`);else{console.log("Native platform detected - attempting to access recent photos");try{r=(await Id.pickImages({quality:90,limit:t,presentationStyle:"popover"})).photos,console.log(`Found ${r.length} photos using pickImages`)}catch(c){console.log("pickImages failed, showing selection dialog:",c),r=[]}}}catch(l){console.log("Photo access failed:",l),r=[]}const s=new Date(n),i=new Date(e),o=[],a=[];for(const l of r)try{const u=(await bK(l.webPath)).originalTimestamp,h={webPath:l.webPath,path:l.path,exif:l.exif,format:l.format,timestamp:u||void 0,isWithinEvent:!1,selected:!1};u&&u>=s&&u<=i?(h.isWithinEvent=!0,h.selected=!0,o.push(h)):a.push(h)}catch(c){console.error("Error analyzing photo:",c),a.push({webPath:l.webPath,path:l.path,exif:l.exif,format:l.format,isWithinEvent:!1,selected:!1})}return console.log(`Found ${o.length} photos within event timeframe`),{eventPhotos:o,otherPhotos:a,totalScanned:r.length}}catch(r){throw console.error("Error scanning device photos:",r),new Error("Failed to scan device photos. Please ensure you grant photo access permission.")}},SK=async n=>new Promise((e,t)=>{const r=document.createElement("input");r.type="file",r.multiple=!0,r.accept="image/*",r.onchange=async s=>{const i=s.target.files;if(!i||i.length===0){t(new Error("No files selected"));return}const o=[],a=Math.min(i.length,n);for(let l=0;l<a;l++){const c=i[l],u=URL.createObjectURL(c);o.push({webPath:u,format:c.type.split("/")[1]||"jpeg",saved:!1})}e(o)},r.oncancel=()=>{t(new Error("User cancelled photo selection"))},r.click()}),Uee=async n=>{try{if(console.log("Converting photo to data URL:",{webPath:n.webPath,path:n.path,platform:de.getPlatform(),isNative:de.isNativePlatform()}),!n.webPath)throw new Error("No web path available for photo");if(de.isNativePlatform())if(console.log("Native platform detected, processing path:",n.webPath),de.getPlatform()==="ios"){if(console.log("iOS specific handling for path:",n.webPath),n.webPath.startsWith("capacitor://localhost/_capacitor_file_")){const r=n.webPath.replace("capacitor://localhost/_capacitor_file_","");console.log("Extracted iOS path:",r);try{const s=await ym.readFile({path:r}),o=`data:${`image/${n.format||"jpeg"}`};base64,${s.data}`;return console.log("iOS capacitor path conversion successful, length:",o.length),o}catch(s){console.log("iOS capacitor path failed, trying photo.path:",s)}}if(n.path){console.log("Trying with iOS photo.path:",n.path);let r=n.path;r.startsWith("file://")&&(r=r.replace("file://",""));try{const s=await ym.readFile({path:r}),o=`data:${`image/${n.format||"jpeg"}`};base64,${s.data}`;return console.log("iOS photo.path conversion successful, length:",o.length),o}catch(s){console.log("iOS photo.path failed:",s)}}if(console.log("iOS trying fallback with webPath"),fo(n.webPath))return console.log("iOS webPath is data URL, returning directly"),n.webPath;const t=await(await fetch(n.webPath)).blob();return new Promise((r,s)=>{const i=new FileReader;i.onload=()=>{console.log("iOS fetch fallback successful"),r(i.result)},i.onerror=o=>{console.error("iOS fetch fallback failed:",o),s(o)},i.readAsDataURL(t)})}else{console.log("Android platform handling");let e=n.webPath;e.startsWith("file://")&&(e=e.replace("file://",""));const t=await ym.readFile({path:e}),s=`data:${`image/${n.format||"jpeg"}`};base64,${t.data}`;return console.log("Android conversion successful, length:",s.length),s}else{if(console.log("Web platform detected, checking URL type"),fo(n.webPath))return console.log("Web webPath is data URL, returning directly"),n.webPath;console.log("Web platform using fetch for blob URL");const t=await(await fetch(n.webPath)).blob();return new Promise((r,s)=>{const i=new FileReader;i.onload=()=>{console.log("Web conversion successful"),r(i.result)},i.onerror=s,i.readAsDataURL(t)})}}catch(e){throw console.error("Error converting photo to data URL:",e),e}},CK=()=>{const[n,e]=b.useState(!1),[t,r]=b.useState(!1),[s,i]=b.useState([]),{isNative:o}=Od(),{scheduleEventNotifications:a,hasPermission:l}=YI(),{toast:c}=Bt();b.useEffect(()=>{const y=localStorage.getItem("autoPhotoDetection")==="true",x=localStorage.getItem("eventTimeframes");if(r(y),x)try{i(JSON.parse(x))}catch(v){console.error("Error loading saved event timeframes:",v)}},[]),b.useEffect(()=>{localStorage.setItem("autoPhotoDetection",t.toString()),localStorage.setItem("eventTimeframes",JSON.stringify(s))},[t,s]);const u=b.useCallback(y=>{i(x=>x.find(w=>w.eventId===y.eventId)?x.map(w=>w.eventId===y.eventId?y:w):[...x,y]),c({title:"Auto-detection enabled",description:`Will automatically detect photos for ${y.eventName}`})},[c]),h=b.useCallback(y=>{i(x=>x.filter(v=>v.eventId!==y)),c({title:"Auto-detection disabled",description:"Automatic photo detection has been disabled for this event."})},[c]),d=b.useCallback(y=>{const x=new Date,v=new Date(y.startTime),w=new Date(y.endTime);return x>=v&&x<=w},[]),p=b.useCallback(async y=>{if(!o||n)return null;const x=s.find(v=>v.eventId===y);if(!x)return null;e(!0);try{const v=d(x),w=await _K(x.startTime,x.endTime,100),_={newPhotos:w.eventPhotos,totalScanned:w.totalScanned,isWithinEventTime:v};return w.eventPhotos.length>0&&c({title:` Found ${w.eventPhotos.length} photos`,description:`Photos taken during ${x.eventName}`}),_}catch(v){return console.error("Error scanning for event photos:",v),c({title:"Scan failed",description:"Unable to scan device photos.",variant:"destructive"}),null}finally{e(!1)}},[o,n,s,d,c]),m=b.useCallback(()=>{r(y=>!y),c(t?{title:"Auto-detection disabled",description:"Automatic photo scanning has been disabled."}:{title:"Auto-detection enabled",description:"Will automatically scan for photos during active events."})},[t,c]),g=b.useCallback(async y=>{if(!(!o||!l))try{await a(y),u(y),c({title:"Event setup complete",description:"Reminders scheduled and auto-detection enabled."})}catch(x){console.error("Error setting up event reminders:",x),c({title:"Setup failed",description:"Unable to complete event setup.",variant:"destructive"})}},[o,l,a,u,c]);return{isScanning:n,isEnabled:t,eventTimeframes:s,enableAutoDetection:u,disableAutoDetection:h,scanForEventPhotos:p,toggleAutoDetection:m,setupEventReminders:g}},EK=()=>{const[n,e]=b.useState(!1),[t,r]=b.useState(null),{toast:s}=Bt();b.useEffect(()=>{i()},[]);const i=async()=>{try{const h=ci();console.log(" Initializing push notifications for platform:",h),await Vh("tokenReceived",p=>{const m=zY(p);console.log("Push registration success, token: "+m),e(!0),r(m),localStorage.setItem("push_token",m),s({title:"Notifications enabled",description:"You'll receive event updates and reminders."})}),await Vh("error",p=>{console.error("Error on registration: "+JSON.stringify(p)),s({title:"Notification setup failed",description:"Unable to enable push notifications.",variant:"destructive"})}),await Vh("notificationReceived",p=>{console.log("Push notification received: ",p),s({title:p.title||"New notification",description:p.body||"You have a new update."})}),await Vh("notificationActionPerformed",p=>{var g;console.log("Push notification action performed: ",p);const m=((g=p.notification)==null?void 0:g.data)||p.data;m!=null&&m.deepLink?(console.log(" Using deep link handler for:",m.deepLink),typeof window.handlePhotoShareDeepLink=="function"?window.handlePhotoShareDeepLink(m.deepLink):(console.warn(" handlePhotoShareDeepLink not available, using fallback"),window.location.href="/dashboard")):m!=null&&m.eventId?(console.log(" Legacy notification, navigating to event:",m.eventId),window.location.href=`/event/${m.eventId}`):(console.log(" No deep link data, navigating to dashboard"),window.location.href="/dashboard")});const d=localStorage.getItem("push_token");d&&(e(!0),r(d))}catch(h){console.error("Push notification initialization failed:",h)}};return{isRegistered:n,token:t,requestPermissions:async()=>{var h,d,p;try{const m=ci();let g=!1,y;try{const x=await((p=(d=(h=window.Capacitor)==null?void 0:h.Plugins)==null?void 0:d.AppPermissions)==null?void 0:p.requestNotificationPermission());g=(x==null?void 0:x.granted)||!1,y=x==null?void 0:x.error}catch(x){console.log("AppPermissions plugin not available, trying fallback:",x);const v=await DI();g=v.granted,y=v.error}if(g){if(m==="android"){const x=await BY();x!=null&&x.token&&(r(x.token),e(!0),localStorage.setItem("push_token",x.token))}else m==="ios"&&await UY();return!0}else return s({title:"Permissions denied",description:y||"Push notifications are disabled. You can enable them in settings.",variant:"destructive"}),!1}catch(m){return console.error("Permission request failed:",m),s({title:"Permission error",description:"Unable to request notification permissions.",variant:"destructive"}),!1}},sendTestNotification:()=>{s({title:" New photo uploaded!",description:"Someone just shared a moment at Sarah's Wedding"})},scheduleEventReminder:(h,d)=>{console.log(`Scheduled reminder for ${h} at ${d}`),s({title:"Reminder set",description:`You'll be notified before ${h} starts.`})},registerForEventNotifications:async h=>{const d=localStorage.getItem("push_token");if(!d){console.log("No push token available");return}try{const p=JSON.parse(localStorage.getItem("event_notifications")||"{}");p[h.eventId]={push_token:d,event_start:h.startTime,event_end:h.endTime,deletion_date:h.deleteDate,notification_types:["event_reminder","event_live","event_ending","deletion_warning"],created_at:new Date().toISOString()},localStorage.setItem("event_notifications",JSON.stringify(p)),s({title:"Notifications registered",description:`You'll receive push notifications for ${h.eventName}`})}catch(p){console.error("Error registering for event notifications:",p),s({title:"Registration failed",description:"Unable to register for event notifications.",variant:"destructive"})}},unregisterFromEventNotifications:async h=>{try{const d=JSON.parse(localStorage.getItem("event_notifications")||"{}");delete d[h],localStorage.setItem("event_notifications",JSON.stringify(d)),s({title:"Notifications disabled",description:"Event notifications have been disabled."})}catch(d){console.error("Error unregistering from event notifications:",d)}}}},kK=()=>{const{scheduleEventNotifications:n,cancelEventNotifications:e,hasPermission:t}=YI(),{setupEventReminders:r,scanForEventPhotos:s}=CK(),{registerForEventNotifications:i,unregisterFromEventNotifications:o,isRegistered:a}=EK(),{preferences:l,getNotificationSchedule:c,syncPreferencesWithFirebase:u}=X1(),{toast:h}=Bt(),d=b.useCallback(async g=>{try{const y=[];if(t&&y.push(n(g)),a&&l.enabled&&de.isNativePlatform()){y.push(i(g));const v=c(g.eventId,g.eventName,g.startTime,g.endTime);if(v&&v.length>0){const w=localStorage.getItem("push_token");if(w){const _=JSON.parse(localStorage.getItem("firebase_event_schedules")||"{}");_[g.eventId]={eventData:g,notificationSchedule:v,token:w,platform:de.getPlatform(),createdAt:new Date().toISOString()},localStorage.setItem("firebase_event_schedules",JSON.stringify(_)),await u(w),console.log(" Firebase notification schedule created:",v)}}}y.push(r(g)),await Promise.allSettled(y);const x=[];t&&x.push("local"),a&&l.enabled&&x.push("push"),h({title:"Event notifications setup",description:`${x.join(" and ")} notifications configured for ${g.eventName}`})}catch(y){console.error("Error setting up event notifications:",y),h({title:"Setup incomplete",description:"Some notifications could not be configured.",variant:"destructive"})}},[t,a,l,n,i,r,c,u,h]),p=b.useCallback(async g=>{try{const y=[e(g),o(g)],x=JSON.parse(localStorage.getItem("firebase_event_schedules")||"{}");delete x[g],localStorage.setItem("firebase_event_schedules",JSON.stringify(x)),await Promise.allSettled(y),h({title:"Notifications removed",description:"All event notifications have been cancelled."})}catch(y){console.error("Error removing event notifications:",y)}},[e,o,h]),m=b.useCallback(async g=>{try{await r(g),h({title:"Auto-detection enabled",description:"Will automatically detect photos during the event."})}catch(y){console.error("Error enabling auto photo detection:",y),h({title:"Setup failed",description:"Unable to enable auto photo detection.",variant:"destructive"})}},[r,h]);return{setupEventNotifications:d,removeEventNotifications:p,enableAutoPhotoDetection:m,scanForEventPhotos:s}};var XI={exports:{}};function PK(n){throw new Error('Could not dynamically require "'+n+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var wm={exports:{}};const TK={},AK=Object.freeze(Object.defineProperty({__proto__:null,default:TK},Symbol.toStringTag,{value:"Module"})),DK=G2(AK);var IE;function Ze(){return IE||(IE=1,function(n,e){(function(t,r){n.exports=r()})(Ie,function(){var t=t||function(r,s){var i;if(typeof window<"u"&&window.crypto&&(i=window.crypto),typeof self<"u"&&self.crypto&&(i=self.crypto),typeof globalThis<"u"&&globalThis.crypto&&(i=globalThis.crypto),!i&&typeof window<"u"&&window.msCrypto&&(i=window.msCrypto),!i&&typeof Ie<"u"&&Ie.crypto&&(i=Ie.crypto),!i&&typeof PK=="function")try{i=DK}catch{}var o=function(){if(i){if(typeof i.getRandomValues=="function")try{return i.getRandomValues(new Uint32Array(1))[0]}catch{}if(typeof i.randomBytes=="function")try{return i.randomBytes(4).readInt32LE()}catch{}}throw new Error("Native crypto module could not be used to get secure random number.")},a=Object.create||function(){function v(){}return function(w){var _;return v.prototype=w,_=new v,v.prototype=null,_}}(),l={},c=l.lib={},u=c.Base=function(){return{extend:function(v){var w=a(this);return v&&w.mixIn(v),(!w.hasOwnProperty("init")||this.init===w.init)&&(w.init=function(){w.$super.init.apply(this,arguments)}),w.init.prototype=w,w.$super=this,w},create:function(){var v=this.extend();return v.init.apply(v,arguments),v},init:function(){},mixIn:function(v){for(var w in v)v.hasOwnProperty(w)&&(this[w]=v[w]);v.hasOwnProperty("toString")&&(this.toString=v.toString)},clone:function(){return this.init.prototype.extend(this)}}}(),h=c.WordArray=u.extend({init:function(v,w){v=this.words=v||[],w!=s?this.sigBytes=w:this.sigBytes=v.length*4},toString:function(v){return(v||p).stringify(this)},concat:function(v){var w=this.words,_=v.words,S=this.sigBytes,E=v.sigBytes;if(this.clamp(),S%4)for(var C=0;C<E;C++){var P=_[C>>>2]>>>24-C%4*8&255;w[S+C>>>2]|=P<<24-(S+C)%4*8}else for(var O=0;O<E;O+=4)w[S+O>>>2]=_[O>>>2];return this.sigBytes+=E,this},clamp:function(){var v=this.words,w=this.sigBytes;v[w>>>2]&=4294967295<<32-w%4*8,v.length=r.ceil(w/4)},clone:function(){var v=u.clone.call(this);return v.words=this.words.slice(0),v},random:function(v){for(var w=[],_=0;_<v;_+=4)w.push(o());return new h.init(w,v)}}),d=l.enc={},p=d.Hex={stringify:function(v){for(var w=v.words,_=v.sigBytes,S=[],E=0;E<_;E++){var C=w[E>>>2]>>>24-E%4*8&255;S.push((C>>>4).toString(16)),S.push((C&15).toString(16))}return S.join("")},parse:function(v){for(var w=v.length,_=[],S=0;S<w;S+=2)_[S>>>3]|=parseInt(v.substr(S,2),16)<<24-S%8*4;return new h.init(_,w/2)}},m=d.Latin1={stringify:function(v){for(var w=v.words,_=v.sigBytes,S=[],E=0;E<_;E++){var C=w[E>>>2]>>>24-E%4*8&255;S.push(String.fromCharCode(C))}return S.join("")},parse:function(v){for(var w=v.length,_=[],S=0;S<w;S++)_[S>>>2]|=(v.charCodeAt(S)&255)<<24-S%4*8;return new h.init(_,w)}},g=d.Utf8={stringify:function(v){try{return decodeURIComponent(escape(m.stringify(v)))}catch{throw new Error("Malformed UTF-8 data")}},parse:function(v){return m.parse(unescape(encodeURIComponent(v)))}},y=c.BufferedBlockAlgorithm=u.extend({reset:function(){this._data=new h.init,this._nDataBytes=0},_append:function(v){typeof v=="string"&&(v=g.parse(v)),this._data.concat(v),this._nDataBytes+=v.sigBytes},_process:function(v){var w,_=this._data,S=_.words,E=_.sigBytes,C=this.blockSize,P=C*4,O=E/P;v?O=r.ceil(O):O=r.max((O|0)-this._minBufferSize,0);var A=O*C,R=r.min(A*4,E);if(A){for(var B=0;B<A;B+=C)this._doProcessBlock(S,B);w=S.splice(0,A),_.sigBytes-=R}return new h.init(w,R)},clone:function(){var v=u.clone.call(this);return v._data=this._data.clone(),v},_minBufferSize:0});c.Hasher=y.extend({cfg:u.extend(),init:function(v){this.cfg=this.cfg.extend(v),this.reset()},reset:function(){y.reset.call(this),this._doReset()},update:function(v){return this._append(v),this._process(),this},finalize:function(v){v&&this._append(v);var w=this._doFinalize();return w},blockSize:16,_createHelper:function(v){return function(w,_){return new v.init(_).finalize(w)}},_createHmacHelper:function(v){return function(w,_){return new x.HMAC.init(v,_).finalize(w)}}});var x=l.algo={};return l}(Math);return t})}(wm)),wm.exports}var bm={exports:{}},RE;function $0(){return RE||(RE=1,function(n,e){(function(t,r){n.exports=r(Ze())})(Ie,function(t){return function(r){var s=t,i=s.lib,o=i.Base,a=i.WordArray,l=s.x64={};l.Word=o.extend({init:function(c,u){this.high=c,this.low=u}}),l.WordArray=o.extend({init:function(c,u){c=this.words=c||[],u!=r?this.sigBytes=u:this.sigBytes=c.length*8},toX32:function(){for(var c=this.words,u=c.length,h=[],d=0;d<u;d++){var p=c[d];h.push(p.high),h.push(p.low)}return a.create(h,this.sigBytes)},clone:function(){for(var c=o.clone.call(this),u=c.words=this.words.slice(0),h=u.length,d=0;d<h;d++)u[d]=u[d].clone();return c}})}(),t})}(bm)),bm.exports}var _m={exports:{}},NE;function OK(){return NE||(NE=1,function(n,e){(function(t,r){n.exports=r(Ze())})(Ie,function(t){return function(){if(typeof ArrayBuffer=="function"){var r=t,s=r.lib,i=s.WordArray,o=i.init,a=i.init=function(l){if(l instanceof ArrayBuffer&&(l=new Uint8Array(l)),(l instanceof Int8Array||typeof Uint8ClampedArray<"u"&&l instanceof Uint8ClampedArray||l instanceof Int16Array||l instanceof Uint16Array||l instanceof Int32Array||l instanceof Uint32Array||l instanceof Float32Array||l instanceof Float64Array)&&(l=new Uint8Array(l.buffer,l.byteOffset,l.byteLength)),l instanceof Uint8Array){for(var c=l.byteLength,u=[],h=0;h<c;h++)u[h>>>2]|=l[h]<<24-h%4*8;o.call(this,u,c)}else o.apply(this,arguments)};a.prototype=i}}(),t.lib.WordArray})}(_m)),_m.exports}var Sm={exports:{}},jE;function IK(){return jE||(jE=1,function(n,e){(function(t,r){n.exports=r(Ze())})(Ie,function(t){return function(){var r=t,s=r.lib,i=s.WordArray,o=r.enc;o.Utf16=o.Utf16BE={stringify:function(l){for(var c=l.words,u=l.sigBytes,h=[],d=0;d<u;d+=2){var p=c[d>>>2]>>>16-d%4*8&65535;h.push(String.fromCharCode(p))}return h.join("")},parse:function(l){for(var c=l.length,u=[],h=0;h<c;h++)u[h>>>1]|=l.charCodeAt(h)<<16-h%2*16;return i.create(u,c*2)}},o.Utf16LE={stringify:function(l){for(var c=l.words,u=l.sigBytes,h=[],d=0;d<u;d+=2){var p=a(c[d>>>2]>>>16-d%4*8&65535);h.push(String.fromCharCode(p))}return h.join("")},parse:function(l){for(var c=l.length,u=[],h=0;h<c;h++)u[h>>>1]|=a(l.charCodeAt(h)<<16-h%2*16);return i.create(u,c*2)}};function a(l){return l<<8&4278255360|l>>>8&16711935}}(),t.enc.Utf16})}(Sm)),Sm.exports}var Cm={exports:{}},LE;function Pa(){return LE||(LE=1,function(n,e){(function(t,r){n.exports=r(Ze())})(Ie,function(t){return function(){var r=t,s=r.lib,i=s.WordArray,o=r.enc;o.Base64={stringify:function(l){var c=l.words,u=l.sigBytes,h=this._map;l.clamp();for(var d=[],p=0;p<u;p+=3)for(var m=c[p>>>2]>>>24-p%4*8&255,g=c[p+1>>>2]>>>24-(p+1)%4*8&255,y=c[p+2>>>2]>>>24-(p+2)%4*8&255,x=m<<16|g<<8|y,v=0;v<4&&p+v*.75<u;v++)d.push(h.charAt(x>>>6*(3-v)&63));var w=h.charAt(64);if(w)for(;d.length%4;)d.push(w);return d.join("")},parse:function(l){var c=l.length,u=this._map,h=this._reverseMap;if(!h){h=this._reverseMap=[];for(var d=0;d<u.length;d++)h[u.charCodeAt(d)]=d}var p=u.charAt(64);if(p){var m=l.indexOf(p);m!==-1&&(c=m)}return a(l,c,h)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="};function a(l,c,u){for(var h=[],d=0,p=0;p<c;p++)if(p%4){var m=u[l.charCodeAt(p-1)]<<p%4*2,g=u[l.charCodeAt(p)]>>>6-p%4*2,y=m|g;h[d>>>2]|=y<<24-d%4*8,d++}return i.create(h,d)}}(),t.enc.Base64})}(Cm)),Cm.exports}var Em={exports:{}},ME;function RK(){return ME||(ME=1,function(n,e){(function(t,r){n.exports=r(Ze())})(Ie,function(t){return function(){var r=t,s=r.lib,i=s.WordArray,o=r.enc;o.Base64url={stringify:function(l,c){c===void 0&&(c=!0);var u=l.words,h=l.sigBytes,d=c?this._safe_map:this._map;l.clamp();for(var p=[],m=0;m<h;m+=3)for(var g=u[m>>>2]>>>24-m%4*8&255,y=u[m+1>>>2]>>>24-(m+1)%4*8&255,x=u[m+2>>>2]>>>24-(m+2)%4*8&255,v=g<<16|y<<8|x,w=0;w<4&&m+w*.75<h;w++)p.push(d.charAt(v>>>6*(3-w)&63));var _=d.charAt(64);if(_)for(;p.length%4;)p.push(_);return p.join("")},parse:function(l,c){c===void 0&&(c=!0);var u=l.length,h=c?this._safe_map:this._map,d=this._reverseMap;if(!d){d=this._reverseMap=[];for(var p=0;p<h.length;p++)d[h.charCodeAt(p)]=p}var m=h.charAt(64);if(m){var g=l.indexOf(m);g!==-1&&(u=g)}return a(l,u,d)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",_safe_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_"};function a(l,c,u){for(var h=[],d=0,p=0;p<c;p++)if(p%4){var m=u[l.charCodeAt(p-1)]<<p%4*2,g=u[l.charCodeAt(p)]>>>6-p%4*2,y=m|g;h[d>>>2]|=y<<24-d%4*8,d++}return i.create(h,d)}}(),t.enc.Base64url})}(Em)),Em.exports}var km={exports:{}},FE;function Ta(){return FE||(FE=1,function(n,e){(function(t,r){n.exports=r(Ze())})(Ie,function(t){return function(r){var s=t,i=s.lib,o=i.WordArray,a=i.Hasher,l=s.algo,c=[];(function(){for(var g=0;g<64;g++)c[g]=r.abs(r.sin(g+1))*4294967296|0})();var u=l.MD5=a.extend({_doReset:function(){this._hash=new o.init([1732584193,4023233417,2562383102,271733878])},_doProcessBlock:function(g,y){for(var x=0;x<16;x++){var v=y+x,w=g[v];g[v]=(w<<8|w>>>24)&16711935|(w<<24|w>>>8)&4278255360}var _=this._hash.words,S=g[y+0],E=g[y+1],C=g[y+2],P=g[y+3],O=g[y+4],A=g[y+5],R=g[y+6],B=g[y+7],I=g[y+8],L=g[y+9],U=g[y+10],F=g[y+11],D=g[y+12],k=g[y+13],N=g[y+14],M=g[y+15],T=_[0],j=_[1],$=_[2],z=_[3];T=h(T,j,$,z,S,7,c[0]),z=h(z,T,j,$,E,12,c[1]),$=h($,z,T,j,C,17,c[2]),j=h(j,$,z,T,P,22,c[3]),T=h(T,j,$,z,O,7,c[4]),z=h(z,T,j,$,A,12,c[5]),$=h($,z,T,j,R,17,c[6]),j=h(j,$,z,T,B,22,c[7]),T=h(T,j,$,z,I,7,c[8]),z=h(z,T,j,$,L,12,c[9]),$=h($,z,T,j,U,17,c[10]),j=h(j,$,z,T,F,22,c[11]),T=h(T,j,$,z,D,7,c[12]),z=h(z,T,j,$,k,12,c[13]),$=h($,z,T,j,N,17,c[14]),j=h(j,$,z,T,M,22,c[15]),T=d(T,j,$,z,E,5,c[16]),z=d(z,T,j,$,R,9,c[17]),$=d($,z,T,j,F,14,c[18]),j=d(j,$,z,T,S,20,c[19]),T=d(T,j,$,z,A,5,c[20]),z=d(z,T,j,$,U,9,c[21]),$=d($,z,T,j,M,14,c[22]),j=d(j,$,z,T,O,20,c[23]),T=d(T,j,$,z,L,5,c[24]),z=d(z,T,j,$,N,9,c[25]),$=d($,z,T,j,P,14,c[26]),j=d(j,$,z,T,I,20,c[27]),T=d(T,j,$,z,k,5,c[28]),z=d(z,T,j,$,C,9,c[29]),$=d($,z,T,j,B,14,c[30]),j=d(j,$,z,T,D,20,c[31]),T=p(T,j,$,z,A,4,c[32]),z=p(z,T,j,$,I,11,c[33]),$=p($,z,T,j,F,16,c[34]),j=p(j,$,z,T,N,23,c[35]),T=p(T,j,$,z,E,4,c[36]),z=p(z,T,j,$,O,11,c[37]),$=p($,z,T,j,B,16,c[38]),j=p(j,$,z,T,U,23,c[39]),T=p(T,j,$,z,k,4,c[40]),z=p(z,T,j,$,S,11,c[41]),$=p($,z,T,j,P,16,c[42]),j=p(j,$,z,T,R,23,c[43]),T=p(T,j,$,z,L,4,c[44]),z=p(z,T,j,$,D,11,c[45]),$=p($,z,T,j,M,16,c[46]),j=p(j,$,z,T,C,23,c[47]),T=m(T,j,$,z,S,6,c[48]),z=m(z,T,j,$,B,10,c[49]),$=m($,z,T,j,N,15,c[50]),j=m(j,$,z,T,A,21,c[51]),T=m(T,j,$,z,D,6,c[52]),z=m(z,T,j,$,P,10,c[53]),$=m($,z,T,j,U,15,c[54]),j=m(j,$,z,T,E,21,c[55]),T=m(T,j,$,z,I,6,c[56]),z=m(z,T,j,$,M,10,c[57]),$=m($,z,T,j,R,15,c[58]),j=m(j,$,z,T,k,21,c[59]),T=m(T,j,$,z,O,6,c[60]),z=m(z,T,j,$,F,10,c[61]),$=m($,z,T,j,C,15,c[62]),j=m(j,$,z,T,L,21,c[63]),_[0]=_[0]+T|0,_[1]=_[1]+j|0,_[2]=_[2]+$|0,_[3]=_[3]+z|0},_doFinalize:function(){var g=this._data,y=g.words,x=this._nDataBytes*8,v=g.sigBytes*8;y[v>>>5]|=128<<24-v%32;var w=r.floor(x/4294967296),_=x;y[(v+64>>>9<<4)+15]=(w<<8|w>>>24)&16711935|(w<<24|w>>>8)&4278255360,y[(v+64>>>9<<4)+14]=(_<<8|_>>>24)&16711935|(_<<24|_>>>8)&4278255360,g.sigBytes=(y.length+1)*4,this._process();for(var S=this._hash,E=S.words,C=0;C<4;C++){var P=E[C];E[C]=(P<<8|P>>>24)&16711935|(P<<24|P>>>8)&4278255360}return S},clone:function(){var g=a.clone.call(this);return g._hash=this._hash.clone(),g}});function h(g,y,x,v,w,_,S){var E=g+(y&x|~y&v)+w+S;return(E<<_|E>>>32-_)+y}function d(g,y,x,v,w,_,S){var E=g+(y&v|x&~v)+w+S;return(E<<_|E>>>32-_)+y}function p(g,y,x,v,w,_,S){var E=g+(y^x^v)+w+S;return(E<<_|E>>>32-_)+y}function m(g,y,x,v,w,_,S){var E=g+(x^(y|~v))+w+S;return(E<<_|E>>>32-_)+y}s.MD5=a._createHelper(u),s.HmacMD5=a._createHmacHelper(u)}(Math),t.MD5})}(km)),km.exports}var Pm={exports:{}},BE;function KI(){return BE||(BE=1,function(n,e){(function(t,r){n.exports=r(Ze())})(Ie,function(t){return function(){var r=t,s=r.lib,i=s.WordArray,o=s.Hasher,a=r.algo,l=[],c=a.SHA1=o.extend({_doReset:function(){this._hash=new i.init([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(u,h){for(var d=this._hash.words,p=d[0],m=d[1],g=d[2],y=d[3],x=d[4],v=0;v<80;v++){if(v<16)l[v]=u[h+v]|0;else{var w=l[v-3]^l[v-8]^l[v-14]^l[v-16];l[v]=w<<1|w>>>31}var _=(p<<5|p>>>27)+x+l[v];v<20?_+=(m&g|~m&y)+1518500249:v<40?_+=(m^g^y)+1859775393:v<60?_+=(m&g|m&y|g&y)-1894007588:_+=(m^g^y)-899497514,x=y,y=g,g=m<<30|m>>>2,m=p,p=_}d[0]=d[0]+p|0,d[1]=d[1]+m|0,d[2]=d[2]+g|0,d[3]=d[3]+y|0,d[4]=d[4]+x|0},_doFinalize:function(){var u=this._data,h=u.words,d=this._nDataBytes*8,p=u.sigBytes*8;return h[p>>>5]|=128<<24-p%32,h[(p+64>>>9<<4)+14]=Math.floor(d/4294967296),h[(p+64>>>9<<4)+15]=d,u.sigBytes=h.length*4,this._process(),this._hash},clone:function(){var u=o.clone.call(this);return u._hash=this._hash.clone(),u}});r.SHA1=o._createHelper(c),r.HmacSHA1=o._createHmacHelper(c)}(),t.SHA1})}(Pm)),Pm.exports}var Tm={exports:{}},UE;function K1(){return UE||(UE=1,function(n,e){(function(t,r){n.exports=r(Ze())})(Ie,function(t){return function(r){var s=t,i=s.lib,o=i.WordArray,a=i.Hasher,l=s.algo,c=[],u=[];(function(){function p(x){for(var v=r.sqrt(x),w=2;w<=v;w++)if(!(x%w))return!1;return!0}function m(x){return(x-(x|0))*4294967296|0}for(var g=2,y=0;y<64;)p(g)&&(y<8&&(c[y]=m(r.pow(g,1/2))),u[y]=m(r.pow(g,1/3)),y++),g++})();var h=[],d=l.SHA256=a.extend({_doReset:function(){this._hash=new o.init(c.slice(0))},_doProcessBlock:function(p,m){for(var g=this._hash.words,y=g[0],x=g[1],v=g[2],w=g[3],_=g[4],S=g[5],E=g[6],C=g[7],P=0;P<64;P++){if(P<16)h[P]=p[m+P]|0;else{var O=h[P-15],A=(O<<25|O>>>7)^(O<<14|O>>>18)^O>>>3,R=h[P-2],B=(R<<15|R>>>17)^(R<<13|R>>>19)^R>>>10;h[P]=A+h[P-7]+B+h[P-16]}var I=_&S^~_&E,L=y&x^y&v^x&v,U=(y<<30|y>>>2)^(y<<19|y>>>13)^(y<<10|y>>>22),F=(_<<26|_>>>6)^(_<<21|_>>>11)^(_<<7|_>>>25),D=C+F+I+u[P]+h[P],k=U+L;C=E,E=S,S=_,_=w+D|0,w=v,v=x,x=y,y=D+k|0}g[0]=g[0]+y|0,g[1]=g[1]+x|0,g[2]=g[2]+v|0,g[3]=g[3]+w|0,g[4]=g[4]+_|0,g[5]=g[5]+S|0,g[6]=g[6]+E|0,g[7]=g[7]+C|0},_doFinalize:function(){var p=this._data,m=p.words,g=this._nDataBytes*8,y=p.sigBytes*8;return m[y>>>5]|=128<<24-y%32,m[(y+64>>>9<<4)+14]=r.floor(g/4294967296),m[(y+64>>>9<<4)+15]=g,p.sigBytes=m.length*4,this._process(),this._hash},clone:function(){var p=a.clone.call(this);return p._hash=this._hash.clone(),p}});s.SHA256=a._createHelper(d),s.HmacSHA256=a._createHmacHelper(d)}(Math),t.SHA256})}(Tm)),Tm.exports}var Am={exports:{}},$E;function NK(){return $E||($E=1,function(n,e){(function(t,r,s){n.exports=r(Ze(),K1())})(Ie,function(t){return function(){var r=t,s=r.lib,i=s.WordArray,o=r.algo,a=o.SHA256,l=o.SHA224=a.extend({_doReset:function(){this._hash=new i.init([3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428])},_doFinalize:function(){var c=a._doFinalize.call(this);return c.sigBytes-=4,c}});r.SHA224=a._createHelper(l),r.HmacSHA224=a._createHmacHelper(l)}(),t.SHA224})}(Am)),Am.exports}var Dm={exports:{}},zE;function JI(){return zE||(zE=1,function(n,e){(function(t,r,s){n.exports=r(Ze(),$0())})(Ie,function(t){return function(){var r=t,s=r.lib,i=s.Hasher,o=r.x64,a=o.Word,l=o.WordArray,c=r.algo;function u(){return a.create.apply(a,arguments)}var h=[u(1116352408,3609767458),u(1899447441,602891725),u(3049323471,3964484399),u(3921009573,2173295548),u(961987163,4081628472),u(1508970993,3053834265),u(2453635748,2937671579),u(2870763221,3664609560),u(3624381080,2734883394),u(310598401,1164996542),u(607225278,1323610764),u(1426881987,3590304994),u(1925078388,4068182383),u(2162078206,991336113),u(2614888103,633803317),u(3248222580,3479774868),u(3835390401,2666613458),u(4022224774,944711139),u(264347078,2341262773),u(604807628,2007800933),u(770255983,1495990901),u(1249150122,1856431235),u(1555081692,3175218132),u(1996064986,2198950837),u(2554220882,3999719339),u(2821834349,766784016),u(2952996808,2566594879),u(3210313671,3203337956),u(3336571891,1034457026),u(3584528711,2466948901),u(113926993,3758326383),u(338241895,168717936),u(666307205,1188179964),u(773529912,1546045734),u(1294757372,1522805485),u(1396182291,2643833823),u(1695183700,2343527390),u(1986661051,1014477480),u(2177026350,1206759142),u(2456956037,344077627),u(2730485921,1290863460),u(2820302411,3158454273),u(3259730800,3505952657),u(3345764771,106217008),u(3516065817,3606008344),u(3600352804,1432725776),u(4094571909,1467031594),u(275423344,851169720),u(430227734,3100823752),u(506948616,1363258195),u(659060556,3750685593),u(883997877,3785050280),u(958139571,3318307427),u(1322822218,3812723403),u(1537002063,2003034995),u(1747873779,3602036899),u(1955562222,1575990012),u(2024104815,1125592928),u(2227730452,2716904306),u(2361852424,442776044),u(2428436474,593698344),u(2756734187,3733110249),u(3204031479,2999351573),u(3329325298,3815920427),u(3391569614,3928383900),u(3515267271,566280711),u(3940187606,3454069534),u(4118630271,4000239992),u(116418474,1914138554),u(174292421,2731055270),u(289380356,3203993006),u(460393269,320620315),u(685471733,587496836),u(852142971,1086792851),u(1017036298,365543100),u(1126000580,2618297676),u(1288033470,3409855158),u(1501505948,4234509866),u(1607167915,987167468),u(1816402316,1246189591)],d=[];(function(){for(var m=0;m<80;m++)d[m]=u()})();var p=c.SHA512=i.extend({_doReset:function(){this._hash=new l.init([new a.init(1779033703,4089235720),new a.init(3144134277,2227873595),new a.init(1013904242,4271175723),new a.init(2773480762,1595750129),new a.init(1359893119,2917565137),new a.init(2600822924,725511199),new a.init(528734635,4215389547),new a.init(1541459225,327033209)])},_doProcessBlock:function(m,g){for(var y=this._hash.words,x=y[0],v=y[1],w=y[2],_=y[3],S=y[4],E=y[5],C=y[6],P=y[7],O=x.high,A=x.low,R=v.high,B=v.low,I=w.high,L=w.low,U=_.high,F=_.low,D=S.high,k=S.low,N=E.high,M=E.low,T=C.high,j=C.low,$=P.high,z=P.low,ee=O,X=A,J=R,K=B,ne=I,ie=L,ae=U,W=F,H=D,G=k,Q=N,te=M,he=T,xe=j,fe=$,be=z,Pe=0;Pe<80;Pe++){var Se,Ye,Ve=d[Pe];if(Pe<16)Ye=Ve.high=m[g+Pe*2]|0,Se=Ve.low=m[g+Pe*2+1]|0;else{var Ge=d[Pe-15],Re=Ge.high,ge=Ge.low,et=(Re>>>1|ge<<31)^(Re>>>8|ge<<24)^Re>>>7,tt=(ge>>>1|Re<<31)^(ge>>>8|Re<<24)^(ge>>>7|Re<<25),ke=d[Pe-2],st=ke.high,it=ke.low,xt=(st>>>19|it<<13)^(st<<3|it>>>29)^st>>>6,Tn=(it>>>19|st<<13)^(it<<3|st>>>29)^(it>>>6|st<<26),yn=d[Pe-7],gt=yn.high,Ao=yn.low,le=d[Pe-16],Ce=le.high,we=le.low;Se=tt+Ao,Ye=et+gt+(Se>>>0<tt>>>0?1:0),Se=Se+Tn,Ye=Ye+xt+(Se>>>0<Tn>>>0?1:0),Se=Se+we,Ye=Ye+Ce+(Se>>>0<we>>>0?1:0),Ve.high=Ye,Ve.low=Se}var Me=H&Q^~H&he,Ne=G&te^~G&xe,jt=ee&J^ee&ne^J&ne,Ot=X&K^X&ie^K&ie,rn=(ee>>>28|X<<4)^(ee<<30|X>>>2)^(ee<<25|X>>>7),hn=(X>>>28|ee<<4)^(X<<30|ee>>>2)^(X<<25|ee>>>7),mr=(H>>>14|G<<18)^(H>>>18|G<<14)^(H<<23|G>>>9),vr=(G>>>14|H<<18)^(G>>>18|H<<14)^(G<<23|H>>>9),An=h[Pe],gi=An.high,yr=An.low,qt=be+vr,ss=fe+mr+(qt>>>0<be>>>0?1:0),qt=qt+Ne,ss=ss+Me+(qt>>>0<Ne>>>0?1:0),qt=qt+yr,ss=ss+gi+(qt>>>0<yr>>>0?1:0),qt=qt+Se,ss=ss+Ye+(qt>>>0<Se>>>0?1:0),Bd=hn+Ot,V0=rn+jt+(Bd>>>0<hn>>>0?1:0);fe=he,be=xe,he=Q,xe=te,Q=H,te=G,G=W+qt|0,H=ae+ss+(G>>>0<W>>>0?1:0)|0,ae=ne,W=ie,ne=J,ie=K,J=ee,K=X,X=qt+Bd|0,ee=ss+V0+(X>>>0<qt>>>0?1:0)|0}A=x.low=A+X,x.high=O+ee+(A>>>0<X>>>0?1:0),B=v.low=B+K,v.high=R+J+(B>>>0<K>>>0?1:0),L=w.low=L+ie,w.high=I+ne+(L>>>0<ie>>>0?1:0),F=_.low=F+W,_.high=U+ae+(F>>>0<W>>>0?1:0),k=S.low=k+G,S.high=D+H+(k>>>0<G>>>0?1:0),M=E.low=M+te,E.high=N+Q+(M>>>0<te>>>0?1:0),j=C.low=j+xe,C.high=T+he+(j>>>0<xe>>>0?1:0),z=P.low=z+be,P.high=$+fe+(z>>>0<be>>>0?1:0)},_doFinalize:function(){var m=this._data,g=m.words,y=this._nDataBytes*8,x=m.sigBytes*8;g[x>>>5]|=128<<24-x%32,g[(x+128>>>10<<5)+30]=Math.floor(y/4294967296),g[(x+128>>>10<<5)+31]=y,m.sigBytes=g.length*4,this._process();var v=this._hash.toX32();return v},clone:function(){var m=i.clone.call(this);return m._hash=this._hash.clone(),m},blockSize:1024/32});r.SHA512=i._createHelper(p),r.HmacSHA512=i._createHmacHelper(p)}(),t.SHA512})}(Dm)),Dm.exports}var Om={exports:{}},WE;function jK(){return WE||(WE=1,function(n,e){(function(t,r,s){n.exports=r(Ze(),$0(),JI())})(Ie,function(t){return function(){var r=t,s=r.x64,i=s.Word,o=s.WordArray,a=r.algo,l=a.SHA512,c=a.SHA384=l.extend({_doReset:function(){this._hash=new o.init([new i.init(3418070365,3238371032),new i.init(1654270250,914150663),new i.init(2438529370,812702999),new i.init(355462360,4144912697),new i.init(1731405415,4290775857),new i.init(2394180231,1750603025),new i.init(3675008525,1694076839),new i.init(1203062813,3204075428)])},_doFinalize:function(){var u=l._doFinalize.call(this);return u.sigBytes-=16,u}});r.SHA384=l._createHelper(c),r.HmacSHA384=l._createHmacHelper(c)}(),t.SHA384})}(Om)),Om.exports}var Im={exports:{}},HE;function LK(){return HE||(HE=1,function(n,e){(function(t,r,s){n.exports=r(Ze(),$0())})(Ie,function(t){return function(r){var s=t,i=s.lib,o=i.WordArray,a=i.Hasher,l=s.x64,c=l.Word,u=s.algo,h=[],d=[],p=[];(function(){for(var y=1,x=0,v=0;v<24;v++){h[y+5*x]=(v+1)*(v+2)/2%64;var w=x%5,_=(2*y+3*x)%5;y=w,x=_}for(var y=0;y<5;y++)for(var x=0;x<5;x++)d[y+5*x]=x+(2*y+3*x)%5*5;for(var S=1,E=0;E<24;E++){for(var C=0,P=0,O=0;O<7;O++){if(S&1){var A=(1<<O)-1;A<32?P^=1<<A:C^=1<<A-32}S&128?S=S<<1^113:S<<=1}p[E]=c.create(C,P)}})();var m=[];(function(){for(var y=0;y<25;y++)m[y]=c.create()})();var g=u.SHA3=a.extend({cfg:a.cfg.extend({outputLength:512}),_doReset:function(){for(var y=this._state=[],x=0;x<25;x++)y[x]=new c.init;this.blockSize=(1600-2*this.cfg.outputLength)/32},_doProcessBlock:function(y,x){for(var v=this._state,w=this.blockSize/2,_=0;_<w;_++){var S=y[x+2*_],E=y[x+2*_+1];S=(S<<8|S>>>24)&16711935|(S<<24|S>>>8)&4278255360,E=(E<<8|E>>>24)&16711935|(E<<24|E>>>8)&4278255360;var C=v[_];C.high^=E,C.low^=S}for(var P=0;P<24;P++){for(var O=0;O<5;O++){for(var A=0,R=0,B=0;B<5;B++){var C=v[O+5*B];A^=C.high,R^=C.low}var I=m[O];I.high=A,I.low=R}for(var O=0;O<5;O++)for(var L=m[(O+4)%5],U=m[(O+1)%5],F=U.high,D=U.low,A=L.high^(F<<1|D>>>31),R=L.low^(D<<1|F>>>31),B=0;B<5;B++){var C=v[O+5*B];C.high^=A,C.low^=R}for(var k=1;k<25;k++){var A,R,C=v[k],N=C.high,M=C.low,T=h[k];T<32?(A=N<<T|M>>>32-T,R=M<<T|N>>>32-T):(A=M<<T-32|N>>>64-T,R=N<<T-32|M>>>64-T);var j=m[d[k]];j.high=A,j.low=R}var $=m[0],z=v[0];$.high=z.high,$.low=z.low;for(var O=0;O<5;O++)for(var B=0;B<5;B++){var k=O+5*B,C=v[k],ee=m[k],X=m[(O+1)%5+5*B],J=m[(O+2)%5+5*B];C.high=ee.high^~X.high&J.high,C.low=ee.low^~X.low&J.low}var C=v[0],K=p[P];C.high^=K.high,C.low^=K.low}},_doFinalize:function(){var y=this._data,x=y.words;this._nDataBytes*8;var v=y.sigBytes*8,w=this.blockSize*32;x[v>>>5]|=1<<24-v%32,x[(r.ceil((v+1)/w)*w>>>5)-1]|=128,y.sigBytes=x.length*4,this._process();for(var _=this._state,S=this.cfg.outputLength/8,E=S/8,C=[],P=0;P<E;P++){var O=_[P],A=O.high,R=O.low;A=(A<<8|A>>>24)&16711935|(A<<24|A>>>8)&4278255360,R=(R<<8|R>>>24)&16711935|(R<<24|R>>>8)&4278255360,C.push(R),C.push(A)}return new o.init(C,S)},clone:function(){for(var y=a.clone.call(this),x=y._state=this._state.slice(0),v=0;v<25;v++)x[v]=x[v].clone();return y}});s.SHA3=a._createHelper(g),s.HmacSHA3=a._createHmacHelper(g)}(Math),t.SHA3})}(Im)),Im.exports}var Rm={exports:{}},VE;function MK(){return VE||(VE=1,function(n,e){(function(t,r){n.exports=r(Ze())})(Ie,function(t){/** @preserve
			(c) 2012 by Cdric Mesnil. All rights reserved.

			Redistribution and use in source and binary forms, with or without modification, are permitted provided that the following conditions are met:

			    - Redistributions of source code must retain the above copyright notice, this list of conditions and the following disclaimer.
			    - Redistributions in binary form must reproduce the above copyright notice, this list of conditions and the following disclaimer in the documentation and/or other materials provided with the distribution.

			THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
			*/return function(r){var s=t,i=s.lib,o=i.WordArray,a=i.Hasher,l=s.algo,c=o.create([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8,3,10,14,4,9,15,8,1,2,7,0,6,13,11,5,12,1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13]),u=o.create([5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11]),h=o.create([11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8,7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,11,13,6,7,14,9,13,15,14,8,13,6,5,12,7,5,11,12,14,15,14,15,9,8,9,14,5,6,8,6,5,12,9,15,5,11,6,8,13,12,5,12,13,14,11,8,5,6]),d=o.create([8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11]),p=o.create([0,1518500249,1859775393,2400959708,2840853838]),m=o.create([1352829926,1548603684,1836072691,2053994217,0]),g=l.RIPEMD160=a.extend({_doReset:function(){this._hash=o.create([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(E,C){for(var P=0;P<16;P++){var O=C+P,A=E[O];E[O]=(A<<8|A>>>24)&16711935|(A<<24|A>>>8)&4278255360}var R=this._hash.words,B=p.words,I=m.words,L=c.words,U=u.words,F=h.words,D=d.words,k,N,M,T,j,$,z,ee,X,J;$=k=R[0],z=N=R[1],ee=M=R[2],X=T=R[3],J=j=R[4];for(var K,P=0;P<80;P+=1)K=k+E[C+L[P]]|0,P<16?K+=y(N,M,T)+B[0]:P<32?K+=x(N,M,T)+B[1]:P<48?K+=v(N,M,T)+B[2]:P<64?K+=w(N,M,T)+B[3]:K+=_(N,M,T)+B[4],K=K|0,K=S(K,F[P]),K=K+j|0,k=j,j=T,T=S(M,10),M=N,N=K,K=$+E[C+U[P]]|0,P<16?K+=_(z,ee,X)+I[0]:P<32?K+=w(z,ee,X)+I[1]:P<48?K+=v(z,ee,X)+I[2]:P<64?K+=x(z,ee,X)+I[3]:K+=y(z,ee,X)+I[4],K=K|0,K=S(K,D[P]),K=K+J|0,$=J,J=X,X=S(ee,10),ee=z,z=K;K=R[1]+M+X|0,R[1]=R[2]+T+J|0,R[2]=R[3]+j+$|0,R[3]=R[4]+k+z|0,R[4]=R[0]+N+ee|0,R[0]=K},_doFinalize:function(){var E=this._data,C=E.words,P=this._nDataBytes*8,O=E.sigBytes*8;C[O>>>5]|=128<<24-O%32,C[(O+64>>>9<<4)+14]=(P<<8|P>>>24)&16711935|(P<<24|P>>>8)&4278255360,E.sigBytes=(C.length+1)*4,this._process();for(var A=this._hash,R=A.words,B=0;B<5;B++){var I=R[B];R[B]=(I<<8|I>>>24)&16711935|(I<<24|I>>>8)&4278255360}return A},clone:function(){var E=a.clone.call(this);return E._hash=this._hash.clone(),E}});function y(E,C,P){return E^C^P}function x(E,C,P){return E&C|~E&P}function v(E,C,P){return(E|~C)^P}function w(E,C,P){return E&P|C&~P}function _(E,C,P){return E^(C|~P)}function S(E,C){return E<<C|E>>>32-C}s.RIPEMD160=a._createHelper(g),s.HmacRIPEMD160=a._createHmacHelper(g)}(),t.RIPEMD160})}(Rm)),Rm.exports}var Nm={exports:{}},GE;function J1(){return GE||(GE=1,function(n,e){(function(t,r){n.exports=r(Ze())})(Ie,function(t){(function(){var r=t,s=r.lib,i=s.Base,o=r.enc,a=o.Utf8,l=r.algo;l.HMAC=i.extend({init:function(c,u){c=this._hasher=new c.init,typeof u=="string"&&(u=a.parse(u));var h=c.blockSize,d=h*4;u.sigBytes>d&&(u=c.finalize(u)),u.clamp();for(var p=this._oKey=u.clone(),m=this._iKey=u.clone(),g=p.words,y=m.words,x=0;x<h;x++)g[x]^=1549556828,y[x]^=909522486;p.sigBytes=m.sigBytes=d,this.reset()},reset:function(){var c=this._hasher;c.reset(),c.update(this._iKey)},update:function(c){return this._hasher.update(c),this},finalize:function(c){var u=this._hasher,h=u.finalize(c);u.reset();var d=u.finalize(this._oKey.clone().concat(h));return d}})})()})}(Nm)),Nm.exports}var jm={exports:{}},qE;function FK(){return qE||(qE=1,function(n,e){(function(t,r,s){n.exports=r(Ze(),K1(),J1())})(Ie,function(t){return function(){var r=t,s=r.lib,i=s.Base,o=s.WordArray,a=r.algo,l=a.SHA256,c=a.HMAC,u=a.PBKDF2=i.extend({cfg:i.extend({keySize:128/32,hasher:l,iterations:25e4}),init:function(h){this.cfg=this.cfg.extend(h)},compute:function(h,d){for(var p=this.cfg,m=c.create(p.hasher,h),g=o.create(),y=o.create([1]),x=g.words,v=y.words,w=p.keySize,_=p.iterations;x.length<w;){var S=m.update(d).finalize(y);m.reset();for(var E=S.words,C=E.length,P=S,O=1;O<_;O++){P=m.finalize(P),m.reset();for(var A=P.words,R=0;R<C;R++)E[R]^=A[R]}g.concat(S),v[0]++}return g.sigBytes=w*4,g}});r.PBKDF2=function(h,d,p){return u.create(p).compute(h,d)}}(),t.PBKDF2})}(jm)),jm.exports}var Lm={exports:{}},YE;function ko(){return YE||(YE=1,function(n,e){(function(t,r,s){n.exports=r(Ze(),KI(),J1())})(Ie,function(t){return function(){var r=t,s=r.lib,i=s.Base,o=s.WordArray,a=r.algo,l=a.MD5,c=a.EvpKDF=i.extend({cfg:i.extend({keySize:128/32,hasher:l,iterations:1}),init:function(u){this.cfg=this.cfg.extend(u)},compute:function(u,h){for(var d,p=this.cfg,m=p.hasher.create(),g=o.create(),y=g.words,x=p.keySize,v=p.iterations;y.length<x;){d&&m.update(d),d=m.update(u).finalize(h),m.reset();for(var w=1;w<v;w++)d=m.finalize(d),m.reset();g.concat(d)}return g.sigBytes=x*4,g}});r.EvpKDF=function(u,h,d){return c.create(d).compute(u,h)}}(),t.EvpKDF})}(Lm)),Lm.exports}var Mm={exports:{}},XE;function dn(){return XE||(XE=1,function(n,e){(function(t,r,s){n.exports=r(Ze(),ko())})(Ie,function(t){t.lib.Cipher||function(r){var s=t,i=s.lib,o=i.Base,a=i.WordArray,l=i.BufferedBlockAlgorithm,c=s.enc;c.Utf8;var u=c.Base64,h=s.algo,d=h.EvpKDF,p=i.Cipher=l.extend({cfg:o.extend(),createEncryptor:function(A,R){return this.create(this._ENC_XFORM_MODE,A,R)},createDecryptor:function(A,R){return this.create(this._DEC_XFORM_MODE,A,R)},init:function(A,R,B){this.cfg=this.cfg.extend(B),this._xformMode=A,this._key=R,this.reset()},reset:function(){l.reset.call(this),this._doReset()},process:function(A){return this._append(A),this._process()},finalize:function(A){A&&this._append(A);var R=this._doFinalize();return R},keySize:128/32,ivSize:128/32,_ENC_XFORM_MODE:1,_DEC_XFORM_MODE:2,_createHelper:function(){function A(R){return typeof R=="string"?O:E}return function(R){return{encrypt:function(B,I,L){return A(I).encrypt(R,B,I,L)},decrypt:function(B,I,L){return A(I).decrypt(R,B,I,L)}}}}()});i.StreamCipher=p.extend({_doFinalize:function(){var A=this._process(!0);return A},blockSize:1});var m=s.mode={},g=i.BlockCipherMode=o.extend({createEncryptor:function(A,R){return this.Encryptor.create(A,R)},createDecryptor:function(A,R){return this.Decryptor.create(A,R)},init:function(A,R){this._cipher=A,this._iv=R}}),y=m.CBC=function(){var A=g.extend();A.Encryptor=A.extend({processBlock:function(B,I){var L=this._cipher,U=L.blockSize;R.call(this,B,I,U),L.encryptBlock(B,I),this._prevBlock=B.slice(I,I+U)}}),A.Decryptor=A.extend({processBlock:function(B,I){var L=this._cipher,U=L.blockSize,F=B.slice(I,I+U);L.decryptBlock(B,I),R.call(this,B,I,U),this._prevBlock=F}});function R(B,I,L){var U,F=this._iv;F?(U=F,this._iv=r):U=this._prevBlock;for(var D=0;D<L;D++)B[I+D]^=U[D]}return A}(),x=s.pad={},v=x.Pkcs7={pad:function(A,R){for(var B=R*4,I=B-A.sigBytes%B,L=I<<24|I<<16|I<<8|I,U=[],F=0;F<I;F+=4)U.push(L);var D=a.create(U,I);A.concat(D)},unpad:function(A){var R=A.words[A.sigBytes-1>>>2]&255;A.sigBytes-=R}};i.BlockCipher=p.extend({cfg:p.cfg.extend({mode:y,padding:v}),reset:function(){var A;p.reset.call(this);var R=this.cfg,B=R.iv,I=R.mode;this._xformMode==this._ENC_XFORM_MODE?A=I.createEncryptor:(A=I.createDecryptor,this._minBufferSize=1),this._mode&&this._mode.__creator==A?this._mode.init(this,B&&B.words):(this._mode=A.call(I,this,B&&B.words),this._mode.__creator=A)},_doProcessBlock:function(A,R){this._mode.processBlock(A,R)},_doFinalize:function(){var A,R=this.cfg.padding;return this._xformMode==this._ENC_XFORM_MODE?(R.pad(this._data,this.blockSize),A=this._process(!0)):(A=this._process(!0),R.unpad(A)),A},blockSize:128/32});var w=i.CipherParams=o.extend({init:function(A){this.mixIn(A)},toString:function(A){return(A||this.formatter).stringify(this)}}),_=s.format={},S=_.OpenSSL={stringify:function(A){var R,B=A.ciphertext,I=A.salt;return I?R=a.create([1398893684,1701076831]).concat(I).concat(B):R=B,R.toString(u)},parse:function(A){var R,B=u.parse(A),I=B.words;return I[0]==1398893684&&I[1]==1701076831&&(R=a.create(I.slice(2,4)),I.splice(0,4),B.sigBytes-=16),w.create({ciphertext:B,salt:R})}},E=i.SerializableCipher=o.extend({cfg:o.extend({format:S}),encrypt:function(A,R,B,I){I=this.cfg.extend(I);var L=A.createEncryptor(B,I),U=L.finalize(R),F=L.cfg;return w.create({ciphertext:U,key:B,iv:F.iv,algorithm:A,mode:F.mode,padding:F.padding,blockSize:A.blockSize,formatter:I.format})},decrypt:function(A,R,B,I){I=this.cfg.extend(I),R=this._parse(R,I.format);var L=A.createDecryptor(B,I).finalize(R.ciphertext);return L},_parse:function(A,R){return typeof A=="string"?R.parse(A,this):A}}),C=s.kdf={},P=C.OpenSSL={execute:function(A,R,B,I,L){if(I||(I=a.random(64/8)),L)var U=d.create({keySize:R+B,hasher:L}).compute(A,I);else var U=d.create({keySize:R+B}).compute(A,I);var F=a.create(U.words.slice(R),B*4);return U.sigBytes=R*4,w.create({key:U,iv:F,salt:I})}},O=i.PasswordBasedCipher=E.extend({cfg:E.cfg.extend({kdf:P}),encrypt:function(A,R,B,I){I=this.cfg.extend(I);var L=I.kdf.execute(B,A.keySize,A.ivSize,I.salt,I.hasher);I.iv=L.iv;var U=E.encrypt.call(this,A,R,L.key,I);return U.mixIn(L),U},decrypt:function(A,R,B,I){I=this.cfg.extend(I),R=this._parse(R,I.format);var L=I.kdf.execute(B,A.keySize,A.ivSize,R.salt,I.hasher);I.iv=L.iv;var U=E.decrypt.call(this,A,R,L.key,I);return U}})}()})}(Mm)),Mm.exports}var Fm={exports:{}},KE;function BK(){return KE||(KE=1,function(n,e){(function(t,r,s){n.exports=r(Ze(),dn())})(Ie,function(t){return t.mode.CFB=function(){var r=t.lib.BlockCipherMode.extend();r.Encryptor=r.extend({processBlock:function(i,o){var a=this._cipher,l=a.blockSize;s.call(this,i,o,l,a),this._prevBlock=i.slice(o,o+l)}}),r.Decryptor=r.extend({processBlock:function(i,o){var a=this._cipher,l=a.blockSize,c=i.slice(o,o+l);s.call(this,i,o,l,a),this._prevBlock=c}});function s(i,o,a,l){var c,u=this._iv;u?(c=u.slice(0),this._iv=void 0):c=this._prevBlock,l.encryptBlock(c,0);for(var h=0;h<a;h++)i[o+h]^=c[h]}return r}(),t.mode.CFB})}(Fm)),Fm.exports}var Bm={exports:{}},JE;function UK(){return JE||(JE=1,function(n,e){(function(t,r,s){n.exports=r(Ze(),dn())})(Ie,function(t){return t.mode.CTR=function(){var r=t.lib.BlockCipherMode.extend(),s=r.Encryptor=r.extend({processBlock:function(i,o){var a=this._cipher,l=a.blockSize,c=this._iv,u=this._counter;c&&(u=this._counter=c.slice(0),this._iv=void 0);var h=u.slice(0);a.encryptBlock(h,0),u[l-1]=u[l-1]+1|0;for(var d=0;d<l;d++)i[o+d]^=h[d]}});return r.Decryptor=s,r}(),t.mode.CTR})}(Bm)),Bm.exports}var Um={exports:{}},QE;function $K(){return QE||(QE=1,function(n,e){(function(t,r,s){n.exports=r(Ze(),dn())})(Ie,function(t){/** @preserve
 * Counter block mode compatible with  Dr Brian Gladman fileenc.c
 * derived from CryptoJS.mode.CTR
 * Jan Hruby jhruby.web@gmail.com
 */return t.mode.CTRGladman=function(){var r=t.lib.BlockCipherMode.extend();function s(a){if((a>>24&255)===255){var l=a>>16&255,c=a>>8&255,u=a&255;l===255?(l=0,c===255?(c=0,u===255?u=0:++u):++c):++l,a=0,a+=l<<16,a+=c<<8,a+=u}else a+=1<<24;return a}function i(a){return(a[0]=s(a[0]))===0&&(a[1]=s(a[1])),a}var o=r.Encryptor=r.extend({processBlock:function(a,l){var c=this._cipher,u=c.blockSize,h=this._iv,d=this._counter;h&&(d=this._counter=h.slice(0),this._iv=void 0),i(d);var p=d.slice(0);c.encryptBlock(p,0);for(var m=0;m<u;m++)a[l+m]^=p[m]}});return r.Decryptor=o,r}(),t.mode.CTRGladman})}(Um)),Um.exports}var $m={exports:{}},ZE;function zK(){return ZE||(ZE=1,function(n,e){(function(t,r,s){n.exports=r(Ze(),dn())})(Ie,function(t){return t.mode.OFB=function(){var r=t.lib.BlockCipherMode.extend(),s=r.Encryptor=r.extend({processBlock:function(i,o){var a=this._cipher,l=a.blockSize,c=this._iv,u=this._keystream;c&&(u=this._keystream=c.slice(0),this._iv=void 0),a.encryptBlock(u,0);for(var h=0;h<l;h++)i[o+h]^=u[h]}});return r.Decryptor=s,r}(),t.mode.OFB})}($m)),$m.exports}var zm={exports:{}},e2;function WK(){return e2||(e2=1,function(n,e){(function(t,r,s){n.exports=r(Ze(),dn())})(Ie,function(t){return t.mode.ECB=function(){var r=t.lib.BlockCipherMode.extend();return r.Encryptor=r.extend({processBlock:function(s,i){this._cipher.encryptBlock(s,i)}}),r.Decryptor=r.extend({processBlock:function(s,i){this._cipher.decryptBlock(s,i)}}),r}(),t.mode.ECB})}(zm)),zm.exports}var Wm={exports:{}},t2;function HK(){return t2||(t2=1,function(n,e){(function(t,r,s){n.exports=r(Ze(),dn())})(Ie,function(t){return t.pad.AnsiX923={pad:function(r,s){var i=r.sigBytes,o=s*4,a=o-i%o,l=i+a-1;r.clamp(),r.words[l>>>2]|=a<<24-l%4*8,r.sigBytes+=a},unpad:function(r){var s=r.words[r.sigBytes-1>>>2]&255;r.sigBytes-=s}},t.pad.Ansix923})}(Wm)),Wm.exports}var Hm={exports:{}},n2;function VK(){return n2||(n2=1,function(n,e){(function(t,r,s){n.exports=r(Ze(),dn())})(Ie,function(t){return t.pad.Iso10126={pad:function(r,s){var i=s*4,o=i-r.sigBytes%i;r.concat(t.lib.WordArray.random(o-1)).concat(t.lib.WordArray.create([o<<24],1))},unpad:function(r){var s=r.words[r.sigBytes-1>>>2]&255;r.sigBytes-=s}},t.pad.Iso10126})}(Hm)),Hm.exports}var Vm={exports:{}},r2;function GK(){return r2||(r2=1,function(n,e){(function(t,r,s){n.exports=r(Ze(),dn())})(Ie,function(t){return t.pad.Iso97971={pad:function(r,s){r.concat(t.lib.WordArray.create([2147483648],1)),t.pad.ZeroPadding.pad(r,s)},unpad:function(r){t.pad.ZeroPadding.unpad(r),r.sigBytes--}},t.pad.Iso97971})}(Vm)),Vm.exports}var Gm={exports:{}},s2;function qK(){return s2||(s2=1,function(n,e){(function(t,r,s){n.exports=r(Ze(),dn())})(Ie,function(t){return t.pad.ZeroPadding={pad:function(r,s){var i=s*4;r.clamp(),r.sigBytes+=i-(r.sigBytes%i||i)},unpad:function(r){for(var s=r.words,i=r.sigBytes-1,i=r.sigBytes-1;i>=0;i--)if(s[i>>>2]>>>24-i%4*8&255){r.sigBytes=i+1;break}}},t.pad.ZeroPadding})}(Gm)),Gm.exports}var qm={exports:{}},i2;function YK(){return i2||(i2=1,function(n,e){(function(t,r,s){n.exports=r(Ze(),dn())})(Ie,function(t){return t.pad.NoPadding={pad:function(){},unpad:function(){}},t.pad.NoPadding})}(qm)),qm.exports}var Ym={exports:{}},o2;function XK(){return o2||(o2=1,function(n,e){(function(t,r,s){n.exports=r(Ze(),dn())})(Ie,function(t){return function(r){var s=t,i=s.lib,o=i.CipherParams,a=s.enc,l=a.Hex,c=s.format;c.Hex={stringify:function(u){return u.ciphertext.toString(l)},parse:function(u){var h=l.parse(u);return o.create({ciphertext:h})}}}(),t.format.Hex})}(Ym)),Ym.exports}var Xm={exports:{}},a2;function KK(){return a2||(a2=1,function(n,e){(function(t,r,s){n.exports=r(Ze(),Pa(),Ta(),ko(),dn())})(Ie,function(t){return function(){var r=t,s=r.lib,i=s.BlockCipher,o=r.algo,a=[],l=[],c=[],u=[],h=[],d=[],p=[],m=[],g=[],y=[];(function(){for(var w=[],_=0;_<256;_++)_<128?w[_]=_<<1:w[_]=_<<1^283;for(var S=0,E=0,_=0;_<256;_++){var C=E^E<<1^E<<2^E<<3^E<<4;C=C>>>8^C&255^99,a[S]=C,l[C]=S;var P=w[S],O=w[P],A=w[O],R=w[C]*257^C*16843008;c[S]=R<<24|R>>>8,u[S]=R<<16|R>>>16,h[S]=R<<8|R>>>24,d[S]=R;var R=A*16843009^O*65537^P*257^S*16843008;p[C]=R<<24|R>>>8,m[C]=R<<16|R>>>16,g[C]=R<<8|R>>>24,y[C]=R,S?(S=P^w[w[w[A^P]]],E^=w[w[E]]):S=E=1}})();var x=[0,1,2,4,8,16,32,64,128,27,54],v=o.AES=i.extend({_doReset:function(){var w;if(!(this._nRounds&&this._keyPriorReset===this._key)){for(var _=this._keyPriorReset=this._key,S=_.words,E=_.sigBytes/4,C=this._nRounds=E+6,P=(C+1)*4,O=this._keySchedule=[],A=0;A<P;A++)A<E?O[A]=S[A]:(w=O[A-1],A%E?E>6&&A%E==4&&(w=a[w>>>24]<<24|a[w>>>16&255]<<16|a[w>>>8&255]<<8|a[w&255]):(w=w<<8|w>>>24,w=a[w>>>24]<<24|a[w>>>16&255]<<16|a[w>>>8&255]<<8|a[w&255],w^=x[A/E|0]<<24),O[A]=O[A-E]^w);for(var R=this._invKeySchedule=[],B=0;B<P;B++){var A=P-B;if(B%4)var w=O[A];else var w=O[A-4];B<4||A<=4?R[B]=w:R[B]=p[a[w>>>24]]^m[a[w>>>16&255]]^g[a[w>>>8&255]]^y[a[w&255]]}}},encryptBlock:function(w,_){this._doCryptBlock(w,_,this._keySchedule,c,u,h,d,a)},decryptBlock:function(w,_){var S=w[_+1];w[_+1]=w[_+3],w[_+3]=S,this._doCryptBlock(w,_,this._invKeySchedule,p,m,g,y,l);var S=w[_+1];w[_+1]=w[_+3],w[_+3]=S},_doCryptBlock:function(w,_,S,E,C,P,O,A){for(var R=this._nRounds,B=w[_]^S[0],I=w[_+1]^S[1],L=w[_+2]^S[2],U=w[_+3]^S[3],F=4,D=1;D<R;D++){var k=E[B>>>24]^C[I>>>16&255]^P[L>>>8&255]^O[U&255]^S[F++],N=E[I>>>24]^C[L>>>16&255]^P[U>>>8&255]^O[B&255]^S[F++],M=E[L>>>24]^C[U>>>16&255]^P[B>>>8&255]^O[I&255]^S[F++],T=E[U>>>24]^C[B>>>16&255]^P[I>>>8&255]^O[L&255]^S[F++];B=k,I=N,L=M,U=T}var k=(A[B>>>24]<<24|A[I>>>16&255]<<16|A[L>>>8&255]<<8|A[U&255])^S[F++],N=(A[I>>>24]<<24|A[L>>>16&255]<<16|A[U>>>8&255]<<8|A[B&255])^S[F++],M=(A[L>>>24]<<24|A[U>>>16&255]<<16|A[B>>>8&255]<<8|A[I&255])^S[F++],T=(A[U>>>24]<<24|A[B>>>16&255]<<16|A[I>>>8&255]<<8|A[L&255])^S[F++];w[_]=k,w[_+1]=N,w[_+2]=M,w[_+3]=T},keySize:256/32});r.AES=i._createHelper(v)}(),t.AES})}(Xm)),Xm.exports}var Km={exports:{}},l2;function JK(){return l2||(l2=1,function(n,e){(function(t,r,s){n.exports=r(Ze(),Pa(),Ta(),ko(),dn())})(Ie,function(t){return function(){var r=t,s=r.lib,i=s.WordArray,o=s.BlockCipher,a=r.algo,l=[57,49,41,33,25,17,9,1,58,50,42,34,26,18,10,2,59,51,43,35,27,19,11,3,60,52,44,36,63,55,47,39,31,23,15,7,62,54,46,38,30,22,14,6,61,53,45,37,29,21,13,5,28,20,12,4],c=[14,17,11,24,1,5,3,28,15,6,21,10,23,19,12,4,26,8,16,7,27,20,13,2,41,52,31,37,47,55,30,40,51,45,33,48,44,49,39,56,34,53,46,42,50,36,29,32],u=[1,2,4,6,8,10,12,14,15,17,19,21,23,25,27,28],h=[{0:8421888,268435456:32768,536870912:8421378,805306368:2,1073741824:512,1342177280:8421890,1610612736:8389122,1879048192:8388608,2147483648:514,2415919104:8389120,2684354560:33280,2952790016:8421376,3221225472:32770,3489660928:8388610,3758096384:0,4026531840:33282,134217728:0,402653184:8421890,671088640:33282,939524096:32768,1207959552:8421888,1476395008:512,1744830464:8421378,2013265920:2,2281701376:8389120,2550136832:33280,2818572288:8421376,3087007744:8389122,3355443200:8388610,3623878656:32770,3892314112:514,4160749568:8388608,1:32768,268435457:2,536870913:8421888,805306369:8388608,1073741825:8421378,1342177281:33280,1610612737:512,1879048193:8389122,2147483649:8421890,2415919105:8421376,2684354561:8388610,2952790017:33282,3221225473:514,3489660929:8389120,3758096385:32770,4026531841:0,134217729:8421890,402653185:8421376,671088641:8388608,939524097:512,1207959553:32768,1476395009:8388610,1744830465:2,2013265921:33282,2281701377:32770,2550136833:8389122,2818572289:514,3087007745:8421888,3355443201:8389120,3623878657:0,3892314113:33280,4160749569:8421378},{0:1074282512,16777216:16384,33554432:524288,50331648:1074266128,67108864:1073741840,83886080:1074282496,100663296:1073758208,117440512:16,134217728:540672,150994944:1073758224,167772160:1073741824,184549376:540688,201326592:524304,218103808:0,234881024:16400,251658240:1074266112,8388608:1073758208,25165824:540688,41943040:16,58720256:1073758224,75497472:1074282512,92274688:1073741824,109051904:524288,125829120:1074266128,142606336:524304,159383552:0,176160768:16384,192937984:1074266112,209715200:1073741840,226492416:540672,243269632:1074282496,260046848:16400,268435456:0,285212672:1074266128,301989888:1073758224,318767104:1074282496,335544320:1074266112,352321536:16,369098752:540688,385875968:16384,402653184:16400,419430400:524288,436207616:524304,452984832:1073741840,469762048:540672,486539264:1073758208,503316480:1073741824,520093696:1074282512,276824064:540688,293601280:524288,310378496:1074266112,327155712:16384,343932928:1073758208,360710144:1074282512,377487360:16,394264576:1073741824,411041792:1074282496,427819008:1073741840,444596224:1073758224,461373440:524304,478150656:0,494927872:16400,511705088:1074266128,528482304:540672},{0:260,1048576:0,2097152:67109120,3145728:65796,4194304:65540,5242880:67108868,6291456:67174660,7340032:67174400,8388608:67108864,9437184:67174656,10485760:65792,11534336:67174404,12582912:67109124,13631488:65536,14680064:4,15728640:256,524288:67174656,1572864:67174404,2621440:0,3670016:67109120,4718592:67108868,5767168:65536,6815744:65540,7864320:260,8912896:4,9961472:256,11010048:67174400,12058624:65796,13107200:65792,14155776:67109124,15204352:67174660,16252928:67108864,16777216:67174656,17825792:65540,18874368:65536,19922944:67109120,20971520:256,22020096:67174660,23068672:67108868,24117248:0,25165824:67109124,26214400:67108864,27262976:4,28311552:65792,29360128:67174400,30408704:260,31457280:65796,32505856:67174404,17301504:67108864,18350080:260,19398656:67174656,20447232:0,21495808:65540,22544384:67109120,23592960:256,24641536:67174404,25690112:65536,26738688:67174660,27787264:65796,28835840:67108868,29884416:67109124,30932992:67174400,31981568:4,33030144:65792},{0:2151682048,65536:2147487808,131072:4198464,196608:2151677952,262144:0,327680:4198400,393216:2147483712,458752:4194368,524288:2147483648,589824:4194304,655360:64,720896:2147487744,786432:2151678016,851968:4160,917504:4096,983040:2151682112,32768:2147487808,98304:64,163840:2151678016,229376:2147487744,294912:4198400,360448:2151682112,425984:0,491520:2151677952,557056:4096,622592:2151682048,688128:4194304,753664:4160,819200:2147483648,884736:4194368,950272:4198464,1015808:2147483712,1048576:4194368,1114112:4198400,1179648:2147483712,1245184:0,1310720:4160,1376256:2151678016,1441792:2151682048,1507328:2147487808,1572864:2151682112,1638400:2147483648,1703936:2151677952,1769472:4198464,1835008:2147487744,1900544:4194304,1966080:64,2031616:4096,1081344:2151677952,1146880:2151682112,1212416:0,1277952:4198400,1343488:4194368,1409024:2147483648,1474560:2147487808,1540096:64,1605632:2147483712,1671168:4096,1736704:2147487744,1802240:2151678016,1867776:4160,1933312:2151682048,1998848:4194304,2064384:4198464},{0:128,4096:17039360,8192:262144,12288:536870912,16384:537133184,20480:16777344,24576:553648256,28672:262272,32768:16777216,36864:537133056,40960:536871040,45056:553910400,49152:553910272,53248:0,57344:17039488,61440:553648128,2048:17039488,6144:553648256,10240:128,14336:17039360,18432:262144,22528:537133184,26624:553910272,30720:536870912,34816:537133056,38912:0,43008:553910400,47104:16777344,51200:536871040,55296:553648128,59392:16777216,63488:262272,65536:262144,69632:128,73728:536870912,77824:553648256,81920:16777344,86016:553910272,90112:537133184,94208:16777216,98304:553910400,102400:553648128,106496:17039360,110592:537133056,114688:262272,118784:536871040,122880:0,126976:17039488,67584:553648256,71680:16777216,75776:17039360,79872:537133184,83968:536870912,88064:17039488,92160:128,96256:553910272,100352:262272,104448:553910400,108544:0,112640:553648128,116736:16777344,120832:262144,124928:537133056,129024:536871040},{0:268435464,256:8192,512:270532608,768:270540808,1024:268443648,1280:2097152,1536:2097160,1792:268435456,2048:0,2304:268443656,2560:2105344,2816:8,3072:270532616,3328:2105352,3584:8200,3840:270540800,128:270532608,384:270540808,640:8,896:2097152,1152:2105352,1408:268435464,1664:268443648,1920:8200,2176:2097160,2432:8192,2688:268443656,2944:270532616,3200:0,3456:270540800,3712:2105344,3968:268435456,4096:268443648,4352:270532616,4608:270540808,4864:8200,5120:2097152,5376:268435456,5632:268435464,5888:2105344,6144:2105352,6400:0,6656:8,6912:270532608,7168:8192,7424:268443656,7680:270540800,7936:2097160,4224:8,4480:2105344,4736:2097152,4992:268435464,5248:268443648,5504:8200,5760:270540808,6016:270532608,6272:270540800,6528:270532616,6784:8192,7040:2105352,7296:2097160,7552:0,7808:268435456,8064:268443656},{0:1048576,16:33555457,32:1024,48:1049601,64:34604033,80:0,96:1,112:34603009,128:33555456,144:1048577,160:33554433,176:34604032,192:34603008,208:1025,224:1049600,240:33554432,8:34603009,24:0,40:33555457,56:34604032,72:1048576,88:33554433,104:33554432,120:1025,136:1049601,152:33555456,168:34603008,184:1048577,200:1024,216:34604033,232:1,248:1049600,256:33554432,272:1048576,288:33555457,304:34603009,320:1048577,336:33555456,352:34604032,368:1049601,384:1025,400:34604033,416:1049600,432:1,448:0,464:34603008,480:33554433,496:1024,264:1049600,280:33555457,296:34603009,312:1,328:33554432,344:1048576,360:1025,376:34604032,392:33554433,408:34603008,424:0,440:34604033,456:1049601,472:1024,488:33555456,504:1048577},{0:134219808,1:131072,2:134217728,3:32,4:131104,5:134350880,6:134350848,7:2048,8:134348800,9:134219776,10:133120,11:134348832,12:2080,13:0,14:134217760,15:133152,2147483648:2048,2147483649:134350880,2147483650:134219808,2147483651:134217728,2147483652:134348800,2147483653:133120,2147483654:133152,2147483655:32,2147483656:134217760,2147483657:2080,2147483658:131104,2147483659:134350848,2147483660:0,2147483661:134348832,2147483662:134219776,2147483663:131072,16:133152,17:134350848,18:32,19:2048,20:134219776,21:134217760,22:134348832,23:131072,24:0,25:131104,26:134348800,27:134219808,28:134350880,29:133120,30:2080,31:134217728,2147483664:131072,2147483665:2048,2147483666:134348832,2147483667:133152,2147483668:32,2147483669:134348800,2147483670:134217728,2147483671:134219808,2147483672:134350880,2147483673:134217760,2147483674:134219776,2147483675:0,2147483676:133120,2147483677:2080,2147483678:131104,2147483679:134350848}],d=[4160749569,528482304,33030144,2064384,129024,8064,504,2147483679],p=a.DES=o.extend({_doReset:function(){for(var x=this._key,v=x.words,w=[],_=0;_<56;_++){var S=l[_]-1;w[_]=v[S>>>5]>>>31-S%32&1}for(var E=this._subKeys=[],C=0;C<16;C++){for(var P=E[C]=[],O=u[C],_=0;_<24;_++)P[_/6|0]|=w[(c[_]-1+O)%28]<<31-_%6,P[4+(_/6|0)]|=w[28+(c[_+24]-1+O)%28]<<31-_%6;P[0]=P[0]<<1|P[0]>>>31;for(var _=1;_<7;_++)P[_]=P[_]>>>(_-1)*4+3;P[7]=P[7]<<5|P[7]>>>27}for(var A=this._invSubKeys=[],_=0;_<16;_++)A[_]=E[15-_]},encryptBlock:function(x,v){this._doCryptBlock(x,v,this._subKeys)},decryptBlock:function(x,v){this._doCryptBlock(x,v,this._invSubKeys)},_doCryptBlock:function(x,v,w){this._lBlock=x[v],this._rBlock=x[v+1],m.call(this,4,252645135),m.call(this,16,65535),g.call(this,2,858993459),g.call(this,8,16711935),m.call(this,1,1431655765);for(var _=0;_<16;_++){for(var S=w[_],E=this._lBlock,C=this._rBlock,P=0,O=0;O<8;O++)P|=h[O][((C^S[O])&d[O])>>>0];this._lBlock=C,this._rBlock=E^P}var A=this._lBlock;this._lBlock=this._rBlock,this._rBlock=A,m.call(this,1,1431655765),g.call(this,8,16711935),g.call(this,2,858993459),m.call(this,16,65535),m.call(this,4,252645135),x[v]=this._lBlock,x[v+1]=this._rBlock},keySize:64/32,ivSize:64/32,blockSize:64/32});function m(x,v){var w=(this._lBlock>>>x^this._rBlock)&v;this._rBlock^=w,this._lBlock^=w<<x}function g(x,v){var w=(this._rBlock>>>x^this._lBlock)&v;this._lBlock^=w,this._rBlock^=w<<x}r.DES=o._createHelper(p);var y=a.TripleDES=o.extend({_doReset:function(){var x=this._key,v=x.words;if(v.length!==2&&v.length!==4&&v.length<6)throw new Error("Invalid key length - 3DES requires the key length to be 64, 128, 192 or >192.");var w=v.slice(0,2),_=v.length<4?v.slice(0,2):v.slice(2,4),S=v.length<6?v.slice(0,2):v.slice(4,6);this._des1=p.createEncryptor(i.create(w)),this._des2=p.createEncryptor(i.create(_)),this._des3=p.createEncryptor(i.create(S))},encryptBlock:function(x,v){this._des1.encryptBlock(x,v),this._des2.decryptBlock(x,v),this._des3.encryptBlock(x,v)},decryptBlock:function(x,v){this._des3.decryptBlock(x,v),this._des2.encryptBlock(x,v),this._des1.decryptBlock(x,v)},keySize:192/32,ivSize:64/32,blockSize:64/32});r.TripleDES=o._createHelper(y)}(),t.TripleDES})}(Km)),Km.exports}var Jm={exports:{}},c2;function QK(){return c2||(c2=1,function(n,e){(function(t,r,s){n.exports=r(Ze(),Pa(),Ta(),ko(),dn())})(Ie,function(t){return function(){var r=t,s=r.lib,i=s.StreamCipher,o=r.algo,a=o.RC4=i.extend({_doReset:function(){for(var u=this._key,h=u.words,d=u.sigBytes,p=this._S=[],m=0;m<256;m++)p[m]=m;for(var m=0,g=0;m<256;m++){var y=m%d,x=h[y>>>2]>>>24-y%4*8&255;g=(g+p[m]+x)%256;var v=p[m];p[m]=p[g],p[g]=v}this._i=this._j=0},_doProcessBlock:function(u,h){u[h]^=l.call(this)},keySize:256/32,ivSize:0});function l(){for(var u=this._S,h=this._i,d=this._j,p=0,m=0;m<4;m++){h=(h+1)%256,d=(d+u[h])%256;var g=u[h];u[h]=u[d],u[d]=g,p|=u[(u[h]+u[d])%256]<<24-m*8}return this._i=h,this._j=d,p}r.RC4=i._createHelper(a);var c=o.RC4Drop=a.extend({cfg:a.cfg.extend({drop:192}),_doReset:function(){a._doReset.call(this);for(var u=this.cfg.drop;u>0;u--)l.call(this)}});r.RC4Drop=i._createHelper(c)}(),t.RC4})}(Jm)),Jm.exports}var Qm={exports:{}},u2;function ZK(){return u2||(u2=1,function(n,e){(function(t,r,s){n.exports=r(Ze(),Pa(),Ta(),ko(),dn())})(Ie,function(t){return function(){var r=t,s=r.lib,i=s.StreamCipher,o=r.algo,a=[],l=[],c=[],u=o.Rabbit=i.extend({_doReset:function(){for(var d=this._key.words,p=this.cfg.iv,m=0;m<4;m++)d[m]=(d[m]<<8|d[m]>>>24)&16711935|(d[m]<<24|d[m]>>>8)&4278255360;var g=this._X=[d[0],d[3]<<16|d[2]>>>16,d[1],d[0]<<16|d[3]>>>16,d[2],d[1]<<16|d[0]>>>16,d[3],d[2]<<16|d[1]>>>16],y=this._C=[d[2]<<16|d[2]>>>16,d[0]&4294901760|d[1]&65535,d[3]<<16|d[3]>>>16,d[1]&4294901760|d[2]&65535,d[0]<<16|d[0]>>>16,d[2]&4294901760|d[3]&65535,d[1]<<16|d[1]>>>16,d[3]&4294901760|d[0]&65535];this._b=0;for(var m=0;m<4;m++)h.call(this);for(var m=0;m<8;m++)y[m]^=g[m+4&7];if(p){var x=p.words,v=x[0],w=x[1],_=(v<<8|v>>>24)&16711935|(v<<24|v>>>8)&4278255360,S=(w<<8|w>>>24)&16711935|(w<<24|w>>>8)&4278255360,E=_>>>16|S&4294901760,C=S<<16|_&65535;y[0]^=_,y[1]^=E,y[2]^=S,y[3]^=C,y[4]^=_,y[5]^=E,y[6]^=S,y[7]^=C;for(var m=0;m<4;m++)h.call(this)}},_doProcessBlock:function(d,p){var m=this._X;h.call(this),a[0]=m[0]^m[5]>>>16^m[3]<<16,a[1]=m[2]^m[7]>>>16^m[5]<<16,a[2]=m[4]^m[1]>>>16^m[7]<<16,a[3]=m[6]^m[3]>>>16^m[1]<<16;for(var g=0;g<4;g++)a[g]=(a[g]<<8|a[g]>>>24)&16711935|(a[g]<<24|a[g]>>>8)&4278255360,d[p+g]^=a[g]},blockSize:128/32,ivSize:64/32});function h(){for(var d=this._X,p=this._C,m=0;m<8;m++)l[m]=p[m];p[0]=p[0]+1295307597+this._b|0,p[1]=p[1]+3545052371+(p[0]>>>0<l[0]>>>0?1:0)|0,p[2]=p[2]+886263092+(p[1]>>>0<l[1]>>>0?1:0)|0,p[3]=p[3]+1295307597+(p[2]>>>0<l[2]>>>0?1:0)|0,p[4]=p[4]+3545052371+(p[3]>>>0<l[3]>>>0?1:0)|0,p[5]=p[5]+886263092+(p[4]>>>0<l[4]>>>0?1:0)|0,p[6]=p[6]+1295307597+(p[5]>>>0<l[5]>>>0?1:0)|0,p[7]=p[7]+3545052371+(p[6]>>>0<l[6]>>>0?1:0)|0,this._b=p[7]>>>0<l[7]>>>0?1:0;for(var m=0;m<8;m++){var g=d[m]+p[m],y=g&65535,x=g>>>16,v=((y*y>>>17)+y*x>>>15)+x*x,w=((g&4294901760)*g|0)+((g&65535)*g|0);c[m]=v^w}d[0]=c[0]+(c[7]<<16|c[7]>>>16)+(c[6]<<16|c[6]>>>16)|0,d[1]=c[1]+(c[0]<<8|c[0]>>>24)+c[7]|0,d[2]=c[2]+(c[1]<<16|c[1]>>>16)+(c[0]<<16|c[0]>>>16)|0,d[3]=c[3]+(c[2]<<8|c[2]>>>24)+c[1]|0,d[4]=c[4]+(c[3]<<16|c[3]>>>16)+(c[2]<<16|c[2]>>>16)|0,d[5]=c[5]+(c[4]<<8|c[4]>>>24)+c[3]|0,d[6]=c[6]+(c[5]<<16|c[5]>>>16)+(c[4]<<16|c[4]>>>16)|0,d[7]=c[7]+(c[6]<<8|c[6]>>>24)+c[5]|0}r.Rabbit=i._createHelper(u)}(),t.Rabbit})}(Qm)),Qm.exports}var Zm={exports:{}},d2;function eJ(){return d2||(d2=1,function(n,e){(function(t,r,s){n.exports=r(Ze(),Pa(),Ta(),ko(),dn())})(Ie,function(t){return function(){var r=t,s=r.lib,i=s.StreamCipher,o=r.algo,a=[],l=[],c=[],u=o.RabbitLegacy=i.extend({_doReset:function(){var d=this._key.words,p=this.cfg.iv,m=this._X=[d[0],d[3]<<16|d[2]>>>16,d[1],d[0]<<16|d[3]>>>16,d[2],d[1]<<16|d[0]>>>16,d[3],d[2]<<16|d[1]>>>16],g=this._C=[d[2]<<16|d[2]>>>16,d[0]&4294901760|d[1]&65535,d[3]<<16|d[3]>>>16,d[1]&4294901760|d[2]&65535,d[0]<<16|d[0]>>>16,d[2]&4294901760|d[3]&65535,d[1]<<16|d[1]>>>16,d[3]&4294901760|d[0]&65535];this._b=0;for(var y=0;y<4;y++)h.call(this);for(var y=0;y<8;y++)g[y]^=m[y+4&7];if(p){var x=p.words,v=x[0],w=x[1],_=(v<<8|v>>>24)&16711935|(v<<24|v>>>8)&4278255360,S=(w<<8|w>>>24)&16711935|(w<<24|w>>>8)&4278255360,E=_>>>16|S&4294901760,C=S<<16|_&65535;g[0]^=_,g[1]^=E,g[2]^=S,g[3]^=C,g[4]^=_,g[5]^=E,g[6]^=S,g[7]^=C;for(var y=0;y<4;y++)h.call(this)}},_doProcessBlock:function(d,p){var m=this._X;h.call(this),a[0]=m[0]^m[5]>>>16^m[3]<<16,a[1]=m[2]^m[7]>>>16^m[5]<<16,a[2]=m[4]^m[1]>>>16^m[7]<<16,a[3]=m[6]^m[3]>>>16^m[1]<<16;for(var g=0;g<4;g++)a[g]=(a[g]<<8|a[g]>>>24)&16711935|(a[g]<<24|a[g]>>>8)&4278255360,d[p+g]^=a[g]},blockSize:128/32,ivSize:64/32});function h(){for(var d=this._X,p=this._C,m=0;m<8;m++)l[m]=p[m];p[0]=p[0]+1295307597+this._b|0,p[1]=p[1]+3545052371+(p[0]>>>0<l[0]>>>0?1:0)|0,p[2]=p[2]+886263092+(p[1]>>>0<l[1]>>>0?1:0)|0,p[3]=p[3]+1295307597+(p[2]>>>0<l[2]>>>0?1:0)|0,p[4]=p[4]+3545052371+(p[3]>>>0<l[3]>>>0?1:0)|0,p[5]=p[5]+886263092+(p[4]>>>0<l[4]>>>0?1:0)|0,p[6]=p[6]+1295307597+(p[5]>>>0<l[5]>>>0?1:0)|0,p[7]=p[7]+3545052371+(p[6]>>>0<l[6]>>>0?1:0)|0,this._b=p[7]>>>0<l[7]>>>0?1:0;for(var m=0;m<8;m++){var g=d[m]+p[m],y=g&65535,x=g>>>16,v=((y*y>>>17)+y*x>>>15)+x*x,w=((g&4294901760)*g|0)+((g&65535)*g|0);c[m]=v^w}d[0]=c[0]+(c[7]<<16|c[7]>>>16)+(c[6]<<16|c[6]>>>16)|0,d[1]=c[1]+(c[0]<<8|c[0]>>>24)+c[7]|0,d[2]=c[2]+(c[1]<<16|c[1]>>>16)+(c[0]<<16|c[0]>>>16)|0,d[3]=c[3]+(c[2]<<8|c[2]>>>24)+c[1]|0,d[4]=c[4]+(c[3]<<16|c[3]>>>16)+(c[2]<<16|c[2]>>>16)|0,d[5]=c[5]+(c[4]<<8|c[4]>>>24)+c[3]|0,d[6]=c[6]+(c[5]<<16|c[5]>>>16)+(c[4]<<16|c[4]>>>16)|0,d[7]=c[7]+(c[6]<<8|c[6]>>>24)+c[5]|0}r.RabbitLegacy=i._createHelper(u)}(),t.RabbitLegacy})}(Zm)),Zm.exports}var ev={exports:{}},h2;function tJ(){return h2||(h2=1,function(n,e){(function(t,r,s){n.exports=r(Ze(),Pa(),Ta(),ko(),dn())})(Ie,function(t){return function(){var r=t,s=r.lib,i=s.BlockCipher,o=r.algo;const a=16,l=[608135816,2242054355,320440878,57701188,2752067618,698298832,137296536,3964562569,1160258022,953160567,3193202383,887688300,3232508343,3380367581,1065670069,3041331479,2450970073,2306472731],c=[[3509652390,2564797868,805139163,3491422135,3101798381,1780907670,3128725573,4046225305,614570311,3012652279,134345442,2240740374,1667834072,1901547113,2757295779,4103290238,227898511,1921955416,1904987480,2182433518,2069144605,3260701109,2620446009,720527379,3318853667,677414384,3393288472,3101374703,2390351024,1614419982,1822297739,2954791486,3608508353,3174124327,2024746970,1432378464,3864339955,2857741204,1464375394,1676153920,1439316330,715854006,3033291828,289532110,2706671279,2087905683,3018724369,1668267050,732546397,1947742710,3462151702,2609353502,2950085171,1814351708,2050118529,680887927,999245976,1800124847,3300911131,1713906067,1641548236,4213287313,1216130144,1575780402,4018429277,3917837745,3693486850,3949271944,596196993,3549867205,258830323,2213823033,772490370,2760122372,1774776394,2652871518,566650946,4142492826,1728879713,2882767088,1783734482,3629395816,2517608232,2874225571,1861159788,326777828,3124490320,2130389656,2716951837,967770486,1724537150,2185432712,2364442137,1164943284,2105845187,998989502,3765401048,2244026483,1075463327,1455516326,1322494562,910128902,469688178,1117454909,936433444,3490320968,3675253459,1240580251,122909385,2157517691,634681816,4142456567,3825094682,3061402683,2540495037,79693498,3249098678,1084186820,1583128258,426386531,1761308591,1047286709,322548459,995290223,1845252383,2603652396,3431023940,2942221577,3202600964,3727903485,1712269319,422464435,3234572375,1170764815,3523960633,3117677531,1434042557,442511882,3600875718,1076654713,1738483198,4213154764,2393238008,3677496056,1014306527,4251020053,793779912,2902807211,842905082,4246964064,1395751752,1040244610,2656851899,3396308128,445077038,3742853595,3577915638,679411651,2892444358,2354009459,1767581616,3150600392,3791627101,3102740896,284835224,4246832056,1258075500,768725851,2589189241,3069724005,3532540348,1274779536,3789419226,2764799539,1660621633,3471099624,4011903706,913787905,3497959166,737222580,2514213453,2928710040,3937242737,1804850592,3499020752,2949064160,2386320175,2390070455,2415321851,4061277028,2290661394,2416832540,1336762016,1754252060,3520065937,3014181293,791618072,3188594551,3933548030,2332172193,3852520463,3043980520,413987798,3465142937,3030929376,4245938359,2093235073,3534596313,375366246,2157278981,2479649556,555357303,3870105701,2008414854,3344188149,4221384143,3956125452,2067696032,3594591187,2921233993,2428461,544322398,577241275,1471733935,610547355,4027169054,1432588573,1507829418,2025931657,3646575487,545086370,48609733,2200306550,1653985193,298326376,1316178497,3007786442,2064951626,458293330,2589141269,3591329599,3164325604,727753846,2179363840,146436021,1461446943,4069977195,705550613,3059967265,3887724982,4281599278,3313849956,1404054877,2845806497,146425753,1854211946],[1266315497,3048417604,3681880366,3289982499,290971e4,1235738493,2632868024,2414719590,3970600049,1771706367,1449415276,3266420449,422970021,1963543593,2690192192,3826793022,1062508698,1531092325,1804592342,2583117782,2714934279,4024971509,1294809318,4028980673,1289560198,2221992742,1669523910,35572830,157838143,1052438473,1016535060,1802137761,1753167236,1386275462,3080475397,2857371447,1040679964,2145300060,2390574316,1461121720,2956646967,4031777805,4028374788,33600511,2920084762,1018524850,629373528,3691585981,3515945977,2091462646,2486323059,586499841,988145025,935516892,3367335476,2599673255,2839830854,265290510,3972581182,2759138881,3795373465,1005194799,847297441,406762289,1314163512,1332590856,1866599683,4127851711,750260880,613907577,1450815602,3165620655,3734664991,3650291728,3012275730,3704569646,1427272223,778793252,1343938022,2676280711,2052605720,1946737175,3164576444,3914038668,3967478842,3682934266,1661551462,3294938066,4011595847,840292616,3712170807,616741398,312560963,711312465,1351876610,322626781,1910503582,271666773,2175563734,1594956187,70604529,3617834859,1007753275,1495573769,4069517037,2549218298,2663038764,504708206,2263041392,3941167025,2249088522,1514023603,1998579484,1312622330,694541497,2582060303,2151582166,1382467621,776784248,2618340202,3323268794,2497899128,2784771155,503983604,4076293799,907881277,423175695,432175456,1378068232,4145222326,3954048622,3938656102,3820766613,2793130115,2977904593,26017576,3274890735,3194772133,1700274565,1756076034,4006520079,3677328699,720338349,1533947780,354530856,688349552,3973924725,1637815568,332179504,3949051286,53804574,2852348879,3044236432,1282449977,3583942155,3416972820,4006381244,1617046695,2628476075,3002303598,1686838959,431878346,2686675385,1700445008,1080580658,1009431731,832498133,3223435511,2605976345,2271191193,2516031870,1648197032,4164389018,2548247927,300782431,375919233,238389289,3353747414,2531188641,2019080857,1475708069,455242339,2609103871,448939670,3451063019,1395535956,2413381860,1841049896,1491858159,885456874,4264095073,4001119347,1565136089,3898914787,1108368660,540939232,1173283510,2745871338,3681308437,4207628240,3343053890,4016749493,1699691293,1103962373,3625875870,2256883143,3830138730,1031889488,3479347698,1535977030,4236805024,3251091107,2132092099,1774941330,1199868427,1452454533,157007616,2904115357,342012276,595725824,1480756522,206960106,497939518,591360097,863170706,2375253569,3596610801,1814182875,2094937945,3421402208,1082520231,3463918190,2785509508,435703966,3908032597,1641649973,2842273706,3305899714,1510255612,2148256476,2655287854,3276092548,4258621189,236887753,3681803219,274041037,1734335097,3815195456,3317970021,1899903192,1026095262,4050517792,356393447,2410691914,3873677099,3682840055],[3913112168,2491498743,4132185628,2489919796,1091903735,1979897079,3170134830,3567386728,3557303409,857797738,1136121015,1342202287,507115054,2535736646,337727348,3213592640,1301675037,2528481711,1895095763,1721773893,3216771564,62756741,2142006736,835421444,2531993523,1442658625,3659876326,2882144922,676362277,1392781812,170690266,3921047035,1759253602,3611846912,1745797284,664899054,1329594018,3901205900,3045908486,2062866102,2865634940,3543621612,3464012697,1080764994,553557557,3656615353,3996768171,991055499,499776247,1265440854,648242737,3940784050,980351604,3713745714,1749149687,3396870395,4211799374,3640570775,1161844396,3125318951,1431517754,545492359,4268468663,3499529547,1437099964,2702547544,3433638243,2581715763,2787789398,1060185593,1593081372,2418618748,4260947970,69676912,2159744348,86519011,2512459080,3838209314,1220612927,3339683548,133810670,1090789135,1078426020,1569222167,845107691,3583754449,4072456591,1091646820,628848692,1613405280,3757631651,526609435,236106946,48312990,2942717905,3402727701,1797494240,859738849,992217954,4005476642,2243076622,3870952857,3732016268,765654824,3490871365,2511836413,1685915746,3888969200,1414112111,2273134842,3281911079,4080962846,172450625,2569994100,980381355,4109958455,2819808352,2716589560,2568741196,3681446669,3329971472,1835478071,660984891,3704678404,4045999559,3422617507,3040415634,1762651403,1719377915,3470491036,2693910283,3642056355,3138596744,1364962596,2073328063,1983633131,926494387,3423689081,2150032023,4096667949,1749200295,3328846651,309677260,2016342300,1779581495,3079819751,111262694,1274766160,443224088,298511866,1025883608,3806446537,1145181785,168956806,3641502830,3584813610,1689216846,3666258015,3200248200,1692713982,2646376535,4042768518,1618508792,1610833997,3523052358,4130873264,2001055236,3610705100,2202168115,4028541809,2961195399,1006657119,2006996926,3186142756,1430667929,3210227297,1314452623,4074634658,4101304120,2273951170,1399257539,3367210612,3027628629,1190975929,2062231137,2333990788,2221543033,2438960610,1181637006,548689776,2362791313,3372408396,3104550113,3145860560,296247880,1970579870,3078560182,3769228297,1714227617,3291629107,3898220290,166772364,1251581989,493813264,448347421,195405023,2709975567,677966185,3703036547,1463355134,2715995803,1338867538,1343315457,2802222074,2684532164,233230375,2599980071,2000651841,3277868038,1638401717,4028070440,3237316320,6314154,819756386,300326615,590932579,1405279636,3267499572,3150704214,2428286686,3959192993,3461946742,1862657033,1266418056,963775037,2089974820,2263052895,1917689273,448879540,3550394620,3981727096,150775221,3627908307,1303187396,508620638,2975983352,2726630617,1817252668,1876281319,1457606340,908771278,3720792119,3617206836,2455994898,1729034894,1080033504],[976866871,3556439503,2881648439,1522871579,1555064734,1336096578,3548522304,2579274686,3574697629,3205460757,3593280638,3338716283,3079412587,564236357,2993598910,1781952180,1464380207,3163844217,3332601554,1699332808,1393555694,1183702653,3581086237,1288719814,691649499,2847557200,2895455976,3193889540,2717570544,1781354906,1676643554,2592534050,3230253752,1126444790,2770207658,2633158820,2210423226,2615765581,2414155088,3127139286,673620729,2805611233,1269405062,4015350505,3341807571,4149409754,1057255273,2012875353,2162469141,2276492801,2601117357,993977747,3918593370,2654263191,753973209,36408145,2530585658,25011837,3520020182,2088578344,530523599,2918365339,1524020338,1518925132,3760827505,3759777254,1202760957,3985898139,3906192525,674977740,4174734889,2031300136,2019492241,3983892565,4153806404,3822280332,352677332,2297720250,60907813,90501309,3286998549,1016092578,2535922412,2839152426,457141659,509813237,4120667899,652014361,1966332200,2975202805,55981186,2327461051,676427537,3255491064,2882294119,3433927263,1307055953,942726286,933058658,2468411793,3933900994,4215176142,1361170020,2001714738,2830558078,3274259782,1222529897,1679025792,2729314320,3714953764,1770335741,151462246,3013232138,1682292957,1483529935,471910574,1539241949,458788160,3436315007,1807016891,3718408830,978976581,1043663428,3165965781,1927990952,4200891579,2372276910,3208408903,3533431907,1412390302,2931980059,4132332400,1947078029,3881505623,4168226417,2941484381,1077988104,1320477388,886195818,18198404,3786409e3,2509781533,112762804,3463356488,1866414978,891333506,18488651,661792760,1628790961,3885187036,3141171499,876946877,2693282273,1372485963,791857591,2686433993,3759982718,3167212022,3472953795,2716379847,445679433,3561995674,3504004811,3574258232,54117162,3331405415,2381918588,3769707343,4154350007,1140177722,4074052095,668550556,3214352940,367459370,261225585,2610173221,4209349473,3468074219,3265815641,314222801,3066103646,3808782860,282218597,3406013506,3773591054,379116347,1285071038,846784868,2669647154,3771962079,3550491691,2305946142,453669953,1268987020,3317592352,3279303384,3744833421,2610507566,3859509063,266596637,3847019092,517658769,3462560207,3443424879,370717030,4247526661,2224018117,4143653529,4112773975,2788324899,2477274417,1456262402,2901442914,1517677493,1846949527,2295493580,3734397586,2176403920,1280348187,1908823572,3871786941,846861322,1172426758,3287448474,3383383037,1655181056,3139813346,901632758,1897031941,2986607138,3066810236,3447102507,1393639104,373351379,950779232,625454576,3124240540,4148612726,2007998917,544563296,2244738638,2330496472,2058025392,1291430526,424198748,50039436,29584100,3605783033,2429876329,2791104160,1057563949,3255363231,3075367218,3463963227,1469046755,985887462]];var u={pbox:[],sbox:[]};function h(y,x){let v=x>>24&255,w=x>>16&255,_=x>>8&255,S=x&255,E=y.sbox[0][v]+y.sbox[1][w];return E=E^y.sbox[2][_],E=E+y.sbox[3][S],E}function d(y,x,v){let w=x,_=v,S;for(let E=0;E<a;++E)w=w^y.pbox[E],_=h(y,w)^_,S=w,w=_,_=S;return S=w,w=_,_=S,_=_^y.pbox[a],w=w^y.pbox[a+1],{left:w,right:_}}function p(y,x,v){let w=x,_=v,S;for(let E=a+1;E>1;--E)w=w^y.pbox[E],_=h(y,w)^_,S=w,w=_,_=S;return S=w,w=_,_=S,_=_^y.pbox[1],w=w^y.pbox[0],{left:w,right:_}}function m(y,x,v){for(let C=0;C<4;C++){y.sbox[C]=[];for(let P=0;P<256;P++)y.sbox[C][P]=c[C][P]}let w=0;for(let C=0;C<a+2;C++)y.pbox[C]=l[C]^x[w],w++,w>=v&&(w=0);let _=0,S=0,E=0;for(let C=0;C<a+2;C+=2)E=d(y,_,S),_=E.left,S=E.right,y.pbox[C]=_,y.pbox[C+1]=S;for(let C=0;C<4;C++)for(let P=0;P<256;P+=2)E=d(y,_,S),_=E.left,S=E.right,y.sbox[C][P]=_,y.sbox[C][P+1]=S;return!0}var g=o.Blowfish=i.extend({_doReset:function(){if(this._keyPriorReset!==this._key){var y=this._keyPriorReset=this._key,x=y.words,v=y.sigBytes/4;m(u,x,v)}},encryptBlock:function(y,x){var v=d(u,y[x],y[x+1]);y[x]=v.left,y[x+1]=v.right},decryptBlock:function(y,x){var v=p(u,y[x],y[x+1]);y[x]=v.left,y[x+1]=v.right},blockSize:64/32,keySize:128/32,ivSize:64/32});r.Blowfish=i._createHelper(g)}(),t.Blowfish})}(ev)),ev.exports}(function(n,e){(function(t,r,s){n.exports=r(Ze(),$0(),OK(),IK(),Pa(),RK(),Ta(),KI(),K1(),NK(),JI(),jK(),LK(),MK(),J1(),FK(),ko(),dn(),BK(),UK(),$K(),zK(),WK(),HK(),VK(),GK(),qK(),YK(),XK(),KK(),JK(),QK(),ZK(),eJ(),tJ())})(Ie,function(t){return t})})(XI);var nJ=XI.exports;const f2=Ap(nJ),QI=async n=>{try{const e=new Image,t=document.createElement("canvas"),r=t.getContext("2d");if(!r)throw new Error("Could not get canvas context");const s=URL.createObjectURL(n);return new Promise((i,o)=>{e.onload=()=>{try{t.width=8,t.height=8,r.drawImage(e,0,0,8,8);const c=r.getImageData(0,0,8,8).data;let u=0;const h=[];for(let m=0;m<c.length;m+=4){const g=Math.round((c[m]+c[m+1]+c[m+2])/3);h.push(g),u+=g}const d=u/h.length;let p="";for(const m of h)p+=m>d?"1":"0";URL.revokeObjectURL(s),i(p)}catch(a){URL.revokeObjectURL(s),o(a)}},e.onerror=()=>{URL.revokeObjectURL(s),o(new Error("Failed to load image for perceptual hashing"))},e.src=s})}catch(e){throw console.error("Error generating perceptual hash:",e),e}},ZI=async n=>{try{const e=await n.arrayBuffer(),t=f2.lib.WordArray.create(e);return f2.SHA256(t).toString()}catch(e){throw console.error("Error generating file hash:",e),e}},rJ=async(n,e,t)=>{try{const{data:r,error:s}=await t.from("media").select("media_id").eq("event_id",n).eq("file_hash",e).limit(1);return s?(console.error("Error checking for duplicate:",s),!1):r&&r.length>0}catch(r){return console.error("Error checking for duplicate:",r),!1}},$ee=Object.freeze(Object.defineProperty({__proto__:null,checkDuplicatePhoto:rJ,generateFileHash:ZI,generatePerceptualHash:QI},Symbol.toStringTag,{value:"Module"}));async function sJ(n){try{const e=await iJ(n),t=Te.load(e),r={fileName:n.name,fileSize:n.size};if(t["0th"]&&(t["0th"][Te.ImageIFD.Make]&&(r.cameraMake=t["0th"][Te.ImageIFD.Make]),t["0th"][Te.ImageIFD.Model]&&(r.cameraModel=t["0th"][Te.ImageIFD.Model]),t["0th"][Te.ImageIFD.ImageWidth]&&(r.imageWidth=t["0th"][Te.ImageIFD.ImageWidth]),t["0th"][Te.ImageIFD.ImageLength]&&(r.imageHeight=t["0th"][Te.ImageIFD.ImageLength]),t["0th"][Te.ImageIFD.Orientation]&&(r.orientation=t["0th"][Te.ImageIFD.Orientation]),t["0th"][Te.ImageIFD.DateTime])){const s=t["0th"][Te.ImageIFD.DateTime];r.dateTaken=tv(s)}if(t.Exif){if(t.Exif[Te.ExifIFD.DateTimeOriginal]){const s=t.Exif[Te.ExifIFD.DateTimeOriginal];r.dateTaken=tv(s)}else if(t.Exif[Te.ExifIFD.DateTimeDigitized]){const s=t.Exif[Te.ExifIFD.DateTimeDigitized];r.dateTaken=tv(s)}if(t.Exif[Te.ExifIFD.PixelXDimension]&&(r.imageWidth=t.Exif[Te.ExifIFD.PixelXDimension]),t.Exif[Te.ExifIFD.PixelYDimension]&&(r.imageHeight=t.Exif[Te.ExifIFD.PixelYDimension]),t.Exif[Te.ExifIFD.FNumber]){const s=t.Exif[Te.ExifIFD.FNumber];Array.isArray(s)&&(r.fNumber=s[0]/s[1])}if(t.Exif[Te.ExifIFD.ExposureTime]){const s=t.Exif[Te.ExifIFD.ExposureTime];Array.isArray(s)&&(r.exposureTime=`${s[0]}/${s[1]}`)}if(t.Exif[Te.ExifIFD.ISOSpeedRatings]&&(r.iso=t.Exif[Te.ExifIFD.ISOSpeedRatings]),t.Exif[Te.ExifIFD.FocalLength]){const s=t.Exif[Te.ExifIFD.FocalLength];Array.isArray(s)&&(r.focalLength=s[0]/s[1])}t.Exif[Te.ExifIFD.Flash]!==void 0&&(r.flash=(t.Exif[Te.ExifIFD.Flash]&1)===1)}if(t.GPS)try{if(t.GPS[Te.GPSIFD.GPSLatitude]&&t.GPS[Te.GPSIFD.GPSLatitudeRef]){const s=p2(t.GPS[Te.GPSIFD.GPSLatitude],t.GPS[Te.GPSIFD.GPSLatitudeRef]);s!==null&&(r.gpsLatitude=s)}if(t.GPS[Te.GPSIFD.GPSLongitude]&&t.GPS[Te.GPSIFD.GPSLongitudeRef]){const s=p2(t.GPS[Te.GPSIFD.GPSLongitude],t.GPS[Te.GPSIFD.GPSLongitudeRef]);s!==null&&(r.gpsLongitude=s)}}catch(s){console.warn("Failed to parse GPS data:",s)}return r}catch(e){return console.warn("Failed to extract EXIF data:",e),{fileName:n.name,fileSize:n.size}}}function tv(n){try{if(typeof n!="string")return;const e=n.replace(/^(\d{4}):(\d{2}):(\d{2})/,"$1-$2-$3"),t=new Date(e);return isNaN(t.getTime())?void 0:t.toISOString()}catch(e){console.warn("Failed to parse EXIF datetime:",e);return}}function p2(n,e){try{if(!Array.isArray(n)||n.length!==3)return null;const t=n[0][0]/n[0][1],r=n[1][0]/n[1][1],s=n[2][0]/n[2][1];let i=t+r/60+s/3600;return(e==="S"||e==="W")&&(i=-i),i}catch(t){return console.warn("Failed to convert GPS coordinate:",t),null}}function iJ(n){return new Promise((e,t)=>{const r=new FileReader;r.onload=()=>e(r.result),r.onerror=t,r.readAsDataURL(n)})}const oJ=n=>{const{user:e}=Or(),[t,r]=b.useState(null),[s,i]=b.useState(!1),[o,a]=b.useState(!1),l=b.useCallback(async p=>{if(!e)return null;i(!0);try{const{data:m,error:g}=await ue.rpc("get_auto_upload_settings",{event_uuid:p});if(g)throw g;if(m&&m.length>0){const y=m[0];return r(y),y}return null}catch(m){return console.error("Error loading auto-upload settings:",m),null}finally{i(!1)}},[e]),c=b.useCallback(async p=>{if(!e)return!1;try{const{data:m,error:g}=await ue.rpc("is_auto_upload_active",{event_uuid:p});if(g)throw g;return m||!1}catch(m){return console.error("Error checking auto-upload status:",m),!1}},[e]),u=b.useCallback(async p=>{if(!e)throw new Error("No user authenticated");const{data:{session:m}}=await ue.auth.getSession();if(!(m!=null&&m.access_token))throw new Error("No authentication token available");a(!0);try{const g={...p.metadata};if(p.fileData)try{const x=atob(p.fileData),v=new Array(x.length);for(let P=0;P<x.length;P++)v[P]=x.charCodeAt(P);const w=new Uint8Array(v),_=new Blob([w],{type:p.mediaType==="video"?"video/mp4":"image/jpeg"}),S=new File([_],p.fileName,{type:_.type}),E=await ZI(S),C=p.mediaType==="photo"?await QI(S):null;if(g.file_hash=E,C&&(g.perceptual_hash=C),p.mediaType==="photo"){const P=await sJ(S);Object.assign(g,P)}}catch(x){console.warn("Failed to generate hash/EXIF for auto-upload:",x)}const y=await ue.functions.invoke("mobile-upload",{body:{...p,metadata:g},headers:{Authorization:`Bearer ${m.access_token}`,"Content-Type":"application/json"}});if(y.error)throw new Error(y.error.message||"Upload failed");return y.data}catch(g){throw console.error("Error uploading file:",g),g}finally{a(!1)}},[e]),h=b.useCallback(async(p,m,g,y)=>{if(!e)return!1;try{const{data:x,error:v}=await ue.rpc("update_auto_upload_settings",{event_uuid:p,enabled:m,start_time:m&&g?g.toISOString():null,end_time:m&&y?y.toISOString():null});if(v)throw v;return x||!1}catch(x){return console.error("Error updating auto-upload settings:",x),!1}},[e]),d=b.useCallback(async p=>{const m=[];for(const g of p)try{const y=await u(g);m.push(y)}catch(y){m.push({success:!1,message:y instanceof Error?y.message:"Upload failed"})}return m},[u]);return b.useEffect(()=>{},[n,e,l]),{settings:t,loading:s,uploading:o,loadSettings:l,isAutoUploadActive:c,uploadFile:u,batchUpload:d,updateSettings:h}},aJ=()=>{const[n,e]=b.useState(!1);return{isLoading:n,createEventNotificationSettings:async(o,a={upcomingEvent:!0,eventStarting:!0,uploadReminder:!0,downloadReminder:!0})=>{e(!0);try{console.log(" Creating event notification settings:",{eventId:o,settings:a});const{data:{user:l},error:c}=await ue.auth.getUser();if(!l||!l.id||l.id==="session")throw console.error(" Authentication issue:",{user:l,authError:c}),new Error("User not properly authenticated. Please sign in again.");const{data:u,error:h}=await ue.from("user_event_notification_settings").upsert({user_id:l.id,event_id:o,upcoming_event:a.upcomingEvent,event_starting:a.eventStarting,upload_reminder:a.uploadReminder,download_reminder:a.downloadReminder},{onConflict:"user_id,event_id",ignoreDuplicates:!1}).select();if(h)throw console.error(" Error creating event notification settings:",h),h;return console.log(" Event notification settings created:",u),{success:!0,data:u}}catch(l){return console.error(" Failed to create event notification settings:",l),{success:!1,error:l.message}}finally{e(!1)}},removeEventNotificationSettings:async o=>{e(!0);try{console.log(" Removing event notification settings for event:",o);const{data:{user:a},error:l}=await ue.auth.getUser();if(!a||!a.id||a.id==="session")throw console.error(" Authentication issue:",{user:a,authError:l}),new Error("User not properly authenticated. Please sign in again.");const{error:c}=await ue.from("user_event_notification_settings").delete().eq("user_id",a.id).eq("event_id",o);if(c)throw console.error(" Error removing event notification settings:",c),c;return console.log(" Event notification settings removed successfully"),{success:!0}}catch(a){return console.error(" Failed to remove event notification settings:",a),{success:!1,error:a.message}}finally{e(!1)}},getEventNotificationSettings:async o=>{try{const{data:{user:a},error:l}=await ue.auth.getUser();if(!a||!a.id||a.id==="session")return null;const{data:c,error:u}=await ue.from("user_event_notification_settings").select("*").eq("user_id",a.id).eq("event_id",o).maybeSingle();return u?(console.error(" Error getting event notification settings:",u),null):c}catch(a){return console.error(" Failed to get event notification settings:",a),null}},createNotificationSettingsForUserEvents:async()=>{e(!0);try{console.log(" Creating notification settings for all user events");const{data:{user:o},error:a}=await ue.auth.getUser();if(!o||!o.id||o.id==="session")throw console.error(" Authentication issue:",{user:o,authError:a}),new Error("User not properly authenticated. Please sign in again.");const{data:l,error:c}=await ue.from("event_participants").select("event_id").eq("user_id",o.id);if(c)throw console.error(" Error getting participant events:",c),c;const u=new Date;u.setHours(0,0,0,0);const{data:h,error:d}=await ue.from("events").select("event_id, end_time, retention_days").eq("owner_id",o.id);if(d)throw console.error(" Error getting owned events:",d),d;const p=(h||[]).filter(E=>{const C=new Date(E.end_time);return new Date(C.getTime()+E.retention_days*24*60*60*1e3)>=u}),{data:m,error:g}=await ue.from("event_participants").select(`
          event_id,
          events!inner(
            end_time,
            retention_days
          )
        `).eq("user_id",o.id);if(g)throw console.error(" Error getting participant event details:",g),g;const x=[...(m||[]).filter(E=>{const C=E.events,P=new Date(C.end_time);return new Date(P.getTime()+C.retention_days*24*60*60*1e3)>=u}).map(E=>E.event_id),...p.map(E=>E.event_id)],v=[...new Set(x)];if(console.log(` Found ${v.length} valid events for user (auto-delete >= today)`),v.length===0)return{success:!0,message:"No valid events found for user"};const w=v.map(E=>({user_id:o.id,event_id:E,upcoming_event:!0,event_starting:!0,upload_reminder:!0,download_reminder:!0})),{data:_,error:S}=await ue.from("user_event_notification_settings").upsert(w,{onConflict:"user_id,event_id",ignoreDuplicates:!0}).select();if(S)throw console.error(" Error creating notification settings:",S),S;return console.log(" Notification settings created for events:",(_==null?void 0:_.length)||0),{success:!0,data:_}}catch(o){return console.error(" Failed to create notification settings for user events:",o),{success:!1,error:o.message}}finally{e(!1)}}}},lJ=()=>{const[n,e]=b.useState(!1),[t,r]=b.useState(null),s=b.useCallback(async(l,c)=>{e(!0),r(null);try{const{data:u,error:h}=await ue.functions.invoke("upload-queue-register",{body:{event_id:l,uploads:c}});if(h)throw h;return u}catch(u){const h=u instanceof Error?u.message:"Failed to register uploads";return r(h),console.error("Register uploads error:",u),null}finally{e(!1)}},[]),i=b.useCallback(async(l,c,u,h)=>{var d;try{const p={status:c};u!==void 0&&(p.progress=u),h&&(p.error_message=h);const m=await fetch(`https://jgfcfdlfcnmaripgpepl.supabase.co/functions/v1/upload-status-update/${l}`,{method:"PATCH",headers:{Authorization:`Bearer ${(d=(await ue.auth.getSession()).data.session)==null?void 0:d.access_token}`,"Content-Type":"application/json"},body:JSON.stringify(p)});return m.ok?!0:(console.error("Update status error:",await m.text()),!1)}catch(p){return console.error("Update upload status error:",p),!1}},[]),o=b.useCallback(async l=>{var c;try{const u=await fetch(`https://jgfcfdlfcnmaripgpepl.supabase.co/functions/v1/upload-status-get/${l}`,{method:"GET",headers:{Authorization:`Bearer ${(c=(await ue.auth.getSession()).data.session)==null?void 0:c.access_token}`,"Content-Type":"application/json"}});if(!u.ok)throw new Error(await u.text());return await u.json()}catch(u){return console.error("Get upload status error:",u),null}},[]),a=b.useCallback(async(l,c,u)=>{var h;try{const d=new FormData;d.append("file",c),d.append("event_id",u);const p=await fetch(`https://jgfcfdlfcnmaripgpepl.supabase.co/functions/v1/upload-complete/${l}`,{method:"POST",headers:{Authorization:`Bearer ${(h=(await ue.auth.getSession()).data.session)==null?void 0:h.access_token}`},body:d});if(!p.ok)return{success:!1,error:(await p.json()).error};const m=await p.json();return{success:!0,photoId:m.photo_id,url:m.url}}catch(d){return console.error("Complete upload error:",d),{success:!1,error:"Upload failed"}}},[]);return{loading:n,error:t,registerUploads:s,updateUploadStatus:i,getUploadStatus:o,completeUpload:a}},cJ=()=>{const[n,e]=b.useState({isFirstLaunch:!1,isLoading:!0,currentStep:"notifications",shouldShowOnboarding:!1}),t=de.isNativePlatform(),{notifications:r,camera:s,photos:i,isLoading:o,hasAllPermissions:a}=OI(),l=async()=>{var p,m,g,y,x,v,w,_,S,E;const h=de.isNativePlatform(),d=de.getPlatform();if(console.log(" Platform check:",{isNative:h,platform:d}),!h){console.log(" Web platform - skipping onboarding"),e(C=>({...C,isFirstLaunch:!1,shouldShowOnboarding:!1,isLoading:!1,currentStep:"complete"}));return}console.log(` Native ${d} detected - checking permissions`);try{if(console.log(" Checking first launch status..."),window.waitForPermissionGate)try{const B=await window.waitForPermissionGate(5e3);if(B.reason==="onboarding_complete"||B.blocked===!1){console.log(" Permission gate reports onboarding complete - skipping overlay"),e(I=>({...I,isFirstLaunch:!1,shouldShowOnboarding:!1,isLoading:!1,currentStep:"complete"})),(m=(p=window.PhotoSharePermissionsEvents)==null?void 0:p.setBlocked)==null||m.call(p,!1,"react_onboarding_complete");return}}catch(B){console.warn(" Permission gate check failed:",B)}const C=(y=(g=window.Capacitor)==null?void 0:g.Plugins)==null?void 0:y.AppPermissions;if(C!=null&&C.hasCompletedOnboarding)try{const B=await C.hasCompletedOnboarding();if(B!=null&&B.completed){console.log(" Native reports onboarding complete - skipping overlay"),e(I=>({...I,isFirstLaunch:!1,shouldShowOnboarding:!1,isLoading:!1,currentStep:"complete"})),(v=(x=window.PhotoSharePermissionsEvents)==null?void 0:x.setBlocked)==null||v.call(x,!1,"react_onboarding_complete");return}}catch(B){console.warn(" Could not check native onboarding status:",B)}let P=!1;if(C!=null&&C.isFirstLaunch)try{P=(await C.isFirstLaunch()).isFirstLaunch,console.log(" Native first launch check:",P)}catch(B){console.warn(" Could not check native first launch:",B)}if(C!=null&&C.isFirstLaunch||(P=!localStorage.getItem("hasSeenOnboarding"),console.log(" LocalStorage first launch check:",P)),o){console.log(" Waiting for permission checks to complete..."),e(B=>({...B,isLoading:!0}));return}const O=!a,A=P||O;let R="complete";h&&r!=="granted"?R="notifications":s!=="granted"?R="camera":i!=="granted"&&(R="photos"),console.log(" Onboarding decision:",{isFirstLaunch:P,hasAllPermissions:a,needsPermissions:O,shouldShowOnboarding:A,currentStep:R,permissionStatus:{notifications:r,camera:s,photos:i},isNative:h,timestamp:new Date().toISOString()}),A?(console.log(" Updating permission gate: BLOCKED"),(_=(w=window.PhotoSharePermissionsEvents)==null?void 0:w.setBlocked)==null||_.call(w,!0,"react_onboarding_pending")):(console.log(" Updating permission gate: OPEN"),(E=(S=window.PhotoSharePermissionsEvents)==null?void 0:S.setBlocked)==null||E.call(S,!1,"react_onboarding_complete")),e({isFirstLaunch:P,isLoading:!1,currentStep:A?R:"complete",shouldShowOnboarding:A}),console.log(" Onboarding state set, shouldShowOnboarding:",A)}catch(C){console.error(" Error checking permissions for onboarding:",C),e(P=>({...P,isLoading:!1,isFirstLaunch:!1,shouldShowOnboarding:!1}))}},c=h=>{console.log(` Permission step completed: ${h}`);let d;if(t)switch(h){case"notifications":d="camera";break;case"camera":d="photos";break;case"photos":d="complete";break;default:d="complete"}else switch(h){case"camera":d="photos";break;case"photos":d="complete";break;default:d="complete"}e(p=>({...p,currentStep:d,shouldShowOnboarding:d!=="complete"})),d==="complete"&&u()},u=async()=>{var h,d,p,m,g;try{console.log(" Onboarding completed!"),t&&((p=(d=(h=window.Capacitor)==null?void 0:h.Plugins)==null?void 0:d.AppPermissions)!=null&&p.markOnboardingComplete)?await window.Capacitor.Plugins.AppPermissions.markOnboardingComplete():localStorage.setItem("photo-share-onboarding-complete","true"),console.log(" Completing onboarding - opening permission gate"),(g=(m=window.PhotoSharePermissionsEvents)==null?void 0:m.setBlocked)==null||g.call(m,!1,"react_onboarding_complete"),e(y=>({...y,shouldShowOnboarding:!1,currentStep:"complete"}))}catch(y){console.error("Error completing onboarding:",y)}};return b.useEffect(()=>{o||l()},[r,s,i,o]),{...n,markStepComplete:c,completeOnboarding:u,checkFirstLaunch:l}};function Q1({title:n,subtitle:e,showBadge:t=!0}){return f.jsxs("div",{className:"text-center mb-8",children:[t&&f.jsxs("div",{className:"inline-flex items-center gap-2 px-4 py-2 rounded-full mb-6",style:{background:"var(--gradient-primary)",boxShadow:"var(--shadow-camera)"},children:[f.jsx(kr,{className:"w-5 h-5 text-primary-foreground"}),f.jsx("span",{className:"text-primary-foreground font-semibold",children:"PhotoShare"})]}),f.jsx("h1",{className:"text-3xl font-bold mb-4 bg-gradient-to-r from-primary to-accent bg-clip-text text-transparent",children:n}),e&&f.jsx("p",{className:"text-base text-muted-foreground max-w-md mx-auto",children:e})]})}const uJ=({onContinue:n,isLoading:e})=>f.jsxs("div",{className:"space-y-8",children:[f.jsx("div",{className:"flex justify-center",children:f.jsx("div",{className:"p-4 bg-gradient-to-br from-primary/20 to-accent/20 rounded-full",children:f.jsx(ly,{className:"h-10 w-10 text-primary"})})}),f.jsx(Q1,{title:"Stay Updated",subtitle:"Get notified about your events and never miss a moment"}),f.jsx(Ht,{className:"border-primary/20",children:f.jsxs(Qt,{className:"pt-6 space-y-4",children:[f.jsxs("div",{className:"flex items-start gap-4",children:[f.jsx("div",{className:"p-3 bg-primary/10 rounded-full shrink-0",children:f.jsx(cy,{className:"h-5 w-5 text-primary"})}),f.jsxs("div",{children:[f.jsx("h3",{className:"font-semibold mb-1",children:"Event Reminders"}),f.jsx("p",{className:"text-sm text-muted-foreground",children:"Get notified when your events are about to start"})]})]}),f.jsxs("div",{className:"flex items-start gap-4",children:[f.jsx("div",{className:"p-3 bg-primary/10 rounded-full shrink-0",children:f.jsx(Xp,{className:"h-5 w-5 text-primary"})}),f.jsxs("div",{children:[f.jsx("h3",{className:"font-semibold mb-1",children:"Photo Sharing"}),f.jsx("p",{className:"text-sm text-muted-foreground",children:"Know when new photos are added to your events"})]})]}),f.jsxs("div",{className:"flex items-start gap-4",children:[f.jsx("div",{className:"p-3 bg-primary/10 rounded-full shrink-0",children:f.jsx(FT,{className:"h-5 w-5 text-primary"})}),f.jsxs("div",{children:[f.jsx("h3",{className:"font-semibold mb-1",children:"Real-time Updates"}),f.jsx("p",{className:"text-sm text-muted-foreground",children:"Stay connected with live event activities"})]})]})]})}),f.jsxs("div",{className:"space-y-3 px-6",children:[f.jsxs(_e,{onClick:n,disabled:e,className:"w-full",children:[f.jsx(ly,{className:"h-4 w-4 mr-2"}),e?"Setting up...":"Enable Notifications"]}),f.jsx("p",{className:"text-xs text-center text-muted-foreground",children:"You can manage preferences in settings anytime"})]})]}),dJ=({onContinue:n,isLoading:e})=>f.jsxs("div",{className:"space-y-8",children:[f.jsx("div",{className:"flex justify-center",children:f.jsx("div",{className:"p-4 bg-gradient-to-br from-primary/20 to-accent/20 rounded-full",children:f.jsx(kr,{className:"h-10 w-10 text-primary"})})}),f.jsx(Q1,{title:"Capture Moments",subtitle:"Take photos directly in the app to share with your event guests"}),f.jsx(Ht,{className:"border-primary/20",children:f.jsxs(Qt,{className:"pt-6 space-y-4",children:[f.jsxs("div",{className:"flex items-start gap-4",children:[f.jsx("div",{className:"p-3 bg-primary/10 rounded-full shrink-0",children:f.jsx(ML,{className:"h-5 w-5 text-primary"})}),f.jsxs("div",{children:[f.jsx("h3",{className:"font-semibold mb-1",children:"Quick Capture"}),f.jsx("p",{className:"text-sm text-muted-foreground",children:"Take photos instantly without leaving the app"})]})]}),f.jsxs("div",{className:"flex items-start gap-4",children:[f.jsx("div",{className:"p-3 bg-primary/10 rounded-full shrink-0",children:f.jsx(Cw,{className:"h-5 w-5 text-primary"})}),f.jsxs("div",{children:[f.jsx("h3",{className:"font-semibold mb-1",children:"Instant Sharing"}),f.jsx("p",{className:"text-sm text-muted-foreground",children:"Share moments with guests in real-time"})]})]}),f.jsxs("div",{className:"flex items-start gap-4",children:[f.jsx("div",{className:"p-3 bg-primary/10 rounded-full shrink-0",children:f.jsx(Xp,{className:"h-5 w-5 text-primary"})}),f.jsxs("div",{children:[f.jsx("h3",{className:"font-semibold mb-1",children:"Event Memories"}),f.jsx("p",{className:"text-sm text-muted-foreground",children:"Create lasting memories with event participants"})]})]})]})}),f.jsxs("div",{className:"space-y-3 px-6",children:[f.jsxs(_e,{onClick:n,disabled:e,className:"w-full",children:[f.jsx(kr,{className:"h-4 w-4 mr-2"}),e?"Setting up...":"Enable Camera Access"]}),f.jsx("p",{className:"text-xs text-center text-muted-foreground",children:"Camera access is only used when you choose to take photos"})]})]}),hJ=({onContinue:n,isLoading:e})=>f.jsxs("div",{className:"space-y-8",children:[f.jsx("div",{className:"flex justify-center",children:f.jsx("div",{className:"p-4 bg-gradient-to-br from-primary/20 to-accent/20 rounded-full",children:f.jsx(ql,{className:"h-10 w-10 text-primary"})})}),f.jsx(Q1,{title:"Share Memories",subtitle:"Upload your favorite photos from your gallery to event albums"}),f.jsx(Ht,{className:"border-primary/20",children:f.jsxs(Qt,{className:"pt-6 space-y-4",children:[f.jsxs("div",{className:"flex items-start gap-4",children:[f.jsx("div",{className:"p-3 bg-primary/10 rounded-full shrink-0",children:f.jsx(da,{className:"h-5 w-5 text-primary"})}),f.jsxs("div",{children:[f.jsx("h3",{className:"font-semibold mb-1",children:"Easy Upload"}),f.jsx("p",{className:"text-sm text-muted-foreground",children:"Choose photos from your gallery to share with the group"})]})]}),f.jsxs("div",{className:"flex items-start gap-4",children:[f.jsx("div",{className:"p-3 bg-primary/10 rounded-full shrink-0",children:f.jsx(PL,{className:"h-5 w-5 text-primary"})}),f.jsxs("div",{children:[f.jsx("h3",{className:"font-semibold mb-1",children:"Cherished Moments"}),f.jsx("p",{className:"text-sm text-muted-foreground",children:"Share your best memories from the event"})]})]}),f.jsxs("div",{className:"flex items-start gap-4",children:[f.jsx("div",{className:"p-3 bg-primary/10 rounded-full shrink-0",children:f.jsx(RL,{className:"h-5 w-5 text-primary"})}),f.jsxs("div",{children:[f.jsx("h3",{className:"font-semibold mb-1",children:"Curated Albums"}),f.jsx("p",{className:"text-sm text-muted-foreground",children:"Build beautiful event albums together"})]})]})]})}),f.jsxs("div",{className:"space-y-3 px-6",children:[f.jsxs(_e,{onClick:()=>{console.log(" Photo permission button clicked in PhotoPermissionInfo"),n()},disabled:e,className:"w-full",children:[f.jsx(ql,{className:"h-4 w-4 mr-2"}),e?"Setting up...":"Enable Photo Access"]}),f.jsx("p",{className:"text-xs text-center text-muted-foreground",children:"Photo access is only used when you choose to upload images"})]})]}),fJ=({currentStep:n,onStepComplete:e})=>{const[t,r]=b.useState(!1),{toast:s}=Bt();X1(),de.isNativePlatform();const i=async()=>{r(!0);try{console.log(" Requesting notification permission...");let l=!1,c;if(de.isNativePlatform())try{const u=await DI();l=u.granted,c=u.error,console.log(" Push notification permission result:",{granted:l,error:c})}catch(u){console.warn("Platform adapter not available, skipping automatic enable:",u),c="Notification permission could not be requested",l=!1}else"Notification"in window?l=await Notification.requestPermission()==="granted":l=!0;l?s({title:"Notifications enabled!",description:"You'll receive updates about your events."}):c&&s({title:"Permission denied",description:c,variant:"destructive"})}catch(l){console.error("Error requesting notification permission:",l),s({title:"Permission error",description:"Could not enable notifications. You can try again in settings.",variant:"destructive"})}finally{r(!1),console.log(" Permission step completed: notifications"),e("notifications")}},o=async()=>{var l,c;r(!0);try{console.log(" Requesting camera permission...");let u=!1,h;if(de.isNativePlatform())try{const d=(c=(l=window.Capacitor)==null?void 0:l.Plugins)==null?void 0:c.AppPermissions;if(d!=null&&d.requestCameraPermission){const p=await d.requestCameraPermission();u=(p==null?void 0:p.granted)||!1,h=p==null?void 0:p.error,console.log(" AppPermissions camera result:",{granted:u,error:h})}else{const p=await ax();u=p.granted,h=p.message}}catch(d){console.log("AppPermissions plugin not available, trying fallback:",d);const p=await ax();u=p.granted,h=p.message}else u=!0;await new Promise(d=>setTimeout(d,500)),console.log(" Camera permission result received:",{granted:u,error:h}),s(u?{title:"Camera access enabled!",description:"You can now take photos directly in the app."}:{title:"Camera access needed",description:h||"Camera permission is required for photo capture.",variant:"destructive"})}catch(u){console.error("Error requesting camera permission:",u),s({title:"Permission error",description:"Could not enable camera access. You can try again in settings.",variant:"destructive"})}finally{r(!1),console.log(" Completing camera permission step"),e("camera")}},a=async()=>{var l,c;console.log(" Photo permission button clicked in onboarding"),r(!0);try{console.log(" Requesting photo permission...");let u=!1,h;if(de.isNativePlatform())try{const d=(c=(l=window.Capacitor)==null?void 0:l.Plugins)==null?void 0:c.AppPermissions;if(d!=null&&d.requestPhotoPermission){const p=await d.requestPhotoPermission();u=(p==null?void 0:p.granted)||!1,h=p==null?void 0:p.error,console.log(" AppPermissions photo result:",{granted:u,error:h})}else{const p=await cx();u=p.granted,h=p.message}}catch(d){console.log("AppPermissions plugin not available, trying fallback:",d);const p=await cx();u=p.granted,h=p.message}else u=!0;await new Promise(d=>setTimeout(d,500)),console.log(" Photo permission result received:",{granted:u,error:h}),s(u?{title:"Photo access enabled!",description:"You can now upload photos from your gallery."}:{title:"Photo access needed",description:h||"Photo access is required for importing images.",variant:"destructive"})}catch(u){console.error(" Error requesting photo permission:",u),s({title:"Permission error",description:"Could not enable photo access. You can try again in settings.",variant:"destructive"})}finally{r(!1),console.log(" Completing photo permission step"),e("photos")}};if(n==="complete")return null;switch(n){case"notifications":return f.jsx(uJ,{onContinue:i,isLoading:t});case"camera":return f.jsx(dJ,{onContinue:o,isLoading:t});case"photos":return f.jsx(hJ,{onContinue:a,isLoading:t});default:return null}},pJ=async n=>{try{const{data:e,error:t}=await ue.rpc("get_user_display_info",{target_user_id:n});return t?(console.error("Error fetching safe user profile:",t),null):(e==null?void 0:e[0])||null}catch(e){return console.error("Error in getSafeUserProfile:",e),null}},Ep=async n=>{var e;try{const{data:t}=await ue.auth.getUser(),r=(e=t==null?void 0:t.user)==null?void 0:e.id,{data:s,error:i}=await ue.from("users").select("user_id, name, email, created_at").in("user_id",n);return i?(console.error("Error fetching safe user profiles:",i),[]):(s||[]).map(o=>({...o,email:o.user_id===r?o.email:null}))}catch(t){return console.error("Error in getSafeUserProfiles:",t),[]}},kp=n=>n.name?n.name:n.email?n.email.split("@")[0]:"User";function Wr({className:n,...e}){return f.jsx("div",{className:Oe("animate-pulse rounded-md bg-muted",n),...e})}const gJ=({selectedCount:n,onSelectAll:e,onCancel:t,totalCount:r})=>f.jsxs("div",{className:"bg-gradient-to-r from-blue-500/20 to-purple-500/20 border-2 border-primary/30 rounded-lg p-3 mb-4 flex items-center justify-between animate-fade-in sticky top-0 z-10 shadow-sm",children:[f.jsx("div",{className:"flex items-center gap-2",children:f.jsxs(Kr,{variant:"outline",children:[n," selected"]})}),f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsxs(_e,{variant:"ghost",size:"sm",onClick:e,children:["Select All",r?` (${r})`:""]}),f.jsxs(_e,{variant:"ghost",size:"sm",onClick:t,children:[f.jsx(ha,{className:"h-4 w-4 mr-1"}),"Cancel"]})]})]}),mJ=({eventId:n,isOwner:e=!1,isAdmin:t=!1,onPhotoBlock:r,showCameraButton:s=!1,onCameraClick:i,cameraButtonText:o="Capture Photos",isSelectionMode:a=!1,selectedPhotos:l=[],onPhotoSelect:c,onSelectAll:u,onCancelSelection:h,totalPhotoCount:d=0})=>{const[p,m]=b.useState([]),[g,y]=b.useState(!0),[x,v]=b.useState(null),[w,_]=b.useState(!1),[S,E]=b.useState(null),[C,P]=b.useState(null),{toast:O}=Bt();b.useEffect(()=>{B()},[n]),b.useEffect(()=>{const T=j=>{const{photoId:$}=j.detail;console.log("Photo report received from native gallery:",$);const z=p.find(ee=>ee.id===$);z&&U(z)};return document.addEventListener("photoReported",T),()=>{document.removeEventListener("photoReported",T)}},[p]);const A=(T,j=300)=>{try{if(!T.includes("supabase.co/storage/v1/object/public/"))return T;const $=T.replace("/storage/v1/object/public/","/storage/v1/render/image/public/"),z=new URL($);return z.searchParams.set("width",j.toString()),z.searchParams.set("height",j.toString()),z.searchParams.set("resize","cover"),z.searchParams.set("quality","80"),z.toString()}catch($){return console.error("Error generating thumbnail URL:",$),T}},R=T=>{try{if(!T.includes("supabase.co/storage/v1/object/public/"))return T;const j=T.replace("/storage/v1/object/public/","/storage/v1/render/image/public/"),$=new URL(j);return $.searchParams.set("width","800"),$.searchParams.set("resize","contain"),$.searchParams.set("quality","75"),$.toString()}catch(j){return console.error("Error generating native thumbnail URL:",j),T}},B=async()=>{try{_(!0),console.log("Loading photos for event:",n);const{data:T,error:j}=await ue.from("media").select(`
          media_id,
          file_url,
          upload_time,
          uploader_id
        `).eq("event_id",n).eq("is_visible",!0).order("upload_time",{ascending:!1});if(j){console.error("Error loading photos:",j),O({title:"Load failed",description:"Unable to load photos. Please try again.",variant:"destructive"});return}const $=[...new Set((T==null?void 0:T.map(ne=>ne.uploader_id))||[])],z=await Ep($),ee=new Map;z.forEach(ne=>{const ie=kp(ne);ee.set(ne.user_id,ie)}),$.forEach(ne=>{ee.has(ne)||(console.warn("Missing user data for uploader:",ne),ee.set(ne,"User"))});const{data:{user:X}}=await ue.auth.getUser(),J=X==null?void 0:X.id,K=(T||[]).map(ne=>({id:ne.media_id,url:ne.file_url,thumbnailUrl:A(ne.file_url,300),uploadedBy:ee.get(ne.uploader_id)||"User",uploadedAt:ne.upload_time,isOwn:ne.uploader_id===J,uploaderId:ne.uploader_id,uploadTimeIso:ne.upload_time,fullUrl:ne.file_url,nativeThumbnailUrl:R(ne.file_url)}));m(K),y(!1)}catch(T){console.error("Failed to load photos:",T),O({title:"Load failed",description:"Unable to load photos. Please try again.",variant:"destructive"})}finally{_(!1)}},I=async T=>{try{navigator.share?await navigator.share({title:"Photo from event",text:`Check out this photo by ${T.uploadedBy}`,url:T.url}):(await navigator.clipboard.writeText(T.url),O({title:"Link copied",description:"Photo link copied to clipboard."}))}catch(j){console.error("Share failed:",j)}},L=async T=>{try{const $=await(await fetch(T.url)).blob(),z=window.URL.createObjectURL($),ee=document.createElement("a");ee.href=z,ee.download=`event-photo-${T.id}.jpg`,document.body.appendChild(ee),ee.click(),document.body.removeChild(ee),window.URL.revokeObjectURL(z),O({title:"Photo downloaded",description:"Photo saved to your device."})}catch(j){console.error("Download failed:",j),O({title:"Download failed",description:"Unable to download photo.",variant:"destructive"})}},U=async T=>{var j;try{const{data:$,error:z}=await ue.auth.getUser();if(z||!((j=$==null?void 0:$.user)!=null&&j.id)){console.error("Error getting user:",z),O({title:"Report failed",description:"Please log in to report photos.",variant:"destructive"});return}const{error:ee}=await ue.from("photo_reports").insert({media_id:T.id,event_id:n,reported_by:$.user.id,reason:"Inappropriate content"});if(ee){console.error("Error reporting photo:",ee),O({title:"Report failed",description:"Unable to report photo. Please try again.",variant:"destructive"});return}(e||t)&&r&&r(T.id),O({title:"Photo reported",description:e||t?"Photo has been hidden from the gallery.":"Thank you for reporting. We'll review this content."}),v(null)}catch($){console.error("Report failed:",$),O({title:"Report failed",description:"Unable to report photo. Please try again.",variant:"destructive"})}},F=()=>x?p.findIndex(T=>T.id===x.id):-1,D=T=>{const j=F();if(j===-1)return;let $;if(T==="prev"){if($=j-1,$<0)return}else if($=j+1,$>=p.length)return;v(p[$])},k=T=>{P(null),E(T.targetTouches[0].clientX)},N=T=>{P(T.targetTouches[0].clientX)},M=()=>{if(!S||!C)return;const T=S-C,j=T>50,$=T<-50;j?D("next"):$&&D("prev")};return g?f.jsx("div",{className:"photo-grid",children:Array.from({length:12}).map((T,j)=>f.jsxs(Ht,{className:"overflow-hidden",children:[f.jsx(Wr,{className:"aspect-square w-full"}),f.jsx(Qt,{className:"p-3",children:f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsx(Wr,{className:"h-4 w-16"}),f.jsxs("div",{className:"flex space-x-2",children:[f.jsx(Wr,{className:"h-4 w-8"}),f.jsx(Wr,{className:"h-4 w-8"})]})]})})]},j))}):f.jsxs("div",{className:"space-y-4 sm:space-y-6",children:[f.jsxs("div",{className:"space-y-3 sm:space-y-4",children:[a&&u&&h&&f.jsx(gJ,{selectedCount:l.length,onSelectAll:()=>u==null?void 0:u(p.map(T=>T.id)),onCancel:h,totalCount:d}),!a&&f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsxs("h2",{className:"text-xl font-bold",children:["Event Photos (",p.length,")"]}),f.jsxs(_e,{variant:"ghost",size:"sm",className:"gap-2",onClick:()=>{v(null),B()},disabled:w,children:[f.jsx(IL,{className:`h-4 w-4 ${w?"animate-spin":""}`}),f.jsx("span",{className:"hidden sm:inline",children:"Refresh"})]})]})]}),p.length===0?f.jsxs("div",{className:"text-center py-16 text-muted-foreground",children:[f.jsx(kr,{className:"h-12 w-12 mx-auto mb-4 opacity-50"}),f.jsx("p",{children:"No photos yet"}),f.jsx("p",{className:"text-sm",children:"Be the first to share a photo!"})]}):f.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4","data-gallery":!0,"data-event-id":n,children:p.map((T,j)=>{const $=l.includes(T.id);return f.jsxs("div",{className:"space-y-2",children:[f.jsxs("div",{className:`group relative aspect-square rounded-lg overflow-hidden bg-muted ${a&&$?"ring-2 ring-primary":""}`,children:[a&&f.jsx("button",{className:"absolute top-2 right-2 z-20 p-1 bg-background/80 rounded-full hover:bg-background transition-colors",onClick:z=>{z.stopPropagation(),c==null||c(T.id,!$)},children:$?f.jsx(NL,{className:"h-5 w-5 text-primary"}):f.jsx(jL,{className:"h-5 w-5 text-muted-foreground"})}),f.jsx("button",{className:"w-full h-full absolute inset-0 z-10 bg-transparent border-0 p-0",onClick:()=>{var z,ee,X;if(a)c==null||c(T.id,!$);else{const J=window.Capacitor,K=(z=J==null?void 0:J.isNativePlatform)==null?void 0:z.call(J);if(console.log("[LiveGallery] Photo clicked:",{photoId:T.id,isNative:K,hasNativeGallery:!!((ee=J==null?void 0:J.Plugins)!=null&&ee.NativeGallery),url:T.url,fullUrl:T.fullUrl,thumbnailUrl:T.thumbnailUrl}),K&&((X=J==null?void 0:J.Plugins)!=null&&X.NativeGallery)){console.log("[LiveGallery] Deferring to native gallery handler");return}console.log("[LiveGallery] Opening web modal with photo"),v(T)}},children:f.jsx("span",{className:"sr-only",children:a?"Select photo":"View photo"})}),f.jsx("img",{src:T.thumbnailUrl,alt:`Photo by ${T.uploadedBy}`,className:"w-full h-full object-cover",loading:"lazy","data-photo-id":T.id,"data-uploaded-by":T.uploadedBy,"data-uploaded-at":T.uploadTimeIso||T.uploadedAt,"data-is-own":T.isOwn,"data-thumbnail-url":T.nativeThumbnailUrl||T.thumbnailUrl,"data-full-url":T.fullUrl||T.url})]}),f.jsxs("div",{className:"flex items-center justify-between gap-2 px-1",children:[f.jsx("span",{className:"text-sm text-muted-foreground truncate",children:T.uploadedBy}),T.isOwn&&f.jsx(Kr,{variant:"secondary",className:"text-xs shrink-0",children:"You"})]})]},`${T.id}-${j}`)})}),f.jsx(Md,{open:!!x&&!a,onOpenChange:T=>{T||v(null)},children:f.jsxs(bc,{className:"max-w-4xl w-full h-full sm:h-auto p-0 gap-0 border-0 sm:border sm:rounded-lg overflow-hidden",onTouchStart:k,onTouchMove:N,onTouchEnd:M,children:[f.jsxs(_c,{className:"p-4 sm:p-6 pb-0",children:[f.jsxs(Sc,{className:"text-lg font-semibold",children:["Photo by ",x==null?void 0:x.uploadedBy]}),f.jsxs(Cc,{className:"text-sm text-muted-foreground",children:["Event photo uploaded ",x?ku(new Date(x.uploadedAt),{addSuffix:!0}):""]})]}),x&&f.jsxs(f.Fragment,{children:[f.jsxs("div",{className:"relative w-full h-[60vh] sm:h-[70vh] bg-black",children:[f.jsx("img",{src:x.fullUrl||x.url,alt:`Event photo by ${x.uploadedBy}`,className:"w-full h-full object-contain",onError:T=>{console.error("[LiveGallery] Image failed to load:",{url:x.url,fullUrl:x.fullUrl})}}),f.jsx("div",{className:"absolute bottom-4 left-1/2 transform -translate-x-1/2 flex space-x-1 sm:hidden",children:p.map((T,j)=>f.jsx("div",{className:`w-2 h-2 rounded-full transition-all ${j===F()?"bg-white":"bg-white/30"}`},j))})]}),f.jsxs("div",{className:"p-4 sm:p-6 space-y-3 sm:space-y-4 bg-background",children:[f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsxs("div",{className:"flex items-center space-x-3",children:[f.jsx("div",{className:"p-2 bg-primary/10 rounded-full",children:f.jsx(Ew,{className:"h-4 w-4 text-primary"})}),f.jsxs("div",{children:[f.jsx("p",{className:"font-medium text-sm sm:text-base",children:x.uploadedBy}),f.jsx("p",{className:"text-xs sm:text-sm text-muted-foreground",children:ku(new Date(x.uploadedAt),{addSuffix:!0})})]})]}),x.isOwn&&f.jsx(Kr,{variant:"secondary",className:"text-xs",children:"Your photo"})]}),f.jsxs("div",{className:"flex flex-wrap gap-2 pt-2",children:[f.jsxs(_e,{variant:"outline",size:"sm",onClick:()=>L(x),className:"flex-1 sm:flex-none text-xs sm:text-sm h-8 sm:h-9",children:[f.jsx(Gl,{className:"h-3 w-3 sm:h-4 sm:w-4 mr-2"}),"Download"]}),f.jsxs(_e,{variant:"outline",size:"sm",onClick:()=>I(x),className:"flex-1 sm:flex-none text-xs sm:text-sm h-8 sm:h-9",children:[f.jsx(Cw,{className:"h-3 w-3 sm:h-4 sm:w-4 mr-2"}),"Share"]}),f.jsxs(_e,{variant:"outline",size:"sm",onClick:()=>U(x),className:"flex-1 sm:flex-none text-xs sm:text-sm h-8 sm:h-9",children:[f.jsx(kL,{className:"h-3 w-3 sm:h-4 sm:w-4 mr-2"}),"Report"]})]})]})]})]})})]})};function vJ(n){if(typeof document>"u")return;let e=document.head||document.getElementsByTagName("head")[0],t=document.createElement("style");t.type="text/css",e.appendChild(t),t.styleSheet?t.styleSheet.cssText=n:t.appendChild(document.createTextNode(n))}const eR=Y.createContext({drawerRef:{current:null},overlayRef:{current:null},onPress:()=>{},onRelease:()=>{},onDrag:()=>{},onNestedDrag:()=>{},onNestedOpenChange:()=>{},onNestedRelease:()=>{},openProp:void 0,dismissible:!1,isOpen:!1,isDragging:!1,keyboardIsOpen:{current:!1},snapPointsOffset:null,snapPoints:null,handleOnly:!1,modal:!1,shouldFade:!1,activeSnapPoint:null,onOpenChange:()=>{},setActiveSnapPoint:()=>{},closeDrawer:()=>{},direction:"bottom",shouldScaleBackground:!1,setBackgroundColorOnScale:!0,noBodyStyles:!1,container:null,autoFocus:!1}),kc=()=>{const n=Y.useContext(eR);if(!n)throw new Error("useDrawerContext must be used within a Drawer.Root");return n};vJ(`[data-vaul-drawer]{touch-action:none;will-change:transform;transition:transform .5s cubic-bezier(.32, .72, 0, 1);animation-duration:.5s;animation-timing-function:cubic-bezier(0.32,0.72,0,1)}[data-vaul-drawer][data-vaul-snap-points=false][data-vaul-drawer-direction=bottom][data-state=open]{animation-name:slideFromBottom}[data-vaul-drawer][data-vaul-snap-points=false][data-vaul-drawer-direction=bottom][data-state=closed]{animation-name:slideToBottom}[data-vaul-drawer][data-vaul-snap-points=false][data-vaul-drawer-direction=top][data-state=open]{animation-name:slideFromTop}[data-vaul-drawer][data-vaul-snap-points=false][data-vaul-drawer-direction=top][data-state=closed]{animation-name:slideToTop}[data-vaul-drawer][data-vaul-snap-points=false][data-vaul-drawer-direction=left][data-state=open]{animation-name:slideFromLeft}[data-vaul-drawer][data-vaul-snap-points=false][data-vaul-drawer-direction=left][data-state=closed]{animation-name:slideToLeft}[data-vaul-drawer][data-vaul-snap-points=false][data-vaul-drawer-direction=right][data-state=open]{animation-name:slideFromRight}[data-vaul-drawer][data-vaul-snap-points=false][data-vaul-drawer-direction=right][data-state=closed]{animation-name:slideToRight}[data-vaul-drawer][data-vaul-snap-points=true][data-vaul-drawer-direction=bottom]{transform:translate3d(0,100%,0)}[data-vaul-drawer][data-vaul-snap-points=true][data-vaul-drawer-direction=top]{transform:translate3d(0,-100%,0)}[data-vaul-drawer][data-vaul-snap-points=true][data-vaul-drawer-direction=left]{transform:translate3d(-100%,0,0)}[data-vaul-drawer][data-vaul-snap-points=true][data-vaul-drawer-direction=right]{transform:translate3d(100%,0,0)}[data-vaul-drawer][data-vaul-delayed-snap-points=true][data-vaul-drawer-direction=top]{transform:translate3d(0,var(--snap-point-height,0),0)}[data-vaul-drawer][data-vaul-delayed-snap-points=true][data-vaul-drawer-direction=bottom]{transform:translate3d(0,var(--snap-point-height,0),0)}[data-vaul-drawer][data-vaul-delayed-snap-points=true][data-vaul-drawer-direction=left]{transform:translate3d(var(--snap-point-height,0),0,0)}[data-vaul-drawer][data-vaul-delayed-snap-points=true][data-vaul-drawer-direction=right]{transform:translate3d(var(--snap-point-height,0),0,0)}[data-vaul-overlay][data-vaul-snap-points=false]{animation-duration:.5s;animation-timing-function:cubic-bezier(0.32,0.72,0,1)}[data-vaul-overlay][data-vaul-snap-points=false][data-state=open]{animation-name:fadeIn}[data-vaul-overlay][data-state=closed]{animation-name:fadeOut}[data-vaul-overlay][data-vaul-snap-points=true]{opacity:0;transition:opacity .5s cubic-bezier(.32, .72, 0, 1)}[data-vaul-overlay][data-vaul-snap-points=true]{opacity:1}[data-vaul-drawer]:not([data-vaul-custom-container=true])::after{content:'';position:absolute;background:inherit;background-color:inherit}[data-vaul-drawer][data-vaul-drawer-direction=top]::after{top:initial;bottom:100%;left:0;right:0;height:200%}[data-vaul-drawer][data-vaul-drawer-direction=bottom]::after{top:100%;bottom:initial;left:0;right:0;height:200%}[data-vaul-drawer][data-vaul-drawer-direction=left]::after{left:initial;right:100%;top:0;bottom:0;width:200%}[data-vaul-drawer][data-vaul-drawer-direction=right]::after{left:100%;right:initial;top:0;bottom:0;width:200%}[data-vaul-overlay][data-vaul-snap-points=true]:not([data-vaul-snap-points-overlay=true]):not(
[data-state=closed]
){opacity:0}[data-vaul-overlay][data-vaul-snap-points-overlay=true]{opacity:1}[data-vaul-handle]{display:block;position:relative;opacity:.7;background:#e2e2e4;margin-left:auto;margin-right:auto;height:5px;width:32px;border-radius:1rem;touch-action:pan-y}[data-vaul-handle]:active,[data-vaul-handle]:hover{opacity:1}[data-vaul-handle-hitarea]{position:absolute;left:50%;top:50%;transform:translate(-50%,-50%);width:max(100%,2.75rem);height:max(100%,2.75rem);touch-action:inherit}@media (hover:hover) and (pointer:fine){[data-vaul-drawer]{user-select:none}}@media (pointer:fine){[data-vaul-handle-hitarea]:{width:100%;height:100%}}@keyframes fadeIn{from{opacity:0}to{opacity:1}}@keyframes fadeOut{to{opacity:0}}@keyframes slideFromBottom{from{transform:translate3d(0,100%,0)}to{transform:translate3d(0,0,0)}}@keyframes slideToBottom{to{transform:translate3d(0,100%,0)}}@keyframes slideFromTop{from{transform:translate3d(0,-100%,0)}to{transform:translate3d(0,0,0)}}@keyframes slideToTop{to{transform:translate3d(0,-100%,0)}}@keyframes slideFromLeft{from{transform:translate3d(-100%,0,0)}to{transform:translate3d(0,0,0)}}@keyframes slideToLeft{to{transform:translate3d(-100%,0,0)}}@keyframes slideFromRight{from{transform:translate3d(100%,0,0)}to{transform:translate3d(0,0,0)}}@keyframes slideToRight{to{transform:translate3d(100%,0,0)}}`);const yJ=24,xJ=typeof window<"u"?b.useLayoutEffect:b.useEffect;function g2(...n){return(...e)=>{for(let t of n)typeof t=="function"&&t(...e)}}function wJ(){return Z1(/^Mac/)}function bJ(){return Z1(/^iPhone/)}function m2(){return/^((?!chrome|android).)*safari/i.test(navigator.userAgent)}function _J(){return Z1(/^iPad/)||wJ()&&navigator.maxTouchPoints>1}function tR(){return bJ()||_J()}function Z1(n){return typeof window<"u"&&window.navigator!=null?n.test(window.navigator.platform):void 0}const nv=typeof document<"u"&&window.visualViewport;function v2(n){let e=window.getComputedStyle(n);return/(auto|scroll)/.test(e.overflow+e.overflowX+e.overflowY)}function nR(n){for(v2(n)&&(n=n.parentElement);n&&!v2(n);)n=n.parentElement;return n||document.scrollingElement||document.documentElement}const SJ=new Set(["checkbox","radio","range","color","file","image","button","submit","reset"]);let qh=0,rv;function CJ(n={}){let{isDisabled:e}=n;xJ(()=>{if(!e)return qh++,qh===1&&tR()&&(rv=EJ()),()=>{qh--,qh===0&&(rv==null||rv())}},[e])}function EJ(){let n,e=0,t=h=>{n=nR(h.target),!(n===document.documentElement&&n===document.body)&&(e=h.changedTouches[0].pageY)},r=h=>{if(!n||n===document.documentElement||n===document.body){h.preventDefault();return}let d=h.changedTouches[0].pageY,p=n.scrollTop,m=n.scrollHeight-n.clientHeight;m!==0&&((p<=0&&d>e||p>=m&&d<e)&&h.preventDefault(),e=d)},s=h=>{let d=h.target;px(d)&&d!==document.activeElement&&(h.preventDefault(),d.style.transform="translateY(-2000px)",d.focus(),requestAnimationFrame(()=>{d.style.transform=""}))},i=h=>{let d=h.target;px(d)&&(d.style.transform="translateY(-2000px)",requestAnimationFrame(()=>{d.style.transform="",nv&&(nv.height<window.innerHeight?requestAnimationFrame(()=>{y2(d)}):nv.addEventListener("resize",()=>y2(d),{once:!0}))}))},o=()=>{window.scrollTo(0,0)},a=window.pageXOffset,l=window.pageYOffset,c=g2(kJ(document.documentElement,"paddingRight",`${window.innerWidth-document.documentElement.clientWidth}px`));window.scrollTo(0,0);let u=g2(qc(document,"touchstart",t,{passive:!1,capture:!0}),qc(document,"touchmove",r,{passive:!1,capture:!0}),qc(document,"touchend",s,{passive:!1,capture:!0}),qc(document,"focus",i,!0),qc(window,"scroll",o));return()=>{c(),u(),window.scrollTo(a,l)}}function kJ(n,e,t){let r=n.style[e];return n.style[e]=t,()=>{n.style[e]=r}}function qc(n,e,t,r){return n.addEventListener(e,t,r),()=>{n.removeEventListener(e,t,r)}}function y2(n){let e=document.scrollingElement||document.documentElement;for(;n&&n!==e;){let t=nR(n);if(t!==document.documentElement&&t!==document.body&&t!==n){let r=t.getBoundingClientRect().top,s=n.getBoundingClientRect().top,i=n.getBoundingClientRect().bottom;const o=t.getBoundingClientRect().bottom+yJ;i>o&&(t.scrollTop+=s-r)}n=t.parentElement}}function px(n){return n instanceof HTMLInputElement&&!SJ.has(n.type)||n instanceof HTMLTextAreaElement||n instanceof HTMLElement&&n.isContentEditable}function PJ(n,e){typeof n=="function"?n(e):n!=null&&(n.current=e)}function TJ(...n){return e=>n.forEach(t=>PJ(t,e))}function rR(...n){return b.useCallback(TJ(...n),n)}const sR=new WeakMap;function Yt(n,e,t=!1){if(!n||!(n instanceof HTMLElement))return;let r={};Object.entries(e).forEach(([s,i])=>{if(s.startsWith("--")){n.style.setProperty(s,i);return}r[s]=n.style[s],n.style[s]=i}),!t&&sR.set(n,r)}function AJ(n,e){if(!n||!(n instanceof HTMLElement))return;let t=sR.get(n);t&&(n.style[e]=t[e])}const Xt=n=>{switch(n){case"top":case"bottom":return!0;case"left":case"right":return!1;default:return n}};function Yh(n,e){if(!n)return null;const t=window.getComputedStyle(n),r=t.transform||t.webkitTransform||t.mozTransform;let s=r.match(/^matrix3d\((.+)\)$/);return s?parseFloat(s[1].split(", ")[Xt(e)?13:12]):(s=r.match(/^matrix\((.+)\)$/),s?parseFloat(s[1].split(", ")[Xt(e)?5:4]):null)}function DJ(n){return 8*(Math.log(n+1)-2)}function sv(n,e){if(!n)return()=>{};const t=n.style.cssText;return Object.assign(n.style,e),()=>{n.style.cssText=t}}function OJ(...n){return(...e)=>{for(const t of n)typeof t=="function"&&t(...e)}}const kt={DURATION:.5,EASE:[.32,.72,0,1]},iR=.4,IJ=.25,RJ=100,oR=8,jo=16,gx=26,iv="vaul-dragging";function aR(n){const e=Y.useRef(n);return Y.useEffect(()=>{e.current=n}),Y.useMemo(()=>(...t)=>e.current==null?void 0:e.current.call(e,...t),[])}function NJ({defaultProp:n,onChange:e}){const t=Y.useState(n),[r]=t,s=Y.useRef(r),i=aR(e);return Y.useEffect(()=>{s.current!==r&&(i(r),s.current=r)},[r,s,i]),t}function lR({prop:n,defaultProp:e,onChange:t=()=>{}}){const[r,s]=NJ({defaultProp:e,onChange:t}),i=n!==void 0,o=i?n:r,a=aR(t),l=Y.useCallback(c=>{if(i){const h=typeof c=="function"?c(n):c;h!==n&&a(h)}else s(c)},[i,n,s,a]);return[o,l]}function jJ({activeSnapPointProp:n,setActiveSnapPointProp:e,snapPoints:t,drawerRef:r,overlayRef:s,fadeFromIndex:i,onSnapPointChange:o,direction:a="bottom",container:l,snapToSequentialPoint:c}){const[u,h]=lR({prop:n,defaultProp:t==null?void 0:t[0],onChange:e}),[d,p]=Y.useState(typeof window<"u"?{innerWidth:window.innerWidth,innerHeight:window.innerHeight}:void 0);Y.useEffect(()=>{function C(){p({innerWidth:window.innerWidth,innerHeight:window.innerHeight})}return window.addEventListener("resize",C),()=>window.removeEventListener("resize",C)},[]);const m=Y.useMemo(()=>u===(t==null?void 0:t[t.length-1])||null,[t,u]),g=Y.useMemo(()=>t==null?void 0:t.findIndex(C=>C===u),[t,u]),y=t&&t.length>0&&(i||i===0)&&!Number.isNaN(i)&&t[i]===u||!t,x=Y.useMemo(()=>{const C=l?{width:l.getBoundingClientRect().width,height:l.getBoundingClientRect().height}:typeof window<"u"?{width:window.innerWidth,height:window.innerHeight}:{width:0,height:0};var P;return(P=t==null?void 0:t.map(O=>{const A=typeof O=="string";let R=0;if(A&&(R=parseInt(O,10)),Xt(a)){const I=A?R:d?O*C.height:0;return d?a==="bottom"?C.height-I:-C.height+I:I}const B=A?R:d?O*C.width:0;return d?a==="right"?C.width-B:-C.width+B:B}))!=null?P:[]},[t,d,l]),v=Y.useMemo(()=>g!==null?x==null?void 0:x[g]:null,[x,g]),w=Y.useCallback(C=>{var P;const O=(P=x==null?void 0:x.findIndex(A=>A===C))!=null?P:null;o(O),Yt(r.current,{transition:`transform ${kt.DURATION}s cubic-bezier(${kt.EASE.join(",")})`,transform:Xt(a)?`translate3d(0, ${C}px, 0)`:`translate3d(${C}px, 0, 0)`}),x&&O!==x.length-1&&O!==i&&O<i?Yt(s.current,{transition:`opacity ${kt.DURATION}s cubic-bezier(${kt.EASE.join(",")})`,opacity:"0"}):Yt(s.current,{transition:`opacity ${kt.DURATION}s cubic-bezier(${kt.EASE.join(",")})`,opacity:"1"}),h(t==null?void 0:t[Math.max(O,0)])},[r.current,t,x,i,s,h]);Y.useEffect(()=>{if(u||n){var C;const P=(C=t==null?void 0:t.findIndex(O=>O===n||O===u))!=null?C:-1;x&&P!==-1&&typeof x[P]=="number"&&w(x[P])}},[u,n,t,x,w]);function _({draggedDistance:C,closeDrawer:P,velocity:O,dismissible:A}){if(i===void 0)return;const R=a==="bottom"||a==="right"?(v??0)-C:(v??0)+C,B=g===i-1,I=g===0,L=C>0;if(B&&Yt(s.current,{transition:`opacity ${kt.DURATION}s cubic-bezier(${kt.EASE.join(",")})`}),!c&&O>2&&!L){A?P():w(x[0]);return}if(!c&&O>2&&L&&x&&t){w(x[t.length-1]);return}const U=x==null?void 0:x.reduce((D,k)=>typeof D!="number"||typeof k!="number"?D:Math.abs(k-R)<Math.abs(D-R)?k:D),F=Xt(a)?window.innerHeight:window.innerWidth;if(O>iR&&Math.abs(C)<F*.4){const D=L?1:-1;if(D>0&&m){w(x[t.length-1]);return}if(I&&D<0&&A&&P(),g===null)return;w(x[g+D]);return}w(U)}function S({draggedDistance:C}){if(v===null)return;const P=a==="bottom"||a==="right"?v-C:v+C;(a==="bottom"||a==="right")&&P<x[x.length-1]||(a==="top"||a==="left")&&P>x[x.length-1]||Yt(r.current,{transform:Xt(a)?`translate3d(0, ${P}px, 0)`:`translate3d(${P}px, 0, 0)`})}function E(C,P){if(!t||typeof g!="number"||!x||i===void 0)return null;const O=g===i-1;if(g>=i&&P)return 0;if(O&&!P)return 1;if(!y&&!O)return null;const R=O?g+1:g-1,B=O?x[R]-x[R-1]:x[R+1]-x[R],I=C/Math.abs(B);return O?1-I:I}return{isLastSnapPoint:m,activeSnapPoint:u,shouldFade:y,getPercentageDragged:E,setActiveSnapPoint:h,activeSnapPointIndex:g,onRelease:_,onDrag:S,snapPointsOffset:x}}const LJ=()=>()=>{};function MJ(){const{direction:n,isOpen:e,shouldScaleBackground:t,setBackgroundColorOnScale:r,noBodyStyles:s}=kc(),i=Y.useRef(null),o=b.useMemo(()=>document.body.style.backgroundColor,[]);function a(){return(window.innerWidth-gx)/window.innerWidth}Y.useEffect(()=>{if(e&&t){i.current&&clearTimeout(i.current);const l=document.querySelector("[data-vaul-drawer-wrapper]")||document.querySelector("[vaul-drawer-wrapper]");if(!l)return;OJ(r&&!s?sv(document.body,{background:"black"}):LJ,sv(l,{transformOrigin:Xt(n)?"top":"left",transitionProperty:"transform, border-radius",transitionDuration:`${kt.DURATION}s`,transitionTimingFunction:`cubic-bezier(${kt.EASE.join(",")})`}));const c=sv(l,{borderRadius:`${oR}px`,overflow:"hidden",...Xt(n)?{transform:`scale(${a()}) translate3d(0, calc(env(safe-area-inset-top) + 14px), 0)`}:{transform:`scale(${a()}) translate3d(calc(env(safe-area-inset-top) + 14px), 0, 0)`}});return()=>{c(),i.current=window.setTimeout(()=>{o?document.body.style.background=o:document.body.style.removeProperty("background")},kt.DURATION*1e3)}}},[e,t,o])}let Yc=null;function FJ({isOpen:n,modal:e,nested:t,hasBeenOpened:r,preventScrollRestoration:s,noBodyStyles:i}){const[o,a]=Y.useState(()=>typeof window<"u"?window.location.href:""),l=Y.useRef(0),c=Y.useCallback(()=>{if(m2()&&Yc===null&&n&&!i){Yc={position:document.body.style.position,top:document.body.style.top,left:document.body.style.left,height:document.body.style.height,right:"unset"};const{scrollX:h,innerHeight:d}=window;document.body.style.setProperty("position","fixed","important"),Object.assign(document.body.style,{top:`${-l.current}px`,left:`${-h}px`,right:"0px",height:"auto"}),window.setTimeout(()=>window.requestAnimationFrame(()=>{const p=d-window.innerHeight;p&&l.current>=d&&(document.body.style.top=`${-(l.current+p)}px`)}),300)}},[n]),u=Y.useCallback(()=>{if(m2()&&Yc!==null&&!i){const h=-parseInt(document.body.style.top,10),d=-parseInt(document.body.style.left,10);Object.assign(document.body.style,Yc),window.requestAnimationFrame(()=>{if(s&&o!==window.location.href){a(window.location.href);return}window.scrollTo(d,h)}),Yc=null}},[o]);return Y.useEffect(()=>{function h(){l.current=window.scrollY}return h(),window.addEventListener("scroll",h),()=>{window.removeEventListener("scroll",h)}},[]),Y.useEffect(()=>{t||!r||(n?(!window.matchMedia("(display-mode: standalone)").matches&&c(),e||window.setTimeout(()=>{u()},500)):u())},[n,r,o,e,t,c,u]),{restorePositionSetting:u}}function cR({open:n,onOpenChange:e,children:t,onDrag:r,onRelease:s,snapPoints:i,shouldScaleBackground:o=!1,setBackgroundColorOnScale:a=!0,closeThreshold:l=IJ,scrollLockTimeout:c=RJ,dismissible:u=!0,handleOnly:h=!1,fadeFromIndex:d=i&&i.length-1,activeSnapPoint:p,setActiveSnapPoint:m,fixed:g,modal:y=!0,onClose:x,nested:v,noBodyStyles:w,direction:_="bottom",defaultOpen:S=!1,disablePreventScroll:E=!0,snapToSequentialPoint:C=!1,preventScrollRestoration:P=!1,repositionInputs:O=!0,onAnimationEnd:A,container:R,autoFocus:B=!1}){var I,L;const[U=!1,F]=lR({defaultProp:S,prop:n,onChange:le=>{e==null||e(le),!le&&!v&&Re(),setTimeout(()=>{A==null||A(le)},kt.DURATION*1e3),le&&!y&&typeof window<"u"&&window.requestAnimationFrame(()=>{document.body.style.pointerEvents="auto"}),le||(document.body.style.pointerEvents="auto")}}),[D,k]=Y.useState(!1),[N,M]=Y.useState(!1),[T,j]=Y.useState(!1),$=Y.useRef(null),z=Y.useRef(null),ee=Y.useRef(null),X=Y.useRef(null),J=Y.useRef(null),K=Y.useRef(!1),ne=Y.useRef(null),ie=Y.useRef(0),ae=Y.useRef(!1),W=Y.useRef(0),H=Y.useRef(null),G=Y.useRef(((I=H.current)==null?void 0:I.getBoundingClientRect().height)||0),Q=Y.useRef(((L=H.current)==null?void 0:L.getBoundingClientRect().width)||0),te=Y.useRef(0),he=Y.useCallback(le=>{i&&le===Se.length-1&&(z.current=new Date)},[]),{activeSnapPoint:xe,activeSnapPointIndex:fe,setActiveSnapPoint:be,onRelease:Pe,snapPointsOffset:Se,onDrag:Ye,shouldFade:Ve,getPercentageDragged:Ge}=jJ({snapPoints:i,activeSnapPointProp:p,setActiveSnapPointProp:m,drawerRef:H,fadeFromIndex:d,overlayRef:$,onSnapPointChange:he,direction:_,container:R,snapToSequentialPoint:C});CJ({isDisabled:!U||N||!y||T||!D||!O||!E});const{restorePositionSetting:Re}=FJ({isOpen:U,modal:y,nested:v,hasBeenOpened:D,preventScrollRestoration:P,noBodyStyles:w});function ge(){return(window.innerWidth-gx)/window.innerWidth}function et(le){var Ce,we;!u&&!i||H.current&&!H.current.contains(le.target)||(G.current=((Ce=H.current)==null?void 0:Ce.getBoundingClientRect().height)||0,Q.current=((we=H.current)==null?void 0:we.getBoundingClientRect().width)||0,M(!0),ee.current=new Date,tR()&&window.addEventListener("touchend",()=>K.current=!1,{once:!0}),le.target.setPointerCapture(le.pointerId),ie.current=Xt(_)?le.pageY:le.pageX)}function tt(le,Ce){var we,Me;let Ne=le;const jt=(we=window.getSelection())==null?void 0:we.toString(),Ot=H.current?Yh(H.current,_):null,rn=new Date;if(Ne.hasAttribute("data-vaul-no-drag")||Ne.closest("[data-vaul-no-drag]"))return!1;if(_==="right"||_==="left")return!0;if(z.current&&rn.getTime()-z.current.getTime()<500)return!1;if(Ot!==null&&(_==="bottom"?Ot>0:Ot<0))return!0;if(jt&&jt.length>0)return!1;if(rn.getTime()-((Me=J.current)==null?void 0:Me.getTime())<c&&Ot===0||Ce)return J.current=rn,!1;for(;Ne;){if(Ne.scrollHeight>Ne.clientHeight){if(Ne.scrollTop!==0)return J.current=new Date,!1;if(Ne.getAttribute("role")==="dialog")return!0}Ne=Ne.parentNode}return!0}function ke(le){if(H.current&&N){const Ce=_==="bottom"||_==="right"?1:-1,we=(ie.current-(Xt(_)?le.pageY:le.pageX))*Ce,Me=we>0,Ne=i&&!u&&!Me;if(Ne&&fe===0)return;const jt=Math.abs(we),Ot=document.querySelector("[data-vaul-drawer-wrapper]"),rn=_==="bottom"||_==="top"?G.current:Q.current;let hn=jt/rn;const mr=Ge(jt,Me);if(mr!==null&&(hn=mr),Ne&&hn>=1||!K.current&&!tt(le.target,Me))return;if(H.current.classList.add(iv),K.current=!0,Yt(H.current,{transition:"none"}),Yt($.current,{transition:"none"}),i&&Ye({draggedDistance:we}),Me&&!i){const An=DJ(we),gi=Math.min(An*-1,0)*Ce;Yt(H.current,{transform:Xt(_)?`translate3d(0, ${gi}px, 0)`:`translate3d(${gi}px, 0, 0)`});return}const vr=1-hn;if((Ve||d&&fe===d-1)&&(r==null||r(le,hn),Yt($.current,{opacity:`${vr}`,transition:"none"},!0)),Ot&&$.current&&o){const An=Math.min(ge()+hn*(1-ge()),1),gi=8-hn*8,yr=Math.max(0,14-hn*14);Yt(Ot,{borderRadius:`${gi}px`,transform:Xt(_)?`scale(${An}) translate3d(0, ${yr}px, 0)`:`scale(${An}) translate3d(${yr}px, 0, 0)`,transition:"none"},!0)}if(!i){const An=jt*Ce;Yt(H.current,{transform:Xt(_)?`translate3d(0, ${An}px, 0)`:`translate3d(${An}px, 0, 0)`})}}}Y.useEffect(()=>{var le;function Ce(){if(!H.current||!O)return;const we=document.activeElement;if(px(we)||ae.current){var Me;const Ne=((Me=window.visualViewport)==null?void 0:Me.height)||0,jt=window.innerHeight;let Ot=jt-Ne;const rn=H.current.getBoundingClientRect().height||0,hn=rn>jt*.8;te.current||(te.current=rn);const mr=H.current.getBoundingClientRect().top;if(Math.abs(W.current-Ot)>60&&(ae.current=!ae.current),i&&i.length>0&&Se&&fe){const vr=Se[fe]||0;Ot+=vr}if(W.current=Ot,rn>Ne||ae.current){const vr=H.current.getBoundingClientRect().height;let An=vr;vr>Ne&&(An=Ne-(hn?mr:gx)),g?H.current.style.height=`${vr-Math.max(Ot,0)}px`:H.current.style.height=`${Math.max(An,Ne-mr)}px`}else H.current.style.height=`${te.current}px`;i&&i.length>0&&!ae.current?H.current.style.bottom="0px":H.current.style.bottom=`${Math.max(Ot,0)}px`}}return(le=window.visualViewport)==null||le.addEventListener("resize",Ce),()=>{var we;return(we=window.visualViewport)==null?void 0:we.removeEventListener("resize",Ce)}},[fe,i,Se]);function st(le){xt(),x==null||x(),le||F(!1),setTimeout(()=>{i&&be(i[0])},kt.DURATION*1e3)}function it(){if(!H.current)return;const le=document.querySelector("[data-vaul-drawer-wrapper]"),Ce=Yh(H.current,_);Yt(H.current,{transform:"translate3d(0, 0, 0)",transition:`transform ${kt.DURATION}s cubic-bezier(${kt.EASE.join(",")})`}),Yt($.current,{transition:`opacity ${kt.DURATION}s cubic-bezier(${kt.EASE.join(",")})`,opacity:"1"}),o&&Ce&&Ce>0&&U&&Yt(le,{borderRadius:`${oR}px`,overflow:"hidden",...Xt(_)?{transform:`scale(${ge()}) translate3d(0, calc(env(safe-area-inset-top) + 14px), 0)`,transformOrigin:"top"}:{transform:`scale(${ge()}) translate3d(calc(env(safe-area-inset-top) + 14px), 0, 0)`,transformOrigin:"left"},transitionProperty:"transform, border-radius",transitionDuration:`${kt.DURATION}s`,transitionTimingFunction:`cubic-bezier(${kt.EASE.join(",")})`},!0)}function xt(){!N||!H.current||(H.current.classList.remove(iv),K.current=!1,M(!1),X.current=new Date)}function Tn(le){if(!N||!H.current)return;H.current.classList.remove(iv),K.current=!1,M(!1),X.current=new Date;const Ce=Yh(H.current,_);if(!tt(le.target,!1)||!Ce||Number.isNaN(Ce)||ee.current===null)return;const we=X.current.getTime()-ee.current.getTime(),Me=ie.current-(Xt(_)?le.pageY:le.pageX),Ne=Math.abs(Me)/we;if(Ne>.05&&(j(!0),setTimeout(()=>{j(!1)},200)),i){Pe({draggedDistance:Me*(_==="bottom"||_==="right"?1:-1),closeDrawer:st,velocity:Ne,dismissible:u}),s==null||s(le,!0);return}if(_==="bottom"||_==="right"?Me>0:Me<0){it(),s==null||s(le,!0);return}if(Ne>iR){st(),s==null||s(le,!1);return}var jt;const Ot=Math.min((jt=H.current.getBoundingClientRect().height)!=null?jt:0,window.innerHeight);var rn;const hn=Math.min((rn=H.current.getBoundingClientRect().width)!=null?rn:0,window.innerWidth),mr=_==="left"||_==="right";if(Math.abs(Ce)>=(mr?hn:Ot)*l){st(),s==null||s(le,!1);return}s==null||s(le,!0),it()}Y.useEffect(()=>(U&&(Yt(document.documentElement,{scrollBehavior:"auto"}),z.current=new Date),()=>{AJ(document.documentElement,"scrollBehavior")}),[U]);function yn(le){const Ce=le?(window.innerWidth-jo)/window.innerWidth:1,we=le?-jo:0;ne.current&&window.clearTimeout(ne.current),Yt(H.current,{transition:`transform ${kt.DURATION}s cubic-bezier(${kt.EASE.join(",")})`,transform:`scale(${Ce}) translate3d(0, ${we}px, 0)`}),!le&&H.current&&(ne.current=setTimeout(()=>{const Me=Yh(H.current,_);Yt(H.current,{transition:"none",transform:Xt(_)?`translate3d(0, ${Me}px, 0)`:`translate3d(${Me}px, 0, 0)`})},500))}function gt(le,Ce){if(Ce<0)return;const we=(window.innerWidth-jo)/window.innerWidth,Me=we+Ce*(1-we),Ne=-jo+Ce*jo;Yt(H.current,{transform:Xt(_)?`scale(${Me}) translate3d(0, ${Ne}px, 0)`:`scale(${Me}) translate3d(${Ne}px, 0, 0)`,transition:"none"})}function Ao(le,Ce){const we=Xt(_)?window.innerHeight:window.innerWidth,Me=Ce?(we-jo)/we:1,Ne=Ce?-jo:0;Ce&&Yt(H.current,{transition:`transform ${kt.DURATION}s cubic-bezier(${kt.EASE.join(",")})`,transform:Xt(_)?`scale(${Me}) translate3d(0, ${Ne}px, 0)`:`scale(${Me}) translate3d(${Ne}px, 0, 0)`})}return Y.createElement($1,{defaultOpen:S,onOpenChange:le=>{!u&&!le||(le?k(!0):st(!0),F(le))},open:U},Y.createElement(eR.Provider,{value:{activeSnapPoint:xe,snapPoints:i,setActiveSnapPoint:be,drawerRef:H,overlayRef:$,onOpenChange:e,onPress:et,onRelease:Tn,onDrag:ke,dismissible:u,handleOnly:h,isOpen:U,isDragging:N,shouldFade:Ve,closeDrawer:st,onNestedDrag:gt,onNestedOpenChange:yn,onNestedRelease:Ao,keyboardIsOpen:ae,modal:y,snapPointsOffset:Se,direction:_,shouldScaleBackground:o,setBackgroundColorOnScale:a,noBodyStyles:w,container:R,autoFocus:B}},t))}const uR=Y.forwardRef(function({...n},e){const{overlayRef:t,snapPoints:r,onRelease:s,shouldFade:i,isOpen:o,modal:a}=kc(),l=rR(e,t),c=r&&r.length>0;return a?Y.createElement(N0,{onMouseUp:s,ref:l,"data-vaul-overlay":"","data-vaul-snap-points":o&&c?"true":"false","data-vaul-snap-points-overlay":o&&i?"true":"false",...n}):(typeof window<"u"&&window.requestAnimationFrame(()=>{document.body.style.pointerEvents="auto"}),null)});uR.displayName="Drawer.Overlay";const dR=Y.forwardRef(function({onPointerDownOutside:n,style:e,onOpenAutoFocus:t,...r},s){const{drawerRef:i,onPress:o,onRelease:a,onDrag:l,keyboardIsOpen:c,snapPointsOffset:u,modal:h,isOpen:d,direction:p,snapPoints:m,container:g,handleOnly:y,autoFocus:x}=kc(),[v,w]=Y.useState(!1),_=rR(s,i),S=Y.useRef(null),E=Y.useRef(null),C=Y.useRef(!1),P=m&&m.length>0;MJ();const O=(R,B,I=0)=>{if(C.current)return!0;const L=Math.abs(R.y),U=Math.abs(R.x),F=U>L,D=["bottom","right"].includes(B)?1:-1;if(B==="left"||B==="right"){if(!(R.x*D<0)&&U>=0&&U<=I)return F}else if(!(R.y*D<0)&&L>=0&&L<=I)return!F;return C.current=!0,!0};Y.useEffect(()=>{P&&window.requestAnimationFrame(()=>{w(!0)})},[]);function A(R){S.current=null,C.current=!1,a(R)}return Y.createElement(j0,{"data-vaul-drawer-direction":p,"data-vaul-drawer":"","data-vaul-delayed-snap-points":v?"true":"false","data-vaul-snap-points":d&&P?"true":"false","data-vaul-custom-container":g?"true":"false",...r,ref:_,style:u&&u.length>0?{"--snap-point-height":`${u[0]}px`,...e}:e,onPointerDown:R=>{y||(r.onPointerDown==null||r.onPointerDown.call(r,R),S.current={x:R.pageX,y:R.pageY},o(R))},onOpenAutoFocus:R=>{t==null||t(R),x||R.preventDefault()},onPointerDownOutside:R=>{if(n==null||n(R),!h||R.defaultPrevented){R.preventDefault();return}c.current&&(c.current=!1)},onFocusOutside:R=>{if(!h){R.preventDefault();return}},onPointerMove:R=>{if(E.current=R,y||(r.onPointerMove==null||r.onPointerMove.call(r,R),!S.current))return;const B=R.pageY-S.current.y,I=R.pageX-S.current.x,L=R.pointerType==="touch"?10:2;O({x:I,y:B},p,L)?l(R):(Math.abs(I)>L||Math.abs(B)>L)&&(S.current=null)},onPointerUp:R=>{r.onPointerUp==null||r.onPointerUp.call(r,R),S.current=null,C.current=!1,a(R)},onPointerOut:R=>{r.onPointerOut==null||r.onPointerOut.call(r,R),A(E.current)},onContextMenu:R=>{r.onContextMenu==null||r.onContextMenu.call(r,R),A(E.current)}})});dR.displayName="Drawer.Content";const BJ=250,UJ=120,hR=Y.forwardRef(function({preventCycle:n=!1,children:e,...t},r){const{closeDrawer:s,isDragging:i,snapPoints:o,activeSnapPoint:a,setActiveSnapPoint:l,dismissible:c,handleOnly:u,isOpen:h,onPress:d,onDrag:p}=kc(),m=Y.useRef(null),g=Y.useRef(!1);function y(){if(g.current){w();return}window.setTimeout(()=>{x()},UJ)}function x(){if(i||n||g.current){w();return}if(w(),(!o||o.length===0)&&c){s();return}if(a===o[o.length-1]&&c){s();return}const S=o.findIndex(C=>C===a);if(S===-1)return;const E=o[S+1];l(E)}function v(){m.current=window.setTimeout(()=>{g.current=!0},BJ)}function w(){window.clearTimeout(m.current),g.current=!1}return Y.createElement("div",{onClick:y,onPointerCancel:w,onPointerDown:_=>{u&&d(_),v()},onPointerMove:_=>{u&&p(_)},ref:r,"data-vaul-drawer-visible":h?"true":"false","data-vaul-handle":"","aria-hidden":"true",...t},Y.createElement("span",{"data-vaul-handle-hitarea":"","aria-hidden":"true"},e))});hR.displayName="Drawer.Handle";function $J({onDrag:n,onOpenChange:e,...t}){const{onNestedDrag:r,onNestedOpenChange:s,onNestedRelease:i}=kc();if(!r)throw new Error("Drawer.NestedRoot must be placed in another drawer");return Y.createElement(cR,{nested:!0,onClose:()=>{s(!1)},onDrag:(o,a)=>{r(o,a),n==null||n(o,a)},onOpenChange:o=>{o&&s(o)},onRelease:i,...t})}function zJ(n){const e=kc(),{container:t=e.container,...r}=n;return Y.createElement(W1,{container:t,...r})}const _s={Root:cR,NestedRoot:$J,Content:dR,Overlay:uR,Trigger:z1,Portal:zJ,Handle:hR,Close:F0,Title:L0,Description:M0},eb=({shouldScaleBackground:n=!0,...e})=>f.jsx(_s.Root,{shouldScaleBackground:n,...e});eb.displayName="Drawer";const WJ=_s.Trigger,HJ=_s.Portal,fR=b.forwardRef(({className:n,...e},t)=>f.jsx(_s.Overlay,{ref:t,className:Oe("fixed inset-0 z-[9999] bg-black/80",n),style:{touchAction:"none",overscrollBehavior:"none",WebkitOverflowScrolling:"touch"},...e}));fR.displayName=_s.Overlay.displayName;const tb=b.forwardRef(({className:n,children:e,...t},r)=>{const[s,i]=b.useState(0),[o,a]=b.useState(!1);return b.useEffect(()=>{const l=r&&"current"in r?r.current:null;if(!l)return;const c=new MutationObserver(h=>{h.forEach(d=>{if(d.attributeName==="data-state"){const p=l.getAttribute("data-state");a(p==="open")}})});c.observe(l,{attributes:!0});const u=l.getAttribute("data-state");return a(u==="open"),()=>c.disconnect()},[r]),b.useEffect(()=>{let l=0;if(!o||!e)return;if(/iPad|iPhone|iPod/.test(navigator.userAgent)&&!window.MSStream){l=window.scrollY,i(l);const u=document.documentElement,h=document.body,d=()=>{u.style.setProperty("--ios-vh",`${window.innerHeight*.01}px`)};return d(),u.classList.add("drawer-open"),h.style.position="fixed",h.style.top=`-${l}px`,h.style.width="100%",h.style.overflow="hidden",window.addEventListener("resize",d),()=>{u.classList.remove("drawer-open"),h.style.position="",h.style.top="",h.style.width="",h.style.overflow="",window.removeEventListener("resize",d),window.scrollTo(0,l)}}else return()=>{}},[o,e]),f.jsxs(HJ,{children:[f.jsx(fR,{}),f.jsxs(_s.Content,{ref:r,className:Oe("fixed inset-x-0 bottom-0 z-[10000] mt-24 flex h-auto flex-col rounded-t-[10px] border bg-background kb-safe-inset kb-safe-padding",n),style:{touchAction:"pan-y",overscrollBehavior:"contain",isolation:"isolate"},...t,onPointerDown:l=>l.stopPropagation(),onTouchStart:l=>l.stopPropagation(),children:[f.jsx("div",{className:"mx-auto mt-4 h-2 w-[100px] rounded-full bg-muted"}),e]})]})});tb.displayName="DrawerContent";const nb=({className:n,...e})=>f.jsx("div",{className:Oe("grid gap-1.5 p-4 text-center sm:text-left",n),...e});nb.displayName="DrawerHeader";const rb=b.forwardRef(({className:n,...e},t)=>f.jsx(_s.Title,{ref:t,className:Oe("text-lg font-semibold leading-none tracking-tight",n),...e}));rb.displayName=_s.Title.displayName;const sb=b.forwardRef(({className:n,...e},t)=>f.jsx(_s.Description,{ref:t,className:Oe("text-sm text-muted-foreground",n),...e}));sb.displayName=_s.Description.displayName;var pR={exports:{}};(function(n,e){(function(t,r){n.exports=r()})(Ie,()=>(()=>{var t={873:(o,a)=>{var l,c,u=function(){var h=function(L,U){var F=L,D=x[U],k=null,N=0,M=null,T=[],j={},$=function(W,H){k=function(G){for(var Q=new Array(G),te=0;te<G;te+=1){Q[te]=new Array(G);for(var he=0;he<G;he+=1)Q[te][he]=null}return Q}(N=4*F+17),z(0,0),z(N-7,0),z(0,N-7),X(),ee(),K(W,H),F>=7&&J(W),M==null&&(M=ie(F,D,T)),ne(M,H)},z=function(W,H){for(var G=-1;G<=7;G+=1)if(!(W+G<=-1||N<=W+G))for(var Q=-1;Q<=7;Q+=1)H+Q<=-1||N<=H+Q||(k[W+G][H+Q]=0<=G&&G<=6&&(Q==0||Q==6)||0<=Q&&Q<=6&&(G==0||G==6)||2<=G&&G<=4&&2<=Q&&Q<=4)},ee=function(){for(var W=8;W<N-8;W+=1)k[W][6]==null&&(k[W][6]=W%2==0);for(var H=8;H<N-8;H+=1)k[6][H]==null&&(k[6][H]=H%2==0)},X=function(){for(var W=v.getPatternPosition(F),H=0;H<W.length;H+=1)for(var G=0;G<W.length;G+=1){var Q=W[H],te=W[G];if(k[Q][te]==null)for(var he=-2;he<=2;he+=1)for(var xe=-2;xe<=2;xe+=1)k[Q+he][te+xe]=he==-2||he==2||xe==-2||xe==2||he==0&&xe==0}},J=function(W){for(var H=v.getBCHTypeNumber(F),G=0;G<18;G+=1){var Q=!W&&(H>>G&1)==1;k[Math.floor(G/3)][G%3+N-8-3]=Q}for(G=0;G<18;G+=1)Q=!W&&(H>>G&1)==1,k[G%3+N-8-3][Math.floor(G/3)]=Q},K=function(W,H){for(var G=D<<3|H,Q=v.getBCHTypeInfo(G),te=0;te<15;te+=1){var he=!W&&(Q>>te&1)==1;te<6?k[te][8]=he:te<8?k[te+1][8]=he:k[N-15+te][8]=he}for(te=0;te<15;te+=1)he=!W&&(Q>>te&1)==1,te<8?k[8][N-te-1]=he:te<9?k[8][15-te-1+1]=he:k[8][15-te-1]=he;k[N-8][8]=!W},ne=function(W,H){for(var G=-1,Q=N-1,te=7,he=0,xe=v.getMaskFunction(H),fe=N-1;fe>0;fe-=2)for(fe==6&&(fe-=1);;){for(var be=0;be<2;be+=1)if(k[Q][fe-be]==null){var Pe=!1;he<W.length&&(Pe=(W[he]>>>te&1)==1),xe(Q,fe-be)&&(Pe=!Pe),k[Q][fe-be]=Pe,(te-=1)==-1&&(he+=1,te=7)}if((Q+=G)<0||N<=Q){Q-=G,G=-G;break}}},ie=function(W,H,G){for(var Q=S.getRSBlocks(W,H),te=E(),he=0;he<G.length;he+=1){var xe=G[he];te.put(xe.getMode(),4),te.put(xe.getLength(),v.getLengthInBits(xe.getMode(),W)),xe.write(te)}var fe=0;for(he=0;he<Q.length;he+=1)fe+=Q[he].dataCount;if(te.getLengthInBits()>8*fe)throw"code length overflow. ("+te.getLengthInBits()+">"+8*fe+")";for(te.getLengthInBits()+4<=8*fe&&te.put(0,4);te.getLengthInBits()%8!=0;)te.putBit(!1);for(;!(te.getLengthInBits()>=8*fe||(te.put(236,8),te.getLengthInBits()>=8*fe));)te.put(17,8);return function(be,Pe){for(var Se=0,Ye=0,Ve=0,Ge=new Array(Pe.length),Re=new Array(Pe.length),ge=0;ge<Pe.length;ge+=1){var et=Pe[ge].dataCount,tt=Pe[ge].totalCount-et;Ye=Math.max(Ye,et),Ve=Math.max(Ve,tt),Ge[ge]=new Array(et);for(var ke=0;ke<Ge[ge].length;ke+=1)Ge[ge][ke]=255&be.getBuffer()[ke+Se];Se+=et;var st=v.getErrorCorrectPolynomial(tt),it=_(Ge[ge],st.getLength()-1).mod(st);for(Re[ge]=new Array(st.getLength()-1),ke=0;ke<Re[ge].length;ke+=1){var xt=ke+it.getLength()-Re[ge].length;Re[ge][ke]=xt>=0?it.getAt(xt):0}}var Tn=0;for(ke=0;ke<Pe.length;ke+=1)Tn+=Pe[ke].totalCount;var yn=new Array(Tn),gt=0;for(ke=0;ke<Ye;ke+=1)for(ge=0;ge<Pe.length;ge+=1)ke<Ge[ge].length&&(yn[gt]=Ge[ge][ke],gt+=1);for(ke=0;ke<Ve;ke+=1)for(ge=0;ge<Pe.length;ge+=1)ke<Re[ge].length&&(yn[gt]=Re[ge][ke],gt+=1);return yn}(te,Q)};j.addData=function(W,H){var G=null;switch(H=H||"Byte"){case"Numeric":G=C(W);break;case"Alphanumeric":G=P(W);break;case"Byte":G=O(W);break;case"Kanji":G=A(W);break;default:throw"mode:"+H}T.push(G),M=null},j.isDark=function(W,H){if(W<0||N<=W||H<0||N<=H)throw W+","+H;return k[W][H]},j.getModuleCount=function(){return N},j.make=function(){if(F<1){for(var W=1;W<40;W++){for(var H=S.getRSBlocks(W,D),G=E(),Q=0;Q<T.length;Q++){var te=T[Q];G.put(te.getMode(),4),G.put(te.getLength(),v.getLengthInBits(te.getMode(),W)),te.write(G)}var he=0;for(Q=0;Q<H.length;Q++)he+=H[Q].dataCount;if(G.getLengthInBits()<=8*he)break}F=W}$(!1,function(){for(var xe=0,fe=0,be=0;be<8;be+=1){$(!0,be);var Pe=v.getLostPoint(j);(be==0||xe>Pe)&&(xe=Pe,fe=be)}return fe}())},j.createTableTag=function(W,H){W=W||2;var G="";G+='<table style="',G+=" border-width: 0px; border-style: none;",G+=" border-collapse: collapse;",G+=" padding: 0px; margin: "+(H=H===void 0?4*W:H)+"px;",G+='">',G+="<tbody>";for(var Q=0;Q<j.getModuleCount();Q+=1){G+="<tr>";for(var te=0;te<j.getModuleCount();te+=1)G+='<td style="',G+=" border-width: 0px; border-style: none;",G+=" border-collapse: collapse;",G+=" padding: 0px; margin: 0px;",G+=" width: "+W+"px;",G+=" height: "+W+"px;",G+=" background-color: ",G+=j.isDark(Q,te)?"#000000":"#ffffff",G+=";",G+='"/>';G+="</tr>"}return(G+="</tbody>")+"</table>"},j.createSvgTag=function(W,H,G,Q){var te={};typeof arguments[0]=="object"&&(W=(te=arguments[0]).cellSize,H=te.margin,G=te.alt,Q=te.title),W=W||2,H=H===void 0?4*W:H,(G=typeof G=="string"?{text:G}:G||{}).text=G.text||null,G.id=G.text?G.id||"qrcode-description":null,(Q=typeof Q=="string"?{text:Q}:Q||{}).text=Q.text||null,Q.id=Q.text?Q.id||"qrcode-title":null;var he,xe,fe,be,Pe=j.getModuleCount()*W+2*H,Se="";for(be="l"+W+",0 0,"+W+" -"+W+",0 0,-"+W+"z ",Se+='<svg version="1.1" xmlns="http://www.w3.org/2000/svg"',Se+=te.scalable?"":' width="'+Pe+'px" height="'+Pe+'px"',Se+=' viewBox="0 0 '+Pe+" "+Pe+'" ',Se+=' preserveAspectRatio="xMinYMin meet"',Se+=Q.text||G.text?' role="img" aria-labelledby="'+ae([Q.id,G.id].join(" ").trim())+'"':"",Se+=">",Se+=Q.text?'<title id="'+ae(Q.id)+'">'+ae(Q.text)+"</title>":"",Se+=G.text?'<description id="'+ae(G.id)+'">'+ae(G.text)+"</description>":"",Se+='<rect width="100%" height="100%" fill="white" cx="0" cy="0"/>',Se+='<path d="',xe=0;xe<j.getModuleCount();xe+=1)for(fe=xe*W+H,he=0;he<j.getModuleCount();he+=1)j.isDark(xe,he)&&(Se+="M"+(he*W+H)+","+fe+be);return(Se+='" stroke="transparent" fill="black"/>')+"</svg>"},j.createDataURL=function(W,H){W=W||2,H=H===void 0?4*W:H;var G=j.getModuleCount()*W+2*H,Q=H,te=G-H;return I(G,G,function(he,xe){if(Q<=he&&he<te&&Q<=xe&&xe<te){var fe=Math.floor((he-Q)/W),be=Math.floor((xe-Q)/W);return j.isDark(be,fe)?0:1}return 1})},j.createImgTag=function(W,H,G){W=W||2,H=H===void 0?4*W:H;var Q=j.getModuleCount()*W+2*H,te="";return te+="<img",te+=' src="',te+=j.createDataURL(W,H),te+='"',te+=' width="',te+=Q,te+='"',te+=' height="',te+=Q,te+='"',G&&(te+=' alt="',te+=ae(G),te+='"'),te+"/>"};var ae=function(W){for(var H="",G=0;G<W.length;G+=1){var Q=W.charAt(G);switch(Q){case"<":H+="&lt;";break;case">":H+="&gt;";break;case"&":H+="&amp;";break;case'"':H+="&quot;";break;default:H+=Q}}return H};return j.createASCII=function(W,H){if((W=W||1)<2)return function(Ge){Ge=Ge===void 0?2:Ge;var Re,ge,et,tt,ke,st=1*j.getModuleCount()+2*Ge,it=Ge,xt=st-Ge,Tn={"":""," ":""," ":"","  ":" "},yn={"":""," ":""," ":" ","  ":" "},gt="";for(Re=0;Re<st;Re+=2){for(et=Math.floor((Re-it)/1),tt=Math.floor((Re+1-it)/1),ge=0;ge<st;ge+=1)ke="",it<=ge&&ge<xt&&it<=Re&&Re<xt&&j.isDark(et,Math.floor((ge-it)/1))&&(ke=" "),it<=ge&&ge<xt&&it<=Re+1&&Re+1<xt&&j.isDark(tt,Math.floor((ge-it)/1))?ke+=" ":ke+="",gt+=Ge<1&&Re+1>=xt?yn[ke]:Tn[ke];gt+=`
`}return st%2&&Ge>0?gt.substring(0,gt.length-st-1)+Array(st+1).join(""):gt.substring(0,gt.length-1)}(H);W-=1,H=H===void 0?2*W:H;var G,Q,te,he,xe=j.getModuleCount()*W+2*H,fe=H,be=xe-H,Pe=Array(W+1).join(""),Se=Array(W+1).join("  "),Ye="",Ve="";for(G=0;G<xe;G+=1){for(te=Math.floor((G-fe)/W),Ve="",Q=0;Q<xe;Q+=1)he=1,fe<=Q&&Q<be&&fe<=G&&G<be&&j.isDark(te,Math.floor((Q-fe)/W))&&(he=0),Ve+=he?Pe:Se;for(te=0;te<W;te+=1)Ye+=Ve+`
`}return Ye.substring(0,Ye.length-1)},j.renderTo2dContext=function(W,H){H=H||2;for(var G=j.getModuleCount(),Q=0;Q<G;Q++)for(var te=0;te<G;te++)W.fillStyle=j.isDark(Q,te)?"black":"white",W.fillRect(Q*H,te*H,H,H)},j};h.stringToBytes=(h.stringToBytesFuncs={default:function(L){for(var U=[],F=0;F<L.length;F+=1){var D=L.charCodeAt(F);U.push(255&D)}return U}}).default,h.createStringToBytes=function(L,U){var F=function(){for(var k=B(L),N=function(){var ee=k.read();if(ee==-1)throw"eof";return ee},M=0,T={};;){var j=k.read();if(j==-1)break;var $=N(),z=N()<<8|N();T[String.fromCharCode(j<<8|$)]=z,M+=1}if(M!=U)throw M+" != "+U;return T}(),D=63;return function(k){for(var N=[],M=0;M<k.length;M+=1){var T=k.charCodeAt(M);if(T<128)N.push(T);else{var j=F[k.charAt(M)];typeof j=="number"?(255&j)==j?N.push(j):(N.push(j>>>8),N.push(255&j)):N.push(D)}}return N}};var d,p,m,g,y,x={L:1,M:0,Q:3,H:2},v=(d=[[],[6,18],[6,22],[6,26],[6,30],[6,34],[6,22,38],[6,24,42],[6,26,46],[6,28,50],[6,30,54],[6,32,58],[6,34,62],[6,26,46,66],[6,26,48,70],[6,26,50,74],[6,30,54,78],[6,30,56,82],[6,30,58,86],[6,34,62,90],[6,28,50,72,94],[6,26,50,74,98],[6,30,54,78,102],[6,28,54,80,106],[6,32,58,84,110],[6,30,58,86,114],[6,34,62,90,118],[6,26,50,74,98,122],[6,30,54,78,102,126],[6,26,52,78,104,130],[6,30,56,82,108,134],[6,34,60,86,112,138],[6,30,58,86,114,142],[6,34,62,90,118,146],[6,30,54,78,102,126,150],[6,24,50,76,102,128,154],[6,28,54,80,106,132,158],[6,32,58,84,110,136,162],[6,26,54,82,110,138,166],[6,30,58,86,114,142,170]],p=1335,m=7973,y=function(L){for(var U=0;L!=0;)U+=1,L>>>=1;return U},(g={}).getBCHTypeInfo=function(L){for(var U=L<<10;y(U)-y(p)>=0;)U^=p<<y(U)-y(p);return 21522^(L<<10|U)},g.getBCHTypeNumber=function(L){for(var U=L<<12;y(U)-y(m)>=0;)U^=m<<y(U)-y(m);return L<<12|U},g.getPatternPosition=function(L){return d[L-1]},g.getMaskFunction=function(L){switch(L){case 0:return function(U,F){return(U+F)%2==0};case 1:return function(U,F){return U%2==0};case 2:return function(U,F){return F%3==0};case 3:return function(U,F){return(U+F)%3==0};case 4:return function(U,F){return(Math.floor(U/2)+Math.floor(F/3))%2==0};case 5:return function(U,F){return U*F%2+U*F%3==0};case 6:return function(U,F){return(U*F%2+U*F%3)%2==0};case 7:return function(U,F){return(U*F%3+(U+F)%2)%2==0};default:throw"bad maskPattern:"+L}},g.getErrorCorrectPolynomial=function(L){for(var U=_([1],0),F=0;F<L;F+=1)U=U.multiply(_([1,w.gexp(F)],0));return U},g.getLengthInBits=function(L,U){if(1<=U&&U<10)switch(L){case 1:return 10;case 2:return 9;case 4:case 8:return 8;default:throw"mode:"+L}else if(U<27)switch(L){case 1:return 12;case 2:return 11;case 4:return 16;case 8:return 10;default:throw"mode:"+L}else{if(!(U<41))throw"type:"+U;switch(L){case 1:return 14;case 2:return 13;case 4:return 16;case 8:return 12;default:throw"mode:"+L}}},g.getLostPoint=function(L){for(var U=L.getModuleCount(),F=0,D=0;D<U;D+=1)for(var k=0;k<U;k+=1){for(var N=0,M=L.isDark(D,k),T=-1;T<=1;T+=1)if(!(D+T<0||U<=D+T))for(var j=-1;j<=1;j+=1)k+j<0||U<=k+j||T==0&&j==0||M==L.isDark(D+T,k+j)&&(N+=1);N>5&&(F+=3+N-5)}for(D=0;D<U-1;D+=1)for(k=0;k<U-1;k+=1){var $=0;L.isDark(D,k)&&($+=1),L.isDark(D+1,k)&&($+=1),L.isDark(D,k+1)&&($+=1),L.isDark(D+1,k+1)&&($+=1),$!=0&&$!=4||(F+=3)}for(D=0;D<U;D+=1)for(k=0;k<U-6;k+=1)L.isDark(D,k)&&!L.isDark(D,k+1)&&L.isDark(D,k+2)&&L.isDark(D,k+3)&&L.isDark(D,k+4)&&!L.isDark(D,k+5)&&L.isDark(D,k+6)&&(F+=40);for(k=0;k<U;k+=1)for(D=0;D<U-6;D+=1)L.isDark(D,k)&&!L.isDark(D+1,k)&&L.isDark(D+2,k)&&L.isDark(D+3,k)&&L.isDark(D+4,k)&&!L.isDark(D+5,k)&&L.isDark(D+6,k)&&(F+=40);var z=0;for(k=0;k<U;k+=1)for(D=0;D<U;D+=1)L.isDark(D,k)&&(z+=1);return F+Math.abs(100*z/U/U-50)/5*10},g),w=function(){for(var L=new Array(256),U=new Array(256),F=0;F<8;F+=1)L[F]=1<<F;for(F=8;F<256;F+=1)L[F]=L[F-4]^L[F-5]^L[F-6]^L[F-8];for(F=0;F<255;F+=1)U[L[F]]=F;return{glog:function(D){if(D<1)throw"glog("+D+")";return U[D]},gexp:function(D){for(;D<0;)D+=255;for(;D>=256;)D-=255;return L[D]}}}();function _(L,U){if(L.length===void 0)throw L.length+"/"+U;var F=function(){for(var k=0;k<L.length&&L[k]==0;)k+=1;for(var N=new Array(L.length-k+U),M=0;M<L.length-k;M+=1)N[M]=L[M+k];return N}(),D={getAt:function(k){return F[k]},getLength:function(){return F.length},multiply:function(k){for(var N=new Array(D.getLength()+k.getLength()-1),M=0;M<D.getLength();M+=1)for(var T=0;T<k.getLength();T+=1)N[M+T]^=w.gexp(w.glog(D.getAt(M))+w.glog(k.getAt(T)));return _(N,0)},mod:function(k){if(D.getLength()-k.getLength()<0)return D;for(var N=w.glog(D.getAt(0))-w.glog(k.getAt(0)),M=new Array(D.getLength()),T=0;T<D.getLength();T+=1)M[T]=D.getAt(T);for(T=0;T<k.getLength();T+=1)M[T]^=w.gexp(w.glog(k.getAt(T))+N);return _(M,0).mod(k)}};return D}var S=function(){var L=[[1,26,19],[1,26,16],[1,26,13],[1,26,9],[1,44,34],[1,44,28],[1,44,22],[1,44,16],[1,70,55],[1,70,44],[2,35,17],[2,35,13],[1,100,80],[2,50,32],[2,50,24],[4,25,9],[1,134,108],[2,67,43],[2,33,15,2,34,16],[2,33,11,2,34,12],[2,86,68],[4,43,27],[4,43,19],[4,43,15],[2,98,78],[4,49,31],[2,32,14,4,33,15],[4,39,13,1,40,14],[2,121,97],[2,60,38,2,61,39],[4,40,18,2,41,19],[4,40,14,2,41,15],[2,146,116],[3,58,36,2,59,37],[4,36,16,4,37,17],[4,36,12,4,37,13],[2,86,68,2,87,69],[4,69,43,1,70,44],[6,43,19,2,44,20],[6,43,15,2,44,16],[4,101,81],[1,80,50,4,81,51],[4,50,22,4,51,23],[3,36,12,8,37,13],[2,116,92,2,117,93],[6,58,36,2,59,37],[4,46,20,6,47,21],[7,42,14,4,43,15],[4,133,107],[8,59,37,1,60,38],[8,44,20,4,45,21],[12,33,11,4,34,12],[3,145,115,1,146,116],[4,64,40,5,65,41],[11,36,16,5,37,17],[11,36,12,5,37,13],[5,109,87,1,110,88],[5,65,41,5,66,42],[5,54,24,7,55,25],[11,36,12,7,37,13],[5,122,98,1,123,99],[7,73,45,3,74,46],[15,43,19,2,44,20],[3,45,15,13,46,16],[1,135,107,5,136,108],[10,74,46,1,75,47],[1,50,22,15,51,23],[2,42,14,17,43,15],[5,150,120,1,151,121],[9,69,43,4,70,44],[17,50,22,1,51,23],[2,42,14,19,43,15],[3,141,113,4,142,114],[3,70,44,11,71,45],[17,47,21,4,48,22],[9,39,13,16,40,14],[3,135,107,5,136,108],[3,67,41,13,68,42],[15,54,24,5,55,25],[15,43,15,10,44,16],[4,144,116,4,145,117],[17,68,42],[17,50,22,6,51,23],[19,46,16,6,47,17],[2,139,111,7,140,112],[17,74,46],[7,54,24,16,55,25],[34,37,13],[4,151,121,5,152,122],[4,75,47,14,76,48],[11,54,24,14,55,25],[16,45,15,14,46,16],[6,147,117,4,148,118],[6,73,45,14,74,46],[11,54,24,16,55,25],[30,46,16,2,47,17],[8,132,106,4,133,107],[8,75,47,13,76,48],[7,54,24,22,55,25],[22,45,15,13,46,16],[10,142,114,2,143,115],[19,74,46,4,75,47],[28,50,22,6,51,23],[33,46,16,4,47,17],[8,152,122,4,153,123],[22,73,45,3,74,46],[8,53,23,26,54,24],[12,45,15,28,46,16],[3,147,117,10,148,118],[3,73,45,23,74,46],[4,54,24,31,55,25],[11,45,15,31,46,16],[7,146,116,7,147,117],[21,73,45,7,74,46],[1,53,23,37,54,24],[19,45,15,26,46,16],[5,145,115,10,146,116],[19,75,47,10,76,48],[15,54,24,25,55,25],[23,45,15,25,46,16],[13,145,115,3,146,116],[2,74,46,29,75,47],[42,54,24,1,55,25],[23,45,15,28,46,16],[17,145,115],[10,74,46,23,75,47],[10,54,24,35,55,25],[19,45,15,35,46,16],[17,145,115,1,146,116],[14,74,46,21,75,47],[29,54,24,19,55,25],[11,45,15,46,46,16],[13,145,115,6,146,116],[14,74,46,23,75,47],[44,54,24,7,55,25],[59,46,16,1,47,17],[12,151,121,7,152,122],[12,75,47,26,76,48],[39,54,24,14,55,25],[22,45,15,41,46,16],[6,151,121,14,152,122],[6,75,47,34,76,48],[46,54,24,10,55,25],[2,45,15,64,46,16],[17,152,122,4,153,123],[29,74,46,14,75,47],[49,54,24,10,55,25],[24,45,15,46,46,16],[4,152,122,18,153,123],[13,74,46,32,75,47],[48,54,24,14,55,25],[42,45,15,32,46,16],[20,147,117,4,148,118],[40,75,47,7,76,48],[43,54,24,22,55,25],[10,45,15,67,46,16],[19,148,118,6,149,119],[18,75,47,31,76,48],[34,54,24,34,55,25],[20,45,15,61,46,16]],U=function(D,k){var N={};return N.totalCount=D,N.dataCount=k,N},F={getRSBlocks:function(D,k){var N=function(J,K){switch(K){case x.L:return L[4*(J-1)+0];case x.M:return L[4*(J-1)+1];case x.Q:return L[4*(J-1)+2];case x.H:return L[4*(J-1)+3];default:return}}(D,k);if(N===void 0)throw"bad rs block @ typeNumber:"+D+"/errorCorrectionLevel:"+k;for(var M=N.length/3,T=[],j=0;j<M;j+=1)for(var $=N[3*j+0],z=N[3*j+1],ee=N[3*j+2],X=0;X<$;X+=1)T.push(U(z,ee));return T}};return F}(),E=function(){var L=[],U=0,F={getBuffer:function(){return L},getAt:function(D){var k=Math.floor(D/8);return(L[k]>>>7-D%8&1)==1},put:function(D,k){for(var N=0;N<k;N+=1)F.putBit((D>>>k-N-1&1)==1)},getLengthInBits:function(){return U},putBit:function(D){var k=Math.floor(U/8);L.length<=k&&L.push(0),D&&(L[k]|=128>>>U%8),U+=1}};return F},C=function(L){var U=L,F={getMode:function(){return 1},getLength:function(N){return U.length},write:function(N){for(var M=U,T=0;T+2<M.length;)N.put(D(M.substring(T,T+3)),10),T+=3;T<M.length&&(M.length-T==1?N.put(D(M.substring(T,T+1)),4):M.length-T==2&&N.put(D(M.substring(T,T+2)),7))}},D=function(N){for(var M=0,T=0;T<N.length;T+=1)M=10*M+k(N.charAt(T));return M},k=function(N){if("0"<=N&&N<="9")return N.charCodeAt(0)-48;throw"illegal char :"+N};return F},P=function(L){var U=L,F={getMode:function(){return 2},getLength:function(k){return U.length},write:function(k){for(var N=U,M=0;M+1<N.length;)k.put(45*D(N.charAt(M))+D(N.charAt(M+1)),11),M+=2;M<N.length&&k.put(D(N.charAt(M)),6)}},D=function(k){if("0"<=k&&k<="9")return k.charCodeAt(0)-48;if("A"<=k&&k<="Z")return k.charCodeAt(0)-65+10;switch(k){case" ":return 36;case"$":return 37;case"%":return 38;case"*":return 39;case"+":return 40;case"-":return 41;case".":return 42;case"/":return 43;case":":return 44;default:throw"illegal char :"+k}};return F},O=function(L){var U=h.stringToBytes(L);return{getMode:function(){return 4},getLength:function(F){return U.length},write:function(F){for(var D=0;D<U.length;D+=1)F.put(U[D],8)}}},A=function(L){var U=h.stringToBytesFuncs.SJIS;if(!U)throw"sjis not supported.";(function(){var k=U("");if(k.length!=2||(k[0]<<8|k[1])!=38726)throw"sjis not supported."})();var F=U(L),D={getMode:function(){return 8},getLength:function(k){return~~(F.length/2)},write:function(k){for(var N=F,M=0;M+1<N.length;){var T=(255&N[M])<<8|255&N[M+1];if(33088<=T&&T<=40956)T-=33088;else{if(!(57408<=T&&T<=60351))throw"illegal char at "+(M+1)+"/"+T;T-=49472}T=192*(T>>>8&255)+(255&T),k.put(T,13),M+=2}if(M<N.length)throw"illegal char at "+(M+1)}};return D},R=function(){var L=[],U={writeByte:function(F){L.push(255&F)},writeShort:function(F){U.writeByte(F),U.writeByte(F>>>8)},writeBytes:function(F,D,k){D=D||0,k=k||F.length;for(var N=0;N<k;N+=1)U.writeByte(F[N+D])},writeString:function(F){for(var D=0;D<F.length;D+=1)U.writeByte(F.charCodeAt(D))},toByteArray:function(){return L},toString:function(){var F="";F+="[";for(var D=0;D<L.length;D+=1)D>0&&(F+=","),F+=L[D];return F+"]"}};return U},B=function(L){var U=L,F=0,D=0,k=0,N={read:function(){for(;k<8;){if(F>=U.length){if(k==0)return-1;throw"unexpected end of file./"+k}var T=U.charAt(F);if(F+=1,T=="=")return k=0,-1;T.match(/^\s$/)||(D=D<<6|M(T.charCodeAt(0)),k+=6)}var j=D>>>k-8&255;return k-=8,j}},M=function(T){if(65<=T&&T<=90)return T-65;if(97<=T&&T<=122)return T-97+26;if(48<=T&&T<=57)return T-48+52;if(T==43)return 62;if(T==47)return 63;throw"c:"+T};return N},I=function(L,U,F){for(var D=function(z,ee){var X=z,J=ee,K=new Array(z*ee),ne={setPixel:function(W,H,G){K[H*X+W]=G},write:function(W){W.writeString("GIF87a"),W.writeShort(X),W.writeShort(J),W.writeByte(128),W.writeByte(0),W.writeByte(0),W.writeByte(0),W.writeByte(0),W.writeByte(0),W.writeByte(255),W.writeByte(255),W.writeByte(255),W.writeString(","),W.writeShort(0),W.writeShort(0),W.writeShort(X),W.writeShort(J),W.writeByte(0);var H=ie(2);W.writeByte(2);for(var G=0;H.length-G>255;)W.writeByte(255),W.writeBytes(H,G,255),G+=255;W.writeByte(H.length-G),W.writeBytes(H,G,H.length-G),W.writeByte(0),W.writeString(";")}},ie=function(W){for(var H=1<<W,G=1+(1<<W),Q=W+1,te=ae(),he=0;he<H;he+=1)te.add(String.fromCharCode(he));te.add(String.fromCharCode(H)),te.add(String.fromCharCode(G));var xe,fe,be,Pe=R(),Se=(xe=Pe,fe=0,be=0,{write:function(Re,ge){if(Re>>>ge)throw"length over";for(;fe+ge>=8;)xe.writeByte(255&(Re<<fe|be)),ge-=8-fe,Re>>>=8-fe,be=0,fe=0;be|=Re<<fe,fe+=ge},flush:function(){fe>0&&xe.writeByte(be)}});Se.write(H,Q);var Ye=0,Ve=String.fromCharCode(K[Ye]);for(Ye+=1;Ye<K.length;){var Ge=String.fromCharCode(K[Ye]);Ye+=1,te.contains(Ve+Ge)?Ve+=Ge:(Se.write(te.indexOf(Ve),Q),te.size()<4095&&(te.size()==1<<Q&&(Q+=1),te.add(Ve+Ge)),Ve=Ge)}return Se.write(te.indexOf(Ve),Q),Se.write(G,Q),Se.flush(),Pe.toByteArray()},ae=function(){var W={},H=0,G={add:function(Q){if(G.contains(Q))throw"dup key:"+Q;W[Q]=H,H+=1},size:function(){return H},indexOf:function(Q){return W[Q]},contains:function(Q){return W[Q]!==void 0}};return G};return ne}(L,U),k=0;k<U;k+=1)for(var N=0;N<L;N+=1)D.setPixel(N,k,F(N,k));var M=R();D.write(M);for(var T=function(){var z=0,ee=0,X=0,J="",K={},ne=function(ae){J+=String.fromCharCode(ie(63&ae))},ie=function(ae){if(!(ae<0)){if(ae<26)return 65+ae;if(ae<52)return ae-26+97;if(ae<62)return ae-52+48;if(ae==62)return 43;if(ae==63)return 47}throw"n:"+ae};return K.writeByte=function(ae){for(z=z<<8|255&ae,ee+=8,X+=1;ee>=6;)ne(z>>>ee-6),ee-=6},K.flush=function(){if(ee>0&&(ne(z<<6-ee),z=0,ee=0),X%3!=0)for(var ae=3-X%3,W=0;W<ae;W+=1)J+="="},K.toString=function(){return J},K}(),j=M.toByteArray(),$=0;$<j.length;$+=1)T.writeByte(j[$]);return T.flush(),"data:image/gif;base64,"+T};return h}();u.stringToBytesFuncs["UTF-8"]=function(h){return function(d){for(var p=[],m=0;m<d.length;m++){var g=d.charCodeAt(m);g<128?p.push(g):g<2048?p.push(192|g>>6,128|63&g):g<55296||g>=57344?p.push(224|g>>12,128|g>>6&63,128|63&g):(m++,g=65536+((1023&g)<<10|1023&d.charCodeAt(m)),p.push(240|g>>18,128|g>>12&63,128|g>>6&63,128|63&g))}return p}(h)},(c=typeof(l=function(){return u})=="function"?l.apply(a,[]):l)===void 0||(o.exports=c)}},r={};function s(o){var a=r[o];if(a!==void 0)return a.exports;var l=r[o]={exports:{}};return t[o](l,l.exports,s),l.exports}s.n=o=>{var a=o&&o.__esModule?()=>o.default:()=>o;return s.d(a,{a}),a},s.d=(o,a)=>{for(var l in a)s.o(a,l)&&!s.o(o,l)&&Object.defineProperty(o,l,{enumerable:!0,get:a[l]})},s.o=(o,a)=>Object.prototype.hasOwnProperty.call(o,a);var i={};return(()=>{s.d(i,{default:()=>U});const o=F=>!!F&&typeof F=="object"&&!Array.isArray(F);function a(F,...D){if(!D.length)return F;const k=D.shift();return k!==void 0&&o(F)&&o(k)?(F=Object.assign({},F),Object.keys(k).forEach(N=>{const M=F[N],T=k[N];Array.isArray(M)&&Array.isArray(T)?F[N]=T:o(M)&&o(T)?F[N]=a(Object.assign({},M),T):F[N]=T}),a(F,...D)):F}function l(F,D){const k=document.createElement("a");k.download=D,k.href=F,document.body.appendChild(k),k.click(),document.body.removeChild(k)}const c={L:.07,M:.15,Q:.25,H:.3};class u{constructor({svg:D,type:k,window:N}){this._svg=D,this._type=k,this._window=N}draw(D,k,N,M){let T;switch(this._type){case"dots":T=this._drawDot;break;case"classy":T=this._drawClassy;break;case"classy-rounded":T=this._drawClassyRounded;break;case"rounded":T=this._drawRounded;break;case"extra-rounded":T=this._drawExtraRounded;break;default:T=this._drawSquare}T.call(this,{x:D,y:k,size:N,getNeighbor:M})}_rotateFigure({x:D,y:k,size:N,rotation:M=0,draw:T}){var j;const $=D+N/2,z=k+N/2;T(),(j=this._element)===null||j===void 0||j.setAttribute("transform",`rotate(${180*M/Math.PI},${$},${z})`)}_basicDot(D){const{size:k,x:N,y:M}=D;this._rotateFigure(Object.assign(Object.assign({},D),{draw:()=>{this._element=this._window.document.createElementNS("http://www.w3.org/2000/svg","circle"),this._element.setAttribute("cx",String(N+k/2)),this._element.setAttribute("cy",String(M+k/2)),this._element.setAttribute("r",String(k/2))}}))}_basicSquare(D){const{size:k,x:N,y:M}=D;this._rotateFigure(Object.assign(Object.assign({},D),{draw:()=>{this._element=this._window.document.createElementNS("http://www.w3.org/2000/svg","rect"),this._element.setAttribute("x",String(N)),this._element.setAttribute("y",String(M)),this._element.setAttribute("width",String(k)),this._element.setAttribute("height",String(k))}}))}_basicSideRounded(D){const{size:k,x:N,y:M}=D;this._rotateFigure(Object.assign(Object.assign({},D),{draw:()=>{this._element=this._window.document.createElementNS("http://www.w3.org/2000/svg","path"),this._element.setAttribute("d",`M ${N} ${M}v ${k}h `+k/2+`a ${k/2} ${k/2}, 0, 0, 0, 0 ${-k}`)}}))}_basicCornerRounded(D){const{size:k,x:N,y:M}=D;this._rotateFigure(Object.assign(Object.assign({},D),{draw:()=>{this._element=this._window.document.createElementNS("http://www.w3.org/2000/svg","path"),this._element.setAttribute("d",`M ${N} ${M}v ${k}h ${k}v `+-k/2+`a ${k/2} ${k/2}, 0, 0, 0, ${-k/2} ${-k/2}`)}}))}_basicCornerExtraRounded(D){const{size:k,x:N,y:M}=D;this._rotateFigure(Object.assign(Object.assign({},D),{draw:()=>{this._element=this._window.document.createElementNS("http://www.w3.org/2000/svg","path"),this._element.setAttribute("d",`M ${N} ${M}v ${k}h ${k}a ${k} ${k}, 0, 0, 0, ${-k} ${-k}`)}}))}_basicCornersRounded(D){const{size:k,x:N,y:M}=D;this._rotateFigure(Object.assign(Object.assign({},D),{draw:()=>{this._element=this._window.document.createElementNS("http://www.w3.org/2000/svg","path"),this._element.setAttribute("d",`M ${N} ${M}v `+k/2+`a ${k/2} ${k/2}, 0, 0, 0, ${k/2} ${k/2}h `+k/2+"v "+-k/2+`a ${k/2} ${k/2}, 0, 0, 0, ${-k/2} ${-k/2}`)}}))}_drawDot({x:D,y:k,size:N}){this._basicDot({x:D,y:k,size:N,rotation:0})}_drawSquare({x:D,y:k,size:N}){this._basicSquare({x:D,y:k,size:N,rotation:0})}_drawRounded({x:D,y:k,size:N,getNeighbor:M}){const T=M?+M(-1,0):0,j=M?+M(1,0):0,$=M?+M(0,-1):0,z=M?+M(0,1):0,ee=T+j+$+z;if(ee!==0)if(ee>2||T&&j||$&&z)this._basicSquare({x:D,y:k,size:N,rotation:0});else{if(ee===2){let X=0;return T&&$?X=Math.PI/2:$&&j?X=Math.PI:j&&z&&(X=-Math.PI/2),void this._basicCornerRounded({x:D,y:k,size:N,rotation:X})}if(ee===1){let X=0;return $?X=Math.PI/2:j?X=Math.PI:z&&(X=-Math.PI/2),void this._basicSideRounded({x:D,y:k,size:N,rotation:X})}}else this._basicDot({x:D,y:k,size:N,rotation:0})}_drawExtraRounded({x:D,y:k,size:N,getNeighbor:M}){const T=M?+M(-1,0):0,j=M?+M(1,0):0,$=M?+M(0,-1):0,z=M?+M(0,1):0,ee=T+j+$+z;if(ee!==0)if(ee>2||T&&j||$&&z)this._basicSquare({x:D,y:k,size:N,rotation:0});else{if(ee===2){let X=0;return T&&$?X=Math.PI/2:$&&j?X=Math.PI:j&&z&&(X=-Math.PI/2),void this._basicCornerExtraRounded({x:D,y:k,size:N,rotation:X})}if(ee===1){let X=0;return $?X=Math.PI/2:j?X=Math.PI:z&&(X=-Math.PI/2),void this._basicSideRounded({x:D,y:k,size:N,rotation:X})}}else this._basicDot({x:D,y:k,size:N,rotation:0})}_drawClassy({x:D,y:k,size:N,getNeighbor:M}){const T=M?+M(-1,0):0,j=M?+M(1,0):0,$=M?+M(0,-1):0,z=M?+M(0,1):0;T+j+$+z!==0?T||$?j||z?this._basicSquare({x:D,y:k,size:N,rotation:0}):this._basicCornerRounded({x:D,y:k,size:N,rotation:Math.PI/2}):this._basicCornerRounded({x:D,y:k,size:N,rotation:-Math.PI/2}):this._basicCornersRounded({x:D,y:k,size:N,rotation:Math.PI/2})}_drawClassyRounded({x:D,y:k,size:N,getNeighbor:M}){const T=M?+M(-1,0):0,j=M?+M(1,0):0,$=M?+M(0,-1):0,z=M?+M(0,1):0;T+j+$+z!==0?T||$?j||z?this._basicSquare({x:D,y:k,size:N,rotation:0}):this._basicCornerExtraRounded({x:D,y:k,size:N,rotation:Math.PI/2}):this._basicCornerExtraRounded({x:D,y:k,size:N,rotation:-Math.PI/2}):this._basicCornersRounded({x:D,y:k,size:N,rotation:Math.PI/2})}}const h={dot:"dot",square:"square",extraRounded:"extra-rounded"},d=Object.values(h);class p{constructor({svg:D,type:k,window:N}){this._svg=D,this._type=k,this._window=N}draw(D,k,N,M){let T;switch(this._type){case h.square:T=this._drawSquare;break;case h.extraRounded:T=this._drawExtraRounded;break;default:T=this._drawDot}T.call(this,{x:D,y:k,size:N,rotation:M})}_rotateFigure({x:D,y:k,size:N,rotation:M=0,draw:T}){var j;const $=D+N/2,z=k+N/2;T(),(j=this._element)===null||j===void 0||j.setAttribute("transform",`rotate(${180*M/Math.PI},${$},${z})`)}_basicDot(D){const{size:k,x:N,y:M}=D,T=k/7;this._rotateFigure(Object.assign(Object.assign({},D),{draw:()=>{this._element=this._window.document.createElementNS("http://www.w3.org/2000/svg","path"),this._element.setAttribute("clip-rule","evenodd"),this._element.setAttribute("d",`M ${N+k/2} ${M}a ${k/2} ${k/2} 0 1 0 0.1 0zm 0 ${T}a ${k/2-T} ${k/2-T} 0 1 1 -0.1 0Z`)}}))}_basicSquare(D){const{size:k,x:N,y:M}=D,T=k/7;this._rotateFigure(Object.assign(Object.assign({},D),{draw:()=>{this._element=this._window.document.createElementNS("http://www.w3.org/2000/svg","path"),this._element.setAttribute("clip-rule","evenodd"),this._element.setAttribute("d",`M ${N} ${M}v ${k}h ${k}v `+-k+`zM ${N+T} ${M+T}h `+(k-2*T)+"v "+(k-2*T)+"h "+(2*T-k)+"z")}}))}_basicExtraRounded(D){const{size:k,x:N,y:M}=D,T=k/7;this._rotateFigure(Object.assign(Object.assign({},D),{draw:()=>{this._element=this._window.document.createElementNS("http://www.w3.org/2000/svg","path"),this._element.setAttribute("clip-rule","evenodd"),this._element.setAttribute("d",`M ${N} ${M+2.5*T}v `+2*T+`a ${2.5*T} ${2.5*T}, 0, 0, 0, ${2.5*T} ${2.5*T}h `+2*T+`a ${2.5*T} ${2.5*T}, 0, 0, 0, ${2.5*T} ${2.5*-T}v `+-2*T+`a ${2.5*T} ${2.5*T}, 0, 0, 0, ${2.5*-T} ${2.5*-T}h `+-2*T+`a ${2.5*T} ${2.5*T}, 0, 0, 0, ${2.5*-T} ${2.5*T}M ${N+2.5*T} ${M+T}h `+2*T+`a ${1.5*T} ${1.5*T}, 0, 0, 1, ${1.5*T} ${1.5*T}v `+2*T+`a ${1.5*T} ${1.5*T}, 0, 0, 1, ${1.5*-T} ${1.5*T}h `+-2*T+`a ${1.5*T} ${1.5*T}, 0, 0, 1, ${1.5*-T} ${1.5*-T}v `+-2*T+`a ${1.5*T} ${1.5*T}, 0, 0, 1, ${1.5*T} ${1.5*-T}`)}}))}_drawDot({x:D,y:k,size:N,rotation:M}){this._basicDot({x:D,y:k,size:N,rotation:M})}_drawSquare({x:D,y:k,size:N,rotation:M}){this._basicSquare({x:D,y:k,size:N,rotation:M})}_drawExtraRounded({x:D,y:k,size:N,rotation:M}){this._basicExtraRounded({x:D,y:k,size:N,rotation:M})}}const m={dot:"dot",square:"square"},g=Object.values(m);class y{constructor({svg:D,type:k,window:N}){this._svg=D,this._type=k,this._window=N}draw(D,k,N,M){let T;T=this._type===m.square?this._drawSquare:this._drawDot,T.call(this,{x:D,y:k,size:N,rotation:M})}_rotateFigure({x:D,y:k,size:N,rotation:M=0,draw:T}){var j;const $=D+N/2,z=k+N/2;T(),(j=this._element)===null||j===void 0||j.setAttribute("transform",`rotate(${180*M/Math.PI},${$},${z})`)}_basicDot(D){const{size:k,x:N,y:M}=D;this._rotateFigure(Object.assign(Object.assign({},D),{draw:()=>{this._element=this._window.document.createElementNS("http://www.w3.org/2000/svg","circle"),this._element.setAttribute("cx",String(N+k/2)),this._element.setAttribute("cy",String(M+k/2)),this._element.setAttribute("r",String(k/2))}}))}_basicSquare(D){const{size:k,x:N,y:M}=D;this._rotateFigure(Object.assign(Object.assign({},D),{draw:()=>{this._element=this._window.document.createElementNS("http://www.w3.org/2000/svg","rect"),this._element.setAttribute("x",String(N)),this._element.setAttribute("y",String(M)),this._element.setAttribute("width",String(k)),this._element.setAttribute("height",String(k))}}))}_drawDot({x:D,y:k,size:N,rotation:M}){this._basicDot({x:D,y:k,size:N,rotation:M})}_drawSquare({x:D,y:k,size:N,rotation:M}){this._basicSquare({x:D,y:k,size:N,rotation:M})}}const x="circle",v=[[1,1,1,1,1,1,1],[1,0,0,0,0,0,1],[1,0,0,0,0,0,1],[1,0,0,0,0,0,1],[1,0,0,0,0,0,1],[1,0,0,0,0,0,1],[1,1,1,1,1,1,1]],w=[[0,0,0,0,0,0,0],[0,0,0,0,0,0,0],[0,0,1,1,1,0,0],[0,0,1,1,1,0,0],[0,0,1,1,1,0,0],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0]];class _{constructor(D,k){this._roundSize=N=>this._options.dotsOptions.roundSize?Math.floor(N):N,this._window=k,this._element=this._window.document.createElementNS("http://www.w3.org/2000/svg","svg"),this._element.setAttribute("width",String(D.width)),this._element.setAttribute("height",String(D.height)),this._element.setAttribute("xmlns:xlink","http://www.w3.org/1999/xlink"),D.dotsOptions.roundSize||this._element.setAttribute("shape-rendering","crispEdges"),this._element.setAttribute("viewBox",`0 0 ${D.width} ${D.height}`),this._defs=this._window.document.createElementNS("http://www.w3.org/2000/svg","defs"),this._element.appendChild(this._defs),this._imageUri=D.image,this._instanceId=_.instanceCount++,this._options=D}get width(){return this._options.width}get height(){return this._options.height}getElement(){return this._element}async drawQR(D){const k=D.getModuleCount(),N=Math.min(this._options.width,this._options.height)-2*this._options.margin,M=this._options.shape===x?N/Math.sqrt(2):N,T=this._roundSize(M/k);let j={hideXDots:0,hideYDots:0,width:0,height:0};if(this._qr=D,this._options.image){if(await this.loadImage(),!this._image)return;const{imageOptions:$,qrOptions:z}=this._options,ee=$.imageSize*c[z.errorCorrectionLevel],X=Math.floor(ee*k*k);j=function({originalHeight:J,originalWidth:K,maxHiddenDots:ne,maxHiddenAxisDots:ie,dotSize:ae}){const W={x:0,y:0},H={x:0,y:0};if(J<=0||K<=0||ne<=0||ae<=0)return{height:0,width:0,hideYDots:0,hideXDots:0};const G=J/K;return W.x=Math.floor(Math.sqrt(ne/G)),W.x<=0&&(W.x=1),ie&&ie<W.x&&(W.x=ie),W.x%2==0&&W.x--,H.x=W.x*ae,W.y=1+2*Math.ceil((W.x*G-1)/2),H.y=Math.round(H.x*G),(W.y*W.x>ne||ie&&ie<W.y)&&(ie&&ie<W.y?(W.y=ie,W.y%2==0&&W.x--):W.y-=2,H.y=W.y*ae,W.x=1+2*Math.ceil((W.y/G-1)/2),H.x=Math.round(H.y/G)),{height:H.y,width:H.x,hideYDots:W.y,hideXDots:W.x}}({originalWidth:this._image.width,originalHeight:this._image.height,maxHiddenDots:X,maxHiddenAxisDots:k-14,dotSize:T})}this.drawBackground(),this.drawDots(($,z)=>{var ee,X,J,K,ne,ie;return!(this._options.imageOptions.hideBackgroundDots&&$>=(k-j.hideYDots)/2&&$<(k+j.hideYDots)/2&&z>=(k-j.hideXDots)/2&&z<(k+j.hideXDots)/2||!((ee=v[$])===null||ee===void 0)&&ee[z]||!((X=v[$-k+7])===null||X===void 0)&&X[z]||!((J=v[$])===null||J===void 0)&&J[z-k+7]||!((K=w[$])===null||K===void 0)&&K[z]||!((ne=w[$-k+7])===null||ne===void 0)&&ne[z]||!((ie=w[$])===null||ie===void 0)&&ie[z-k+7])}),this.drawCorners(),this._options.image&&await this.drawImage({width:j.width,height:j.height,count:k,dotSize:T})}drawBackground(){var D,k,N;const M=this._element,T=this._options;if(M){const j=(D=T.backgroundOptions)===null||D===void 0?void 0:D.gradient,$=(k=T.backgroundOptions)===null||k===void 0?void 0:k.color;let z=T.height,ee=T.width;if(j||$){const X=this._window.document.createElementNS("http://www.w3.org/2000/svg","rect");this._backgroundClipPath=this._window.document.createElementNS("http://www.w3.org/2000/svg","clipPath"),this._backgroundClipPath.setAttribute("id",`clip-path-background-color-${this._instanceId}`),this._defs.appendChild(this._backgroundClipPath),!((N=T.backgroundOptions)===null||N===void 0)&&N.round&&(z=ee=Math.min(T.width,T.height),X.setAttribute("rx",String(z/2*T.backgroundOptions.round))),X.setAttribute("x",String(this._roundSize((T.width-ee)/2))),X.setAttribute("y",String(this._roundSize((T.height-z)/2))),X.setAttribute("width",String(ee)),X.setAttribute("height",String(z)),this._backgroundClipPath.appendChild(X),this._createColor({options:j,color:$,additionalRotation:0,x:0,y:0,height:T.height,width:T.width,name:`background-color-${this._instanceId}`})}}}drawDots(D){var k,N;if(!this._qr)throw"QR code is not defined";const M=this._options,T=this._qr.getModuleCount();if(T>M.width||T>M.height)throw"The canvas is too small.";const j=Math.min(M.width,M.height)-2*M.margin,$=M.shape===x?j/Math.sqrt(2):j,z=this._roundSize($/T),ee=this._roundSize((M.width-T*z)/2),X=this._roundSize((M.height-T*z)/2),J=new u({svg:this._element,type:M.dotsOptions.type,window:this._window});this._dotsClipPath=this._window.document.createElementNS("http://www.w3.org/2000/svg","clipPath"),this._dotsClipPath.setAttribute("id",`clip-path-dot-color-${this._instanceId}`),this._defs.appendChild(this._dotsClipPath),this._createColor({options:(k=M.dotsOptions)===null||k===void 0?void 0:k.gradient,color:M.dotsOptions.color,additionalRotation:0,x:0,y:0,height:M.height,width:M.width,name:`dot-color-${this._instanceId}`});for(let K=0;K<T;K++)for(let ne=0;ne<T;ne++)D&&!D(K,ne)||!((N=this._qr)===null||N===void 0)&&N.isDark(K,ne)&&(J.draw(ee+ne*z,X+K*z,z,(ie,ae)=>!(ne+ie<0||K+ae<0||ne+ie>=T||K+ae>=T)&&!(D&&!D(K+ae,ne+ie))&&!!this._qr&&this._qr.isDark(K+ae,ne+ie)),J._element&&this._dotsClipPath&&this._dotsClipPath.appendChild(J._element));if(M.shape===x){const K=this._roundSize((j/z-T)/2),ne=T+2*K,ie=ee-K*z,ae=X-K*z,W=[],H=this._roundSize(ne/2);for(let G=0;G<ne;G++){W[G]=[];for(let Q=0;Q<ne;Q++)G>=K-1&&G<=ne-K&&Q>=K-1&&Q<=ne-K||Math.sqrt((G-H)*(G-H)+(Q-H)*(Q-H))>H?W[G][Q]=0:W[G][Q]=this._qr.isDark(Q-2*K<0?Q:Q>=T?Q-2*K:Q-K,G-2*K<0?G:G>=T?G-2*K:G-K)?1:0}for(let G=0;G<ne;G++)for(let Q=0;Q<ne;Q++)W[G][Q]&&(J.draw(ie+Q*z,ae+G*z,z,(te,he)=>{var xe;return!!(!((xe=W[G+he])===null||xe===void 0)&&xe[Q+te])}),J._element&&this._dotsClipPath&&this._dotsClipPath.appendChild(J._element))}}drawCorners(){if(!this._qr)throw"QR code is not defined";const D=this._element,k=this._options;if(!D)throw"Element code is not defined";const N=this._qr.getModuleCount(),M=Math.min(k.width,k.height)-2*k.margin,T=k.shape===x?M/Math.sqrt(2):M,j=this._roundSize(T/N),$=7*j,z=3*j,ee=this._roundSize((k.width-N*j)/2),X=this._roundSize((k.height-N*j)/2);[[0,0,0],[1,0,Math.PI/2],[0,1,-Math.PI/2]].forEach(([J,K,ne])=>{var ie,ae,W,H,G,Q,te,he,xe,fe,be,Pe,Se,Ye;const Ve=ee+J*j*(N-7),Ge=X+K*j*(N-7);let Re=this._dotsClipPath,ge=this._dotsClipPath;if((!((ie=k.cornersSquareOptions)===null||ie===void 0)&&ie.gradient||!((ae=k.cornersSquareOptions)===null||ae===void 0)&&ae.color)&&(Re=this._window.document.createElementNS("http://www.w3.org/2000/svg","clipPath"),Re.setAttribute("id",`clip-path-corners-square-color-${J}-${K}-${this._instanceId}`),this._defs.appendChild(Re),this._cornersSquareClipPath=this._cornersDotClipPath=ge=Re,this._createColor({options:(W=k.cornersSquareOptions)===null||W===void 0?void 0:W.gradient,color:(H=k.cornersSquareOptions)===null||H===void 0?void 0:H.color,additionalRotation:ne,x:Ve,y:Ge,height:$,width:$,name:`corners-square-color-${J}-${K}-${this._instanceId}`})),((G=k.cornersSquareOptions)===null||G===void 0?void 0:G.type)&&d.includes(k.cornersSquareOptions.type)){const et=new p({svg:this._element,type:k.cornersSquareOptions.type,window:this._window});et.draw(Ve,Ge,$,ne),et._element&&Re&&Re.appendChild(et._element)}else{const et=new u({svg:this._element,type:((Q=k.cornersSquareOptions)===null||Q===void 0?void 0:Q.type)||k.dotsOptions.type,window:this._window});for(let tt=0;tt<v.length;tt++)for(let ke=0;ke<v[tt].length;ke++)!((te=v[tt])===null||te===void 0)&&te[ke]&&(et.draw(Ve+ke*j,Ge+tt*j,j,(st,it)=>{var xt;return!!(!((xt=v[tt+it])===null||xt===void 0)&&xt[ke+st])}),et._element&&Re&&Re.appendChild(et._element))}if((!((he=k.cornersDotOptions)===null||he===void 0)&&he.gradient||!((xe=k.cornersDotOptions)===null||xe===void 0)&&xe.color)&&(ge=this._window.document.createElementNS("http://www.w3.org/2000/svg","clipPath"),ge.setAttribute("id",`clip-path-corners-dot-color-${J}-${K}-${this._instanceId}`),this._defs.appendChild(ge),this._cornersDotClipPath=ge,this._createColor({options:(fe=k.cornersDotOptions)===null||fe===void 0?void 0:fe.gradient,color:(be=k.cornersDotOptions)===null||be===void 0?void 0:be.color,additionalRotation:ne,x:Ve+2*j,y:Ge+2*j,height:z,width:z,name:`corners-dot-color-${J}-${K}-${this._instanceId}`})),((Pe=k.cornersDotOptions)===null||Pe===void 0?void 0:Pe.type)&&g.includes(k.cornersDotOptions.type)){const et=new y({svg:this._element,type:k.cornersDotOptions.type,window:this._window});et.draw(Ve+2*j,Ge+2*j,z,ne),et._element&&ge&&ge.appendChild(et._element)}else{const et=new u({svg:this._element,type:((Se=k.cornersDotOptions)===null||Se===void 0?void 0:Se.type)||k.dotsOptions.type,window:this._window});for(let tt=0;tt<w.length;tt++)for(let ke=0;ke<w[tt].length;ke++)!((Ye=w[tt])===null||Ye===void 0)&&Ye[ke]&&(et.draw(Ve+ke*j,Ge+tt*j,j,(st,it)=>{var xt;return!!(!((xt=w[tt+it])===null||xt===void 0)&&xt[ke+st])}),et._element&&ge&&ge.appendChild(et._element))}})}loadImage(){return new Promise((D,k)=>{var N;const M=this._options;if(!M.image)return k("Image is not defined");if(!((N=M.nodeCanvas)===null||N===void 0)&&N.loadImage)M.nodeCanvas.loadImage(M.image).then(T=>{var j,$;if(this._image=T,this._options.imageOptions.saveAsBlob){const z=(j=M.nodeCanvas)===null||j===void 0?void 0:j.createCanvas(this._image.width,this._image.height);($=z==null?void 0:z.getContext("2d"))===null||$===void 0||$.drawImage(T,0,0),this._imageUri=z==null?void 0:z.toDataURL()}D()}).catch(k);else{const T=new this._window.Image;typeof M.imageOptions.crossOrigin=="string"&&(T.crossOrigin=M.imageOptions.crossOrigin),this._image=T,T.onload=async()=>{this._options.imageOptions.saveAsBlob&&(this._imageUri=await async function(j,$){return new Promise(z=>{const ee=new $.XMLHttpRequest;ee.onload=function(){const X=new $.FileReader;X.onloadend=function(){z(X.result)},X.readAsDataURL(ee.response)},ee.open("GET",j),ee.responseType="blob",ee.send()})}(M.image||"",this._window)),D()},T.src=M.image}})}async drawImage({width:D,height:k,count:N,dotSize:M}){const T=this._options,j=this._roundSize((T.width-N*M)/2),$=this._roundSize((T.height-N*M)/2),z=j+this._roundSize(T.imageOptions.margin+(N*M-D)/2),ee=$+this._roundSize(T.imageOptions.margin+(N*M-k)/2),X=D-2*T.imageOptions.margin,J=k-2*T.imageOptions.margin,K=this._window.document.createElementNS("http://www.w3.org/2000/svg","image");K.setAttribute("href",this._imageUri||""),K.setAttribute("xlink:href",this._imageUri||""),K.setAttribute("x",String(z)),K.setAttribute("y",String(ee)),K.setAttribute("width",`${X}px`),K.setAttribute("height",`${J}px`),this._element.appendChild(K)}_createColor({options:D,color:k,additionalRotation:N,x:M,y:T,height:j,width:$,name:z}){const ee=$>j?$:j,X=this._window.document.createElementNS("http://www.w3.org/2000/svg","rect");if(X.setAttribute("x",String(M)),X.setAttribute("y",String(T)),X.setAttribute("height",String(j)),X.setAttribute("width",String($)),X.setAttribute("clip-path",`url('#clip-path-${z}')`),D){let J;if(D.type==="radial")J=this._window.document.createElementNS("http://www.w3.org/2000/svg","radialGradient"),J.setAttribute("id",z),J.setAttribute("gradientUnits","userSpaceOnUse"),J.setAttribute("fx",String(M+$/2)),J.setAttribute("fy",String(T+j/2)),J.setAttribute("cx",String(M+$/2)),J.setAttribute("cy",String(T+j/2)),J.setAttribute("r",String(ee/2));else{const K=((D.rotation||0)+N)%(2*Math.PI),ne=(K+2*Math.PI)%(2*Math.PI);let ie=M+$/2,ae=T+j/2,W=M+$/2,H=T+j/2;ne>=0&&ne<=.25*Math.PI||ne>1.75*Math.PI&&ne<=2*Math.PI?(ie-=$/2,ae-=j/2*Math.tan(K),W+=$/2,H+=j/2*Math.tan(K)):ne>.25*Math.PI&&ne<=.75*Math.PI?(ae-=j/2,ie-=$/2/Math.tan(K),H+=j/2,W+=$/2/Math.tan(K)):ne>.75*Math.PI&&ne<=1.25*Math.PI?(ie+=$/2,ae+=j/2*Math.tan(K),W-=$/2,H-=j/2*Math.tan(K)):ne>1.25*Math.PI&&ne<=1.75*Math.PI&&(ae+=j/2,ie+=$/2/Math.tan(K),H-=j/2,W-=$/2/Math.tan(K)),J=this._window.document.createElementNS("http://www.w3.org/2000/svg","linearGradient"),J.setAttribute("id",z),J.setAttribute("gradientUnits","userSpaceOnUse"),J.setAttribute("x1",String(Math.round(ie))),J.setAttribute("y1",String(Math.round(ae))),J.setAttribute("x2",String(Math.round(W))),J.setAttribute("y2",String(Math.round(H)))}D.colorStops.forEach(({offset:K,color:ne})=>{const ie=this._window.document.createElementNS("http://www.w3.org/2000/svg","stop");ie.setAttribute("offset",100*K+"%"),ie.setAttribute("stop-color",ne),J.appendChild(ie)}),X.setAttribute("fill",`url('#${z}')`),this._defs.appendChild(J)}else k&&X.setAttribute("fill",k);this._element.appendChild(X)}}_.instanceCount=0;const S=_,E="canvas",C={};for(let F=0;F<=40;F++)C[F]=F;const P={type:E,shape:"square",width:300,height:300,data:"",margin:0,qrOptions:{typeNumber:C[0],mode:void 0,errorCorrectionLevel:"Q"},imageOptions:{saveAsBlob:!0,hideBackgroundDots:!0,imageSize:.4,crossOrigin:void 0,margin:0},dotsOptions:{type:"square",color:"#000",roundSize:!0},backgroundOptions:{round:0,color:"#fff"}};function O(F){const D=Object.assign({},F);if(!D.colorStops||!D.colorStops.length)throw"Field 'colorStops' is required in gradient";return D.rotation?D.rotation=Number(D.rotation):D.rotation=0,D.colorStops=D.colorStops.map(k=>Object.assign(Object.assign({},k),{offset:Number(k.offset)})),D}function A(F){const D=Object.assign({},F);return D.width=Number(D.width),D.height=Number(D.height),D.margin=Number(D.margin),D.imageOptions=Object.assign(Object.assign({},D.imageOptions),{hideBackgroundDots:!!D.imageOptions.hideBackgroundDots,imageSize:Number(D.imageOptions.imageSize),margin:Number(D.imageOptions.margin)}),D.margin>Math.min(D.width,D.height)&&(D.margin=Math.min(D.width,D.height)),D.dotsOptions=Object.assign({},D.dotsOptions),D.dotsOptions.gradient&&(D.dotsOptions.gradient=O(D.dotsOptions.gradient)),D.cornersSquareOptions&&(D.cornersSquareOptions=Object.assign({},D.cornersSquareOptions),D.cornersSquareOptions.gradient&&(D.cornersSquareOptions.gradient=O(D.cornersSquareOptions.gradient))),D.cornersDotOptions&&(D.cornersDotOptions=Object.assign({},D.cornersDotOptions),D.cornersDotOptions.gradient&&(D.cornersDotOptions.gradient=O(D.cornersDotOptions.gradient))),D.backgroundOptions&&(D.backgroundOptions=Object.assign({},D.backgroundOptions),D.backgroundOptions.gradient&&(D.backgroundOptions.gradient=O(D.backgroundOptions.gradient))),D}var R=s(873),B=s.n(R);function I(F){if(!F)throw new Error("Extension must be defined");F[0]==="."&&(F=F.substring(1));const D={bmp:"image/bmp",gif:"image/gif",ico:"image/vnd.microsoft.icon",jpeg:"image/jpeg",jpg:"image/jpeg",png:"image/png",svg:"image/svg+xml",tif:"image/tiff",tiff:"image/tiff",webp:"image/webp",pdf:"application/pdf"}[F.toLowerCase()];if(!D)throw new Error(`Extension "${F}" is not supported`);return D}class L{constructor(D){D!=null&&D.jsdom?this._window=new D.jsdom("",{resources:"usable"}).window:this._window=window,this._options=D?A(a(P,D)):P,this.update()}static _clearContainer(D){D&&(D.innerHTML="")}_setupSvg(){if(!this._qr)return;const D=new S(this._options,this._window);this._svg=D.getElement(),this._svgDrawingPromise=D.drawQR(this._qr).then(()=>{var k;this._svg&&((k=this._extension)===null||k===void 0||k.call(this,D.getElement(),this._options))})}_setupCanvas(){var D,k;this._qr&&(!((D=this._options.nodeCanvas)===null||D===void 0)&&D.createCanvas?(this._nodeCanvas=this._options.nodeCanvas.createCanvas(this._options.width,this._options.height),this._nodeCanvas.width=this._options.width,this._nodeCanvas.height=this._options.height):(this._domCanvas=document.createElement("canvas"),this._domCanvas.width=this._options.width,this._domCanvas.height=this._options.height),this._setupSvg(),this._canvasDrawingPromise=(k=this._svgDrawingPromise)===null||k===void 0?void 0:k.then(()=>{var N;if(!this._svg)return;const M=this._svg,T=new this._window.XMLSerializer().serializeToString(M),j=btoa(T),$=`data:${I("svg")};base64,${j}`;if(!((N=this._options.nodeCanvas)===null||N===void 0)&&N.loadImage)return this._options.nodeCanvas.loadImage($).then(z=>{var ee,X;z.width=this._options.width,z.height=this._options.height,(X=(ee=this._nodeCanvas)===null||ee===void 0?void 0:ee.getContext("2d"))===null||X===void 0||X.drawImage(z,0,0)});{const z=new this._window.Image;return new Promise(ee=>{z.onload=()=>{var X,J;(J=(X=this._domCanvas)===null||X===void 0?void 0:X.getContext("2d"))===null||J===void 0||J.drawImage(z,0,0),ee()},z.src=$})}}))}async _getElement(D="png"){if(!this._qr)throw"QR code is empty";return D.toLowerCase()==="svg"?(this._svg&&this._svgDrawingPromise||this._setupSvg(),await this._svgDrawingPromise,this._svg):((this._domCanvas||this._nodeCanvas)&&this._canvasDrawingPromise||this._setupCanvas(),await this._canvasDrawingPromise,this._domCanvas||this._nodeCanvas)}update(D){L._clearContainer(this._container),this._options=D?A(a(this._options,D)):this._options,this._options.data&&(this._qr=B()(this._options.qrOptions.typeNumber,this._options.qrOptions.errorCorrectionLevel),this._qr.addData(this._options.data,this._options.qrOptions.mode||function(k){switch(!0){case/^[0-9]*$/.test(k):return"Numeric";case/^[0-9A-Z $%*+\-./:]*$/.test(k):return"Alphanumeric";default:return"Byte"}}(this._options.data)),this._qr.make(),this._options.type===E?this._setupCanvas():this._setupSvg(),this.append(this._container))}append(D){if(D){if(typeof D.appendChild!="function")throw"Container should be a single DOM node";this._options.type===E?this._domCanvas&&D.appendChild(this._domCanvas):this._svg&&D.appendChild(this._svg),this._container=D}}applyExtension(D){if(!D)throw"Extension function should be defined.";this._extension=D,this.update()}deleteExtension(){this._extension=void 0,this.update()}async getRawData(D="png"){if(!this._qr)throw"QR code is empty";const k=await this._getElement(D),N=I(D);if(!k)return null;if(D.toLowerCase()==="svg"){const M=`<?xml version="1.0" standalone="no"?>\r
${new this._window.XMLSerializer().serializeToString(k)}`;return typeof Blob>"u"||this._options.jsdom?Buffer.from(M):new Blob([M],{type:N})}return new Promise(M=>{const T=k;if("toBuffer"in T)if(N==="image/png")M(T.toBuffer(N));else if(N==="image/jpeg")M(T.toBuffer(N));else{if(N!=="application/pdf")throw Error("Unsupported extension");M(T.toBuffer(N))}else"toBlob"in T&&T.toBlob(M,N,1)})}async download(D){if(!this._qr)throw"QR code is empty";if(typeof Blob>"u")throw"Cannot download in Node.js, call getRawData instead.";let k="png",N="qr";typeof D=="string"?(k=D,console.warn("Extension is deprecated as argument for 'download' method, please pass object { name: '...', extension: '...' } as argument")):typeof D=="object"&&D!==null&&(D.name&&(N=D.name),D.extension&&(k=D.extension));const M=await this._getElement(k);if(M)if(k.toLowerCase()==="svg"){let T=new XMLSerializer().serializeToString(M);T=`<?xml version="1.0" standalone="no"?>\r
`+T,l(`data:${I(k)};charset=utf-8,${encodeURIComponent(T)}`,`${N}.svg`)}else l(M.toDataURL(I(k)),`${N}.${k}`)}}const U=L})(),i.default})())})(pR);var VJ=pR.exports;const GJ=Ap(VJ),ib=({eventCode:n,eventName:e,passcode:t,customQRCodeUrl:r})=>{const s=b.useRef(null),[i]=b.useState(()=>new GJ({width:240,height:240,type:"svg",data:`https://photo-share.app/join/${n}${t?`?passcode=${t}`:""}`,image:r||"/favicon.ico",dotsOptions:{color:"hsl(217, 91%, 60%)",type:"rounded"},backgroundOptions:{color:"hsl(240, 10%, 3.9%)"},imageOptions:{crossOrigin:"anonymous",margin:5},cornersSquareOptions:{color:"hsl(330, 85%, 60%)",type:"extra-rounded"},cornersDotOptions:{color:"hsl(270, 95%, 75%)",type:"dot"}})),{toast:o}=Bt();b.useEffect(()=>{s.current&&i.append(s.current)},[i]),b.useEffect(()=>{i.update({image:r||"/favicon.ico"})},[r,i]);const a=()=>{i.download({name:`${n}-qr-code`,extension:"png"}),o({title:"QR Code Downloaded",description:"The QR code has been saved to your device."})},l=async()=>{const u=`https://photo-share.app/join/${n}${t?`?passcode=${t}`:""}`;try{await navigator.clipboard.writeText(u),o({title:"Link Copied",description:"Event link copied to clipboard!"})}catch(h){console.error("Copy failed:",h),o({title:"Copy Failed",description:"Unable to copy link. Please copy manually.",variant:"destructive"})}},c=async()=>{const u={title:`Join ${e}`,text:`You're invited to share photos at ${e}! Use code: ${n}${t?` | Passcode: ${t}`:""}`,url:`https://photo-share.app/join/${n}${t?`?passcode=${t}`:""}`};try{navigator.share?await navigator.share(u):await l()}catch(h){console.error("Share failed:",h)}};return f.jsxs("div",{className:"space-y-6 py-6 px-4",children:[f.jsx("div",{className:"flex flex-col items-center justify-center p-6 bg-muted/30 rounded-lg",children:f.jsx("div",{className:"p-3 bg-background rounded-lg shadow-sm border border-primary/20",children:f.jsx("div",{ref:s,className:"w-[240px] h-[240px]"})})}),f.jsx("div",{className:"space-y-2",children:f.jsx("h3",{className:"text-lg font-semibold text-center",children:e})}),f.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[f.jsxs(_e,{variant:"outline",className:"w-full",size:"sm",onClick:l,children:[f.jsx(EL,{className:"h-4 w-4 mr-1"}),"Copy"]}),f.jsxs(_e,{variant:"outline",className:"w-full",size:"sm",onClick:a,children:[f.jsx(Gl,{className:"h-4 w-4 mr-1"}),"Download"]}),f.jsxs(_e,{variant:"outline",className:"w-full",size:"sm",onClick:c,children:[f.jsx(Cw,{className:"h-4 w-4 mr-1"}),"Share"]})]})]})},zee=Object.freeze(Object.defineProperty({__proto__:null,default:ib},Symbol.toStringTag,{value:"Module"}));function x2(n,[e,t]){return Math.min(t,Math.max(e,n))}var qJ=[" ","Enter","ArrowUp","ArrowDown"],YJ=[" ","Enter"],Fd="Select",[z0,W0,XJ]=yw(Fd),[Pc,Wee]=xo(Fd,[XJ,Zp]),H0=Zp(),[KJ,Po]=Pc(Fd),[JJ,QJ]=Pc(Fd),gR=n=>{const{__scopeSelect:e,children:t,open:r,defaultOpen:s,onOpenChange:i,value:o,defaultValue:a,onValueChange:l,dir:c,name:u,autoComplete:h,disabled:d,required:p,form:m}=n,g=H0(e),[y,x]=b.useState(null),[v,w]=b.useState(null),[_,S]=b.useState(!1),E=c1(c),[C=!1,P]=ti({prop:r,defaultProp:s,onChange:i}),[O,A]=ti({prop:o,defaultProp:a,onChange:l}),R=b.useRef(null),B=y?m||!!y.closest("form"):!0,[I,L]=b.useState(new Set),U=Array.from(I).map(F=>F.props.value).join(";");return f.jsx(lF,{...g,children:f.jsxs(KJ,{required:p,scope:e,trigger:y,onTriggerChange:x,valueNode:v,onValueNodeChange:w,valueNodeHasChildren:_,onValueNodeHasChildrenChange:S,contentId:Hs(),value:O,onValueChange:A,open:C,onOpenChange:P,dir:E,triggerPointerDownPosRef:R,disabled:d,children:[f.jsx(z0.Provider,{scope:e,children:f.jsx(JJ,{scope:n.__scopeSelect,onNativeOptionAdd:b.useCallback(F=>{L(D=>new Set(D).add(F))},[]),onNativeOptionRemove:b.useCallback(F=>{L(D=>{const k=new Set(D);return k.delete(F),k})},[]),children:t})}),B?f.jsxs(UR,{"aria-hidden":!0,required:p,tabIndex:-1,name:u,autoComplete:h,value:O,onChange:F=>A(F.target.value),disabled:d,form:m,children:[O===void 0?f.jsx("option",{value:""}):null,Array.from(I)]},U):null]})})};gR.displayName=Fd;var mR="SelectTrigger",vR=b.forwardRef((n,e)=>{const{__scopeSelect:t,disabled:r=!1,...s}=n,i=H0(t),o=Po(mR,t),a=o.disabled||r,l=ct(e,o.onTriggerChange),c=W0(t),u=b.useRef("touch"),[h,d,p]=$R(g=>{const y=c().filter(w=>!w.disabled),x=y.find(w=>w.value===o.value),v=zR(y,g,x);v!==void 0&&o.onValueChange(v.value)}),m=g=>{a||(o.onOpenChange(!0),p()),g&&(o.triggerPointerDownPosRef.current={x:Math.round(g.pageX),y:Math.round(g.pageY)})};return f.jsx(gA,{asChild:!0,...i,children:f.jsx(Le.button,{type:"button",role:"combobox","aria-controls":o.contentId,"aria-expanded":o.open,"aria-required":o.required,"aria-autocomplete":"none",dir:o.dir,"data-state":o.open?"open":"closed",disabled:a,"data-disabled":a?"":void 0,"data-placeholder":BR(o.value)?"":void 0,...s,ref:l,onClick:De(s.onClick,g=>{g.currentTarget.focus(),u.current!=="mouse"&&m(g)}),onPointerDown:De(s.onPointerDown,g=>{u.current=g.pointerType;const y=g.target;y.hasPointerCapture(g.pointerId)&&y.releasePointerCapture(g.pointerId),g.button===0&&g.ctrlKey===!1&&g.pointerType==="mouse"&&(m(g),g.preventDefault())}),onKeyDown:De(s.onKeyDown,g=>{const y=h.current!=="";!(g.ctrlKey||g.altKey||g.metaKey)&&g.key.length===1&&d(g.key),!(y&&g.key===" ")&&qJ.includes(g.key)&&(m(),g.preventDefault())})})})});vR.displayName=mR;var yR="SelectValue",xR=b.forwardRef((n,e)=>{const{__scopeSelect:t,className:r,style:s,children:i,placeholder:o="",...a}=n,l=Po(yR,t),{onValueNodeHasChildrenChange:c}=l,u=i!==void 0,h=ct(e,l.onValueNodeChange);return vn(()=>{c(u)},[c,u]),f.jsx(Le.span,{...a,ref:h,style:{pointerEvents:"none"},children:BR(l.value)?f.jsx(f.Fragment,{children:o}):i})});xR.displayName=yR;var ZJ="SelectIcon",wR=b.forwardRef((n,e)=>{const{__scopeSelect:t,children:r,...s}=n;return f.jsx(Le.span,{"aria-hidden":!0,...s,ref:e,children:r||""})});wR.displayName=ZJ;var eQ="SelectPortal",bR=n=>f.jsx(Gp,{asChild:!0,...n});bR.displayName=eQ;var ya="SelectContent",_R=b.forwardRef((n,e)=>{const t=Po(ya,n.__scopeSelect),[r,s]=b.useState();if(vn(()=>{s(new DocumentFragment)},[]),!t.open){const i=r;return i?ba.createPortal(f.jsx(SR,{scope:n.__scopeSelect,children:f.jsx(z0.Slot,{scope:n.__scopeSelect,children:f.jsx("div",{children:n.children})})}),i):null}return f.jsx(CR,{...n,ref:e})});_R.displayName=ya;var Lr=10,[SR,To]=Pc(ya),tQ="SelectContentImpl",CR=b.forwardRef((n,e)=>{const{__scopeSelect:t,position:r="item-aligned",onCloseAutoFocus:s,onEscapeKeyDown:i,onPointerDownOutside:o,side:a,sideOffset:l,align:c,alignOffset:u,arrowPadding:h,collisionBoundary:d,collisionPadding:p,sticky:m,hideWhenDetached:g,avoidCollisions:y,...x}=n,v=Po(ya,t),[w,_]=b.useState(null),[S,E]=b.useState(null),C=ct(e,J=>_(J)),[P,O]=b.useState(null),[A,R]=b.useState(null),B=W0(t),[I,L]=b.useState(!1),U=b.useRef(!1);b.useEffect(()=>{if(w)return iI(w)},[w]),KO();const F=b.useCallback(J=>{const[K,...ne]=B().map(W=>W.ref.current),[ie]=ne.slice(-1),ae=document.activeElement;for(const W of J)if(W===ae||(W==null||W.scrollIntoView({block:"nearest"}),W===K&&S&&(S.scrollTop=0),W===ie&&S&&(S.scrollTop=S.scrollHeight),W==null||W.focus(),document.activeElement!==ae))return},[B,S]),D=b.useCallback(()=>F([P,w]),[F,P,w]);b.useEffect(()=>{I&&D()},[I,D]);const{onOpenChange:k,triggerPointerDownPosRef:N}=v;b.useEffect(()=>{if(w){let J={x:0,y:0};const K=ie=>{var ae,W;J={x:Math.abs(Math.round(ie.pageX)-(((ae=N.current)==null?void 0:ae.x)??0)),y:Math.abs(Math.round(ie.pageY)-(((W=N.current)==null?void 0:W.y)??0))}},ne=ie=>{J.x<=10&&J.y<=10?ie.preventDefault():w.contains(ie.target)||k(!1),document.removeEventListener("pointermove",K),N.current=null};return N.current!==null&&(document.addEventListener("pointermove",K),document.addEventListener("pointerup",ne,{capture:!0,once:!0})),()=>{document.removeEventListener("pointermove",K),document.removeEventListener("pointerup",ne,{capture:!0})}}},[w,k,N]),b.useEffect(()=>{const J=()=>k(!1);return window.addEventListener("blur",J),window.addEventListener("resize",J),()=>{window.removeEventListener("blur",J),window.removeEventListener("resize",J)}},[k]);const[M,T]=$R(J=>{const K=B().filter(ae=>!ae.disabled),ne=K.find(ae=>ae.ref.current===document.activeElement),ie=zR(K,J,ne);ie&&setTimeout(()=>ie.ref.current.focus())}),j=b.useCallback((J,K,ne)=>{const ie=!U.current&&!ne;(v.value!==void 0&&v.value===K||ie)&&(O(J),ie&&(U.current=!0))},[v.value]),$=b.useCallback(()=>w==null?void 0:w.focus(),[w]),z=b.useCallback((J,K,ne)=>{const ie=!U.current&&!ne;(v.value!==void 0&&v.value===K||ie)&&R(J)},[v.value]),ee=r==="popper"?mx:ER,X=ee===mx?{side:a,sideOffset:l,align:c,alignOffset:u,arrowPadding:h,collisionBoundary:d,collisionPadding:p,sticky:m,hideWhenDetached:g,avoidCollisions:y}:{};return f.jsx(SR,{scope:t,content:w,viewport:S,onViewportChange:E,itemRefCallback:j,selectedItem:P,onItemLeave:$,itemTextRefCallback:z,focusSelectedItem:D,selectedItemText:A,position:r,isPositioned:I,searchRef:M,children:f.jsx(L1,{as:ua,allowPinchZoom:!0,children:f.jsx(j1,{asChild:!0,trapped:v.open,onMountAutoFocus:J=>{J.preventDefault()},onUnmountAutoFocus:De(s,J=>{var K;(K=v.trigger)==null||K.focus({preventScroll:!0}),J.preventDefault()}),children:f.jsx(yd,{asChild:!0,disableOutsidePointerEvents:!0,onEscapeKeyDown:i,onPointerDownOutside:o,onFocusOutside:J=>J.preventDefault(),onDismiss:()=>v.onOpenChange(!1),children:f.jsx(ee,{role:"listbox",id:v.contentId,"data-state":v.open?"open":"closed",dir:v.dir,onContextMenu:J=>J.preventDefault(),...x,...X,onPlaced:()=>L(!0),ref:C,style:{display:"flex",flexDirection:"column",outline:"none",...x.style},onKeyDown:De(x.onKeyDown,J=>{const K=J.ctrlKey||J.altKey||J.metaKey;if(J.key==="Tab"&&J.preventDefault(),!K&&J.key.length===1&&T(J.key),["ArrowUp","ArrowDown","Home","End"].includes(J.key)){let ie=B().filter(ae=>!ae.disabled).map(ae=>ae.ref.current);if(["ArrowUp","End"].includes(J.key)&&(ie=ie.slice().reverse()),["ArrowUp","ArrowDown"].includes(J.key)){const ae=J.target,W=ie.indexOf(ae);ie=ie.slice(W+1)}setTimeout(()=>F(ie)),J.preventDefault()}})})})})})})});CR.displayName=tQ;var nQ="SelectItemAlignedPosition",ER=b.forwardRef((n,e)=>{const{__scopeSelect:t,onPlaced:r,...s}=n,i=Po(ya,t),o=To(ya,t),[a,l]=b.useState(null),[c,u]=b.useState(null),h=ct(e,C=>u(C)),d=W0(t),p=b.useRef(!1),m=b.useRef(!0),{viewport:g,selectedItem:y,selectedItemText:x,focusSelectedItem:v}=o,w=b.useCallback(()=>{if(i.trigger&&i.valueNode&&a&&c&&g&&y&&x){const C=i.trigger.getBoundingClientRect(),P=c.getBoundingClientRect(),O=i.valueNode.getBoundingClientRect(),A=x.getBoundingClientRect();if(i.dir!=="rtl"){const ae=A.left-P.left,W=O.left-ae,H=C.left-W,G=C.width+H,Q=Math.max(G,P.width),te=window.innerWidth-Lr,he=x2(W,[Lr,Math.max(Lr,te-Q)]);a.style.minWidth=G+"px",a.style.left=he+"px"}else{const ae=P.right-A.right,W=window.innerWidth-O.right-ae,H=window.innerWidth-C.right-W,G=C.width+H,Q=Math.max(G,P.width),te=window.innerWidth-Lr,he=x2(W,[Lr,Math.max(Lr,te-Q)]);a.style.minWidth=G+"px",a.style.right=he+"px"}const R=d(),B=window.innerHeight-Lr*2,I=g.scrollHeight,L=window.getComputedStyle(c),U=parseInt(L.borderTopWidth,10),F=parseInt(L.paddingTop,10),D=parseInt(L.borderBottomWidth,10),k=parseInt(L.paddingBottom,10),N=U+F+I+k+D,M=Math.min(y.offsetHeight*5,N),T=window.getComputedStyle(g),j=parseInt(T.paddingTop,10),$=parseInt(T.paddingBottom,10),z=C.top+C.height/2-Lr,ee=B-z,X=y.offsetHeight/2,J=y.offsetTop+X,K=U+F+J,ne=N-K;if(K<=z){const ae=R.length>0&&y===R[R.length-1].ref.current;a.style.bottom="0px";const W=c.clientHeight-g.offsetTop-g.offsetHeight,H=Math.max(ee,X+(ae?$:0)+W+D),G=K+H;a.style.height=G+"px"}else{const ae=R.length>0&&y===R[0].ref.current;a.style.top="0px";const H=Math.max(z,U+g.offsetTop+(ae?j:0)+X)+ne;a.style.height=H+"px",g.scrollTop=K-z+g.offsetTop}a.style.margin=`${Lr}px 0`,a.style.minHeight=M+"px",a.style.maxHeight=B+"px",r==null||r(),requestAnimationFrame(()=>p.current=!0)}},[d,i.trigger,i.valueNode,a,c,g,y,x,i.dir,r]);vn(()=>w(),[w]);const[_,S]=b.useState();vn(()=>{c&&S(window.getComputedStyle(c).zIndex)},[c]);const E=b.useCallback(C=>{C&&m.current===!0&&(w(),v==null||v(),m.current=!1)},[w,v]);return f.jsx(sQ,{scope:t,contentWrapper:a,shouldExpandOnScrollRef:p,onScrollButtonChange:E,children:f.jsx("div",{ref:l,style:{display:"flex",flexDirection:"column",position:"fixed",zIndex:_},children:f.jsx(Le.div,{...s,ref:h,style:{boxSizing:"border-box",maxHeight:"100%",...s.style}})})})});ER.displayName=nQ;var rQ="SelectPopperPosition",mx=b.forwardRef((n,e)=>{const{__scopeSelect:t,align:r="start",collisionPadding:s=Lr,...i}=n,o=H0(t);return f.jsx(mA,{...o,...i,ref:e,align:r,collisionPadding:s,style:{boxSizing:"border-box",...i.style,"--radix-select-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-select-content-available-width":"var(--radix-popper-available-width)","--radix-select-content-available-height":"var(--radix-popper-available-height)","--radix-select-trigger-width":"var(--radix-popper-anchor-width)","--radix-select-trigger-height":"var(--radix-popper-anchor-height)"}})});mx.displayName=rQ;var[sQ,ob]=Pc(ya,{}),vx="SelectViewport",kR=b.forwardRef((n,e)=>{const{__scopeSelect:t,nonce:r,...s}=n,i=To(vx,t),o=ob(vx,t),a=ct(e,i.onViewportChange),l=b.useRef(0);return f.jsxs(f.Fragment,{children:[f.jsx("style",{dangerouslySetInnerHTML:{__html:"[data-radix-select-viewport]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}[data-radix-select-viewport]::-webkit-scrollbar{display:none}"},nonce:r}),f.jsx(z0.Slot,{scope:t,children:f.jsx(Le.div,{"data-radix-select-viewport":"",role:"presentation",...s,ref:a,style:{position:"relative",flex:1,overflow:"hidden auto",...s.style},onScroll:De(s.onScroll,c=>{const u=c.currentTarget,{contentWrapper:h,shouldExpandOnScrollRef:d}=o;if(d!=null&&d.current&&h){const p=Math.abs(l.current-u.scrollTop);if(p>0){const m=window.innerHeight-Lr*2,g=parseFloat(h.style.minHeight),y=parseFloat(h.style.height),x=Math.max(g,y);if(x<m){const v=x+p,w=Math.min(m,v),_=v-w;h.style.height=w+"px",h.style.bottom==="0px"&&(u.scrollTop=_>0?_:0,h.style.justifyContent="flex-end")}}}l.current=u.scrollTop})})})]})});kR.displayName=vx;var PR="SelectGroup",[iQ,oQ]=Pc(PR),aQ=b.forwardRef((n,e)=>{const{__scopeSelect:t,...r}=n,s=Hs();return f.jsx(iQ,{scope:t,id:s,children:f.jsx(Le.div,{role:"group","aria-labelledby":s,...r,ref:e})})});aQ.displayName=PR;var TR="SelectLabel",AR=b.forwardRef((n,e)=>{const{__scopeSelect:t,...r}=n,s=oQ(TR,t);return f.jsx(Le.div,{id:s.id,...r,ref:e})});AR.displayName=TR;var Pp="SelectItem",[lQ,DR]=Pc(Pp),OR=b.forwardRef((n,e)=>{const{__scopeSelect:t,value:r,disabled:s=!1,textValue:i,...o}=n,a=Po(Pp,t),l=To(Pp,t),c=a.value===r,[u,h]=b.useState(i??""),[d,p]=b.useState(!1),m=ct(e,v=>{var w;return(w=l.itemRefCallback)==null?void 0:w.call(l,v,r,s)}),g=Hs(),y=b.useRef("touch"),x=()=>{s||(a.onValueChange(r),a.onOpenChange(!1))};if(r==="")throw new Error("A <Select.Item /> must have a value prop that is not an empty string. This is because the Select value can be set to an empty string to clear the selection and show the placeholder.");return f.jsx(lQ,{scope:t,value:r,disabled:s,textId:g,isSelected:c,onItemTextChange:b.useCallback(v=>{h(w=>w||((v==null?void 0:v.textContent)??"").trim())},[]),children:f.jsx(z0.ItemSlot,{scope:t,value:r,disabled:s,textValue:u,children:f.jsx(Le.div,{role:"option","aria-labelledby":g,"data-highlighted":d?"":void 0,"aria-selected":c&&d,"data-state":c?"checked":"unchecked","aria-disabled":s||void 0,"data-disabled":s?"":void 0,tabIndex:s?void 0:-1,...o,ref:m,onFocus:De(o.onFocus,()=>p(!0)),onBlur:De(o.onBlur,()=>p(!1)),onClick:De(o.onClick,()=>{y.current!=="mouse"&&x()}),onPointerUp:De(o.onPointerUp,()=>{y.current==="mouse"&&x()}),onPointerDown:De(o.onPointerDown,v=>{y.current=v.pointerType}),onPointerMove:De(o.onPointerMove,v=>{var w;y.current=v.pointerType,s?(w=l.onItemLeave)==null||w.call(l):y.current==="mouse"&&v.currentTarget.focus({preventScroll:!0})}),onPointerLeave:De(o.onPointerLeave,v=>{var w;v.currentTarget===document.activeElement&&((w=l.onItemLeave)==null||w.call(l))}),onKeyDown:De(o.onKeyDown,v=>{var _;((_=l.searchRef)==null?void 0:_.current)!==""&&v.key===" "||(YJ.includes(v.key)&&x(),v.key===" "&&v.preventDefault())})})})})});OR.displayName=Pp;var su="SelectItemText",IR=b.forwardRef((n,e)=>{const{__scopeSelect:t,className:r,style:s,...i}=n,o=Po(su,t),a=To(su,t),l=DR(su,t),c=QJ(su,t),[u,h]=b.useState(null),d=ct(e,x=>h(x),l.onItemTextChange,x=>{var v;return(v=a.itemTextRefCallback)==null?void 0:v.call(a,x,l.value,l.disabled)}),p=u==null?void 0:u.textContent,m=b.useMemo(()=>f.jsx("option",{value:l.value,disabled:l.disabled,children:p},l.value),[l.disabled,l.value,p]),{onNativeOptionAdd:g,onNativeOptionRemove:y}=c;return vn(()=>(g(m),()=>y(m)),[g,y,m]),f.jsxs(f.Fragment,{children:[f.jsx(Le.span,{id:l.textId,...i,ref:d}),l.isSelected&&o.valueNode&&!o.valueNodeHasChildren?ba.createPortal(i.children,o.valueNode):null]})});IR.displayName=su;var RR="SelectItemIndicator",NR=b.forwardRef((n,e)=>{const{__scopeSelect:t,...r}=n;return DR(RR,t).isSelected?f.jsx(Le.span,{"aria-hidden":!0,...r,ref:e}):null});NR.displayName=RR;var yx="SelectScrollUpButton",jR=b.forwardRef((n,e)=>{const t=To(yx,n.__scopeSelect),r=ob(yx,n.__scopeSelect),[s,i]=b.useState(!1),o=ct(e,r.onScrollButtonChange);return vn(()=>{if(t.viewport&&t.isPositioned){let a=function(){const c=l.scrollTop>0;i(c)};const l=t.viewport;return a(),l.addEventListener("scroll",a),()=>l.removeEventListener("scroll",a)}},[t.viewport,t.isPositioned]),s?f.jsx(MR,{...n,ref:o,onAutoScroll:()=>{const{viewport:a,selectedItem:l}=t;a&&l&&(a.scrollTop=a.scrollTop-l.offsetHeight)}}):null});jR.displayName=yx;var xx="SelectScrollDownButton",LR=b.forwardRef((n,e)=>{const t=To(xx,n.__scopeSelect),r=ob(xx,n.__scopeSelect),[s,i]=b.useState(!1),o=ct(e,r.onScrollButtonChange);return vn(()=>{if(t.viewport&&t.isPositioned){let a=function(){const c=l.scrollHeight-l.clientHeight,u=Math.ceil(l.scrollTop)<c;i(u)};const l=t.viewport;return a(),l.addEventListener("scroll",a),()=>l.removeEventListener("scroll",a)}},[t.viewport,t.isPositioned]),s?f.jsx(MR,{...n,ref:o,onAutoScroll:()=>{const{viewport:a,selectedItem:l}=t;a&&l&&(a.scrollTop=a.scrollTop+l.offsetHeight)}}):null});LR.displayName=xx;var MR=b.forwardRef((n,e)=>{const{__scopeSelect:t,onAutoScroll:r,...s}=n,i=To("SelectScrollButton",t),o=b.useRef(null),a=W0(t),l=b.useCallback(()=>{o.current!==null&&(window.clearInterval(o.current),o.current=null)},[]);return b.useEffect(()=>()=>l(),[l]),vn(()=>{var u;const c=a().find(h=>h.ref.current===document.activeElement);(u=c==null?void 0:c.ref.current)==null||u.scrollIntoView({block:"nearest"})},[a]),f.jsx(Le.div,{"aria-hidden":!0,...s,ref:e,style:{flexShrink:0,...s.style},onPointerDown:De(s.onPointerDown,()=>{o.current===null&&(o.current=window.setInterval(r,50))}),onPointerMove:De(s.onPointerMove,()=>{var c;(c=i.onItemLeave)==null||c.call(i),o.current===null&&(o.current=window.setInterval(r,50))}),onPointerLeave:De(s.onPointerLeave,()=>{l()})})}),cQ="SelectSeparator",FR=b.forwardRef((n,e)=>{const{__scopeSelect:t,...r}=n;return f.jsx(Le.div,{"aria-hidden":!0,...r,ref:e})});FR.displayName=cQ;var wx="SelectArrow",uQ=b.forwardRef((n,e)=>{const{__scopeSelect:t,...r}=n,s=H0(t),i=Po(wx,t),o=To(wx,t);return i.open&&o.position==="popper"?f.jsx(vA,{...s,...r,ref:e}):null});uQ.displayName=wx;function BR(n){return n===""||n===void 0}var UR=b.forwardRef((n,e)=>{const{value:t,...r}=n,s=b.useRef(null),i=ct(e,s),o=CI(t);return b.useEffect(()=>{const a=s.current,l=window.HTMLSelectElement.prototype,u=Object.getOwnPropertyDescriptor(l,"value").set;if(o!==t&&u){const h=new Event("change",{bubbles:!0});u.call(a,t),a.dispatchEvent(h)}},[o,t]),f.jsx(xd,{asChild:!0,children:f.jsx("select",{...r,ref:i,defaultValue:t})})});UR.displayName="BubbleSelect";function $R(n){const e=tr(n),t=b.useRef(""),r=b.useRef(0),s=b.useCallback(o=>{const a=t.current+o;e(a),function l(c){t.current=c,window.clearTimeout(r.current),c!==""&&(r.current=window.setTimeout(()=>l(""),1e3))}(a)},[e]),i=b.useCallback(()=>{t.current="",window.clearTimeout(r.current)},[]);return b.useEffect(()=>()=>window.clearTimeout(r.current),[]),[t,s,i]}function zR(n,e,t){const s=e.length>1&&Array.from(e).every(c=>c===e[0])?e[0]:e,i=t?n.indexOf(t):-1;let o=dQ(n,Math.max(i,0));s.length===1&&(o=o.filter(c=>c!==t));const l=o.find(c=>c.textValue.toLowerCase().startsWith(s.toLowerCase()));return l!==t?l:void 0}function dQ(n,e){return n.map((t,r)=>n[(e+r)%n.length])}var hQ=gR,WR=vR,fQ=xR,pQ=wR,gQ=bR,HR=_R,mQ=kR,VR=AR,GR=OR,vQ=IR,yQ=NR,qR=jR,YR=LR,XR=FR;const KR=hQ,JR=fQ,ab=b.forwardRef(({className:n,children:e,...t},r)=>f.jsxs(WR,{ref:r,className:Oe("flex h-12 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",n),...t,children:[e,f.jsx(pQ,{asChild:!0,children:f.jsx(Hu,{className:"h-4 w-4 opacity-50"})})]}));ab.displayName=WR.displayName;const QR=b.forwardRef(({className:n,...e},t)=>f.jsx(qR,{ref:t,className:Oe("flex cursor-default items-center justify-center py-3",n),...e,children:f.jsx(CL,{className:"h-4 w-4"})}));QR.displayName=qR.displayName;const ZR=b.forwardRef(({className:n,...e},t)=>f.jsx(YR,{ref:t,className:Oe("flex cursor-default items-center justify-center py-3",n),...e,children:f.jsx(Hu,{className:"h-4 w-4"})}));ZR.displayName=YR.displayName;const lb=b.forwardRef(({className:n,children:e,position:t="popper",...r},s)=>f.jsx(gQ,{children:f.jsxs(HR,{ref:s,className:Oe("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",t==="popper"&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",n),position:t,...r,children:[f.jsx(QR,{}),f.jsx(mQ,{className:Oe("p-1",t==="popper"&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:e}),f.jsx(ZR,{})]})}));lb.displayName=HR.displayName;const xQ=b.forwardRef(({className:n,...e},t)=>f.jsx(VR,{ref:t,className:Oe("py-3 pl-8 pr-2 text-sm font-semibold",n),...e}));xQ.displayName=VR.displayName;const Gr=b.forwardRef(({className:n,children:e,...t},r)=>f.jsxs(GR,{ref:r,className:Oe("relative flex w-full cursor-default select-none items-center rounded-sm py-3 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50 min-h-12",n),...t,children:[f.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:f.jsx(yQ,{children:f.jsx(bL,{className:"h-4 w-4"})})}),f.jsx(vQ,{children:e})]}));Gr.displayName=GR.displayName;const wQ=b.forwardRef(({className:n,...e},t)=>f.jsx(XR,{ref:t,className:Oe("-mx-1 my-1 h-px bg-muted",n),...e}));wQ.displayName=XR.displayName;const bQ=({eventId:n})=>{const[e,t]=b.useState([]),[r,s]=b.useState(0),[i,o]=b.useState(!1),[a,l]=b.useState(2),[c,u]=b.useState(!1),[h,d]=b.useState([]),[p,m]=b.useState(new Date().toISOString()),g=b.useRef(null),y=b.useRef(null),x=b.useRef(null),{toast:v}=Bt(),w=b.useCallback(async()=>{try{const{data:A,error:R}=await ue.from("media").select(`
          media_id,
          file_url,
          upload_time,
          uploader_id
        `).eq("event_id",n).eq("is_visible",!0).order("upload_time",{ascending:!1});if(R){console.error("Error loading slideshow photos:",R);return}const B=[...new Set((A==null?void 0:A.map(k=>k.uploader_id))||[])],I=await Ep(B),L=new Map;I.forEach(k=>{const N=kp(k);L.set(k.user_id,N)});const U=(A||[]).map(k=>({id:k.media_id,url:k.file_url,uploadedAt:k.upload_time,uploadedBy:L.get(k.uploader_id)||"User"})),F=new Date().toISOString(),D=U.filter(k=>new Date(k.uploadedAt)>new Date(p));d(D),console.log("=== LOADPHOTOS UPDATING PHOTOS ARRAY ==="),console.log(`Previous photos length: ${e.length}, New photos length: ${U.length}`),console.log(`Current photo index: ${r}, isPlaying: ${i}`),console.log(`New photos found: ${D.length}`),t(U),i?console.log("Slideshow playing - keeping current index"):(console.log("Slideshow not playing - resetting index to 0"),s(0)),m(F)}catch(A){console.error("Failed to load slideshow photos:",A),v({title:"Load failed",description:"Unable to load photos for slideshow.",variant:"destructive"})}},[n,v,i,r,e.length]),_=()=>{if(console.log("=== STARTING SLIDESHOW ==="),E(),e.length===0){console.log("No photos to show");return}o(!0),console.log(`Photos available: ${e.length}, Starting at index: ${r}, Interval: ${a}s`),g.current=window.setInterval(()=>{console.log("=== INTERVAL TICK ==="),s(A=>{const R=(A+1)%e.length;return console.log(`Moving from photo ${A} to photo ${R}`),R})},a*1e3),x.current=window.setInterval(()=>{console.log("=== 1 MINUTE TIMER - CHECKING FOR NEW PHOTOS ==="),S()},6e4)},S=async()=>{console.log("=== CHECKING FOR NEW PHOTOS TO RESTART SLIDESHOW ==="),e.length;const A=h.length;await w(),setTimeout(()=>{h.length>A?(console.log(`Found ${h.length-A} new photos - restarting slideshow`),v({title:"New photos found!",description:`Restarting slideshow with ${h.length} new photos`}),s(0),d([]),m(new Date().toISOString()),i&&_()):console.log("No new photos found - continuing slideshow")},100)},E=b.useCallback(()=>{o(!1),g.current&&(window.clearInterval(g.current),g.current=null),x.current&&(window.clearInterval(x.current),x.current=null)},[]),C=()=>{s(A=>A>=e.length-1?0:A+1)},P=()=>{s(A=>A<=0?e.length-1:A-1)};b.useEffect(()=>()=>{g.current&&window.clearInterval(g.current),y.current&&window.clearInterval(y.current),x.current&&window.clearInterval(x.current)},[]),b.useEffect(()=>{c||(E(),y.current&&(window.clearInterval(y.current),y.current=null))},[c,E]),b.useEffect(()=>(c&&(w(),y.current=window.setInterval(()=>{console.log("=== PERIODIC CHECK FOR NEW PHOTOS ==="),w()},3e4)),()=>{y.current&&(window.clearInterval(y.current),y.current=null)}),[c,i,w]);const O=e[r];return b.useEffect(()=>{console.log(`Photo index changed to: ${r}, total photos: ${e.length}, current photo ID: ${O==null?void 0:O.id}`)},[r,e.length,O==null?void 0:O.id]),f.jsxs(f.Fragment,{children:[f.jsxs(_e,{variant:"outline",className:"w-full text-xs sm:text-sm",onClick:()=>{w(),u(!0)},children:[f.jsx(V_,{className:"h-3 w-3 sm:h-4 sm:w-4 mr-1 sm:mr-2"}),"Start Slideshow"]}),c&&f.jsxs("div",{className:"fixed inset-0 z-[10001] bg-black flex flex-col font-outfit",children:[f.jsxs("div",{className:"relative z-10 p-4 flex items-center justify-between bg-gradient-to-b from-black/60 to-transparent",children:[f.jsxs("div",{className:"flex items-center gap-3",children:[f.jsx(_e,{variant:"ghost",size:"icon",className:"text-white hover:bg-white/20",onClick:()=>u(!1),children:f.jsx(ha,{className:"h-6 w-6"})}),f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx(MT,{className:"h-5 w-5 text-white"}),f.jsxs(KR,{value:a.toString(),onValueChange:A=>l(Number(A)),children:[f.jsx(ab,{className:"w-24 bg-black/50 text-white border-white/30",children:f.jsx(JR,{})}),f.jsxs(lb,{children:[f.jsx(Gr,{value:"2",children:"2s"}),f.jsx(Gr,{value:"3",children:"3s"}),f.jsx(Gr,{value:"5",children:"5s"}),f.jsx(Gr,{value:"10",children:"10s"}),f.jsx(Gr,{value:"15",children:"15s"}),f.jsx(Gr,{value:"30",children:"30s"})]})]})]}),h.length>0&&f.jsxs("div",{className:"text-xs bg-primary/20 text-white px-3 py-1 rounded-full font-semibold",children:[h.length," new"]})]}),f.jsx("div",{className:"text-white font-semibold",children:e.length>0?`${r+1} / ${e.length}`:"0 / 0"}),f.jsx(_e,{variant:"ghost",size:"icon",className:"text-white hover:bg-white/20",onClick:i?E:_,disabled:e.length===0,children:i?f.jsx(DL,{className:"h-6 w-6"}):f.jsx(OL,{className:"h-6 w-6"})})]}),f.jsx("div",{className:"flex-1 flex items-center justify-center relative",children:O?f.jsxs(f.Fragment,{children:[f.jsx("img",{src:O.url,alt:`Photo by ${O.uploadedBy}`,className:"max-w-full max-h-full object-contain"}),f.jsxs("div",{className:"absolute bottom-6 right-6 bg-black/70 text-white px-4 py-2 rounded-lg",children:[f.jsxs("p",{className:"text-sm font-medium",children:["Uploaded by ",O.uploadedBy]}),f.jsx("p",{className:"text-xs opacity-80",children:new Date(O.uploadedAt).toLocaleString()})]}),f.jsx(_e,{variant:"ghost",size:"icon",className:"absolute left-4 text-white hover:bg-white/20 h-16 w-16",onClick:P,disabled:e.length===0,children:f.jsx(_L,{className:"h-8 w-8"})}),f.jsx(_e,{variant:"ghost",size:"icon",className:"absolute right-4 text-white hover:bg-white/20 h-16 w-16",onClick:C,disabled:e.length===0,children:f.jsx(SL,{className:"h-8 w-8"})})]}):f.jsxs("div",{className:"text-center text-white",children:[f.jsx(V_,{className:"h-16 w-16 mx-auto mb-4 opacity-50"}),f.jsx("p",{children:"No photos available for slideshow"})]})})]})]})};function w2(n,e,t){const r=vK(),s=CQ(n,t.timeZone,t.locale??r.locale);return"formatToParts"in s?_Q(s,e):SQ(s,e)}function _Q(n,e){const t=n.formatToParts(e);for(let r=t.length-1;r>=0;--r)if(t[r].type==="timeZoneName")return t[r].value}function SQ(n,e){const t=n.format(e).replace(/\u200E/g,""),r=/ [\w-+ ]+$/.exec(t);return r?r[0].substr(1):""}function CQ(n,e,t){return new Intl.DateTimeFormat(t?[t.code,"en-US"]:void 0,{timeZone:e,timeZoneName:n})}function EQ(n,e){const t=DQ(e);return"formatToParts"in t?PQ(t,n):TQ(t,n)}const kQ={year:0,month:1,day:2,hour:3,minute:4,second:5};function PQ(n,e){try{const t=n.formatToParts(e),r=[];for(let s=0;s<t.length;s++){const i=kQ[t[s].type];i!==void 0&&(r[i]=parseInt(t[s].value,10))}return r}catch(t){if(t instanceof RangeError)return[NaN];throw t}}function TQ(n,e){const t=n.format(e),r=/(\d+)\/(\d+)\/(\d+),? (\d+):(\d+):(\d+)/.exec(t);return[parseInt(r[3],10),parseInt(r[1],10),parseInt(r[2],10),parseInt(r[4],10),parseInt(r[5],10),parseInt(r[6],10)]}const ov={},b2=new Intl.DateTimeFormat("en-US",{hourCycle:"h23",timeZone:"America/New_York",year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit"}).format(new Date("2014-06-25T04:00:00.123Z")),AQ=b2==="06/25/2014, 00:00:00"||b2==="06/25/2014 00:00:00";function DQ(n){return ov[n]||(ov[n]=AQ?new Intl.DateTimeFormat("en-US",{hourCycle:"h23",timeZone:n,year:"numeric",month:"numeric",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit"}):new Intl.DateTimeFormat("en-US",{hour12:!1,timeZone:n,year:"numeric",month:"numeric",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit"})),ov[n]}function e3(n,e,t,r,s,i,o){const a=new Date(0);return a.setUTCFullYear(n,e,t),a.setUTCHours(r,s,i,o),a}const _2=36e5,OQ=6e4,av={timezone:/([Z+-].*)$/,timezoneZ:/^(Z)$/,timezoneHH:/^([+-]\d{2})$/,timezoneHHMM:/^([+-])(\d{2}):?(\d{2})$/};function cb(n,e,t){if(!n)return 0;let r=av.timezoneZ.exec(n);if(r)return 0;let s,i;if(r=av.timezoneHH.exec(n),r)return s=parseInt(r[1],10),S2(s)?-(s*_2):NaN;if(r=av.timezoneHHMM.exec(n),r){s=parseInt(r[2],10);const o=parseInt(r[3],10);return S2(s,o)?(i=Math.abs(s)*_2+o*OQ,r[1]==="+"?-i:i):NaN}if(NQ(n)){e=new Date(e||Date.now());const o=t?e:IQ(e),a=bx(o,n);return-(t?a:RQ(e,a,n))}return NaN}function IQ(n){return e3(n.getFullYear(),n.getMonth(),n.getDate(),n.getHours(),n.getMinutes(),n.getSeconds(),n.getMilliseconds())}function bx(n,e){const t=EQ(n,e),r=e3(t[0],t[1]-1,t[2],t[3]%24,t[4],t[5],0).getTime();let s=n.getTime();const i=s%1e3;return s-=i>=0?i:1e3+i,r-s}function RQ(n,e,t){let s=n.getTime()-e;const i=bx(new Date(s),t);if(e===i)return e;s-=i-e;const o=bx(new Date(s),t);return i===o?i:Math.max(i,o)}function S2(n,e){return-23<=n&&n<=23&&(e==null||0<=e&&e<=59)}const C2={};function NQ(n){if(C2[n])return!0;try{return new Intl.DateTimeFormat(void 0,{timeZone:n}),C2[n]=!0,!0}catch{return!1}}const jQ=60*1e3,LQ={X:function(n,e,t){const r=lv(t.timeZone,n);if(r===0)return"Z";switch(e){case"X":return E2(r);case"XXXX":case"XX":return Ga(r);case"XXXXX":case"XXX":default:return Ga(r,":")}},x:function(n,e,t){const r=lv(t.timeZone,n);switch(e){case"x":return E2(r);case"xxxx":case"xx":return Ga(r);case"xxxxx":case"xxx":default:return Ga(r,":")}},O:function(n,e,t){const r=lv(t.timeZone,n);switch(e){case"O":case"OO":case"OOO":return"GMT"+MQ(r,":");case"OOOO":default:return"GMT"+Ga(r,":")}},z:function(n,e,t){switch(e){case"z":case"zz":case"zzz":return w2("short",n,t);case"zzzz":default:return w2("long",n,t)}}};function lv(n,e){const t=n?cb(n,e,!0)/jQ:(e==null?void 0:e.getTimezoneOffset())??0;if(Number.isNaN(t))throw new RangeError("Invalid time zone specified: "+n);return t}function Tp(n,e){const t=n<0?"-":"";let r=Math.abs(n).toString();for(;r.length<e;)r="0"+r;return t+r}function Ga(n,e=""){const t=n>0?"-":"+",r=Math.abs(n),s=Tp(Math.floor(r/60),2),i=Tp(Math.floor(r%60),2);return t+s+e+i}function E2(n,e){return n%60===0?(n>0?"-":"+")+Tp(Math.abs(n)/60,2):Ga(n,e)}function MQ(n,e=""){const t=n>0?"-":"+",r=Math.abs(n),s=Math.floor(r/60),i=r%60;return i===0?t+String(s):t+String(s)+e+Tp(i,2)}function k2(n){const e=new Date(Date.UTC(n.getFullYear(),n.getMonth(),n.getDate(),n.getHours(),n.getMinutes(),n.getSeconds(),n.getMilliseconds()));return e.setUTCFullYear(n.getFullYear()),+n-+e}const FQ=/(Z|[+-]\d{2}(?::?\d{2})?| UTC| [a-zA-Z]+\/[a-zA-Z_]+(?:\/[a-zA-Z_]+)?)$/,cv=36e5,P2=6e4,BQ=2,Nn={dateTimePattern:/^([0-9W+-]+)(T| )(.*)/,datePattern:/^([0-9W+-]+)(.*)/,plainTime:/:/,YY:/^(\d{2})$/,YYY:[/^([+-]\d{2})$/,/^([+-]\d{3})$/,/^([+-]\d{4})$/],YYYY:/^(\d{4})/,YYYYY:[/^([+-]\d{4})/,/^([+-]\d{5})/,/^([+-]\d{6})/],MM:/^-(\d{2})$/,DDD:/^-?(\d{3})$/,MMDD:/^-?(\d{2})-?(\d{2})$/,Www:/^-?W(\d{2})$/,WwwD:/^-?W(\d{2})-?(\d{1})$/,HH:/^(\d{2}([.,]\d*)?)$/,HHMM:/^(\d{2}):?(\d{2}([.,]\d*)?)$/,HHMMSS:/^(\d{2}):?(\d{2}):?(\d{2}([.,]\d*)?)$/,timeZone:FQ};function t3(n,e={}){if(arguments.length<1)throw new TypeError("1 argument required, but only "+arguments.length+" present");if(n===null)return new Date(NaN);const t=e.additionalDigits==null?BQ:Number(e.additionalDigits);if(t!==2&&t!==1&&t!==0)throw new RangeError("additionalDigits must be 0, 1 or 2");if(n instanceof Date||typeof n=="object"&&Object.prototype.toString.call(n)==="[object Date]")return new Date(n.getTime());if(typeof n=="number"||Object.prototype.toString.call(n)==="[object Number]")return new Date(n);if(Object.prototype.toString.call(n)!=="[object String]")return new Date(NaN);const r=UQ(n),{year:s,restDateString:i}=$Q(r.date,t),o=zQ(i,s);if(o===null||isNaN(o.getTime()))return new Date(NaN);if(o){const a=o.getTime();let l=0,c;if(r.time&&(l=WQ(r.time),l===null||isNaN(l)))return new Date(NaN);if(r.timeZone||e.timeZone){if(c=cb(r.timeZone||e.timeZone,new Date(a+l)),isNaN(c))return new Date(NaN)}else c=k2(new Date(a+l)),c=k2(new Date(a+l+c));return new Date(a+l+c)}else return new Date(NaN)}function UQ(n){const e={};let t=Nn.dateTimePattern.exec(n),r;if(t?(e.date=t[1],r=t[3]):(t=Nn.datePattern.exec(n),t?(e.date=t[1],r=t[2]):(e.date=null,r=n)),r){const s=Nn.timeZone.exec(r);s?(e.time=r.replace(s[1],""),e.timeZone=s[1].trim()):e.time=r}return e}function $Q(n,e){if(n){const t=Nn.YYY[e],r=Nn.YYYYY[e];let s=Nn.YYYY.exec(n)||r.exec(n);if(s){const i=s[1];return{year:parseInt(i,10),restDateString:n.slice(i.length)}}if(s=Nn.YY.exec(n)||t.exec(n),s){const i=s[1];return{year:parseInt(i,10)*100,restDateString:n.slice(i.length)}}}return{year:null}}function zQ(n,e){if(e===null)return null;let t,r,s;if(!n||!n.length)return t=new Date(0),t.setUTCFullYear(e),t;let i=Nn.MM.exec(n);if(i)return t=new Date(0),r=parseInt(i[1],10)-1,A2(e,r)?(t.setUTCFullYear(e,r),t):new Date(NaN);if(i=Nn.DDD.exec(n),i){t=new Date(0);const o=parseInt(i[1],10);return GQ(e,o)?(t.setUTCFullYear(e,0,o),t):new Date(NaN)}if(i=Nn.MMDD.exec(n),i){t=new Date(0),r=parseInt(i[1],10)-1;const o=parseInt(i[2],10);return A2(e,r,o)?(t.setUTCFullYear(e,r,o),t):new Date(NaN)}if(i=Nn.Www.exec(n),i)return s=parseInt(i[1],10)-1,D2(s)?T2(e,s):new Date(NaN);if(i=Nn.WwwD.exec(n),i){s=parseInt(i[1],10)-1;const o=parseInt(i[2],10)-1;return D2(s,o)?T2(e,s,o):new Date(NaN)}return null}function WQ(n){let e,t,r=Nn.HH.exec(n);if(r)return e=parseFloat(r[1].replace(",",".")),uv(e)?e%24*cv:NaN;if(r=Nn.HHMM.exec(n),r)return e=parseInt(r[1],10),t=parseFloat(r[2].replace(",",".")),uv(e,t)?e%24*cv+t*P2:NaN;if(r=Nn.HHMMSS.exec(n),r){e=parseInt(r[1],10),t=parseInt(r[2],10);const s=parseFloat(r[3].replace(",","."));return uv(e,t,s)?e%24*cv+t*P2+s*1e3:NaN}return null}function T2(n,e,t){e=e||0,t=t||0;const r=new Date(0);r.setUTCFullYear(n,0,4);const s=r.getUTCDay()||7,i=e*7+t+1-s;return r.setUTCDate(r.getUTCDate()+i),r}const HQ=[31,28,31,30,31,30,31,31,30,31,30,31],VQ=[31,29,31,30,31,30,31,31,30,31,30,31];function n3(n){return n%400===0||n%4===0&&n%100!==0}function A2(n,e,t){if(e<0||e>11)return!1;if(t!=null){if(t<1)return!1;const r=n3(n);if(r&&t>VQ[e]||!r&&t>HQ[e])return!1}return!0}function GQ(n,e){if(e<1)return!1;const t=n3(n);return!(t&&e>366||!t&&e>365)}function D2(n,e){return!(n<0||n>52||e!=null&&(e<0||e>6))}function uv(n,e,t){return!(n<0||n>=25||e!=null&&(e<0||e>=60)||t!=null&&(t<0||t>=60))}const qQ=/([xXOz]+)|''|'(''|[^'])+('|$)/g;function YQ(n,e,t={}){e=String(e);const r=e.match(qQ);if(r){const s=t3(t.originalDate||n,t);e=r.reduce(function(i,o){if(o[0]==="'")return i;const a=i.indexOf(o),l=i[a-1]==="'",c=i.replace(o,"'"+LQ[o[0]](s,o,t)+"'");return l?c.substring(0,a-1)+c.substring(a+1):c},e)}return qI(n,e,t)}function XQ(n,e,t){n=t3(n,t);const r=cb(e,n,!0),s=new Date(n.getTime()-r),i=new Date(0);return i.setFullYear(s.getUTCFullYear(),s.getUTCMonth(),s.getUTCDate()),i.setHours(s.getUTCHours(),s.getUTCMinutes(),s.getUTCSeconds(),s.getUTCMilliseconds()),i}function r3(n,e,t,r){return r={...r,timeZone:e,originalDate:n},YQ(XQ(n,e,{timeZone:r.timeZone}),t,r)}const KQ=({event:n,onEventUpdate:e,isAdmin:t=!1,isOrganizer:r=!1})=>{const s=vs(),{user:i}=Or(),{toast:o}=Bt(),[a,l]=b.useState(!1),[c,u]=b.useState(!1),h=(i==null?void 0:i.id)===n.ownerId,d=n.status==="live",p=n.status==="upcoming",m=n.status==="ended",g=async x=>{if(!(!h&&!r)){u(!0);try{const v=new Date(n.endTime),w=nX(v,x),{error:_}=await ue.from("events").update({end_time:w.toISOString()}).eq("event_id",n.eventId);if(_)throw _;const S={...n,endTime:w.toISOString()};e(S),o({title:"Event Extended",description:`Event extended by ${x} hour${x!==1?"s":""}`})}catch(v){console.error("Extend event failed:",v),o({title:"Extension failed",description:"Unable to extend event.",variant:"destructive"})}finally{u(!1)}}},y=x=>{try{return r3(new Date(x),n.timezone,"MMM dd, yyyy  h:mm a zzz")}catch(v){return console.error("Date formatting error:",v),new Date(x).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric",hour:"2-digit",minute:"2-digit",timeZoneName:"short"})}};return!h&&t?null:f.jsxs(Ht,{className:"mb-6",children:[f.jsxs(Gs,{children:[f.jsx(qs,{children:"Event Controls"}),f.jsx(Ys,{children:p?"Event schedule and information":"Quick actions and event statistics"})]}),f.jsxs(Qt,{className:"space-y-4",children:[(d||m)&&f.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[f.jsxs(eb,{open:a,onOpenChange:l,children:[f.jsx(WJ,{asChild:!0,children:f.jsxs(_e,{variant:"outline",className:"gap-2",children:[f.jsx(no,{className:"h-4 w-4"}),"Event QR Code"]})}),f.jsxs(tb,{children:[f.jsxs(nb,{children:[f.jsxs(rb,{className:"flex items-center gap-2",children:[f.jsx(no,{className:"h-5 w-5"}),"Share Event"]}),f.jsx(sb,{children:"Scan the QR code or share the event link to invite guests"})]}),f.jsx(ib,{eventCode:n.eventCode,eventName:hy(n.name),passcode:n.passcode,customQRCodeUrl:n.qrCodeImageUrl}),(h||r)&&f.jsx("div",{className:"px-4 pb-6",children:f.jsxs(_e,{className:"w-full",onClick:()=>{l(!1),s(`/event/${n.eventId}/qr`)},children:[f.jsx(no,{className:"h-4 w-4 mr-2"}),"Full Screen QR Code"]})})]})]}),f.jsx(bQ,{eventId:n.eventId})]}),(d||m)&&f.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[f.jsxs("div",{className:"p-4 bg-muted/20 rounded-lg",children:[f.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[f.jsx(Xp,{className:"h-4 w-4 text-muted-foreground"}),f.jsx("p",{className:"text-sm font-medium",children:"Guests"})]}),f.jsx("p",{className:"text-2xl font-bold",children:n.participantCount})]}),f.jsxs("div",{className:"p-4 bg-muted/20 rounded-lg",children:[f.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[f.jsx(kr,{className:"h-4 w-4 text-muted-foreground"}),f.jsx("p",{className:"text-sm font-medium",children:"Photos"})]}),f.jsx("p",{className:"text-2xl font-bold",children:n.photoCount})]})]}),f.jsxs("div",{className:"p-4 bg-muted/20 rounded-lg space-y-2",children:[f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx(cy,{className:"h-4 w-4 text-muted-foreground"}),f.jsx("p",{className:"text-sm font-medium",children:"Start Date"})]}),f.jsx("p",{className:"text-sm text-muted-foreground",children:y(n.startTime)})]}),f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx(cy,{className:"h-4 w-4 text-muted-foreground"}),f.jsx("p",{className:"text-sm font-medium",children:"End Date"})]}),f.jsx("p",{className:"text-sm text-muted-foreground",children:y(n.endTime)})]})]}),d&&f.jsxs("div",{className:"p-4 bg-muted/20 rounded-lg space-y-3",children:[f.jsxs("div",{children:[f.jsx("p",{className:"font-medium",children:"Extend Event"}),f.jsx("p",{className:"text-sm text-muted-foreground",children:"Add more time to your event"})]}),f.jsxs("div",{className:"flex gap-2",children:[f.jsx(_e,{variant:"outline",size:"sm",className:"flex-1",onClick:()=>g(1),disabled:c,children:"+1 Hour"}),f.jsx(_e,{variant:"outline",size:"sm",className:"flex-1",onClick:()=>g(2),disabled:c,children:"+2 Hours"}),f.jsx(_e,{variant:"outline",size:"sm",className:"flex-1",onClick:()=>g(4),disabled:c,children:"+4 Hours"})]})]})]})]})},JQ=()=>{const[n,e]=b.useState(!1),{toast:t}=Bt(),r=async i=>{var o;if(n)return null;e(!0);try{if(!de.isNativePlatform())return await s();const a=(o=de.Plugins)==null?void 0:o.CustomGalleryPicker;if(a)try{console.log(" Using CustomGalleryPicker plugin with metadata:",{purpose:(i==null?void 0:i.purpose)||"general",allowEditing:(i==null?void 0:i.allowEditing)??!0});const u=await a.pickImage({source:"gallery",purpose:(i==null?void 0:i.purpose)||"general",quality:90,allowEditing:(i==null?void 0:i.allowEditing)??!1,maxWidth:i==null?void 0:i.maxWidth,maxHeight:i==null?void 0:i.maxHeight});if(console.log(" CustomGalleryPicker result:",u),!u.success||!u.dataUrl&&!u.webPath)return console.log("CustomGalleryPicker: No image selected or cancelled"),null;const h=u.dataUrl||u.webPath;if(!h)return null;const d=ec(h,`${u.metadata.purpose}-${Date.now()}.${u.format||"jpg"}`,`image/${u.format||"jpeg"}`);return console.log(" CustomGalleryPicker success:",{purpose:u.metadata.purpose,wasEdited:u.metadata.wasEdited,originalSize:u.metadata.originalDimensions,editedSize:u.metadata.editedDimensions}),d}catch(u){const h=u instanceof Error?u.message:String(u);if(h.includes("cancelled")||h.includes("canceled")||h.includes("User cancelled")||h.includes("CropEditor cancelled"))return console.log(" CustomGalleryPicker: User cancelled operation"),null;console.log("CustomGalleryPicker error, falling back to standard camera:",u)}console.log(" Using standard Capacitor Camera (fallback)");const l=await Id.getPhoto({quality:90,allowEditing:(i==null?void 0:i.allowEditing)??!1,resultType:sd.DataUrl,source:Us.Photos,promptLabelHeader:"Select Photo",promptLabelPhoto:"From Gallery",promptLabelPicture:"Take Photo",...(i==null?void 0:i.purpose)&&{purpose:i.purpose},...(i==null?void 0:i.maxWidth)&&{maxWidth:i.maxWidth},...(i==null?void 0:i.maxHeight)&&{maxHeight:i.maxHeight}});return l.dataUrl?ec(l.dataUrl,`image-${Date.now()}.${l.format||"jpg"}`,`image/${l.format||"jpeg"}`):(t({title:"No image selected",description:"Please select a photo to continue.",variant:"destructive"}),null)}catch(a){const l=a instanceof Error?a.message:String(a);return l.includes("cancelled")||l.includes("canceled")||l.includes("User cancelled")||l.includes("CropEditor cancelled")?(console.log(" Regular photo picker: User cancelled operation"),null):(console.error("Regular photo picker failed:",a),t({title:"Photo selection failed",description:l,variant:"destructive"}),null)}finally{e(!1)}},s=()=>new Promise(i=>{const o=document.createElement("input");o.type="file",o.accept="image/*",o.onchange=a=>{var c;const l=(c=a.target.files)==null?void 0:c[0];i(l||null)},o.oncancel=()=>i(null),o.click()});return{pickSinglePhoto:r,isPickingPhoto:n}};Pn("ImageCropper",{web:()=>Ae(()=>import("./web-BLf-5bQi.js"),[]).then(n=>new n.ImageCropperWeb)});const O2=({mode:n})=>{const[e,t]=b.useState(!1);return{editPhoto:b.useCallback(async s=>(t(!0),console.log(" Using Fabric.js photo editor for mode:",n),new Promise(i=>{let o;s instanceof File?(o=URL.createObjectURL(s),console.log(" Converted File to blob URL:",o)):(o=s,console.log(" Using provided image URL:",o)),console.log(" Creating FabricPhotoEditor instance...");const a=new nc({imagePath:o,mode:n,onSave:l=>{console.log(" Photo editor saved:",l),t(!1),i(l)},onCancel:l=>{console.log(" Photo editor cancelled:",l),t(!1),i(l)}});if(!nc.testFabricAvailability()){console.error(" Fabric.js not available in photo editor hook, falling back"),t(!1),i({edited:!1});return}console.log(" FabricPhotoEditor instance created, calling show()..."),a.show().catch(l=>{console.error(" Error showing photo editor:",l),t(!1),i({edited:!1})})})),[n]),isEditing:e}},QQ=({eventId:n,headerImageUrl:e,qrCodeImageUrl:t,onUpdate:r,canManageBranding:s,open:i,onOpenChange:o})=>{const{user:a}=Or(),{toast:l}=Bt(),[c,u]=b.useState(null),[h,d]=b.useState(!1),{pickSinglePhoto:p,isPickingPhoto:m}=JQ(),g=O2({mode:"crop-header"}),y=O2({mode:"crop-qr"}),x=async(_,S)=>{if(!a||!s){l({title:"Access denied",description:"Only event owners and organizers can upload branding images",variant:"destructive"});return}u(S);try{console.log(" Starting image upload process:",{eventId:n,type:S,fileName:_.name}),console.log(" Checking permissions for event:",n);const{data:E,error:C}=await ue.rpc("can_manage_event_branding",{target_event_id:n});if(console.log(" Permission check result:",{hasPermission:E,permissionError:C}),C)throw console.error(" Permission check failed:",C),new Error(`Permission check failed: ${C.message}`);if(!E)throw console.error(" User does not have permission"),new Error("You do not have permission to manage branding for this event");const P=_.name.split(".").pop(),O=`branding/${n}/${S}-${Date.now()}.${P}`;console.log(" Attempting upload with filename:",O),console.log(" Using bucket: event-photos (with branding subfolder)"),console.log(" File details:",{name:_.name,size:_.size,type:_.type,lastModified:_.lastModified});const{data:{user:A},error:R}=await ue.auth.getUser();console.log(" Current user:",{user:A==null?void 0:A.id,authError:R});const{data:B,error:I}=await ue.storage.from("event-photos").upload(O,_,{cacheControl:"3600",upsert:!1});if(console.log(" Upload result:",{uploadData:B,uploadError:I}),I)throw console.error(" Storage upload failed with details:",{message:I.message,name:I.name,stack:I.stack,fullError:I}),I.message.includes("not found")||I.message.includes("does not exist")?new Error("Storage bucket not found. Please contact support."):I.message.includes("policy")?new Error("Storage permission denied. Please try again or contact support."):I.message.includes("size")?new Error("File is too large. Please use a file smaller than 5MB."):I.message.includes("type")||I.message.includes("mime")?new Error("Invalid file type. Please use JPG, PNG, or WebP images."):new Error(`Upload failed: ${I.message}`);console.log(" Getting public URL for:",O);const{data:{publicUrl:L}}=ue.storage.from("event-photos").getPublicUrl(O);console.log(" Public URL generated:",L);const U=S==="header"?"header_image_url":"qr_code_image_url";console.log(" Updating database field:",U,"with URL:",L);const{error:F}=await ue.from("events").update({[U]:L}).eq("event_id",n);if(console.log(" Database update result:",{updateError:F}),F)throw console.error(" Database update failed:",F),F;console.log(" Calling onUpdate with:",{[U]:L}),r({[U]:L}),console.log(" Upload process completed successfully"),l({title:"Success",description:`${S==="header"?"Header":"QR code"} image uploaded successfully`})}catch(E){console.error("Upload error:",E),l({title:"Upload failed",description:E.message||"Failed to upload image",variant:"destructive"})}finally{u(null)}},v=async _=>{if(!(!a||!s))try{const S=_==="header"?"header_image_url":"qr_code_image_url",E=_==="header"?e:t,{error:C}=await ue.from("events").update({[S]:null}).eq("event_id",n);if(C)throw C;if(E){const P=E.split("/"),O=P[P.length-1],A=`branding/${n}/${O}`;O&&await ue.storage.from("event-photos").remove([A])}r({[S]:void 0}),l({title:"Success",description:`${_==="header"?"Header":"QR code"} image removed`})}catch(S){console.error("Remove error:",S),l({title:"Remove failed",description:S.message||"Failed to remove image",variant:"destructive"})}},w=async _=>{if(!a){l({title:"Authentication required",description:"Please sign in to upload images",variant:"destructive"});return}try{const S=de.getPlatform()==="ios",E=await p({purpose:_==="header"?"header":"qr",allowEditing:!!S,maxWidth:_==="header"?1920:1080,maxHeight:1080});if(!E)return;if(!E.type.startsWith("image/")){l({title:"Invalid file type",description:"Please select an image file",variant:"destructive"});return}if(E.size>10*1024*1024){l({title:"File too large",description:"Please select an image smaller than 10MB",variant:"destructive"});return}if(S){await x(E,_);return}const P=await(_==="header"?g:y).editPhoto(E);if(P.edited&&P.webPath){let O;if(fo(P.webPath))O=ec(P.webPath,E.name,"image/jpeg");else{const R=await(await fetch(P.webPath)).blob();O=new File([R],E.name,{type:R.type||"image/jpeg"})}await x(O,_)}}catch(S){console.error("Error selecting/editing photo:",S),l({title:"Error",description:"Failed to select or edit image",variant:"destructive"})}};return s?f.jsxs(Md,{open:i??h,onOpenChange:o??d,children:[i===void 0&&f.jsx(kY,{asChild:!0,children:f.jsxs(_e,{variant:"outline",size:"sm",children:[f.jsx(ql,{className:"h-4 w-4 mr-2"}),"Manage Branding"]})}),f.jsxs(bc,{className:"max-w-2xl max-h-[90vh] overflow-y-auto",children:[f.jsxs(_c,{children:[f.jsx(Sc,{children:"Event Branding"}),f.jsx(Cc,{children:"Upload custom images to brand your event page and match your event theme"})]}),f.jsxs("div",{className:"space-y-6",children:[f.jsxs(Ht,{children:[f.jsxs(Gs,{children:[f.jsxs(qs,{className:"flex items-center gap-2",children:[f.jsx(ql,{className:"h-5 w-5"}),"Header Image"]}),f.jsxs(Ys,{children:["Upload a banner image to display at the top of your event page",f.jsx("br",{}),f.jsx("span",{className:"text-xs text-muted-foreground",children:"Recommended: 1920x480px (4:1 ratio)  Max 5MB  JPG/PNG"})]})]}),f.jsxs(Qt,{className:"space-y-4",children:[e?f.jsxs("div",{className:"relative",children:[f.jsx("div",{className:"w-full h-32 overflow-hidden rounded-lg bg-muted",children:f.jsx("img",{src:e,alt:"Event header preview",className:"w-full h-full object-cover object-center"})}),f.jsx(_e,{variant:"destructive",size:"sm",className:"absolute top-2 right-2",onClick:()=>v("header"),children:f.jsx(ha,{className:"h-4 w-4"})})]}):f.jsxs("div",{className:"relative",children:[f.jsx("div",{className:"w-full h-32 overflow-hidden rounded-lg bg-muted",children:f.jsx("img",{src:RI,alt:"Default header (PhotoShare branding)",className:"w-full h-full object-cover object-center opacity-60"})}),f.jsx("div",{className:"absolute top-2 left-2 bg-black/50 text-white text-xs px-2 py-1 rounded",children:"Default Header"}),f.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-black/10 rounded-lg",children:f.jsx("p",{className:"text-sm text-white font-medium",children:"Upload custom header image"})})]}),f.jsx(_e,{variant:"outline",disabled:c==="header"||m||g.isEditing,onClick:()=>w("header"),className:"w-full",children:c==="header"?f.jsxs(f.Fragment,{children:[f.jsx(da,{className:"h-4 w-4 mr-2 animate-spin"}),"Uploading..."]}):m||g.isEditing?f.jsxs(f.Fragment,{children:[f.jsx(z_,{className:"h-4 w-4 mr-2 animate-spin"}),g.isEditing?"Cropping...":"Selecting..."]}):f.jsxs(f.Fragment,{children:[f.jsx($_,{className:"h-4 w-4 mr-2"}),e?"Replace & Crop":"Select & Crop"]})})]})]}),f.jsxs(Ht,{children:[f.jsxs(Gs,{children:[f.jsxs(qs,{className:"flex items-center gap-2",children:[f.jsx(no,{className:"h-5 w-5"}),"Custom QR Code Image"]}),f.jsxs(Ys,{children:["Upload a custom QR code image to replace the default generated one",f.jsx("br",{}),f.jsx("span",{className:"text-xs text-muted-foreground",children:"Recommended: 512x512px (1:1 square)  Max 5MB  JPG/PNG"})]})]}),f.jsxs(Qt,{className:"space-y-4",children:[t?f.jsxs("div",{className:"relative",children:[f.jsx("div",{className:"w-32 h-32 overflow-hidden rounded-lg border bg-muted mx-auto",children:f.jsx("img",{src:t,alt:"Custom QR code preview",className:"w-full h-full object-cover object-center"})}),f.jsx(_e,{variant:"destructive",size:"sm",className:"absolute top-2 right-2",onClick:()=>v("qr"),children:f.jsx(ha,{className:"h-4 w-4"})})]}):f.jsxs("div",{className:"border-2 border-dashed border-muted-foreground/25 rounded-lg p-8 text-center",children:[f.jsx(no,{className:"h-12 w-12 mx-auto text-muted-foreground mb-4"}),f.jsx("p",{className:"text-sm text-muted-foreground mb-4",children:"No custom QR code uploaded"})]}),f.jsx(_e,{variant:"outline",disabled:c==="qr"||m||y.isEditing,onClick:()=>w("qr"),className:"w-full",children:c==="qr"?f.jsxs(f.Fragment,{children:[f.jsx(da,{className:"h-4 w-4 mr-2 animate-spin"}),"Uploading..."]}):m||y.isEditing?f.jsxs(f.Fragment,{children:[f.jsx(z_,{className:"h-4 w-4 mr-2 animate-spin"}),y.isEditing?"Cropping...":"Selecting..."]}):f.jsxs(f.Fragment,{children:[f.jsx($_,{className:"h-4 w-4 mr-2"}),t?"Replace & Crop":"Select & Crop"]})})]})]})]})]})]}):null},ZQ=({event:n,onEventUpdate:e,userId:t,autoUploadEnabled:r,onAutoUploadChange:s})=>{const{toast:i}=Bt(),[o,a]=b.useState(!1),[l,c]=b.useState(!1),[u,h]=b.useState(!1),d=t===n.ownerId,p=async _=>{if(d){c(!0);try{const{error:S}=await ue.from("events").update({allow_uploads_after_end:_}).eq("event_id",n.eventId);if(S)throw S;const E={...n,allowUploadsAfterEnd:_};e(E),i({title:_?"Uploads Enabled After Event":"Uploads Disabled After Event",description:_?"Guests can now upload photos after the event ends":"Uploads will be disabled when the event ends"})}catch(S){console.error("Failed to update upload settings:",S),i({title:"Update failed",description:"Unable to update upload settings.",variant:"destructive"})}finally{c(!1)}}},m=async _=>{c(!0);try{let S=null,E=null;if(_){S=new Date(n.startTime);const P=gm(new Date(n.startTime),n.retentionDays);E=new Date(P.getTime()-6e4)}const{error:C}=await ue.rpc("update_auto_upload_settings",{event_uuid:n.eventId,enabled:_,start_time:(S==null?void 0:S.toISOString())||null,end_time:(E==null?void 0:E.toISOString())||null});if(C)throw C;s(_),i({title:_?"Auto Upload Enabled":"Auto Upload Disabled",description:_?"Photos will be automatically uploaded during the event":"Auto upload has been turned off"})}catch(S){console.error("Failed to update auto upload:",S),i({title:"Update failed",description:"Unable to update auto upload settings.",variant:"destructive"})}finally{c(!1)}},g=_=>{const S={...n,headerImageUrl:_.header_image_url,qrCodeImageUrl:_.qr_code_image_url};e(S)},y=()=>{try{const _=new Date(n.startTime),S=gm(_,n.retentionDays);return r3(S,n.timezone,"MMM dd, yyyy")}catch{const S=new Date(n.startTime),E=gm(S,n.retentionDays);return qI(E,"MMM dd, yyyy")}},x=()=>new Date>new Date(n.endTime),v=async()=>{if(!(!d||!x())){c(!0);try{const _=new Date(n.startTime),E=Math.floor((new Date().getTime()-_.getTime())/(1e3*60*60*24)),C=Math.max(0,E),{error:P}=await ue.from("events").update({retention_days:C}).eq("event_id",n.eventId);if(P)throw P;const O={...n,retentionDays:C};e(O),i({title:"Auto-Delete Set to Now",description:"The cleanup process will move this event to memories shortly."})}catch(_){console.error("Failed to update retention:",_),i({title:"Update failed",description:"Unable to update retention period.",variant:"destructive"})}finally{c(!1)}}},w=async()=>{if(d){c(!0);try{const{error:_}=await ue.functions.invoke("cleanup-expired-photos",{body:{}});if(_)throw _;i({title:"Cleanup Triggered",description:"Checking for expired events and moving them to memories."}),setTimeout(()=>{window.location.reload()},2e3)}catch(_){console.error("Failed to trigger cleanup:",_),i({title:"Cleanup failed",description:"Unable to trigger cleanup process.",variant:"destructive"})}finally{c(!1)}}};return f.jsxs(f.Fragment,{children:[f.jsx(ux,{open:o,onOpenChange:a,children:f.jsxs(Ht,{className:"mb-6",children:[f.jsx(Gs,{children:f.jsxs(dx,{className:"flex items-center justify-between w-full hover:opacity-80 transition-opacity [&[data-state=open]>svg]:rotate-180",children:[f.jsxs("div",{className:"text-left",children:[f.jsx(qs,{children:"Event Setup"}),f.jsx(Ys,{children:"Configure event settings and appearance"})]}),f.jsx(Hu,{className:"h-5 w-5 transition-transform duration-200 flex-shrink-0"})]})}),f.jsx(hx,{children:f.jsxs(Qt,{className:"space-y-4",children:[d&&f.jsxs("div",{className:"flex items-center justify-between p-4 bg-muted/20 rounded-lg",children:[f.jsxs("div",{children:[f.jsx("p",{className:"font-medium",children:"Manage Branding"}),f.jsx("p",{className:"text-sm text-muted-foreground",children:"Customize header image and QR code"})]}),f.jsxs(_e,{variant:"outline",size:"sm",className:"gap-2",onClick:()=>h(!0),children:[f.jsx(AL,{className:"h-4 w-4"}),"Manage"]})]}),f.jsxs("div",{className:"flex items-center justify-between p-4 bg-muted/20 rounded-lg",children:[f.jsxs("div",{children:[f.jsx("p",{className:"font-medium",children:"Enable Auto Upload"}),f.jsx("p",{className:"text-sm text-muted-foreground",children:"Automatically upload photos taken during the event"})]}),f.jsx(Tl,{checked:r,onCheckedChange:m,disabled:l})]}),d&&f.jsxs("div",{className:"flex items-center justify-between p-4 bg-muted/20 rounded-lg",children:[f.jsxs("div",{children:[f.jsx("p",{className:"font-medium",children:"Allow Uploads After Event"}),f.jsx("p",{className:"text-sm text-muted-foreground",children:"Let guests upload photos after the event ends"})]}),f.jsx(Tl,{checked:n.allowUploadsAfterEnd,onCheckedChange:p,disabled:l})]}),f.jsxs("div",{className:"p-4 bg-muted/20 rounded-lg space-y-2",children:[f.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[f.jsx(Cg,{className:"h-4 w-4 text-muted-foreground"}),f.jsx("p",{className:"font-medium",children:"Photo Retention"})]}),f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsx("p",{className:"text-sm text-muted-foreground",children:"Retention Period"}),f.jsxs("p",{className:"text-sm font-medium",children:[n.retentionDays," days"]})]}),f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsx("p",{className:"text-sm text-muted-foreground",children:"Auto-Delete Date"}),f.jsx("p",{className:"text-sm font-medium",children:y()})]}),d&&x()&&f.jsxs("div",{className:"space-y-2 mt-2",children:[f.jsxs(_e,{variant:"destructive",size:"sm",className:"w-full",onClick:v,disabled:l,children:[f.jsx(Cg,{className:"h-4 w-4 mr-2"}),"Set Auto-Delete to Now (Testing)"]}),f.jsxs(_e,{variant:"outline",size:"sm",className:"w-full",onClick:w,disabled:l,children:[f.jsx(Cg,{className:"h-4 w-4 mr-2"}),"Run Cleanup Now (Testing)"]})]})]})]})})]})}),f.jsx(QQ,{eventId:n.eventId,headerImageUrl:n.headerImageUrl,qrCodeImageUrl:n.qrCodeImageUrl,onUpdate:g,canManageBranding:d,open:u,onOpenChange:h})]})},s3=b.forwardRef(({className:n,...e},t)=>f.jsx("textarea",{className:Oe("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",n),ref:t,...e}));s3.displayName="Textarea";const eZ=({eventId:n})=>{const[e,t]=b.useState([]),[r,s]=b.useState(!0),[i,o]=b.useState(null),[a,l]=b.useState(""),[c,u]=b.useState("rejected"),[h,d]=b.useState(!1),[p,m]=b.useState(null),{toast:g}=Bt();b.useEffect(()=>{y()},[n]);const y=async()=>{try{s(!0);const{data:E,error:C}=await ue.from("photo_reports").select(`
          report_id,
          media_id,
          reported_by,
          event_id,
          reason,
          status,
          reported_at,
          reviewed_at,
          reviewed_by,
          admin_notes,
          media!inner(file_url)
        `).eq("event_id",n).order("reported_at",{ascending:!1});if(C){console.error("Error loading reports:",C),g({title:"Load failed",description:"Unable to load photo reports. Please try again.",variant:"destructive"});return}const P=[...new Set((E==null?void 0:E.map(A=>A.reported_by))||[])],O=(E||[]).map(A=>{var R;return{report_id:A.report_id,media_id:A.media_id,reported_by:A.reported_by,event_id:A.event_id,reason:A.reason||"No reason provided",status:A.status,reported_at:A.reported_at,reviewed_at:A.reviewed_at,reviewed_by:A.reviewed_by,admin_notes:A.admin_notes,photo_url:((R=A.media)==null?void 0:R.file_url)||"",reporter_email:"Reporter"}});t(O)}catch(E){console.error("Failed to load reports:",E),g({title:"Load failed",description:"Unable to load photo reports. Please try again.",variant:"destructive"})}finally{s(!1)}},x=async E=>{try{const{data:C,error:P}=await ue.from("media").select("uploader_id").eq("media_id",E).single();if(P||!C)return console.error("Error loading uploader info:",P),null;const O=await pJ(C.uploader_id);if(!O)return console.error("Error loading user profile"),null;const A=O.email||`User-${O.user_id.slice(0,8)}`;return{id:O.user_id,email:A}}catch(C){return console.error("Failed to load uploader info:",C),null}},v=async(E,C)=>{const{error:P}=await ue.from("media").update({is_visible:!1}).eq("uploader_id",E).eq("event_id",C);if(P)throw console.error("Error hiding all photos from uploader:",P),P},w=async(E,C)=>{const{error:P}=await ue.from("blocked_users").insert({event_id:C,user_id:E});if(P)throw console.error("Error blocking user:",P),P;const{error:O}=await ue.from("event_participants").update({is_blocked:!0}).eq("event_id",C).eq("user_id",E);O&&console.error("Error updating participant status:",O)},_=async(E,C,P)=>{var O;try{d(!0);const{data:A}=await ue.auth.getUser();if(!((O=A==null?void 0:A.user)!=null&&O.id)){g({title:"Review failed",description:"Please log in to review reports.",variant:"destructive"});return}const R=e.find(F=>F.report_id===E);if(!R){g({title:"Review failed",description:"Report not found.",variant:"destructive"});return}let B=null;if((C==="hide_all"||C==="hide_all_and_block")&&(B=await x(R.media_id),!B)){g({title:"Review failed",description:"Unable to identify photo uploader.",variant:"destructive"});return}const I=C==="rejected"?"rejected":"approved",{error:L}=await ue.from("photo_reports").update({status:I,reviewed_at:new Date().toISOString(),reviewed_by:A.user.id,admin_notes:P}).eq("report_id",E);if(L){console.error("Error updating report:",L),g({title:"Review failed",description:"Unable to update report status.",variant:"destructive"});return}let U="";switch(C){case"approved":const{error:F}=await ue.from("media").update({is_visible:!1}).eq("media_id",R.media_id);if(F){console.error("Error hiding photo:",F),g({title:"Warning",description:"Report was updated but photo visibility could not be changed.",variant:"destructive"});return}U="Photo has been removed.";break;case"hide_all":B&&(await v(B.id,R.event_id),U=`All photos from ${B.email} have been removed.`);break;case"hide_all_and_block":B&&(await v(B.id,R.event_id),await w(B.id,R.event_id),U=`All photos from ${B.email} have been removed and user has been blocked.`);break;case"rejected":U="Photo remains visible.";break}g({title:"Report reviewed",description:`Report has been ${I}. ${U}`}),y(),o(null),l(""),m(null)}catch(A){console.error("Review failed:",A),g({title:"Review failed",description:"Unable to review report. Please try again.",variant:"destructive"})}finally{d(!1)}},S=E=>{switch(E){case"pending":return f.jsxs(Kr,{variant:"outline",className:"text-yellow-600 border-yellow-600",children:[f.jsx(uy,{className:"h-3 w-3 mr-1"}),"Pending"]});case"approved":return f.jsxs(Kr,{variant:"outline",className:"text-red-600 border-red-600",children:[f.jsx(Bc,{className:"h-3 w-3 mr-1"}),"Removed"]});case"rejected":return f.jsxs(Kr,{variant:"outline",className:"text-green-600 border-green-600",children:[f.jsx(Sg,{className:"h-3 w-3 mr-1"}),"Visible"]});default:return f.jsx(Kr,{variant:"outline",children:E})}};return r?f.jsxs("div",{className:"space-y-3 sm:space-y-4",children:[f.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-2 sm:gap-4",children:[f.jsxs("div",{className:"min-w-0 flex-1",children:[f.jsx(Wr,{className:"h-5 sm:h-6 w-32 sm:w-40"}),f.jsx(Wr,{className:"h-3 sm:h-4 w-48 sm:w-64 mt-1"})]}),f.jsx(Wr,{className:"h-8 w-20 flex-shrink-0"})]}),f.jsx("div",{className:"space-y-3 sm:space-y-4",children:Array.from({length:3}).map((E,C)=>f.jsx(Ht,{children:f.jsx(Qt,{className:"p-3 sm:p-4",children:f.jsxs("div",{className:"flex items-center space-x-3 sm:space-x-4",children:[f.jsx(Wr,{className:"h-16 w-16 sm:h-20 sm:w-20 rounded flex-shrink-0"}),f.jsxs("div",{className:"flex-1 space-y-2 min-w-0",children:[f.jsx(Wr,{className:"h-4 w-24 sm:w-32"}),f.jsx(Wr,{className:"h-3 w-full max-w-48"}),f.jsx(Wr,{className:"h-3 w-20 sm:w-24"})]})]})})},C))})]}):f.jsxs("div",{className:"space-y-4",children:[e.length===0?f.jsxs("div",{className:"text-center py-8 text-muted-foreground",children:[f.jsx("div",{className:"p-4 bg-muted/20 rounded-full w-fit mx-auto mb-4",children:f.jsx(LT,{className:"h-8 w-8 text-green-500"})}),f.jsx("p",{className:"text-sm",children:"No photos have been reported yet"})]}):f.jsxs(f.Fragment,{children:[f.jsxs("div",{className:"text-sm text-muted-foreground mb-2",children:[e.length," reports  ",e.filter(E=>E.status==="pending").length," pending review"]}),f.jsx("div",{className:"space-y-4",children:e.map(E=>f.jsx(Ht,{className:`cursor-pointer hover:shadow-md transition-shadow ${E.status==="pending"?"border-yellow-200 bg-muted/20":""}`,onClick:()=>o(E),children:f.jsx(Qt,{className:"p-4",children:f.jsxs("div",{className:"flex items-start space-x-4",children:[f.jsxs("div",{className:"relative flex-shrink-0",children:[f.jsx("img",{src:E.photo_url,alt:"Reported photo",className:"h-20 w-20 object-cover rounded"}),E.status==="approved"&&f.jsx("div",{className:"absolute inset-0 bg-black/50 rounded flex items-center justify-center",children:f.jsx(Bc,{className:"h-5 w-5 text-white"})})]}),f.jsxs("div",{className:"flex-1 min-w-0 space-y-2",children:[f.jsxs("div",{className:"flex items-center space-x-2",children:[f.jsx(Ew,{className:"h-4 w-4 text-muted-foreground flex-shrink-0"}),f.jsxs("span",{className:"text-sm font-medium",children:["Reported by ",E.reporter_email.split("@")[0]]})]}),f.jsx("div",{children:S(E.status)}),f.jsxs("p",{className:"text-sm text-muted-foreground line-clamp-2",children:[f.jsx("strong",{children:"Reason:"})," ",E.reason]}),f.jsxs("div",{className:"text-xs text-muted-foreground space-y-1",children:[f.jsxs("div",{className:"flex items-center space-x-1",children:[f.jsx(MT,{className:"h-3 w-3 flex-shrink-0"}),f.jsxs("span",{children:["Reported ",ku(new Date(E.reported_at),{addSuffix:!0})]})]}),E.reviewed_at&&f.jsxs("div",{className:"flex items-center space-x-1",children:[f.jsx(Sg,{className:"h-3 w-3 flex-shrink-0"}),f.jsxs("span",{children:["Reviewed ",ku(new Date(E.reviewed_at),{addSuffix:!0})]})]})]})]})]})})},E.report_id))})]}),f.jsx(Md,{open:!!i,onOpenChange:E=>{E||(o(null),l(""))},children:f.jsxs(bc,{className:"max-w-2xl max-h-[90vh] overflow-y-auto mx-4 sm:mx-auto",children:[f.jsxs(_c,{children:[f.jsx(Sc,{className:"text-base sm:text-lg",children:"Review Photo Report"}),f.jsx(Cc,{className:"text-sm",children:"Review this reported photo and take appropriate action."})]}),i&&f.jsxs("div",{className:"space-y-4 sm:space-y-6",children:[f.jsx("div",{className:"flex justify-center",children:f.jsxs("div",{className:"relative",children:[f.jsx("img",{src:i.photo_url,alt:"Reported photo",className:"max-w-full max-h-48 sm:max-h-64 object-contain rounded-lg"}),i.status==="approved"&&f.jsx("div",{className:"absolute inset-0 bg-black/50 rounded-lg flex items-center justify-center",children:f.jsxs("div",{className:"text-center text-white",children:[f.jsx(Bc,{className:"h-6 w-6 sm:h-8 sm:w-8 mx-auto mb-2"}),f.jsx("p",{className:"text-xs sm:text-sm",children:"Photo Removed"})]})})]})}),f.jsxs("div",{className:"space-y-3 sm:space-y-4",children:[f.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3 sm:gap-4",children:[f.jsxs("div",{children:[f.jsx("label",{className:"text-xs sm:text-sm font-medium text-muted-foreground",children:"Reported By"}),f.jsx("p",{className:"text-sm truncate",children:i.reporter_email})]}),f.jsxs("div",{children:[f.jsx("label",{className:"text-xs sm:text-sm font-medium text-muted-foreground",children:"Report Date"}),f.jsx("p",{className:"text-sm",children:ku(new Date(i.reported_at),{addSuffix:!0})})]})]}),f.jsxs("div",{children:[f.jsx("label",{className:"text-xs sm:text-sm font-medium text-muted-foreground",children:"Reason"}),f.jsx("p",{className:"text-sm bg-muted/50 p-2 sm:p-3 rounded-md break-words",children:i.reason})]}),f.jsxs("div",{children:[f.jsx("label",{className:"text-xs sm:text-sm font-medium text-muted-foreground",children:"Current Status"}),f.jsx("div",{className:"mt-1",children:S(i.status)})]}),i.admin_notes&&f.jsxs("div",{children:[f.jsx("label",{className:"text-xs sm:text-sm font-medium text-muted-foreground",children:"Previous Admin Notes"}),f.jsx("p",{className:"text-sm bg-muted/50 p-2 sm:p-3 rounded-md break-words",children:i.admin_notes})]})]}),i.status==="pending"&&f.jsxs("div",{className:"space-y-3 sm:space-y-4 border-t pt-3 sm:pt-4",children:[f.jsxs("div",{children:[f.jsx("label",{className:"text-xs sm:text-sm font-medium",children:"Review Action"}),f.jsxs(KR,{value:c,onValueChange:E=>u(E),children:[f.jsx(ab,{className:"mt-1",children:f.jsx(JR,{})}),f.jsxs(lb,{children:[f.jsx(Gr,{value:"approved",children:f.jsxs("div",{className:"flex items-center",children:[f.jsx(Bc,{className:"h-3 w-3 sm:h-4 sm:w-4 mr-2 flex-shrink-0"}),f.jsx("span",{className:"text-xs sm:text-sm",children:"Remove This Photo Only"})]})}),f.jsx(Gr,{value:"hide_all",children:f.jsxs("div",{className:"flex items-center",children:[f.jsx(Bc,{className:"h-3 w-3 sm:h-4 sm:w-4 mr-2 flex-shrink-0"}),f.jsx("span",{className:"text-xs sm:text-sm",children:"Remove ALL Photos from Uploader"})]})}),f.jsx(Gr,{value:"hide_all_and_block",children:f.jsxs("div",{className:"flex items-center",children:[f.jsx(BT,{className:"h-3 w-3 sm:h-4 sm:w-4 mr-2 flex-shrink-0"}),f.jsx("span",{className:"text-xs sm:text-sm",children:"Remove ALL Photos & Block User"})]})}),f.jsx(Gr,{value:"rejected",children:f.jsxs("div",{className:"flex items-center",children:[f.jsx(Sg,{className:"h-3 w-3 sm:h-4 sm:w-4 mr-2 flex-shrink-0"}),f.jsx("span",{className:"text-xs sm:text-sm",children:"Reject Report (Keep Photo Visible)"})]})})]})]})]}),f.jsxs("div",{children:[f.jsx("label",{className:"text-xs sm:text-sm font-medium",children:"Admin Notes"}),f.jsx(s3,{value:a,onChange:E=>l(E.target.value),placeholder:"Add notes about your decision...",className:"mt-1 text-sm",rows:3})]}),f.jsxs("div",{className:"flex flex-col sm:flex-row justify-end gap-2 sm:gap-2 sm:space-x-0",children:[f.jsx(_e,{variant:"outline",onClick:()=>o(null),disabled:h,className:"order-2 sm:order-1 text-sm h-9",children:"Cancel"}),f.jsx(_e,{onClick:()=>_(i.report_id,c,a),disabled:h,className:`order-1 sm:order-2 text-sm h-9 ${c==="rejected"?"bg-green-600 hover:bg-green-700":c==="hide_all_and_block"?"bg-red-800 hover:bg-red-900":"bg-red-600 hover:bg-red-700"}`,children:h?"Processing...":c==="approved"?"Remove Photo":c==="hide_all"?"Remove All Photos":c==="hide_all_and_block"?"Remove All & Block":"Keep Photo"})]})]})]})]})})]})},tZ=({selectedOtherCount:n,selectedMyCount:e,totalSelectedCount:t,onDownload:r,onClearSelection:s,isDownloading:i,disabled:o})=>t===0?null:f.jsx(Ht,{className:"fixed bottom-4 left-4 right-4 z-[60] p-4 bg-background/95 backdrop-blur-sm border-2 border-primary shadow-xl md:left-auto md:right-4 md:max-w-sm animate-fade-in",children:f.jsxs("div",{className:"flex items-center justify-between gap-4",children:[f.jsxs("div",{className:"flex-1",children:[f.jsxs("div",{className:"font-semibold text-sm",children:[t," photo",t!==1?"s":""," selected"]}),f.jsxs("div",{className:"text-xs text-muted-foreground",children:[n>0&&`${n} event`,n>0&&e>0&&", ",e>0&&`${e} mine`]})]}),f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx(_e,{variant:"outline",size:"sm",onClick:s,disabled:i,children:f.jsx(ha,{className:"h-4 w-4"})}),f.jsxs(_e,{onClick:r,disabled:o||i,size:"sm",className:"gap-2",children:[f.jsx(Gl,{className:"h-4 w-4"}),i?"Downloading...":"Download"]})]})]})});var i3="AlertDialog",[nZ,Hee]=xo(i3,[aI]),pi=aI(),o3=n=>{const{__scopeAlertDialog:e,...t}=n,r=pi(e);return f.jsx($1,{...r,...t,modal:!0})};o3.displayName=i3;var rZ="AlertDialogTrigger",sZ=b.forwardRef((n,e)=>{const{__scopeAlertDialog:t,...r}=n,s=pi(t);return f.jsx(z1,{...s,...r,ref:e})});sZ.displayName=rZ;var iZ="AlertDialogPortal",a3=n=>{const{__scopeAlertDialog:e,...t}=n,r=pi(e);return f.jsx(W1,{...r,...t})};a3.displayName=iZ;var oZ="AlertDialogOverlay",l3=b.forwardRef((n,e)=>{const{__scopeAlertDialog:t,...r}=n,s=pi(t);return f.jsx(N0,{...s,...r,ref:e})});l3.displayName=oZ;var Al="AlertDialogContent",[aZ,lZ]=nZ(Al),c3=b.forwardRef((n,e)=>{const{__scopeAlertDialog:t,children:r,...s}=n,i=pi(t),o=b.useRef(null),a=ct(e,o),l=b.useRef(null);return f.jsx(_Y,{contentName:Al,titleName:u3,docsSlug:"alert-dialog",children:f.jsx(aZ,{scope:t,cancelRef:l,children:f.jsxs(j0,{role:"alertdialog",...i,...s,ref:a,onOpenAutoFocus:De(s.onOpenAutoFocus,c=>{var u;c.preventDefault(),(u=l.current)==null||u.focus({preventScroll:!0})}),onPointerDownOutside:c=>c.preventDefault(),onInteractOutside:c=>c.preventDefault(),children:[f.jsx(vw,{children:r}),f.jsx(uZ,{contentRef:o})]})})})});c3.displayName=Al;var u3="AlertDialogTitle",d3=b.forwardRef((n,e)=>{const{__scopeAlertDialog:t,...r}=n,s=pi(t);return f.jsx(L0,{...s,...r,ref:e})});d3.displayName=u3;var h3="AlertDialogDescription",f3=b.forwardRef((n,e)=>{const{__scopeAlertDialog:t,...r}=n,s=pi(t);return f.jsx(M0,{...s,...r,ref:e})});f3.displayName=h3;var cZ="AlertDialogAction",p3=b.forwardRef((n,e)=>{const{__scopeAlertDialog:t,...r}=n,s=pi(t);return f.jsx(F0,{...s,...r,ref:e})});p3.displayName=cZ;var g3="AlertDialogCancel",m3=b.forwardRef((n,e)=>{const{__scopeAlertDialog:t,...r}=n,{cancelRef:s}=lZ(g3,t),i=pi(t),o=ct(e,s);return f.jsx(F0,{...i,...r,ref:o})});m3.displayName=g3;var uZ=({contentRef:n})=>{const e=`\`${Al}\` requires a description for the component to be accessible for screen reader users.

You can add a description to the \`${Al}\` by passing a \`${h3}\` component as a child, which also benefits sighted users by adding visible context to the dialog.

Alternatively, you can use your own component as a description by assigning it an \`id\` and passing the same value to the \`aria-describedby\` prop in \`${Al}\`. If the description is confusing or duplicative for sighted users, you can use the \`@radix-ui/react-visually-hidden\` primitive as a wrapper around your description component.

For more information, see https://radix-ui.com/primitives/docs/components/alert-dialog`;return b.useEffect(()=>{var r;document.getElementById((r=n.current)==null?void 0:r.getAttribute("aria-describedby"))||console.warn(e)},[e,n]),null},dZ=o3,hZ=a3,v3=l3,y3=c3,x3=p3,w3=m3,b3=d3,_3=f3;const S3=dZ,fZ=hZ,C3=b.forwardRef(({className:n,...e},t)=>f.jsx(v3,{className:Oe("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",n),...e,ref:t}));C3.displayName=v3.displayName;const ub=b.forwardRef(({className:n,children:e,...t},r)=>{const s=b.useRef(null);return b.useEffect(()=>{const i=s.current;if(!i)return;const o=a=>{const l=a.target;(l.tagName==="INPUT"||l.tagName==="TEXTAREA"||l.contentEditable==="true")&&setTimeout(()=>{l.scrollIntoView({behavior:"smooth",block:"center",inline:"nearest"})},150)};return i.addEventListener("focusin",o),()=>{i.removeEventListener("focusin",o)}},[]),f.jsxs(fZ,{children:[f.jsx(C3,{}),f.jsx(y3,{ref:r,className:Oe("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg radix-alert-dialog-content",n),...t,children:f.jsx("div",{ref:s,className:"dialog-body overflow-auto -mx-6 px-6",children:e})})]})});ub.displayName=y3.displayName;const db=({className:n,...e})=>f.jsx("div",{className:Oe("flex flex-col space-y-2 text-center sm:text-left",n),...e});db.displayName="AlertDialogHeader";const hb=({className:n,...e})=>f.jsx("div",{className:Oe("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2 kb-safe-padding",n),...e});hb.displayName="AlertDialogFooter";const fb=b.forwardRef(({className:n,...e},t)=>f.jsx(b3,{ref:t,className:Oe("text-lg font-semibold",n),...e}));fb.displayName=b3.displayName;const pb=b.forwardRef(({className:n,...e},t)=>f.jsx(_3,{ref:t,className:Oe("text-sm text-muted-foreground",n),...e}));pb.displayName=_3.displayName;const gb=b.forwardRef(({className:n,...e},t)=>f.jsx(x3,{ref:t,className:Oe(l1(),n),...e}));gb.displayName=x3.displayName;const mb=b.forwardRef(({className:n,...e},t)=>f.jsx(w3,{ref:t,className:Oe(l1({variant:"outline"}),"mt-2 sm:mt-0",n),...e}));mb.displayName=w3.displayName;const pZ=({selectedCount:n,onOpenSettings:e,onClose:t,visible:r})=>f.jsx(S3,{open:r,onOpenChange:s=>!s&&t(),children:f.jsxs(ub,{children:[f.jsxs(db,{children:[f.jsx("div",{className:"flex justify-center mb-4",children:f.jsx("div",{className:"w-16 h-16 rounded-full bg-orange-100 dark:bg-orange-900/20 flex items-center justify-center",children:f.jsx(Yf,{className:"h-8 w-8 text-orange-600 dark:text-orange-400"})})}),f.jsx(fb,{className:"text-center",children:"WiFi-Only Downloads Enabled"}),f.jsxs(pb,{className:"text-center space-y-3",children:[f.jsxs("p",{children:["You have ",n," photo",n!==1?"s":""," selected for download, but you're currently on cellular data."]}),f.jsx("p",{className:"text-sm text-muted-foreground",children:" Connect to WiFi or change your download preferences in Settings"})]})]}),f.jsxs(hb,{className:"flex-col sm:flex-row gap-2",children:[f.jsx(mb,{onClick:t,children:"Wait for WiFi"}),f.jsx(gb,{onClick:e,children:"Update Settings"})]})]})}),gZ=n=>{const e=["AMAZING","EPIC","MAGICAL","SUNNY","GOLDEN","BRIGHT"],t=["PARTY","EVENT","CELEBRATION","GATHERING","MOMENTS","MEMORIES"],r=n.replace(/-/g,"").toLowerCase(),s=parseInt(r.slice(0,2),16)%e.length,i=parseInt(r.slice(2,4),16)%t.length,o=parseInt(r.slice(4,6),16)%100;return`${e[s]}${t[i]}${o}`},mZ=()=>{var _b,Sb;const{eventId:n}=E6(),{user:e}=Or(),{toast:t}=Bt(),[r]=vs().toString().includes("?")?[new URLSearchParams(window.location.search)]:[new URLSearchParams],{takePicture:s,isTakingPicture:i}=xq(),o=vs();(_b=window.CapacitorPushNotifications)!=null&&_b.isRegistered();const a=((Sb=window.CapacitorPushNotifications)==null?void 0:Sb.getToken())||null,{preferences:l,toggleNotifications:c,getNotificationSchedule:u}=X1();kK();const{settings:h,loadSettings:d,updateSettings:p,loading:m}=oJ();PH();const{deviceInfo:g,isNative:y,platform:x,isOnline:v,dbPlatform:w}=Od(),{pickEventPhotos:_,isPickingPhotos:S}=AH(),{createEventNotificationSettings:E,removeEventNotificationSettings:C,getEventNotificationSettings:P}=aJ(),{shouldShowOnboarding:O,currentStep:A,isLoading:R,markStepComplete:B}=cJ(),[I,L]=b.useState(null),[U,F]=b.useState(!0),[D,k]=b.useState("online"),[N,M]=b.useState(!1),[T,j]=b.useState(!1),[$,z]=b.useState(""),[ee,X]=b.useState(!1),[J,K]=b.useState(!1),[ne,ie]=b.useState([]),[ae,W]=b.useState(!1),[H,G]=b.useState(null),[Q,te]=b.useState([]),[he,xe]=b.useState(!1),[fe,be]=b.useState(!1);b.useState([]);const[Pe,Se]=b.useState(!0),[Ye,Ve]=b.useState(!1),[Ge,Re]=b.useState(""),[ge,et]=b.useState(!0),[tt,ke]=b.useState(!1),[st,it]=b.useState(""),[xt,Tn]=b.useState(!0),[yn,gt]=b.useState(0),[Ao,le]=b.useState(!1),Ce=b.useRef(null),{otherPhotos:we,myPhotos:Me,totalCount:Ne,fetchPhotos:jt,loading:Ot,error:rn}=wq(n||"");b.useEffect(()=>{console.log(" useEventPhotosSectioned Data Update:",{eventId:n,loading:Ot,error:rn,otherPhotosCount:we.length,myPhotosCount:Me.length,totalCount:Ne,otherPhotos:we.slice(0,2),myPhotos:Me.slice(0,2)})},[n,Ot,rn,we.length,Me.length,Ne]);const{selectedOtherPhotos:hn,selectedMyPhotos:mr,togglePhoto:vr,selectAllOther:An,selectAllMine:gi,clearSelection:yr,getSelectedCount:qt,getAllSelected:ss}=bq(),{isDownloading:Bd,startDownload:V0}=_q(),{preference:E3}=YO("wifiOnlyDownloads","true"),{connectionType:k3}=a1(),{getUploadStatus:vb}=lJ(),[Aa,P3]=b.useState(null),yb=()=>{gt(re=>re+1),jt()};b.useEffect(()=>{const re=r.get("action");re==="download"&&I&&!U&&(console.log(" [WEB] Deep link download action detected, opening bulk download overlay"),setTimeout(async()=>{Tc()?(console.log(" [WEB] Opening native bulk download overlay"),await G0()):(console.log(" [WEB] Enabling selection mode for web download"),be(!0),Ud()),window.history.replaceState({},"",`/event/${n}`)},500)),re==="upload"&&I&&!U&&T&&(console.log(" [WEB] Deep link upload action detected"),setTimeout(()=>{h!=null&&h.auto_upload_enabled?console.log(" [WEB] Auto-upload enabled, EventAutoUploadProvider will handle upload"):(console.log(" [WEB] Auto-upload not enabled, opening photo picker"),wb()),window.history.replaceState({},"",`/event/${n}`)},500))},[r,I,U,n,T,h]);const Tc=()=>{const re=de.Plugins;return de.isNativePlatform()&&(re==null?void 0:re.BulkDownload)},G0=async()=>{if(I)try{const re=[...we,...Me];let Ee=re;if(console.log(" Download Debug:",{otherPhotosCount:we.length,myPhotosCount:Me.length,totalPhotosCount:re.length,photosCountFromHook:Ne,eventId:I.id}),Ee.length===0)try{const{data:Xe}=await ue.auth.getSession(),rr=Xe.session;if(rr){const sr="https://jgfcfdlfcnmaripgpepl.supabase.co",Cs="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImpnZmNmZGxmY25tYXJpcGdwZXBsIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTI1NDM2MjgsImV4cCI6MjA2ODExOTYyOH0.OmkqPDJM8-BKLDo5WxsL8Nop03XxAaygNaToOMKkzGY",$d=`${sr}/functions/v1/get-uploaded-photos?event_id=${I.id}&section=true&limit=100`,mi=await fetch($d,{method:"GET",headers:{Authorization:`Bearer ${rr.access_token}`,apikey:Cs}});if(mi.ok){const zd=await mi.json(),Dc=zd.otherPhotos||[],G3=zd.myPhotos||[];Ee=[...Dc,...G3],console.log(" Fallback fetch got photos:",Ee.length)}else console.warn("Fallback fetch failed with status",mi.status)}}catch(Xe){console.warn("Fallback fetch error:",Xe)}if(Ee.length===0){Ud();return}const We=[...new Set(Ee.map(Xe=>Xe.uploader_id))],oe=await Ep(We),ve=new Map(oe.map(Xe=>[Xe.user_id,Xe])),Ue=Ee.map(Xe=>{const rr=ve.get(Xe.uploader_id),sr=rr?kp(rr):"Unknown",Cs=Xe.file_url.includes("?")?`${Xe.file_url}&width=300&height=300`:`${Xe.file_url}?width=300&height=300`;return{id:Xe.media_id,thumbnailUrl:Cs,fullUrl:Xe.file_url,title:`Photo - ${new Date(Xe.upload_time).toLocaleDateString()}`,uploadedBy:sr,uploadedAt:new Date(Xe.upload_time).toISOString().split("T")[0],isOwn:Xe.uploader_id===(e==null?void 0:e.id)}}),Fe=de.Plugins.BulkDownload,ot={eventId:I.id,eventName:I.name,photos:Ue};console.log(" Calling native BulkDownload.openBulkDownload():",{eventId:ot.eventId,eventName:ot.eventName,photoCount:ot.photos.length,samplePhoto:ot.photos[0],allPhotoIds:ot.photos.map(Xe=>Xe.id)}),await Fe.openBulkDownload(ot),console.log(" Native download UI launched with",Ue.length,"photos")}catch(re){console.error(" Native download failed:",re),t({title:"Download failed",description:re.message||"Could not open download interface",variant:"destructive"})}},xb=async()=>{if(qt()===0){t({title:"No photos selected",description:"Please select photos to download",variant:"destructive"});return}if(E3==="true"&&!(k3==="wifi")){le(!0);return}const oe=ss();await V0(n||"",oe)&&(yr(),be(!1))},T3=re=>{console.log("Select All clicked!",{allIdsCount:re.length}),An([]),gi(re),console.log("After select all trigger (counts may update async):",{requestedSelectCount:re.length})},Ud=()=>{setTimeout(()=>{var re;(re=Ce.current)==null||re.scrollIntoView({behavior:"smooth",block:"start"})},100)},Ac=b.useCallback(async()=>{if(!n)return;const re=await vb(n);if(re){const Ee=(Aa==null?void 0:Aa.summary.completed)||0;P3(re),re.summary.completed>Ee&&(console.log("New uploads completed, refreshing photo list"),yb()),(re.summary.pending>0||re.summary.uploading>0)&&setTimeout(Ac,3e3)}},[n,vb,Aa==null?void 0:Aa.summary.completed]);b.useEffect(()=>{const re=()=>{console.log("Upload complete event received"),Ac()},Ee=We=>{console.error("Upload error event:",We.detail)};return window.addEventListener("uploadComplete",re),window.addEventListener("uploadError",Ee),()=>{window.removeEventListener("uploadComplete",re),window.removeEventListener("uploadError",Ee)}},[Ac]),b.useEffect(()=>{n&&Ac()},[n,Ac]);const A3=async()=>{var re,Ee,We;console.log(" openCameraDirectly function called on platform:",de.getPlatform()),console.log(" Is native platform:",de.isNativePlatform()),console.log(" User agent:",navigator.userAgent),console.log(" Event object:",I);try{console.log(" Checking camera permissions...");const oe=await am();if(!oe.granted){console.log(" Camera permission not granted:",oe),it(oe.message||"Camera access is required to take photos."),Tn(oe.canPrompt||!1),ke(!0);return}console.log(" Camera permission granted, calling getPhoto...");const{useCameraPicture:ve}=await Ae(async()=>{const{useCameraPicture:rr}=await Promise.resolve().then(()=>DH);return{useCameraPicture:rr}},void 0),{takePicture:Ue}=ve(),Fe=await Ue();if(!Fe){console.log(" Camera capture was cancelled or failed");return}const Xe={dataUrl:await new Promise(rr=>{const sr=new FileReader;sr.onload=()=>rr(sr.result),sr.readAsDataURL(Fe)}),format:"jpeg",webPath:URL.createObjectURL(Fe)};console.log(" Camera getPhoto successful, image received:",!!Xe.dataUrl),Xe.dataUrl?(console.log(" Navigating to camera page with captured image"),o(`/camera/${I.id}`,{state:{capturedImage:Xe.dataUrl}})):(console.log(" No image data received"),t({title:"Camera Error",description:"No image data received from camera.",variant:"destructive"}))}catch(oe){if(console.error(" Camera error in EventDetails:",oe),console.log(" Error type:",typeof oe),console.log(" Error message:",oe==null?void 0:oe.message),console.log(" Error code:",oe==null?void 0:oe.code),console.log(" Full error object:",JSON.stringify(oe,null,2)),(re=oe==null?void 0:oe.message)!=null&&re.includes("cancelled")||(Ee=oe==null?void 0:oe.message)!=null&&Ee.includes("canceled")||(We=oe==null?void 0:oe.message)!=null&&We.includes("User cancelled")||(oe==null?void 0:oe.code)==="USER_CANCELLED"){console.log(" User cancelled camera, not showing error");return}t({title:"Camera Error",description:`Unable to access camera: ${(oe==null?void 0:oe.message)||"Unknown error"}`,variant:"destructive"})}},wb=async()=>{var re,Ee,We,oe;try{if(console.log(" Selecting photos from gallery..."),de.isNativePlatform()){const Ue=await II();if(!Ue.granted){Re(Ue.message||"Photo library access required"),et(Ue.canPrompt||!1),Ve(!0);return}}if(console.log(" EventDetails: Starting photo selection..."),console.log(" EventDetails: Current event data:",I),!I){console.error(" EventDetails: No event data available"),t({title:"Event data missing",description:"Cannot access photos without valid event information.",variant:"destructive"});return}if(!I.id||!I.name||!I.startTime||!I.endTime){console.error(" EventDetails: Incomplete event data:",{id:I.id,name:I.name,startTime:I.startTime,endTime:I.endTime}),t({title:"Incomplete event data",description:"Event information is incomplete. Please try again.",variant:"destructive"});return}const ve=await _({eventId:I.id,eventName:I.name,startTime:I.startTime,endTime:I.endTime});if(ve&&ve.length>0){console.log(` Selected ${ve.length} photos from EventPhotoPicker`);const Ue=ve.map(async(ot,Xe)=>{const rr=await new Promise(sr=>{const Cs=new FileReader;Cs.onload=()=>sr(Cs.result),Cs.readAsDataURL(ot)});return{id:Xe,dataUrl:rr,timestampInfo:null,originalTimestamp:null,withinEvent:!1}}),Fe=await Promise.all(Ue);o(`/camera/${I.id}`,{state:{galleryPhotos:Fe,selectedPhotos:new Set(Fe.map(ot=>ot.id))}})}}catch(ve){if(console.error("Gallery selection error:",ve),(re=ve==null?void 0:ve.message)!=null&&re.includes("cancelled")||(Ee=ve==null?void 0:ve.message)!=null&&Ee.includes("canceled")||(ve==null?void 0:ve.code)==="USER_CANCELLED")return;if((We=ve==null?void 0:ve.message)!=null&&We.includes("permission")||(oe=ve==null?void 0:ve.message)!=null&&oe.includes("denied")){Re("Photo library access was denied. Please enable photo permissions in your device settings to use this feature."),et(!1),Ve(!0);return}t({title:"Gallery Error",description:`Unable to access photo gallery: ${(ve==null?void 0:ve.message)||"Unknown error"}`,variant:"destructive"})}},D3=async()=>{const re=await VY();re.granted?(Ve(!1),wb()):(Re(re.message||"Photo permission required"),et(re.canPrompt||!1))},O3=async()=>{await GY(),Ve(!1)},I3=async()=>{const re=await am();re.granted?(ke(!1),A3()):(it(re.message||"Camera permission required"),Tn(re.canPrompt||!1))},R3=async()=>{await Cq(),ke(!1)},N3=async()=>{try{if((await Yw.getInfo()).platform==="web"){if(!navigator.mediaDevices||!navigator.mediaDevices.getUserMedia){Se(!1);return}try{const We=(await navigator.mediaDevices.enumerateDevices()).some(oe=>oe.kind==="videoinput");Se(We)}catch(Ee){console.log("Camera check failed, assuming camera available:",Ee),Se(!0)}}else Se(!0)}catch(re){console.error("Error checking camera availability:",re),Se(!0)}};b.useEffect(()=>{N3(),j3();const re=()=>k("online"),Ee=()=>k("offline");return window.addEventListener("online",re),window.addEventListener("offline",Ee),()=>{window.removeEventListener("online",re),window.removeEventListener("offline",Ee)}},[n,e,o]),b.useEffect(()=>{(async()=>{if(!n||!e)return;const Ee=await P(n);M(Ee!==null)})()},[n,e]),b.useEffect(()=>(I&&I.id&&(window.currentEvent={eventId:I.id,eventName:I.name,startTime:I.startTime,endTime:I.endTime,allowMultipleSelection:!0},console.log(" Exposed event data to window.currentEvent:",window.currentEvent)),()=>{delete window.currentEvent}),[I]);const j3=async()=>{var re,Ee,We;try{if(!n)return;const{data:oe,error:ve}=await ue.from("events").select(`
          event_id,
          name,
          description,
          start_time,
          end_time,
          timezone,
          status,
          owner_id,
          passcode,
          allow_uploads_after_end,
          retention_days,
          final_participant_count,
          final_photo_count,
          photos_deleted_at,
          header_image_url,
          qr_code_image_url,
          invite_links(
            link
          )
        `).eq("event_id",n).maybeSingle();if(ve){console.error("Error loading event:",ve),console.error("Event ID:",n),console.error("User ID:",e==null?void 0:e.id),console.error("Error details:",JSON.stringify(ve,null,2)),t({title:"Failed to load event",description:`Error: ${ve.message||"Unknown error"}. Check console for details.`,variant:"destructive"});return}if(!oe){L(null);return}let Ue=null;if(e){const{data:Dc}=await ue.from("event_participants").select("*").eq("event_id",n).eq("user_id",e.id).maybeSingle();Ue=Dc,te((Ue==null?void 0:Ue.roles)||[])}j(!!Ue),Ue&&d(n);const{data:Fe,error:ot}=await ue.rpc("get_event_participant_count",{event_id_param:n});ot&&console.error("Error fetching participant count:",ot);let Xe=0;if(oe.photos_deleted_at)Xe=oe.final_photo_count||0;else{const{count:Dc}=await ue.from("media").select("media_id",{count:"exact"}).eq("event_id",n);Xe=Dc||0}const rr=oe.final_participant_count||Fe||0,sr=new Date,Cs=new Date(oe.start_time),$d=new Date(oe.end_time);let mi="upcoming";oe.status==="paused"?mi="paused":sr>=Cs&&sr<=$d?mi="live":sr>$d&&(mi="ended");const zd={id:oe.event_id,eventId:oe.event_id,name:hy(oe.name),description:oe.description?hy(oe.description):void 0,eventCode:((We=(Ee=(re=oe.invite_links)==null?void 0:re[0])==null?void 0:Ee.link)==null?void 0:We.split("/").pop())||gZ(oe.event_id),passcode:oe.passcode||void 0,startTime:oe.start_time,endTime:oe.end_time,timezone:oe.timezone,status:mi,participantCount:rr,photoCount:Xe,allowUploadsAfterEnd:oe.allow_uploads_after_end??!0,retentionDays:oe.retention_days||30,settings:{allowGuests:!0,requiresPasscode:!!oe.passcode,autoModeration:!0},ownerId:oe.owner_id,headerImageUrl:oe.header_image_url||void 0,qrCodeImageUrl:oe.qr_code_image_url||void 0};L(zd),!Ue&&(!e||e.id!==oe.owner_id)&&K(!0)}catch(oe){console.error("Failed to load event:",oe),t({title:"Failed to load event",description:"Please try again or check your connection.",variant:"destructive"})}finally{F(!1)}},L3=async()=>{if(!(!I||!$n&&!Do&&!Ss)){console.log("Loading participants for event:",I.eventId),console.log("Current user:",e==null?void 0:e.id),console.log("Is owner:",$n),console.log("Is admin:",Do),console.log("Is organizer:",Ss);try{const{data:re,error:Ee}=await ue.from("event_participants").select("user_id, joined_at, roles").eq("event_id",I.eventId).order("joined_at",{ascending:!1});if(console.log("Participants query result:",{participantsData:re,participantsError:Ee}),Ee){console.error("Error loading participants:",Ee);return}if(re&&re.length>0){const We=re.map(Ue=>Ue.user_id);console.log("Fetching user details for IDs:",We);const oe=await Ep(We);console.log("Users query result (safe):",{usersData:oe});const ve=re.map(Ue=>{const Fe=oe==null?void 0:oe.find(ot=>ot.user_id===Ue.user_id);return{id:Ue.user_id,name:kp(Fe||{name:null,email:null}),email:(Fe==null?void 0:Fe.email)||"",joinedAt:Ue.joined_at,roles:Ue.roles||["guest"]}});console.log("Formatted participants:",ve),ie(ve)}else console.log("No participants found"),ie([])}catch(re){console.error("Failed to load participants:",re)}}},M3=async(re,Ee)=>{var We;if(!(!I||!$n))try{const oe=Ee.includes("admin");let ve;oe?(ve=Ee.filter(Fe=>Fe!=="admin"),ve.length===0&&(ve=["guest"])):(ve=Ee.filter(Fe=>Fe!=="guest"),ve.push("admin"));const{error:Ue}=await ue.from("event_participants").update({roles:ve}).eq("event_id",I.eventId).eq("user_id",re);if(Ue){console.error("Error updating admin role:",Ue),t({title:"Failed to update admin role",description:"Please try again.",variant:"destructive"});return}ie(Fe=>Fe.map(ot=>ot.id===re?{...ot,roles:ve}:ot)),t({title:oe?"Admin role removed":"Admin role granted",description:`${(We=ne.find(Fe=>Fe.id===re))==null?void 0:We.name} is now ${oe?"no longer an admin":"an admin"}.`})}catch(oe){console.error("Unexpected error:",oe),t({title:"Failed to update role",description:"Please try again.",variant:"destructive"})}},F3=async(re,Ee)=>{var We;if(!(!I||!$n))try{const oe=Ee.includes("organizer");let ve;oe?(ve=Ee.filter(Fe=>Fe!=="organizer"),ve.length===0&&(ve=["guest"])):(ve=Ee.filter(Fe=>Fe!=="guest"),ve.push("organizer"));const{error:Ue}=await ue.from("event_participants").update({roles:ve}).eq("event_id",I.eventId).eq("user_id",re);if(Ue){console.error("Error updating organizer role:",Ue),t({title:"Failed to update organizer role",description:"Please try again.",variant:"destructive"});return}ie(Fe=>Fe.map(ot=>ot.id===re?{...ot,roles:ve}:ot)),t({title:oe?"Organizer role removed":"Organizer role granted",description:`${(We=ne.find(Fe=>Fe.id===re))==null?void 0:We.name} is now ${oe?"no longer an organizer":"an organizer"}.`})}catch(oe){console.error("Unexpected error:",oe),t({title:"Failed to update role",description:"Please try again.",variant:"destructive"})}},$n=I?(e==null?void 0:e.id)===I.ownerId:!1,Do=e&&Q.includes("admin"),Ss=e&&Q.includes("organizer"),bb=re=>{L(re)},B3=re=>{t({title:"Photo hidden",description:"Content has been removed from the gallery."})},U3=async()=>{var re,Ee,We,oe,ve;if(I)if(N)(await C(n)).success?(M(!1),console.log(" Notifications disabled for event"),t({title:"Notifications disabled",description:"You won't receive updates about this event."})):t({title:"Error",description:"Failed to disable notifications.",variant:"destructive"});else{let Ue=!1;try{const Fe=await((We=(Ee=(re=window.Capacitor)==null?void 0:re.Plugins)==null?void 0:Ee.AppPermissions)==null?void 0:We.requestNotificationPermission());Ue=(Fe==null?void 0:Fe.granted)||!1}catch(Fe){console.log("AppPermissions plugin not available, trying fallback:",Fe),Ue=await((oe=window.CapacitorPushNotifications)==null?void 0:oe.requestPermissions())||!1}if(Ue&&a){const Fe=new Date(I.endTime);Fe.setDate(Fe.getDate()+30),I.id,I.name,I.startTime,I.endTime,Fe.toISOString(),l.upcomingEvent,l.eventStarting,l.uploadPhotos,l.downloadPhotos,console.log(" Setting up FCM and notifications");const ot=await((ve=window.useMobileTokenHandler)==null?void 0:ve.requestPermissionAndGetToken());if(ot!=null&&ot.success){console.log(" FCM token registered successfully");const Xe=await E(n,{upcomingEvent:!0,eventStarting:!0,uploadReminder:!0,downloadReminder:!0});Xe.success?(M(!0),console.log(" Notification settings created"),t({title:"Notifications enabled",description:"You'll receive updates about this event."})):t({title:"Setup failed",description:Xe.error||"Failed to set up notifications.",variant:"destructive"})}else t({title:"Setup failed",description:ot.error||"Failed to get FCM token.",variant:"destructive"})}else t({title:"Permission denied",description:"Please enable notifications in your device settings.",variant:"destructive"})}},$3=async()=>{if(!(!I||!e)){X(!0);try{if(I.settings.requiresPasscode&&$!==I.passcode){t({title:"Invalid passcode",description:"Please enter the correct event passcode.",variant:"destructive"}),X(!1);return}const{error:re}=await ue.from("event_participants").upsert({event_id:I.id,user_id:e.id,roles:["guest"],joined_at:new Date().toISOString()},{onConflict:"event_id,user_id"});if(re){console.error("Failed to join event:",re),t({title:"Join failed",description:"Unable to join the event. Please try again.",variant:"destructive"});return}j(!0),K(!1),t({title:"Welcome to the event!",description:`You're now connected to ${I.name}. Start taking photos!`})}catch(re){console.error("Join failed:",re),t({title:"Join failed",description:"Unable to join the event. Please try again.",variant:"destructive"})}finally{X(!1)}}},z3=()=>{xe(!0)},W3=async re=>{if(!(!I||!$n))try{const{error:Ee}=await ue.from("blocked_users").insert({event_id:I.id,user_id:re});if(Ee){console.error("Error blocking user:",Ee),t({title:"Failed to block user",description:"Please try again.",variant:"destructive"});return}const{error:We}=await ue.from("event_participants").update({is_blocked:!0}).eq("event_id",I.id).eq("user_id",re);We&&console.error("Error updating participant status:",We),ie(oe=>oe.filter(ve=>ve.id!==re)),t({title:"User blocked",description:"The user has been blocked from this event."})}catch(Ee){console.error("Failed to block user:",Ee),t({title:"Failed to block user",description:"Please try again.",variant:"destructive"})}},H3=(re,Ee)=>{G({id:re,name:Ee}),W(!0)},V3=()=>{H&&(W3(H.id),W(!1),G(null))};return b.useEffect(()=>{I&&($n||Do||Ss)&&L3()},[I,$n,Do,Ss]),O&&!R?f.jsx(fJ,{currentStep:A,onStepComplete:B}):U?f.jsx("div",{className:"min-h-screen bg-background flex items-center justify-center",children:f.jsx("div",{className:"loading-shimmer w-32 h-32 rounded-full"})}):I?J?f.jsx("div",{className:"min-h-screen bg-gradient-to-br from-background via-background to-muted/20 flex items-center justify-center p-4",children:f.jsxs(Ht,{className:"w-full max-w-md event-card",children:[f.jsxs(Gs,{className:"text-center",children:[f.jsx("div",{className:"p-3 bg-gradient-primary rounded-full w-fit mx-auto mb-4",children:f.jsx(kr,{className:"h-8 w-8 text-primary-foreground"})}),f.jsxs(qs,{className:"text-xl",children:["Join ",I.name]}),f.jsx(Ys,{children:I.description||"Join this event to start sharing photos!"})]}),f.jsxs(Qt,{className:"space-y-4",children:[I.settings.requiresPasscode&&f.jsxs("div",{className:"space-y-2",children:[f.jsx(js,{htmlFor:"passcode",children:"Event Passcode"}),f.jsx(zo,{id:"passcode",type:"password",value:$,onChange:re=>z(re.target.value),placeholder:"Enter passcode",required:!0})]}),f.jsx("div",{className:"p-3 bg-primary/5 rounded-lg border border-primary/20",children:f.jsxs("div",{className:"flex items-start space-x-2",children:[f.jsx(LT,{className:"h-5 w-5 text-primary mt-0.5"}),f.jsxs("div",{children:[f.jsxs("p",{className:"font-medium text-sm",children:["Event Code: ",I.eventCode]}),f.jsxs("div",{className:"text-xs text-muted-foreground",children:["Status: ",f.jsx(Kr,{className:I.status==="live"?"bg-green-500":I.status==="upcoming"?"bg-blue-500":I.status==="paused"?"bg-orange-500":"bg-gray-500",children:I.status})]}),I.status!=="live"&&f.jsxs("div",{className:"flex items-center space-x-1 mt-1",children:[f.jsx(jT,{className:"h-3 w-3 text-orange-500"}),f.jsx("span",{className:"text-xs text-orange-600",children:"Event not currently active"})]})]})]})}),f.jsx(_e,{onClick:$3,className:"w-full camera-button",disabled:ee||I.status!=="live",children:ee?"Joining...":"Join Event"}),f.jsxs("div",{className:"text-center",children:[f.jsx("p",{className:"text-sm text-muted-foreground mb-2",children:"Want to create events?"}),f.jsx(_e,{variant:"outline",onClick:()=>o("/dashboard"),children:"Go to Dashboard"})]})]})]})}):f.jsxs(h1,{className:"pb-20",children:[f.jsx("div",{className:"sticky top-0 z-40 bg-background/80 backdrop-blur-md border-b border-border",children:f.jsx("div",{className:"container mx-auto px-4 py-3",children:f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsxs(_e,{variant:"ghost",size:"sm",onClick:()=>o("/dashboard"),className:"gap-2",children:[f.jsx(_w,{className:"w-4 h-4"}),"Back"]}),f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsxs(_e,{variant:"outline",size:"sm",className:"h-10 px-4",onClick:z3,children:[f.jsx(no,{className:"h-4 w-4 mr-2"}),f.jsx("span",{className:"hidden sm:inline",children:"QR"})]}),f.jsxs(_e,{variant:fe?"default":"outline",size:"sm",className:"h-10 px-4",onClick:async()=>{Tc()?await G0():fe&&qt()>0?xb():(be(!0),yr(),Ud())},disabled:!Tc()&&(Ne||(I==null?void 0:I.photoCount)||0)===0,children:[f.jsx(Gl,{className:"h-4 w-4 mr-2"}),f.jsx("span",{className:"hidden sm:inline",children:"Download"})]}),f.jsx(LI,{variant:"outline",size:"default",pressed:N,onPressedChange:U3,className:"min-w-[48px] min-h-[48px] data-[state=on]:border-accent data-[state=on]:bg-transparent data-[state=off]:border-border","aria-label":N?"Disable notifications":"Enable notifications",children:N?f.jsx(ly,{className:"w-5 h-5 fill-accent text-accent"}):f.jsx(wL,{className:"w-5 h-5"})})]})]})})}),D==="offline"&&f.jsx("div",{className:"container mx-auto px-4 py-2",children:f.jsxs(Kr,{variant:"destructive",className:"flex items-center space-x-1 text-xs w-fit",children:[f.jsx(Yf,{className:"h-3 w-3"}),f.jsx("span",{children:"No Internet Detected"})]})}),f.jsx("div",{className:"w-full h-48 sm:h-64 md:h-80 overflow-hidden bg-muted relative",children:f.jsx("img",{src:I.headerImageUrl||RI,alt:I.headerImageUrl?`${I.name} header`:"PhotoShare default header",className:"w-full h-full object-cover object-center"})}),f.jsxs("div",{className:"px-4 py-6",children:[f.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[f.jsx(Kr,{className:I.status==="live"?"bg-green-500":I.status==="upcoming"?"bg-blue-500":I.status==="paused"?"bg-orange-500":"bg-gray-500",children:I.status}),f.jsx("h1",{className:"text-2xl font-bold",children:I.name})]}),I.description&&f.jsx("p",{className:"text-muted-foreground",children:I.description})]}),f.jsxs("div",{className:"container mx-auto px-4 pb-32",children:[($n||Do||Ss)&&f.jsxs("div",{className:"space-y-6 mb-8",children:[f.jsx(KQ,{event:I,onEventUpdate:bb,isAdmin:Do,isOrganizer:Ss}),($n||Ss)&&f.jsx(ZQ,{event:I,onEventUpdate:bb,userId:(e==null?void 0:e.id)||"",autoUploadEnabled:(h==null?void 0:h.auto_upload_enabled)??!0,onAutoUploadChange:re=>{d(I.eventId)}}),f.jsx(ux,{defaultOpen:!1,children:f.jsxs(Ht,{className:"mb-6",children:[f.jsx(Gs,{children:f.jsxs(dx,{className:"flex items-center justify-between w-full hover:opacity-80 transition-opacity [&[data-state=open]>svg]:rotate-180",children:[f.jsxs("div",{className:"text-left",children:[f.jsx(qs,{children:"Reported Photos"}),f.jsx(Ys,{children:"Manage content reports from participants"})]}),f.jsx(Hu,{className:"h-5 w-5 transition-transform duration-200 flex-shrink-0"})]})}),f.jsx(hx,{children:f.jsx(Qt,{children:f.jsx(eZ,{eventId:I.eventId})})})]})}),ne.length>0&&f.jsx(ux,{defaultOpen:!0,children:f.jsxs(Ht,{className:"event-card",children:[f.jsx(Gs,{children:f.jsxs(dx,{className:"flex items-center justify-between w-full hover:opacity-80 transition-opacity [&[data-state=open]>svg]:rotate-180",children:[f.jsxs("div",{className:"text-left",children:[f.jsx(qs,{className:"text-lg font-semibold",children:"Event Guests"}),f.jsxs(Ys,{className:"text-sm text-muted-foreground",children:["People who have joined this event (",ne.length,")"]})]}),f.jsx(Hu,{className:"h-5 w-5 transition-transform duration-200 flex-shrink-0"})]})}),f.jsx(hx,{children:f.jsx(Qt,{children:f.jsx("div",{className:"space-y-3",children:ne.map(re=>f.jsxs("div",{className:"flex items-start space-x-3 p-3 rounded-lg bg-muted/20",children:[f.jsx("div",{className:"w-8 h-8 bg-primary/10 rounded-full flex items-center justify-center flex-shrink-0",children:f.jsx(Xp,{className:"h-4 w-4 text-primary"})}),f.jsxs("div",{className:"min-w-0 flex-1",children:[f.jsxs("div",{className:"flex items-center space-x-2 mb-1",children:[f.jsx("p",{className:"text-sm font-medium truncate",children:re.name}),re.roles.includes("admin")&&f.jsx(G_,{className:"h-4 w-4 text-primary"}),re.roles.includes("organizer")&&f.jsx(q_,{className:"h-4 w-4 text-secondary"})]}),f.jsx("p",{className:"text-xs text-muted-foreground truncate mb-2",children:re.email}),re.id!==(e==null?void 0:e.id)&&$n&&f.jsxs("div",{className:"flex justify-end space-x-1",children:[f.jsx(_e,{variant:"outline",size:"sm",onClick:()=>M3(re.id,re.roles),className:"h-6 px-2 text-xs",title:re.roles.includes("admin")?"Remove Admin":"Make Admin",children:f.jsx(G_,{className:"h-3 w-3"})}),f.jsx(_e,{variant:"outline",size:"sm",onClick:()=>F3(re.id,re.roles),className:"h-6 px-2 text-xs",title:re.roles.includes("organizer")?"Remove Organizer":"Make Organizer",children:f.jsx(q_,{className:"h-3 w-3"})}),f.jsx(_e,{variant:"outline",size:"sm",onClick:()=>H3(re.id,re.name),className:"h-6 px-2 text-xs text-destructive",title:"Block User",children:f.jsx(BT,{className:"h-3 w-3"})})]})]})]},re.id))})})})]})})]}),f.jsxs("div",{ref:Ce,className:"space-y-6 pb-48 sm:pb-44 scroll-mt-16",children:[f.jsx(mJ,{eventId:I.id,isOwner:$n,isAdmin:Do,onPhotoBlock:B3,showCameraButton:!1,isSelectionMode:fe,selectedPhotos:[...hn,...mr],onPhotoSelect:(re,Ee)=>{const oe=we.some(ve=>ve.media_id===re)?"other":"mine";vr(re,oe)},onSelectAll:T3,onCancelSelection:()=>{be(!1),yr()},totalPhotoCount:Ne||(I==null?void 0:I.photoCount)||0},yn),f.jsx(tZ,{selectedOtherCount:hn.length,selectedMyCount:mr.length,totalSelectedCount:qt(),onDownload:xb,onClearSelection:()=>{yr(),be(!1)},isDownloading:Bd,disabled:qt()===0}),f.jsx(pZ,{selectedCount:qt(),onOpenSettings:()=>{le(!1),o("/settings")},onClose:()=>le(!1),visible:Ao})]})]})," ",f.jsx(S3,{open:ae,onOpenChange:W,children:f.jsxs(ub,{children:[f.jsxs(db,{children:[f.jsx(fb,{children:"Block User"}),f.jsxs(pb,{children:["Are you sure you want to block ",H==null?void 0:H.name," from this event? They will no longer be able to upload photos or participate in the event."]})]}),f.jsxs(hb,{children:[f.jsx(mb,{children:"Cancel"}),f.jsx(gb,{onClick:V3,className:"bg-destructive text-destructive-foreground hover:bg-destructive/90",children:"Block User"})]})]})}),f.jsx(eb,{open:he,onOpenChange:xe,children:f.jsxs(tb,{children:[f.jsxs(nb,{children:[f.jsxs(rb,{className:"flex items-center gap-2",children:[f.jsx(no,{className:"h-5 w-5"}),"Share Event"]}),f.jsx(sb,{children:"Scan the QR code or share the event link to invite guests"})]}),f.jsx(ib,{eventCode:I.eventCode,eventName:I.name,passcode:I.passcode,customQRCodeUrl:I.qrCodeImageUrl}),($n||Ss)&&f.jsx("div",{className:"px-4 pb-6",children:f.jsxs(_e,{className:"w-full",onClick:()=>{console.log("Fullscreen QR clicked:",{isOwner:$n,isUserOrganizer:Ss,eventStatus:I.status}),xe(!1),o(`/event/${I.id}/qr`)},children:[f.jsx(no,{className:"h-4 w-4 mr-2"}),"Full Screen QR Code"]})})]})}),(I.status==="upcoming"||I.status==="live"||I.status==="ended"&&I.allowUploadsAfterEnd)&&(T||$n)&&!fe&&f.jsx("div",{className:"fixed bottom-0 left-0 right-0 bg-gradient-to-r from-blue-500/10 via-purple-500/10 to-pink-500/10 backdrop-blur-lg border-t border-blue-300/30 shadow-[0_-4px_20px_rgba(59,130,246,0.2)] z-50 safe-area-bottom",children:f.jsx("div",{className:"container mx-auto px-4 py-4",children:f.jsxs("div",{className:"flex flex-col space-y-4",children:[f.jsx("div",{className:"text-center",children:f.jsx("h3",{className:"text-sm font-semibold text-foreground drop-shadow-md",children:"Share Photos"})}),I.status==="upcoming"?f.jsx("div",{className:"text-center py-2",children:f.jsx("p",{className:"text-sm text-muted-foreground",children:"Event hasn't started yet. Enable auto-upload to be ready!"})}):f.jsxs("div",{className:"flex gap-3",children:[I.status==="live"?Pe&&f.jsxs(_e,{variant:"outline",size:"lg",onClick:async re=>{console.log(" Camera button pushed - Platform info:",{buttonPushed:"camera",isCapacitorNative:de.isNativePlatform(),capacitorPlatform:de.getPlatform(),platform:x,timestamp:new Date().toISOString()}),re.preventDefault(),re.stopPropagation();const Ee=await am();if(!Ee.granted){it(Ee.message||"Camera access is required to take photos."),Tn(Ee.canPrompt||!1),ke(!0);return}console.log(" Calling takePicture with editor integration...");const We=await s();if(We){console.log(" Photo captured/edited, navigating to camera page with file");const oe=new FileReader;oe.onload=ve=>{var Ue;o(`/camera/${I.id}`,{state:{capturedImage:(Ue=ve.target)==null?void 0:Ue.result}})},oe.readAsDataURL(We)}else console.log(" Camera operation cancelled or failed")},className:"flex-1 h-12",children:[f.jsx(kr,{className:"h-5 w-5 mr-2 text-blue-500"}),"Camera"]}):I.status==="ended"?f.jsxs(_e,{variant:"outline",size:"lg",onClick:async()=>{Tc()?await G0():fe?(be(!1),yr()):(be(!0),yr(),Ud())},disabled:!Tc()&&(Ne||(I==null?void 0:I.photoCount)||0)===0,className:"flex-1 h-12",children:[f.jsx(Gl,{className:"h-5 w-5 mr-2 text-green-500"}),fe?"Cancel Selection":"Download"]}):null,f.jsxs(_e,{variant:"outline",size:"lg",onClick:async re=>{re.preventDefault(),re.stopPropagation(),console.log(" Upload button clicked - Device info:",{platform:x,isNative:y,deviceInfo:g,isOnline:v,userAgent:navigator.userAgent,capacitorPlatform:de.getPlatform(),isCapacitorNative:de.isNativePlatform()});const Ee={eventId:I.id,eventName:I.name,startTime:I.startTime,endTime:I.endTime},We=await _(Ee);if(We.length>0){if(console.log(` ${We.length} files selected`),y&&de.isNativePlatform()){console.log(" Native platform - plugin handling upload, staying on event page"),t({title:"Upload in progress",description:`${We.length} photo${We.length>1?"s":""} selected. Upload handled by native app.`}),setTimeout(()=>{yb()},2e3);return}console.log(" Web platform - navigating to /camera for processing");const oe=await Promise.all(We.map(async(ve,Ue)=>{const Fe=await new Promise(ot=>{const Xe=new FileReader;Xe.onload=()=>ot(Xe.result),Xe.readAsDataURL(ve)});return{id:Ue,dataUrl:Fe,timestampInfo:null,originalTimestamp:null,withinEvent:!1}}));o(`/camera/${I.id}`,{state:{galleryPhotos:oe,selectedPhotos:new Set(oe.map(ve=>ve.id))}})}},disabled:S,className:"flex-1 h-12",children:[f.jsx(da,{className:"h-5 w-5 mr-2 text-green-500"}),"Upload"]})]}),f.jsx(HY,{eventId:I.id,eventName:I.name,eventStartTime:I.startTime,eventEndTime:I.endTime,variant:"inline"})]})})}),f.jsx(AY,{isOpen:Ye,onClose:()=>Ve(!1),onRequestPermission:D3,onOpenSettings:O3,message:Ge,canPrompt:ge}),f.jsx(DY,{isOpen:tt,onClose:()=>ke(!1),onRequestPermission:I3,onOpenSettings:R3,message:st,canPrompt:xt})]}):f.jsx("div",{className:"min-h-screen bg-background flex items-center justify-center",children:f.jsxs("div",{className:"text-center space-y-4",children:[f.jsx("h2",{className:"text-xl font-semibold",children:"Event not found"}),f.jsx("p",{className:"text-muted-foreground",children:"This event may have been deleted or is no longer available."}),f.jsx(_e,{onClick:()=>o("/dashboard"),children:e?"Back to Dashboard":"Find Events"})]})})},I2=()=>f.jsx("div",{className:"min-h-screen bg-gradient-to-br from-background via-background to-muted/20 flex items-center justify-center",children:f.jsxs("div",{className:"text-center space-y-6",children:[f.jsx("div",{className:"flex items-center justify-center mb-4",children:f.jsx("h1",{className:"text-4xl font-bold bg-gradient-to-r from-primary to-accent bg-clip-text text-transparent",children:"PhotoShare"})}),f.jsxs("div",{className:"flex items-center justify-center space-x-2",children:[f.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"}),f.jsx("p",{className:"text-muted-foreground text-lg",children:"Loading..."})]})]})}),vZ=()=>{const[n,e]=b.useState(null),[t,r]=b.useState(!0),{user:s,isAuthenticated:i,isLoading:o}=Or();return b.useEffect(()=>{(async()=>{if(!o){if(!i||!(s!=null&&s.id)){console.log(" Not authenticated, staying on root"),e(null),r(!1);return}if(de.isNativePlatform()){console.log(" Native platform detected, skipping route resolution, routing to dashboard"),e("/dashboard"),r(!1);return}console.log(" Resolving initial route for user:",s.id);try{const l=new Promise((h,d)=>setTimeout(()=>d(new Error("Timeout")),3e3)),c=yZ(s.id),u=await Promise.race([c,l]);if(console.log(" Live events found:",u.length),u.length===1){const h=u[0].event_id,p=de.isNativePlatform()?`/event/${h}`:`/camera/${h}?autoCamera=true`;console.log(" Single live event, routing to:",p),e(p)}else console.log(" Multiple or no live events, routing to dashboard"),e("/dashboard")}catch(l){console.log(" Error or timeout checking events, defaulting to dashboard:",l),e("/dashboard")}finally{r(!1)}}})()},[i,o,s==null?void 0:s.id]),{targetRoute:n,isResolving:t}};async function yZ(n){const e=new Date().toISOString(),[t,r]=await Promise.all([ue.from("events").select("event_id, status").eq("owner_id",n).lte("start_time",e).gte("end_time",e).neq("status","paused"),ue.from("event_participants").select(`
        events!inner(
          event_id,
          status
        )
      `).eq("user_id",n).lte("events.start_time",e).gte("events.end_time",e).neq("events.status","paused")]),s=t.data||[],o=(r.data||[]).map(l=>l.events),a=new Map;return[...s,...o].forEach(l=>{a.has(l.event_id)||a.set(l.event_id,l)}),Array.from(a.values())}const xZ=()=>{const{isAuthenticated:n,isLoading:e}=Or(),{targetRoute:t,isResolving:r}=vZ(),s=vs();return b.useEffect(()=>{!r&&t&&(console.log(" RootRoute: Navigating to resolved route:",t),s(t,{replace:!0}))},[t,r,s]),e||r?f.jsx(I2,{}):n?f.jsx(I2,{}):f.jsx(Gy,{})},wZ=b.lazy(()=>Ae(()=>import("./Dashboard-BHYlAOpn.js"),__vite__mapDeps([0,1,2,3]))),bZ=b.lazy(()=>Ae(()=>import("./AdminDashboard-CU8KvEIB.js"),__vite__mapDeps([4,5,6]))),_Z=b.lazy(()=>Ae(()=>import("./CreateEvent-D3rAg9uo.js"),__vite__mapDeps([7,8,9]))),SZ=b.lazy(()=>Ae(()=>import("./FullscreenQR-oK-T1Zbs.js"),[])),CZ=b.lazy(()=>Ae(()=>import("./Camera-CAx9bHLJ.js"),__vite__mapDeps([10,11,12]))),R2=b.lazy(()=>Ae(()=>import("./JoinEvent-BbPYzfbI.js"),__vite__mapDeps([13,9,14]))),EZ=b.lazy(()=>Ae(()=>import("./Settings-rrgpavlv.js"),__vite__mapDeps([15,16,1,12]))),kZ=b.lazy(()=>Ae(()=>import("./TestDownloadPicker-CH7ogvDp.js"),__vite__mapDeps([17,18]))),PZ=b.lazy(()=>Ae(()=>import("./Styles-DB_OukcW.js"),__vite__mapDeps([19,18,3]))),Qe=()=>f.jsxs("div",{className:"flex items-center justify-center min-h-screen",children:[f.jsx("div",{className:"loading-spinner",children:f.jsx("div",{className:"spinner-ring"})}),f.jsx("div",{className:"ml-4 text-muted-foreground",children:"Loading..."})]}),TZ=new YF,AZ=()=>(b.useEffect(()=>{console.log(" Capacitor.isNativePlatform():",de.isNativePlatform()),console.log(" Capacitor.getPlatform():",de.getPlatform()),de.isNativePlatform()&&(document.body.classList.add("capacitor-app"),document.documentElement.classList.add("capacitor-app"))},[]),eH({overlay:!1,style:zy.Light,backgroundColor:"#000000"}),_4(!0),f.jsxs("div",{className:"safe-area-full min-h-screen",children:[f.jsx(tH,{}),f.jsx(q6,{children:f.jsxs(B6,{children:[f.jsx(ze,{path:"/",element:f.jsx(xZ,{})}),f.jsx(ze,{path:"/join",element:f.jsx(b.Suspense,{fallback:f.jsx(Qe,{}),children:f.jsx(R2,{})})}),f.jsx(ze,{path:"/join/:eventCode",element:f.jsx(b.Suspense,{fallback:f.jsx(Qe,{}),children:f.jsx(R2,{})})}),f.jsx(ze,{path:"/dashboard",element:f.jsx(La,{children:f.jsx(b.Suspense,{fallback:f.jsx(Qe,{}),children:f.jsx(wZ,{})})})}),f.jsx(ze,{path:"/create-event",element:f.jsx(La,{children:f.jsx(b.Suspense,{fallback:f.jsx(Qe,{}),children:f.jsx(_Z,{})})})}),f.jsx(ze,{path:"/event/:eventId",element:f.jsx(La,{children:f.jsx(mZ,{})})}),f.jsx(ze,{path:"/event/:eventId/qr",element:f.jsx(La,{children:f.jsx(b.Suspense,{fallback:f.jsx(Qe,{}),children:f.jsx(SZ,{})})})}),f.jsx(ze,{path:"/camera/:eventId",element:f.jsx(La,{children:f.jsx(b.Suspense,{fallback:f.jsx(Qe,{}),children:f.jsx(CZ,{})})})}),f.jsx(ze,{path:"/settings",element:f.jsx(La,{children:f.jsx(b.Suspense,{fallback:f.jsx(Qe,{}),children:f.jsx(EZ,{})})})}),f.jsx(ze,{path:"/admin/dashboard",element:f.jsx(nH,{children:f.jsx(b.Suspense,{fallback:f.jsx(Qe,{}),children:f.jsx(bZ,{})})})}),f.jsx(ze,{path:"/testdownloadpicker",element:f.jsx(b.Suspense,{fallback:f.jsx(Qe,{}),children:f.jsx(kZ,{})})}),f.jsx(ze,{path:"/styles",element:f.jsx(b.Suspense,{fallback:f.jsx(Qe,{}),children:f.jsx(PZ,{})})}),f.jsx(ze,{path:"/test/index",element:f.jsx(b.Suspense,{fallback:f.jsx(Qe,{}),children:Y.createElement(b.lazy(()=>Ae(()=>import("./TestIndex-Dz_wZ-v9.js"),[])))})}),f.jsx(ze,{path:"/test/dashboard",element:f.jsx(b.Suspense,{fallback:f.jsx(Qe,{}),children:Y.createElement(b.lazy(()=>Ae(()=>import("./TestDashboard-D3glmJ79.js"),__vite__mapDeps([20,2,3]))))})}),f.jsx(ze,{path:"/test/create-event",element:f.jsx(b.Suspense,{fallback:f.jsx(Qe,{}),children:Y.createElement(b.lazy(()=>Ae(()=>import("./TestCreateEvent-HlMlIQWe.js"),__vite__mapDeps([21,8]))))})}),f.jsx(ze,{path:"/test/event-details",element:f.jsx(b.Suspense,{fallback:f.jsx(Qe,{}),children:Y.createElement(b.lazy(()=>Ae(()=>import("./TestEventDetails-DlXqnkEL.js"),[])))})}),f.jsx(ze,{path:"/test/join",element:f.jsx(b.Suspense,{fallback:f.jsx(Qe,{}),children:Y.createElement(b.lazy(()=>Ae(()=>import("./TestJoinEvent-DGl32hPa.js"),__vite__mapDeps([22,14]))))})}),f.jsx(ze,{path:"/test/camera",element:f.jsx(b.Suspense,{fallback:f.jsx(Qe,{}),children:Y.createElement(b.lazy(()=>Ae(()=>import("./TestCamera-DJ4MNXYy.js"),__vite__mapDeps([23,11]))))})}),f.jsx(ze,{path:"/test/settings",element:f.jsx(b.Suspense,{fallback:f.jsx(Qe,{}),children:Y.createElement(b.lazy(()=>Ae(()=>import("./TestSettings-BKmWVVfC.js"),__vite__mapDeps([24,16,1,12]))))})}),f.jsx(ze,{path:"/test/qr",element:f.jsx(b.Suspense,{fallback:f.jsx(Qe,{}),children:Y.createElement(b.lazy(()=>Ae(()=>import("./TestQR-BPSoMmWA.js"),[])))})}),f.jsx(ze,{path:"/test/admin",element:f.jsx(b.Suspense,{fallback:f.jsx(Qe,{}),children:Y.createElement(b.lazy(()=>Ae(()=>import("./TestAdminDashboard-CFJ7oiO7.js"),__vite__mapDeps([25,6]))))})}),f.jsx(ze,{path:"/test/not-found",element:f.jsx(b.Suspense,{fallback:f.jsx(Qe,{}),children:Y.createElement(b.lazy(()=>Ae(()=>import("./TestNotFound-CWIUIeCY.js"),[])))})}),f.jsx(ze,{path:"/test/permissions",element:f.jsx(b.Suspense,{fallback:f.jsx(Qe,{}),children:Y.createElement(b.lazy(()=>Ae(()=>import("./TestPermissions-DKh8d_Y7.js"),[])))})}),f.jsx(ze,{path:"/test/qr-scanner",element:f.jsx(b.Suspense,{fallback:f.jsx(Qe,{}),children:Y.createElement(b.lazy(()=>Ae(()=>import("./TestQRScanner-CdUmJq2K.js"),[])))})}),f.jsx(ze,{path:"/test/slideshow",element:f.jsx(b.Suspense,{fallback:f.jsx(Qe,{}),children:Y.createElement(b.lazy(()=>Ae(()=>import("./TestSlideshow-BGL8sC7l.js"),[])))})}),f.jsx(ze,{path:"/test/join-event-sheet",element:f.jsx(b.Suspense,{fallback:f.jsx(Qe,{}),children:Y.createElement(b.lazy(()=>Ae(()=>import("./TestJoinEventSheet-AEZuGwSs.js"),[])))})}),f.jsx(ze,{path:"/test/event-branding",element:f.jsx(b.Suspense,{fallback:f.jsx(Qe,{}),children:Y.createElement(b.lazy(()=>Ae(()=>import("./TestEventBranding-oZNSbzpQ.js"),[])))})}),f.jsx(ze,{path:"/test/photo-detail",element:f.jsx(b.Suspense,{fallback:f.jsx(Qe,{}),children:Y.createElement(b.lazy(()=>Ae(()=>import("./TestPhotoDetail-BAgOLFRO.js"),[])))})}),f.jsx(ze,{path:"/test/web-photo-editor",element:f.jsx(b.Suspense,{fallback:f.jsx(Qe,{}),children:Y.createElement(b.lazy(()=>Ae(()=>import("./TestWebPhotoEditor-C1TxHn1A.js"),[])))})}),f.jsx(ze,{path:"/test/fabric-editor",element:f.jsx(b.Suspense,{fallback:f.jsx(Qe,{}),children:Y.createElement(b.lazy(()=>Ae(()=>import("./TestFabricEditor-DTDWQW13.js"),[])))})}),f.jsx(ze,{path:"/test/qr-dialog",element:f.jsx(b.Suspense,{fallback:f.jsx(Qe,{}),children:Y.createElement(b.lazy(()=>Ae(()=>import("./TestQRDialog-Ys4eM1KB.js"),[])))})}),f.jsx(ze,{path:"/test/camera-permission",element:f.jsx(b.Suspense,{fallback:f.jsx(Qe,{}),children:Y.createElement(b.lazy(()=>Ae(()=>import("./TestCameraPermission-Cnq9kRwS.js"),[])))})}),f.jsx(ze,{path:"/test/photo-library-permission",element:f.jsx(b.Suspense,{fallback:f.jsx(Qe,{}),children:Y.createElement(b.lazy(()=>Ae(()=>import("./TestPhotoLibraryPermission-CxlkXP4s.js"),[])))})}),f.jsx(ze,{path:"/test/block-user-dialog",element:f.jsx(b.Suspense,{fallback:f.jsx(Qe,{}),children:Y.createElement(b.lazy(()=>Ae(()=>import("./TestBlockUserDialog-CThC3INO.js"),[])))})}),f.jsx(ze,{path:"/test/download-restriction",element:f.jsx(b.Suspense,{fallback:f.jsx(Qe,{}),children:Y.createElement(b.lazy(()=>Ae(()=>import("./TestDownloadRestriction-WmXn_O-R.js"),[])))})}),f.jsx(ze,{path:"/test/upload-overlay",element:f.jsx(b.Suspense,{fallback:f.jsx(Qe,{}),children:Y.createElement(b.lazy(()=>Ae(()=>import("./TestUploadOverlay-mIh1bHuM.js"),__vite__mapDeps([26,11,12]))))})}),f.jsx(ze,{path:"/test/error-ui",element:f.jsx(b.Suspense,{fallback:f.jsx(Qe,{}),children:Y.createElement(b.lazy(()=>Ae(()=>import("./TestErrorUI-CT6WhJl7.js"),__vite__mapDeps([27,5,1]))))})}),f.jsx(ze,{path:"/login",element:f.jsx(Gy,{})}),f.jsx(ze,{path:"/auth",element:f.jsx(Gy,{})}),f.jsx(ze,{path:"*",element:f.jsx(kH,{})})]})})]})),DZ=()=>f.jsx(KF,{client:TZ,children:f.jsx(SM,{attribute:"class",defaultTheme:"light",enableSystem:!0,children:f.jsx(XW,{children:f.jsx(ZW,{children:f.jsxs(EF,{children:[f.jsx(xM,{}),f.jsx(QM,{}),f.jsx(AZ,{})]})})})})}),N2=()=>{const n=document.documentElement,e=document.body;n.classList.remove("drawer-open"),e.style.position="",e.style.top="",e.style.width="",e.style.overflow="",e.style.paddingRight="",console.log(" Cleared any stuck drawer scroll lock states")};if(typeof window<"u"){window.addEventListener("load",N2);let n=window.location.pathname;new MutationObserver(()=>{window.location.pathname!==n&&(n=window.location.pathname,N2())}).observe(document.documentElement,{childList:!0,subtree:!0})}const OZ=()=>{var r,s,i,o,a,l,c,u;const n=(s=(r=window.Capacitor)==null?void 0:r.Plugins)==null?void 0:s.PushNotifications,e=(o=(i=window.Capacitor)==null?void 0:i.Plugins)==null?void 0:o.FirebaseMessaging,t=((l=(a=window.Capacitor)==null?void 0:a.getPlatform)==null?void 0:l.call(a))||"unknown";return console.log(" Push Extensions Status Check..."),console.log("Platform:",t),console.log("PushNotifications available (iOS):",!!n),console.log("FirebaseMessaging available (Android):",!!e),console.log("hasInitializeFCM_check : loaded",!!(n!=null&&n.initializeFCM)),{hasCapacitor:!!window.Capacitor,hasPushNotifications:!!n,hasFirebaseMessaging:!!e,hasInitializeFCM:!!(n!=null&&n.initializeFCM),platform:t,isNative:((u=(c=window.Capacitor)==null?void 0:c.isNativePlatform)==null?void 0:u.call(c))||!1,recommendedPlugin:t==="android"?"FirebaseMessaging":"PushNotifications"}},IZ="jgfcfdlfcnmaripgpepl";function _x(){var n,e,t,r,s;try{const i=(n=window.PhotoShareAuthState)==null?void 0:n.accessToken;if(i)return i;const o=`sb-${IZ}-auth-token`,a=localStorage.getItem(o)||sessionStorage.getItem(o);if(a)try{const u=JSON.parse(a),h=((e=u==null?void 0:u.currentSession)==null?void 0:e.access_token)||(u==null?void 0:u.access_token)||((t=u==null?void 0:u.session)==null?void 0:t.access_token)||null;if(h)return h}catch{}const l=[];for(let u=0;u<localStorage.length;u++){const h=localStorage.key(u);h&&l.push(h)}for(let u=0;u<sessionStorage.length;u++){const h=sessionStorage.key(u);h&&l.push(h)}for(const u of l)if(u.includes("auth-token")){const h=localStorage.getItem(u)||sessionStorage.getItem(u);if(!h)continue;try{const d=JSON.parse(h),p=((r=d==null?void 0:d.currentSession)==null?void 0:r.access_token)||(d==null?void 0:d.access_token)||((s=d==null?void 0:d.session)==null?void 0:s.access_token)||null;if(p)return p}catch{}}const c=localStorage.getItem("sb-access-token")||sessionStorage.getItem("sb-access-token")||null;return c||null}catch{return null}}class RZ{constructor(){It(this,"isAvailable");It(this,"plugin",null);It(this,"currentEventId",null);It(this,"isMonitoring",!1);It(this,"settingsHook",null);this.isAvailable=de.isPluginAvailable("AutoUpload");try{this.plugin=window.AutoUpload||null}catch(e){console.log("AutoUpload plugin not available:",e),this.plugin=null}}isAutoUploadAvailable(){return this.isAvailable&&(de.getPlatform()==="android"||de.getPlatform()==="ios")}async getSettings(){var e;if(!this.isAutoUploadAvailable())return{autoUploadEnabled:!1,backgroundUploadEnabled:!1,wifiOnlyEnabled:!1};try{if(this.plugin&&this.plugin.getSettings){const r=await this.plugin.getSettings();return{autoUploadEnabled:r.autoUploadEnabled||!1,backgroundUploadEnabled:r.backgroundUploadEnabled||!1,wifiOnlyEnabled:r.wifiOnlyEnabled||!1}}const t=(e=window.currentUser)==null?void 0:e.id;if(t){const r=localStorage.getItem(`auto_upload_settings_${t}`);if(r){const s=JSON.parse(r);return{autoUploadEnabled:s.autoUploadEnabled||!1,backgroundUploadEnabled:s.backgroundUploadEnabled||!1,wifiOnlyEnabled:s.wifiOnlyUpload||!1}}}return{autoUploadEnabled:!1,backgroundUploadEnabled:!1,wifiOnlyEnabled:!1}}catch(t){return console.error(" Failed to get auto-upload settings:",t),{autoUploadEnabled:!1,backgroundUploadEnabled:!1,wifiOnlyEnabled:!1}}}async setAutoUploadEnabled(e){var t;if(!this.isAutoUploadAvailable())return{success:!1,error:"Auto-upload not available on this platform"};try{if(console.log(` ${e?"Enabling":"Disabling"} auto-upload...`),this.plugin&&this.plugin.setAutoUploadEnabled){const s=await this.plugin.setAutoUploadEnabled({enabled:e});return e&&this.currentEventId?await this.startMonitoring():e||await this.stopMonitoring(),s}const r=(t=window.currentUser)==null?void 0:t.id;if(r){const s=localStorage.getItem(`auto_upload_settings_${r}`),i=s?JSON.parse(s):{};return i.autoUploadEnabled=e,localStorage.setItem(`auto_upload_settings_${r}`,JSON.stringify(i)),window.dispatchEvent(new CustomEvent("autoUploadSettingsChanged",{detail:{autoUploadEnabled:e}})),{success:!0}}return{success:!1,error:"No user context available"}}catch(r){return console.error(" Failed to set auto-upload enabled:",r),{success:!1,error:r instanceof Error?r.message:"Unknown error"}}}async setBackgroundUploadEnabled(e){var t;if(!this.isAutoUploadAvailable())return{success:!1,error:"Auto-upload not available on this platform"};try{if(console.log(` ${e?"Enabling":"Disabling"} background auto-upload...`),this.plugin&&this.plugin.setBackgroundUploadEnabled)return await this.plugin.setBackgroundUploadEnabled({enabled:e});const r=(t=window.currentUser)==null?void 0:t.id;if(r){const s=localStorage.getItem(`auto_upload_settings_${r}`),i=s?JSON.parse(s):{};return i.backgroundUploadEnabled=e,localStorage.setItem(`auto_upload_settings_${r}`,JSON.stringify(i)),window.dispatchEvent(new CustomEvent("autoUploadSettingsChanged",{detail:{backgroundUploadEnabled:e}})),{success:!0}}return{success:!1,error:"No user context available"}}catch(r){return console.error(" Failed to set background upload:",r),{success:!1,error:r instanceof Error?r.message:"Unknown error"}}}async setWifiOnlyUploadEnabled(e){var t;if(!this.isAutoUploadAvailable())return{success:!1,error:"Auto-upload not available on this platform"};try{if(console.log(` ${e?"Enabling":"Disabling"} WiFi-only auto-upload...`),this.plugin&&this.plugin.setWifiOnlyUploadEnabled)return await this.plugin.setWifiOnlyUploadEnabled({enabled:e});const r=(t=window.currentUser)==null?void 0:t.id;if(r){const s=localStorage.getItem(`auto_upload_settings_${r}`),i=s?JSON.parse(s):{};return i.wifiOnlyUpload=e,localStorage.setItem(`auto_upload_settings_${r}`,JSON.stringify(i)),window.dispatchEvent(new CustomEvent("autoUploadSettingsChanged",{detail:{wifiOnlyEnabled:e}})),{success:!0}}return{success:!1,error:"No user context available"}}catch(r){return console.error(" Failed to set WiFi-only upload:",r),{success:!1,error:r instanceof Error?r.message:"Unknown error"}}}async setCurrentEventContext(e,t,r,s){if(!this.isAutoUploadAvailable())return{success:!1,error:"Auto-upload not available on this platform"};try{if(console.log(` Setting auto-upload event context: ${e} - ${t}`),console.log(` Event timeframe: ${r} to ${s}`),this.currentEventId=e,this.plugin&&this.plugin.setCurrentEventContext){const i=await this.plugin.setCurrentEventContext({eventId:e,eventName:t,startTime:r,endTime:s});return(await this.getSettings()).autoUploadEnabled&&await this.startMonitoring(),i}return window.currentEventContext={eventId:e,eventName:t,startTime:r,endTime:s},{success:!0}}catch(i){return console.error(" Failed to set event context:",i),{success:!1,error:i instanceof Error?i.message:"Unknown error"}}}async clearCurrentEventContext(){if(!this.isAutoUploadAvailable())return{success:!1,error:"Auto-upload not available on this platform"};try{return console.log(" Clearing auto-upload event context"),this.currentEventId=null,await this.stopMonitoring(),this.plugin&&this.plugin.clearCurrentEventContext?await this.plugin.clearCurrentEventContext():(delete window.currentEventContext,{success:!0})}catch(e){return console.error(" Failed to clear event context:",e),{success:!1,error:e instanceof Error?e.message:"Unknown error"}}}async getStatus(){if(!this.isAutoUploadAvailable())return{autoUploadEnabled:!1,available:!1,reason:"Plugin not available on this platform"};try{return this.plugin&&this.plugin.getStatus?{...await this.plugin.getStatus(),available:!0}:{autoUploadEnabled:(await this.getSettings()).autoUploadEnabled,currentEventId:this.currentEventId,isMonitoring:this.isMonitoring,available:!0}}catch(e){return console.error(" Failed to get auto-upload status:",e),{autoUploadEnabled:!1,available:!1,error:e instanceof Error?e.message:"Unknown error"}}}async getNetworkInfo(){if(!this.isAutoUploadAvailable())return{networkType:"unknown",isWifi:!1};try{if(this.plugin&&this.plugin.getNetworkInfo)return await this.plugin.getNetworkInfo();if("connection"in navigator){const e=navigator.connection;return{networkType:e.effectiveType||"unknown",isWifi:e.type==="wifi"}}return{networkType:"unknown",isWifi:!1}}catch(e){return console.error(" Failed to get network info:",e),{networkType:"unknown",isWifi:!1,error:e instanceof Error?e.message:"Unknown error"}}}async checkForNewPhotos(){if(!this.isAutoUploadAvailable())return{success:!1,error:"Auto-upload not available on this platform"};try{return console.log(" Manually checking for new photos..."),this.plugin&&this.plugin.checkForNewPhotos?await this.plugin.checkForNewPhotos():{success:!0,message:"Manual check triggered (web fallback)"}}catch(e){return console.error(" Failed to check for new photos:",e),{success:!1,error:e instanceof Error?e.message:"Unknown error"}}}async getUploadedPhotos(e){var t,r;try{if(console.log(` Getting uploaded photos for event: ${e.eventId}`),this.plugin&&this.plugin.getUploadedPhotos)return await this.plugin.getUploadedPhotos(e);try{!((r=(t=window.PhotoShareAuthBridge)==null?void 0:t.isReady)!=null&&r.call(t))&&window.waitForPhotoshareReady&&await window.waitForPhotoshareReady("authBridge")}catch{}const s=_x();if(!s)throw new Error("No authentication token found (auth not ready)");const i=await fetch(`https://jgfcfdlfcnmaripgpepl.supabase.co/functions/v1/api-events-uploaded-photos/${e.eventId}`,{method:"GET",headers:{Authorization:`Bearer ${s}`,"Content-Type":"application/json"}});if(!i.ok)throw new Error(`HTTP ${i.status}: ${i.statusText}`);const o=await i.json();return{success:!0,photos:o.photos||[],count:o.count||0}}catch(s){return console.error(" Failed to get uploaded photos:",s),{success:!1,error:s instanceof Error?s.message:"Unknown error",photos:[],count:0}}}async uploadPhoto(e){var t,r;try{if(console.log(` Uploading photo to event: ${e.eventId}`),this.plugin&&this.plugin.uploadPhoto)return await this.plugin.uploadPhoto(e);try{!((r=(t=window.PhotoShareAuthBridge)==null?void 0:t.isReady)!=null&&r.call(t))&&window.waitForPhotoshareReady&&await window.waitForPhotoshareReady("authBridge")}catch{}const s=_x();if(!s)throw new Error("No authentication token found (auth not ready)");const i=await fetch("https://jgfcfdlfcnmaripgpepl.supabase.co/functions/v1/mobile-upload",{method:"POST",headers:{Authorization:`Bearer ${s}`,"Content-Type":"application/json"},body:JSON.stringify({eventId:e.eventId,file:e.photoData,mediaType:e.mediaType||"photo"})});if(!i.ok)throw new Error(`HTTP ${i.status}: ${i.statusText}`);const o=await i.json();return{success:!0,uploadId:o.uploadId,mediaId:o.mediaId}}catch(s){return console.error(" Failed to upload photo:",s),{success:!1,error:s instanceof Error?s.message:"Unknown error"}}}async startMonitoring(){if(!this.isAutoUploadAvailable()||this.isMonitoring)return{success:!1,error:"Monitoring not available or already active"};try{if(console.log(" Starting auto-upload photo monitoring..."),this.plugin&&this.plugin.startMonitoring){const e=await this.plugin.startMonitoring();return this.isMonitoring=!0,e}return this.isMonitoring=!0,{success:!0,message:"Monitoring started (web fallback)"}}catch(e){return console.error(" Failed to start monitoring:",e),{success:!1,error:e instanceof Error?e.message:"Unknown error"}}}async stopMonitoring(){if(!this.isAutoUploadAvailable())return{success:!1,error:"Monitoring not available"};try{if(console.log(" Stopping auto-upload photo monitoring"),this.plugin&&this.plugin.stopMonitoring){const e=await this.plugin.stopMonitoring();return this.isMonitoring=!1,e}return this.isMonitoring=!1,{success:!0,message:"Monitoring stopped (web fallback)"}}catch(e){return console.error(" Failed to stop monitoring:",e),{success:!1,error:e instanceof Error?e.message:"Unknown error"}}}async getUploadProgress(){try{if(this.plugin&&this.plugin.getUploadProgress)return await this.plugin.getUploadProgress();const e=localStorage.getItem("upload_queue")||"[]",t=JSON.parse(e);return{success:!0,totalUploads:t.length,completedUploads:t.filter(r=>r.status==="completed").length,failedUploads:t.filter(r=>r.status==="failed").length,queuedUploads:t.filter(r=>r.status==="queued").length}}catch(e){return console.error(" Failed to get upload progress:",e),{success:!1,error:e instanceof Error?e.message:"Unknown error"}}}async retryFailedUploads(){try{return console.log(" Retrying failed uploads..."),this.plugin&&this.plugin.retryFailedUploads?await this.plugin.retryFailedUploads():{success:!0,message:"Retry triggered (web fallback)"}}catch(e){return console.error(" Failed to retry uploads:",e),{success:!1,error:e instanceof Error?e.message:"Unknown error"}}}async clearUploadQueue(){try{return console.log(" Clearing upload queue..."),this.plugin&&this.plugin.clearUploadQueue?await this.plugin.clearUploadQueue():(localStorage.removeItem("upload_queue"),{success:!0,message:"Queue cleared (web fallback)"})}catch(e){return console.error(" Failed to clear upload queue:",e),{success:!1,error:e instanceof Error?e.message:"Unknown error"}}}}const NZ=new RZ;window.PhotoShareAutoUpload=NZ;window.AutoUpload=window.AutoUpload||{};window.AutoUpload.getUploadedPhotos=function(n){try{const e=(n==null?void 0:n.eventId)||"";if(!e)return JSON.stringify({initiated:!0,success:!1,error:"Missing eventId"});const t=_x();if(!t)return JSON.stringify({initiated:!0,success:!1,error:"No authentication token found (auth not ready)"});const r=`https://jgfcfdlfcnmaripgpepl.supabase.co/functions/v1/api-events-uploaded-photos/${encodeURIComponent(e)}`,s=new XMLHttpRequest;try{s.open("GET",r,!1),s.setRequestHeader("Authorization",`Bearer ${t}`),s.setRequestHeader("Content-Type","application/json"),s.send(null)}catch{return JSON.stringify({initiated:!0,success:!1,error:"Network error"})}if(s.status>=200&&s.status<300)try{const o=JSON.parse(s.responseText||"{}");return JSON.stringify({initiated:!0,success:!0,photos:o.photos||[],count:o.count||0})}catch{return JSON.stringify({initiated:!0,success:!1,error:"Invalid JSON response"})}return(s.getResponseHeader("Content-Type")||"").includes("application/json")?JSON.stringify({initiated:!0,success:!1,error:`HTTP ${s.status}`}):JSON.stringify({initiated:!0,success:!1,error:`HTTP ${s.status}: Non-JSON response`})}catch(e){return JSON.stringify({initiated:!0,success:!1,error:(e==null?void 0:e.message)||"Unknown error"})}};const j2=Pn("DeepLinkRouter");var V2;typeof window<"u"&&((V2=window.Capacitor)!=null&&V2.Plugins)&&(window.Capacitor.Plugins.DeepLinkRouter=j2,window.CapacitorPlugins=window.CapacitorPlugins||{},window.CapacitorPlugins.DeepLinkRouter=j2);window.handlePhotoShareDeepLink=function(n){console.log(" [WEB] Processing deep link:",n),console.log(" [WEB] Current location:",window.location.href);try{const e=new URL(n);let t=e.hostname,r=e.pathname.substring(1);if(!t&&e.pathname){const i=e.pathname.replace(/^\/+/,"").split("/");t=i[0]||"",r=i[1]||"",console.log(" [WEB] Parsed from pathname - action:",t,"eventId:",r)}else console.log(" [WEB] Parsed from hostname - action:",t,"eventId:",r);let s="/";switch(t){case"create":s="/create-event",console.log(" [WEB] Navigating to create event");break;case"event":r?(s=`/event/${r}`,console.log(" [WEB] Navigating to event:",r)):(console.warn(" [WEB] Event deep link missing eventId"),s="/dashboard");break;case"upload":r?(s=`/event/${r}?action=upload`,console.log(" [WEB] Navigating to event for upload:",r)):(console.warn(" [WEB] Upload deep link missing eventId"),s="/dashboard");break;case"download":r?(s=`/event/${r}?action=download`,console.log(" [WEB] Navigating to event for download with overlay:",r)):(console.warn(" [WEB] Download deep link missing eventId"),s="/dashboard");break;case"join":const i=r.split("/"),o=i[0],a=i[1]||"";o?(s=a?`/join/${o}?passcode=${a}`:`/join/${o}`,console.log(" [WEB] Navigating to join event:",o,a?"with password":"")):(console.warn(" [WEB] Join deep link missing eventCode"),s="/join");break;case"home":s="/dashboard",console.log(" [WEB] Navigating to home/dashboard");break;default:console.warn(" [WEB] Unknown deep link action:",t),s="/dashboard"}window.location.href=s,console.log(" [WEB] Deep link navigation complete:",s)}catch(e){console.error(" [WEB] Error processing deep link:",e),window.location.href="/dashboard"}};async function jZ(){var n,e,t,r;try{if(!((e=(n=window.Capacitor)==null?void 0:n.isNativePlatform)!=null&&e.call(n))){console.log(" [WEB] Not on native platform, skipping Capacitor appUrlOpen listener");return}if(!((r=(t=window.Capacitor)==null?void 0:t.Plugins)!=null&&r.App)){console.log(" [WEB] App plugin not available on this platform, skipping appUrlOpen listener"),console.log(" [WEB] Deep links will be handled by custom DeepLinkRouter plugin instead");return}console.log(" [WEB] Setting up Capacitor appUrlOpen listener for iOS/Android"),await $y.addListener("appUrlOpen",s=>{console.log(" [WEB] Capacitor appUrlOpen event received:",s),s.url&&typeof window.handlePhotoShareDeepLink=="function"?window.handlePhotoShareDeepLink(s.url):console.warn(" [WEB] appUrlOpen event missing URL or handler not ready:",s)}),console.log(" [WEB] Capacitor appUrlOpen listener registered successfully")}catch(s){console.log(" [WEB] Could not setup Capacitor appUrlOpen listener:",s),console.log(" [WEB] This is normal on Android - deep links will use custom DeepLinkRouter plugin")}}jZ();console.log(" [WEB] DeepLinkRouter plugin registered");console.log(" [WEB] window.handlePhotoShareDeepLink() is available");console.log(" [WEB] Capacitor appUrlOpen listener initialized");document.addEventListener("DOMContentLoaded",()=>{console.log(" [WEB] DOMContentLoaded - checking for pending deep link"),window._pendingDeepLink?(console.log(" [WEB] Found pending deep link:",window._pendingDeepLink),setTimeout(()=>{if(typeof window.handlePhotoShareDeepLink=="function"){console.log(" [WEB] Processing pending deep link from DOMContentLoaded");const n=window._pendingDeepLink;window._pendingDeepLink=null,window.handlePhotoShareDeepLink(n)}else console.warn(" [WEB] handlePhotoShareDeepLink not yet available, will retry"),setTimeout(()=>{if(typeof window.handlePhotoShareDeepLink=="function"&&window._pendingDeepLink){console.log(" [WEB] Retry: Processing pending deep link");const n=window._pendingDeepLink;window._pendingDeepLink=null,window.handlePhotoShareDeepLink(n)}},500)},500)):console.log(" [WEB] No pending deep link found")});window.supabase=ue;window.PhotoShareLoadingState&&window.PhotoShareLoadingState.markReady("supabase");window.handleNativeUploads=async function(n,e){var t;console.log("Native upload handler called:",{photoCount:n.length,eventId:e});try{const r=n.map(o=>({file_name:o.name||`photo-${Date.now()}.jpg`,file_size:o.size||0,media_type:"photo",metadata:{date_taken:o.dateModified?new Date(o.dateModified).toISOString():new Date().toISOString(),device_id:"native-app"}})),s=await fetch("https://jgfcfdlfcnmaripgpepl.supabase.co/functions/v1/upload-queue-register",{method:"POST",headers:{Authorization:`Bearer ${(t=(await ue.auth.getSession()).data.session)==null?void 0:t.access_token}`,"Content-Type":"application/json"},body:JSON.stringify({event_id:e,uploads:r})});if(!s.ok)throw new Error(`Failed to register uploads: ${s.statusText}`);const i=await s.json();return console.log("Queue registration successful:",i),setTimeout(async()=>{try{await LZ(n,e,i.uploads)}catch(o){console.error("Background upload processing failed:",o)}},0),{success:!0,message:`Processing ${n.length} photos`,uploadCount:n.length,queueId:i.queue_id}}catch(r){return console.error("Native upload handler error:",r),{success:!1,message:r instanceof Error?r.message:"Upload registration failed",uploadCount:0}}};async function LZ(n,e,t){var r,s,i,o;console.log("Processing native uploads:",{photoCount:n.length,eventId:e});for(let a=0;a<n.length;a++){const l=n[a],c=t[a];if(c)try{await fetch(`https://jgfcfdlfcnmaripgpepl.supabase.co/functions/v1/upload-status-update/${c.upload_id}`,{method:"PATCH",headers:{Authorization:`Bearer ${(r=(await ue.auth.getSession()).data.session)==null?void 0:r.access_token}`,"Content-Type":"application/json"},body:JSON.stringify({status:"uploading",progress:0})});const u=l.data||l.webPath;let h;typeof u=="string"&&fo(u)?h=p1(u):typeof u=="string"?h=await(await fetch(u)).blob():h=u;const d=new File([h],c.file_name,{type:h.type||"image/jpeg"});await fetch(`https://jgfcfdlfcnmaripgpepl.supabase.co/functions/v1/upload-status-update/${c.upload_id}`,{method:"PATCH",headers:{Authorization:`Bearer ${(s=(await ue.auth.getSession()).data.session)==null?void 0:s.access_token}`,"Content-Type":"application/json"},body:JSON.stringify({status:"uploading",progress:50})});const p=new FormData;p.append("file",d),p.append("event_id",e);const m=await fetch(`https://jgfcfdlfcnmaripgpepl.supabase.co/functions/v1/upload-complete/${c.upload_id}`,{method:"POST",headers:{Authorization:`Bearer ${(i=(await ue.auth.getSession()).data.session)==null?void 0:i.access_token}`},body:p});if(m.ok)console.log(`Upload ${a+1}/${n.length} completed successfully`),window.dispatchEvent(new CustomEvent("uploadComplete",{detail:{eventId:e,uploadId:c.upload_id,photoIndex:a}}));else{let g="Unknown error";try{g=await m.text()}catch(y){console.error("Failed to read error response:",y)}throw new Error(`Upload failed: ${g||"Server error"}`)}}catch(u){console.error(`Upload ${a+1} failed:`,u);try{await fetch(`https://jgfcfdlfcnmaripgpepl.supabase.co/functions/v1/upload-status-update/${c.upload_id}`,{method:"PATCH",headers:{Authorization:`Bearer ${(o=(await ue.auth.getSession()).data.session)==null?void 0:o.access_token}`,"Content-Type":"application/json"},body:JSON.stringify({status:"failed",error_message:u instanceof Error?u.message:"Upload failed"})})}catch(h){console.error("Failed to update status to failed:",h)}}}console.log("All native uploads processed")}async function MZ(){try{de.isNativePlatform()&&(console.log(" Firebase plugins ready for native platforms"),console.log(" IMPORTANT: Make sure GoogleService-Info.plist is added to your iOS project in Xcode"),console.log(" IMPORTANT: Make sure google-services.json is added to your Android project"),console.log(" Firebase setup ready - plugins will auto-initialize with config files"))}catch(n){console.error(" Firebase setup check failed:",n)}}async function FZ(){try{if(de.isNativePlatform()){console.log(" Testing Firebase Auth getCurrentUser...");const n=await Ts.getCurrentUser();console.log(" Firebase Auth test succeeded:",n)}else console.log(" Running on web - Firebase Auth will use web implementation")}catch(n){console.error(" Firebase Auth test failed:",n)}try{console.log(" Testing AppleSignIn plugin availability..."),mD&&console.log(" Apple Sign-In plugin is available")}catch(n){console.error(" AppleSignIn plugin check failed:",n)}}const L2=()=>{MZ().then(()=>{FZ(),setTimeout(()=>{console.log("main_checkPushExtensions : loaded"),OZ()},1e3)})};"requestIdleCallback"in window?requestIdleCallback(L2,{timeout:2e3}):setTimeout(L2,100);aT(document.getElementById("root")).render(f.jsx(DZ,{}));export{lb as $,kr as A,_e as B,Ht as C,Md as D,eb as E,tb as F,nb as G,rb as H,zo as I,sb as J,je as K,GZ as L,Gs as M,qs as N,Ys as O,fJ as P,no as Q,IL as R,Sw as S,LI as T,Xp as U,Tl as V,s3 as W,KR as X,ab as Y,JR as Z,Ae as _,Bt as a,bL as a$,Gr as a0,MT as a1,Wr as a2,LT as a3,Sg as a4,zZ as a5,CH as a6,H4 as a7,Hy as a8,Vy as a9,bK as aA,Bee as aB,Fee as aC,J6 as aD,jT as aE,_M as aF,JW as aG,OI as aH,YO as aI,NL as aJ,Gl as aK,xo as aL,ct as aM,Le as aN,De as aO,wo as aP,CI as aQ,iA as aR,k4 as aS,c1 as aT,ti as aU,xH as aV,wH as aW,Oe as aX,yw as aY,x2 as aZ,PL as a_,FQ as aa,t3 as ab,e3 as ac,cb as ad,h1 as ae,_w as af,AL as ag,G_ as ah,E6 as ai,GJ as aj,ha as ak,Uee as al,da as am,Sa as an,AH as ao,XQ as ap,Ep as aq,kp as ar,xq as as,qI as at,z_ as au,DY as av,Sq as aw,de as ax,ax as ay,Cq as az,vs as b,mee as b$,EH as b0,Zp as b1,gA as b2,iI as b3,KO as b4,j1 as b5,yd as b6,mA as b7,tr as b8,vA as b9,_L as bA,Q1 as bB,QQ as bC,Cw as bD,kL as bE,nc as bF,EL as bG,AY as bH,S3 as bI,ub as bJ,db as bK,fb as bL,pb as bM,hb as bN,mb as bO,gb as bP,wd as bQ,Yf as bR,pZ as bS,W_ as bT,TY as bU,qw as bV,WW as bW,uee as bX,dee as bY,cee as bZ,Eee as b_,lT as ba,L1 as bb,ua as bc,cT as bd,Gp as be,lF as bf,Hs as bg,SL as bh,JQ as bi,O2 as bj,$_ as bk,fo as bl,ec as bm,OL as bn,ux as bo,dx as bp,Hu as bq,hx as br,Cg as bs,Ew as bt,uy as bu,Bc as bv,q_ as bw,BT as bx,TL as by,DL as bz,RI as c,Ree as c0,ff as c1,pee as c2,WS as c3,Ea as c4,ji as c5,Mi as c6,Li as c7,kee as c8,Tee as c9,oC as cA,zz as cB,l4 as cC,Dz as cD,Pn as cE,yl as cF,Zu as cG,Zl as cH,kD as cI,Ed as cJ,So as cK,h$ as cL,zU as cM,$U as cN,ree as cO,yt as cP,TD as cQ,see as cR,mU as cS,OE as cT,$ee as cU,zee as cV,Fi as ca,_9 as cb,Cee as cc,vee as cd,lee as ce,fee as cf,zS as cg,See as ch,iee as ci,aee as cj,hee as ck,gee as cl,Pee as cm,oee as cn,wee as co,bee as cp,xee as cq,Y9 as cr,yee as cs,Oee as ct,Aee as cu,Iee as cv,Dee as cw,mz as cx,oi as cy,_ee as cz,hy as d,Kr as e,Qt as f,cy as g,ly as h,wL as i,f as j,ql as k,bc as l,_c as m,Sc as n,Cc as o,js as p,V4 as q,b as r,ue as s,X1 as t,Or as u,kK as v,Od as w,aJ as x,PH as y,cJ as z};
